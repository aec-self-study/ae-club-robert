[0m10:06:44.988606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434a7a63b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43494ca500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43494c9db0>]}


============================== 10:06:44.991232 | d3f3d39b-bba8-4a8b-8dd2-136e77131d2a ==============================
[0m10:06:44.991232 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:06:44.991983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:06:45.394366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3f3d39b-bba8-4a8b-8dd2-136e77131d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434a37b550>]}
[0m10:06:45.411645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3f3d39b-bba8-4a8b-8dd2-136e77131d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43479b5540>]}
[0m10:06:45.412467 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:06:45.424021 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m10:06:45.424619 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:06:45.425201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd3f3d39b-bba8-4a8b-8dd2-136e77131d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43479b45e0>]}
[0m10:06:46.124726 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m10:06:46.246929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_robert.example
[0m10:06:46.253124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3f3d39b-bba8-4a8b-8dd2-136e77131d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43478f3df0>]}
[0m10:06:46.260211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3f3d39b-bba8-4a8b-8dd2-136e77131d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434737b730>]}
[0m10:06:46.260704 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:06:46.261267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f3d39b-bba8-4a8b-8dd2-136e77131d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43478f3a00>]}
[0m10:06:46.262790 [info ] [MainThread]: 
[0m10:06:46.264057 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:06:46.265698 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m10:06:46.266202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:47.440734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now create_aec-students_dbt_robert)
[0m10:06:47.441863 [debug] [ThreadPool]: Creating schema "database: "aec-students"
schema: "dbt_robert"
"
[0m10:06:47.452547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:06:47.453001 [debug] [ThreadPool]: On create_aec-students_dbt_robert: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "connection_name": "create_aec-students_dbt_robert"} */
create schema if not exists `aec-students`.`dbt_robert`
  
[0m10:06:50.115833 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:EU:76e022bf-8bb6-4cfa-8095-bae50be26cf8&page=queryresults
[0m10:06:50.118987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_aec-students_dbt_robert, now list_aec-students_dbt_robert)
[0m10:06:50.119706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:06:50.288308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f3d39b-bba8-4a8b-8dd2-136e77131d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434737a440>]}
[0m10:06:50.289297 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:06:50.289898 [info ] [MainThread]: 
[0m10:06:50.324403 [debug] [Thread-1 (]: Began running node model.coffee_shop.dbtcustomers
[0m10:06:50.325094 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_robert.dbtcustomers ............................ [RUN]
[0m10:06:50.326134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.coffee_shop.dbtcustomers)
[0m10:06:50.326568 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.dbtcustomers
[0m10:06:50.329271 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.dbtcustomers"
[0m10:06:50.330147 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (compile): 10:06:50.326841 => 10:06:50.329850
[0m10:06:50.330573 [debug] [Thread-1 (]: Began executing node model.coffee_shop.dbtcustomers
[0m10:06:50.364124 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.dbtcustomers"
[0m10:06:50.364934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:06:50.365405 [debug] [Thread-1 (]: On model.coffee_shop.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers`
  OPTIONS()
  as select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
--I've acceted your change.local
from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5;


[0m10:06:50.625834 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers`
  OPTIONS()
  as select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
--I've acceted your change.local
from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5;


[0m10:06:50.626545 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset analytics-engineers-club:coffee_shop was not found in location EU

Location: EU
Job ID: 7c247f8d-9b5c-478d-a065-a8f53c0c4677

[0m10:06:50.627225 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (execute): 10:06:50.330896 => 10:06:50.626982
[0m10:06:50.641042 [debug] [Thread-1 (]: Runtime Error in model dbtcustomers (models/dbtcustomers.sql)
  404 Not found: Dataset analytics-engineers-club:coffee_shop was not found in location EU
  
  Location: EU
  Job ID: 7c247f8d-9b5c-478d-a065-a8f53c0c4677
  
[0m10:06:50.641598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f3d39b-bba8-4a8b-8dd2-136e77131d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4347432ce0>]}
[0m10:06:50.642320 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_robert.dbtcustomers ................... [[31mERROR[0m in 0.32s]
[0m10:06:50.643138 [debug] [Thread-1 (]: Finished running node model.coffee_shop.dbtcustomers
[0m10:06:50.645834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:50.646224 [debug] [MainThread]: Connection 'model.coffee_shop.dbtcustomers' was properly closed.
[0m10:06:50.646574 [info ] [MainThread]: 
[0m10:06:50.647306 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m10:06:50.648489 [debug] [MainThread]: Command end result
[0m10:06:50.655899 [info ] [MainThread]: 
[0m10:06:50.656647 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:06:50.657322 [info ] [MainThread]: 
[0m10:06:50.657889 [error] [MainThread]: [33mRuntime Error in model dbtcustomers (models/dbtcustomers.sql)[0m
[0m10:06:50.658593 [error] [MainThread]:   404 Not found: Dataset analytics-engineers-club:coffee_shop was not found in location EU
[0m10:06:50.659309 [error] [MainThread]:   
[0m10:06:50.659922 [error] [MainThread]:   Location: EU
[0m10:06:50.660613 [error] [MainThread]:   Job ID: 7c247f8d-9b5c-478d-a065-a8f53c0c4677
[0m10:06:50.661281 [error] [MainThread]:   
[0m10:06:50.661933 [info ] [MainThread]: 
[0m10:06:50.662718 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:06:50.663929 [debug] [MainThread]: Command `dbt run` failed at 10:06:50.663722 after 5.68 seconds
[0m10:06:50.664630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434a7a63b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43479d06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434742bcd0>]}
[0m10:06:50.665201 [debug] [MainThread]: Flushing usage events
[0m10:07:22.061426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a2612350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a189e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a189e440>]}


============================== 10:07:22.064003 | 02a29ace-2f2e-48f9-8069-ea9f87c5568e ==============================
[0m10:07:22.064003 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:07:22.064741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:07:22.431918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02a29ace-2f2e-48f9-8069-ea9f87c5568e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a24f5900>]}
[0m10:07:22.449166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02a29ace-2f2e-48f9-8069-ea9f87c5568e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029f9e16c0>]}
[0m10:07:22.449916 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:07:22.461581 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m10:07:22.505692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:07:22.506098 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:07:22.506602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_robert.example
[0m10:07:22.513405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02a29ace-2f2e-48f9-8069-ea9f87c5568e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029f7a80d0>]}
[0m10:07:22.521894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02a29ace-2f2e-48f9-8069-ea9f87c5568e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029f8c6b00>]}
[0m10:07:22.522425 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:07:22.522982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02a29ace-2f2e-48f9-8069-ea9f87c5568e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029f8c6b90>]}
[0m10:07:22.524388 [info ] [MainThread]: 
[0m10:07:22.525778 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:07:22.527409 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m10:07:22.527882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:23.624191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m10:07:23.624955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:23.792919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02a29ace-2f2e-48f9-8069-ea9f87c5568e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029f8c61d0>]}
[0m10:07:23.794232 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:07:23.795017 [info ] [MainThread]: 
[0m10:07:23.799784 [debug] [Thread-1 (]: Began running node model.coffee_shop.dbtcustomers
[0m10:07:23.800518 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_robert.dbtcustomers ............................ [RUN]
[0m10:07:23.801589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.coffee_shop.dbtcustomers)
[0m10:07:23.802052 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.dbtcustomers
[0m10:07:23.804586 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.dbtcustomers"
[0m10:07:23.805396 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (compile): 10:07:23.802483 => 10:07:23.805093
[0m10:07:23.805804 [debug] [Thread-1 (]: Began executing node model.coffee_shop.dbtcustomers
[0m10:07:23.837671 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.dbtcustomers"
[0m10:07:23.838468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:23.838948 [debug] [Thread-1 (]: On model.coffee_shop.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers`
  OPTIONS()
  as select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
--I've acceted your change.local
from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5;


[0m10:07:24.095621 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers`
  OPTIONS()
  as select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
--I've acceted your change.local
from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5;


[0m10:07:24.096612 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset analytics-engineers-club:coffee_shop was not found in location EU

Location: EU
Job ID: 02718f24-1bbd-4fec-a8b1-5c9b73e2ed5a

[0m10:07:24.098808 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (execute): 10:07:23.806100 => 10:07:24.098434
[0m10:07:24.106495 [debug] [Thread-1 (]: Runtime Error in model dbtcustomers (models/dbtcustomers.sql)
  404 Not found: Dataset analytics-engineers-club:coffee_shop was not found in location EU
  
  Location: EU
  Job ID: 02718f24-1bbd-4fec-a8b1-5c9b73e2ed5a
  
[0m10:07:24.107424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02a29ace-2f2e-48f9-8069-ea9f87c5568e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029f76a350>]}
[0m10:07:24.108404 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_robert.dbtcustomers ................... [[31mERROR[0m in 0.31s]
[0m10:07:24.109740 [debug] [Thread-1 (]: Finished running node model.coffee_shop.dbtcustomers
[0m10:07:24.112150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:24.112498 [debug] [MainThread]: Connection 'model.coffee_shop.dbtcustomers' was properly closed.
[0m10:07:24.112877 [info ] [MainThread]: 
[0m10:07:24.113429 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m10:07:24.120658 [debug] [MainThread]: Command end result
[0m10:07:24.139130 [info ] [MainThread]: 
[0m10:07:24.139877 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:07:24.140563 [info ] [MainThread]: 
[0m10:07:24.141230 [error] [MainThread]: [33mRuntime Error in model dbtcustomers (models/dbtcustomers.sql)[0m
[0m10:07:24.141918 [error] [MainThread]:   404 Not found: Dataset analytics-engineers-club:coffee_shop was not found in location EU
[0m10:07:24.142770 [error] [MainThread]:   
[0m10:07:24.143435 [error] [MainThread]:   Location: EU
[0m10:07:24.144093 [error] [MainThread]:   Job ID: 02718f24-1bbd-4fec-a8b1-5c9b73e2ed5a
[0m10:07:24.144747 [error] [MainThread]:   
[0m10:07:24.145404 [info ] [MainThread]: 
[0m10:07:24.146154 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:07:24.147294 [debug] [MainThread]: Command `dbt run` failed at 10:07:24.147112 after 2.09 seconds
[0m10:07:24.147922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a2612350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a255c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f029f790f10>]}
[0m10:07:24.148560 [debug] [MainThread]: Flushing usage events
[0m10:08:02.128144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41505de2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414f4c6440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414f4c63e0>]}


============================== 10:08:02.132290 | 9211df28-cd2a-45f1-a6fc-c7317b54ec94 ==============================
[0m10:08:02.132290 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:08:02.134230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:08:02.500137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9211df28-cd2a-45f1-a6fc-c7317b54ec94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41505153c0>]}
[0m10:08:02.517487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9211df28-cd2a-45f1-a6fc-c7317b54ec94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d9b1d20>]}
[0m10:08:02.518249 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:08:02.529503 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m10:08:02.537087 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:08:02.537773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9211df28-cd2a-45f1-a6fc-c7317b54ec94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d9c9270>]}
[0m10:08:03.279529 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m10:08:03.328663 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_robert.example
[0m10:08:03.334723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9211df28-cd2a-45f1-a6fc-c7317b54ec94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d913fa0>]}
[0m10:08:03.341586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9211df28-cd2a-45f1-a6fc-c7317b54ec94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d3ba2f0>]}
[0m10:08:03.342268 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:08:03.342833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9211df28-cd2a-45f1-a6fc-c7317b54ec94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d9ca410>]}
[0m10:08:03.344303 [info ] [MainThread]: 
[0m10:08:03.345538 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:08:03.346844 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m10:08:03.347604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:04.484287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m10:08:04.484921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:04.626352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9211df28-cd2a-45f1-a6fc-c7317b54ec94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414dd651b0>]}
[0m10:08:04.627437 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:08:04.628057 [info ] [MainThread]: 
[0m10:08:04.632591 [debug] [Thread-1 (]: Began running node model.coffee_shop.dbtcustomers
[0m10:08:04.633202 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_robert.dbtcustomers ............................ [RUN]
[0m10:08:04.634177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.coffee_shop.dbtcustomers)
[0m10:08:04.634634 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.dbtcustomers
[0m10:08:04.637101 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.dbtcustomers"
[0m10:08:04.637896 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (compile): 10:08:04.635014 => 10:08:04.637597
[0m10:08:04.638338 [debug] [Thread-1 (]: Began executing node model.coffee_shop.dbtcustomers
[0m10:08:04.669356 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.dbtcustomers"
[0m10:08:04.670201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:04.670717 [debug] [Thread-1 (]: On model.coffee_shop.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers`
  OPTIONS()
  as select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
--I've acceted your change.local
from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5;


[0m10:08:04.994452 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers`
  OPTIONS()
  as select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
--I've acceted your change.local
from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5;


[0m10:08:04.995198 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset aec-students:dbt_robert was not found in location US

Location: US
Job ID: c7837a60-a6c4-4ae6-b45e-a2c30430e0a1

[0m10:08:04.996026 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (execute): 10:08:04.638608 => 10:08:04.995736
[0m10:08:05.000077 [debug] [Thread-1 (]: Runtime Error in model dbtcustomers (models/dbtcustomers.sql)
  404 Not found: Dataset aec-students:dbt_robert was not found in location US
  
  Location: US
  Job ID: c7837a60-a6c4-4ae6-b45e-a2c30430e0a1
  
[0m10:08:05.000714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9211df28-cd2a-45f1-a6fc-c7317b54ec94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d3ce1d0>]}
[0m10:08:05.001559 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_robert.dbtcustomers ................... [[31mERROR[0m in 0.37s]
[0m10:08:05.002542 [debug] [Thread-1 (]: Finished running node model.coffee_shop.dbtcustomers
[0m10:08:05.005046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:05.005391 [debug] [MainThread]: Connection 'model.coffee_shop.dbtcustomers' was properly closed.
[0m10:08:05.005732 [info ] [MainThread]: 
[0m10:08:05.006336 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m10:08:05.007243 [debug] [MainThread]: Command end result
[0m10:08:05.018144 [info ] [MainThread]: 
[0m10:08:05.018770 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:08:05.019354 [info ] [MainThread]: 
[0m10:08:05.019949 [error] [MainThread]: [33mRuntime Error in model dbtcustomers (models/dbtcustomers.sql)[0m
[0m10:08:05.020451 [error] [MainThread]:   404 Not found: Dataset aec-students:dbt_robert was not found in location US
[0m10:08:05.020965 [error] [MainThread]:   
[0m10:08:05.021532 [error] [MainThread]:   Location: US
[0m10:08:05.022177 [error] [MainThread]:   Job ID: c7837a60-a6c4-4ae6-b45e-a2c30430e0a1
[0m10:08:05.022657 [error] [MainThread]:   
[0m10:08:05.023151 [info ] [MainThread]: 
[0m10:08:05.023689 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:08:05.024566 [debug] [MainThread]: Command `dbt run` failed at 10:08:05.024432 after 2.91 seconds
[0m10:08:05.025013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41505de2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d913f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f414d9495d0>]}
[0m10:08:05.025501 [debug] [MainThread]: Flushing usage events
[0m10:09:20.312262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6c946380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6b70e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6b70e470>]}


============================== 10:09:20.315815 | ffccc335-c91b-4e5e-a6d1-80fa743a288a ==============================
[0m10:09:20.315815 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:09:20.316610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:09:20.737468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffccc335-c91b-4e5e-a6d1-80fa743a288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae69db73a0>]}
[0m10:09:20.754663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffccc335-c91b-4e5e-a6d1-80fa743a288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae69dfbdc0>]}
[0m10:09:20.755422 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:09:20.766771 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m10:09:20.774444 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:09:20.775054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ffccc335-c91b-4e5e-a6d1-80fa743a288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6c6731f0>]}
[0m10:09:21.547070 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m10:09:21.595010 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_robert.example
[0m10:09:21.601370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffccc335-c91b-4e5e-a6d1-80fa743a288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae69b5ffa0>]}
[0m10:09:21.608998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffccc335-c91b-4e5e-a6d1-80fa743a288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae69c05060>]}
[0m10:09:21.609527 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:09:21.610172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffccc335-c91b-4e5e-a6d1-80fa743a288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae69c05bd0>]}
[0m10:09:21.611690 [info ] [MainThread]: 
[0m10:09:21.612956 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:09:21.614680 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m10:09:21.615178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:22.741004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now create_aec-students_dbt_robert_project)
[0m10:09:22.742134 [debug] [ThreadPool]: Creating schema "database: "aec-students"
schema: "dbt_robert_project"
"
[0m10:09:22.752243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:22.752732 [debug] [ThreadPool]: On create_aec-students_dbt_robert_project: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "connection_name": "create_aec-students_dbt_robert_project"} */
create schema if not exists `aec-students`.`dbt_robert_project`
  
[0m10:09:24.048840 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d7547e22-d899-4757-80a2-ce67a3f01f01&page=queryresults
[0m10:09:24.051304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_aec-students_dbt_robert_project, now list_aec-students_dbt_robert_project)
[0m10:09:24.051884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:09:24.362371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffccc335-c91b-4e5e-a6d1-80fa743a288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae69c995d0>]}
[0m10:09:24.363589 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:09:24.364512 [info ] [MainThread]: 
[0m10:09:24.371189 [debug] [Thread-1 (]: Began running node model.coffee_shop.dbtcustomers
[0m10:09:24.371799 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_robert_project.dbtcustomers .................... [RUN]
[0m10:09:24.372718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert_project, now model.coffee_shop.dbtcustomers)
[0m10:09:24.373141 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.dbtcustomers
[0m10:09:24.375552 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.dbtcustomers"
[0m10:09:24.376353 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (compile): 10:09:24.373407 => 10:09:24.376053
[0m10:09:24.376765 [debug] [Thread-1 (]: Began executing node model.coffee_shop.dbtcustomers
[0m10:09:24.402976 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.dbtcustomers"
[0m10:09:24.403682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:09:24.404139 [debug] [Thread-1 (]: On model.coffee_shop.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */


  create or replace view `aec-students`.`dbt_robert_project`.`dbtcustomers`
  OPTIONS()
  as select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
--I've acceted your change.local
from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5;


[0m10:09:25.585222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c98746ec-1ef5-4ba4-888c-3e794e9faf14&page=queryresults
[0m10:09:25.600979 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (execute): 10:09:24.377030 => 10:09:25.600747
[0m10:09:25.601842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffccc335-c91b-4e5e-a6d1-80fa743a288a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae696aff10>]}
[0m10:09:25.602589 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_robert_project.dbtcustomers ............... [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m10:09:25.603548 [debug] [Thread-1 (]: Finished running node model.coffee_shop.dbtcustomers
[0m10:09:25.605370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:25.605716 [debug] [MainThread]: Connection 'model.coffee_shop.dbtcustomers' was properly closed.
[0m10:09:25.606111 [info ] [MainThread]: 
[0m10:09:25.606698 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m10:09:25.607549 [debug] [MainThread]: Command end result
[0m10:09:25.621550 [info ] [MainThread]: 
[0m10:09:25.622430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:09:25.623019 [info ] [MainThread]: 
[0m10:09:25.623866 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:09:25.624853 [debug] [MainThread]: Command `dbt run` succeeded at 10:09:25.624726 after 5.32 seconds
[0m10:09:25.625237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6c946380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae69ba1600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae6c6fd2a0>]}
[0m10:09:25.625816 [debug] [MainThread]: Flushing usage events
[0m10:18:26.497665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5d242320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5c1c6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5c1c6410>]}


============================== 10:18:26.500394 | 72ac2fa6-32ff-4140-a2c5-8a6f7427d92a ==============================
[0m10:18:26.500394 [info ] [MainThread]: Running with dbt=1.5.3
[0m10:18:26.501376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:18:26.882090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72ac2fa6-32ff-4140-a2c5-8a6f7427d92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5d174b20>]}
[0m10:18:26.899957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72ac2fa6-32ff-4140-a2c5-8a6f7427d92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5a6b1c60>]}
[0m10:18:26.900803 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m10:18:26.912372 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m10:18:26.936130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:18:26.936757 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/dbtcustomers.sql
[0m10:18:26.961681 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m10:18:26.979583 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_robert.example
[0m10:18:26.985583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72ac2fa6-32ff-4140-a2c5-8a6f7427d92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5a4d80d0>]}
[0m10:18:26.992642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72ac2fa6-32ff-4140-a2c5-8a6f7427d92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5a596920>]}
[0m10:18:26.993308 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m10:18:26.993883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72ac2fa6-32ff-4140-a2c5-8a6f7427d92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5a5942e0>]}
[0m10:18:26.995427 [info ] [MainThread]: 
[0m10:18:26.996667 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:18:26.998227 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m10:18:26.998868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:28.281161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert_project)
[0m10:18:28.281880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:28.586902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72ac2fa6-32ff-4140-a2c5-8a6f7427d92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5a595d20>]}
[0m10:18:28.587973 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:18:28.588734 [info ] [MainThread]: 
[0m10:18:28.595342 [debug] [Thread-1 (]: Began running node model.coffee_shop.dbtcustomers
[0m10:18:28.596312 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert_project.dbtcustomers ................... [RUN]
[0m10:18:28.597314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert_project, now model.coffee_shop.dbtcustomers)
[0m10:18:28.597814 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.dbtcustomers
[0m10:18:28.601691 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.dbtcustomers"
[0m10:18:28.602627 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (compile): 10:18:28.598305 => 10:18:28.602270
[0m10:18:28.603105 [debug] [Thread-1 (]: Began executing node model.coffee_shop.dbtcustomers
[0m10:18:28.622086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:29.415200 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.dbtcustomers"
[0m10:18:29.416364 [debug] [Thread-1 (]: On model.coffee_shop.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert_project`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m10:18:33.767500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:19a6c54c-09ef-4d73-8649-72dbe2e79a2d&page=queryresults
[0m10:18:33.787433 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (execute): 10:18:28.603433 => 10:18:33.787207
[0m10:18:33.788345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ac2fa6-32ff-4140-a2c5-8a6f7427d92a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5a4dbe80>]}
[0m10:18:33.789122 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert_project.dbtcustomers .............. [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 5.19s]
[0m10:18:33.790291 [debug] [Thread-1 (]: Finished running node model.coffee_shop.dbtcustomers
[0m10:18:33.792146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:33.792527 [debug] [MainThread]: Connection 'model.coffee_shop.dbtcustomers' was properly closed.
[0m10:18:33.792943 [info ] [MainThread]: 
[0m10:18:33.793713 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m10:18:33.794964 [debug] [MainThread]: Command end result
[0m10:18:33.802352 [info ] [MainThread]: 
[0m10:18:33.803088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:33.803792 [info ] [MainThread]: 
[0m10:18:33.804409 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:18:33.805597 [debug] [MainThread]: Command `dbt run` succeeded at 10:18:33.805395 after 7.32 seconds
[0m10:18:33.806131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5d242320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5a4f37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd5d00d600>]}
[0m10:18:33.806593 [debug] [MainThread]: Flushing usage events
[0m13:10:35.114006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a3184e320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a307c6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a307c6410>]}


============================== 13:10:35.118366 | 6555086d-f820-42e9-a51f-584d3708bcff ==============================
[0m13:10:35.118366 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:10:35.119175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:10:36.481055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6555086d-f820-42e9-a51f-584d3708bcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a31784b20>]}
[0m13:10:36.498703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6555086d-f820-42e9-a51f-584d3708bcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2ecb1570>]}
[0m13:10:36.499599 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:10:36.510450 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:10:36.582703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:10:36.583112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:10:36.583580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_robert.example
[0m13:10:36.590075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6555086d-f820-42e9-a51f-584d3708bcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2ea7c0d0>]}
[0m13:10:36.596322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6555086d-f820-42e9-a51f-584d3708bcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2eb96c80>]}
[0m13:10:36.596988 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:10:36.597571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6555086d-f820-42e9-a51f-584d3708bcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2eb96d10>]}
[0m13:10:36.598929 [info ] [MainThread]: 
[0m13:10:36.599892 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:10:36.601192 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:10:36.601637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:40.940487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert_project)
[0m13:10:40.941078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:41.246485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6555086d-f820-42e9-a51f-584d3708bcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2eb96380>]}
[0m13:10:41.247336 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:10:41.247843 [info ] [MainThread]: 
[0m13:10:41.268519 [debug] [Thread-1 (]: Began running node model.coffee_shop.dbtcustomers
[0m13:10:41.269134 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert_project.dbtcustomers ................... [RUN]
[0m13:10:41.269995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert_project, now model.coffee_shop.dbtcustomers)
[0m13:10:41.270379 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.dbtcustomers
[0m13:10:41.274721 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.dbtcustomers"
[0m13:10:41.275433 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (compile): 13:10:41.270611 => 13:10:41.275172
[0m13:10:41.275848 [debug] [Thread-1 (]: Began executing node model.coffee_shop.dbtcustomers
[0m13:10:41.290519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:41.668556 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.dbtcustomers"
[0m13:10:41.669340 [debug] [Thread-1 (]: On model.coffee_shop.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert_project`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m13:10:45.979184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1ffcae61-2acd-41bf-b94e-f36787b7ad29&page=queryresults
[0m13:10:45.995994 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (execute): 13:10:41.276121 => 13:10:45.995790
[0m13:10:45.996764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6555086d-f820-42e9-a51f-584d3708bcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2ec35360>]}
[0m13:10:45.997400 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert_project.dbtcustomers .............. [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.73s]
[0m13:10:45.998369 [debug] [Thread-1 (]: Finished running node model.coffee_shop.dbtcustomers
[0m13:10:46.000150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:46.000456 [debug] [MainThread]: Connection 'model.coffee_shop.dbtcustomers' was properly closed.
[0m13:10:46.000748 [info ] [MainThread]: 
[0m13:10:46.001300 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.40 seconds (9.40s).
[0m13:10:46.002365 [debug] [MainThread]: Command end result
[0m13:10:46.008856 [info ] [MainThread]: 
[0m13:10:46.009535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:10:46.010351 [info ] [MainThread]: 
[0m13:10:46.010995 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:10:46.011901 [debug] [MainThread]: Command `dbt run` succeeded at 13:10:46.011724 after 10.91 seconds
[0m13:10:46.012300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a3184e320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2ea57fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a3161f880>]}
[0m13:10:46.012672 [debug] [MainThread]: Flushing usage events
[0m13:11:41.492933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50ff1e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50eec6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50eec64a0>]}


============================== 13:11:41.495349 | f2c47c2b-dfa7-48ca-8dc3-ce6f3eb67c90 ==============================
[0m13:11:41.495349 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:11:41.496133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:11:41.499223 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'coffee_shop'
[0m13:11:41.500013 [debug] [MainThread]: Command `dbt run` failed at 13:11:41.499889 after 0.01 seconds
[0m13:11:41.500371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50ff1e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50eec7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc50eec7790>]}
[0m13:11:41.500734 [debug] [MainThread]: Flushing usage events
[0m13:11:54.702209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5702a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c55e0e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c55e0e4d0>]}


============================== 13:11:54.704653 | 8c1ade12-7918-4c59-abcb-65e2ff16ff89 ==============================
[0m13:11:54.704653 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:11:54.705400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:11:55.028084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c1ade12-7918-4c59-abcb-65e2ff16ff89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c56ddb730>]}
[0m13:11:55.045319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c1ade12-7918-4c59-abcb-65e2ff16ff89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c544e1420>]}
[0m13:11:55.045985 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:11:55.056841 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:11:55.079014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:55.079361 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:55.079779 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_robert.example
[0m13:11:55.085939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c1ade12-7918-4c59-abcb-65e2ff16ff89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c542a80d0>]}
[0m13:11:55.092341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c1ade12-7918-4c59-abcb-65e2ff16ff89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c543c6980>]}
[0m13:11:55.093051 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:11:55.093929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c1ade12-7918-4c59-abcb-65e2ff16ff89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c543c6a10>]}
[0m13:11:55.095770 [info ] [MainThread]: 
[0m13:11:55.097121 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:11:55.098680 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:11:55.099166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:56.372955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert_project)
[0m13:11:56.373700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:56.679022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c1ade12-7918-4c59-abcb-65e2ff16ff89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c543c5e40>]}
[0m13:11:56.679895 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:11:56.680416 [info ] [MainThread]: 
[0m13:11:56.683956 [debug] [Thread-1 (]: Began running node model.coffee_shop.dbtcustomers
[0m13:11:56.684514 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert_project.dbtcustomers ................... [RUN]
[0m13:11:56.685343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert_project, now model.coffee_shop.dbtcustomers)
[0m13:11:56.685900 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.dbtcustomers
[0m13:11:56.689261 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.dbtcustomers"
[0m13:11:56.690038 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (compile): 13:11:56.686245 => 13:11:56.689762
[0m13:11:56.690412 [debug] [Thread-1 (]: Began executing node model.coffee_shop.dbtcustomers
[0m13:11:56.705100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:57.091429 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.dbtcustomers"
[0m13:11:57.092207 [debug] [Thread-1 (]: On model.coffee_shop.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert_project`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m13:12:00.918060 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5a3b89b8-e51f-4f50-b44d-115a34fc6c70&page=queryresults
[0m13:12:00.935301 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (execute): 13:11:56.690641 => 13:12:00.935096
[0m13:12:00.936254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1ade12-7918-4c59-abcb-65e2ff16ff89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c542690f0>]}
[0m13:12:00.937072 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert_project.dbtcustomers .............. [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.25s]
[0m13:12:00.937958 [debug] [Thread-1 (]: Finished running node model.coffee_shop.dbtcustomers
[0m13:12:00.939841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:00.940166 [debug] [MainThread]: Connection 'model.coffee_shop.dbtcustomers' was properly closed.
[0m13:12:00.940461 [info ] [MainThread]: 
[0m13:12:00.940960 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m13:12:00.941973 [debug] [MainThread]: Command end result
[0m13:12:00.947653 [info ] [MainThread]: 
[0m13:12:00.948339 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:00.948978 [info ] [MainThread]: 
[0m13:12:00.949501 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:12:00.950557 [debug] [MainThread]: Command `dbt run` succeeded at 13:12:00.950386 after 6.26 seconds
[0m13:12:00.950948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5702a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c542985b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c56bdeda0>]}
[0m13:12:00.951309 [debug] [MainThread]: Flushing usage events
[0m15:59:32.556194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa53763b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa45fe500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa45fe4a0>]}


============================== 15:59:32.572681 | aa96382f-bc55-4ce9-b79d-842d2d2d1e34 ==============================
[0m15:59:32.572681 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:59:32.573664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:59:34.154669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa96382f-bc55-4ce9-b79d-842d2d2d1e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa5147550>]}
[0m15:59:34.172438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa96382f-bc55-4ce9-b79d-842d2d2d1e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa27e1570>]}
[0m15:59:34.173625 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:59:34.187713 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:59:34.291023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:34.291568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:34.292218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_robert.example
[0m15:59:34.299790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa96382f-bc55-4ce9-b79d-842d2d2d1e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa25ac0d0>]}
[0m15:59:34.308067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa96382f-bc55-4ce9-b79d-842d2d2d1e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa26c6cb0>]}
[0m15:59:34.308624 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:59:34.309194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa96382f-bc55-4ce9-b79d-842d2d2d1e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa26c6c50>]}
[0m15:59:34.310740 [info ] [MainThread]: 
[0m15:59:34.311973 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:59:34.313389 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:59:34.314013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:39.182652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert_project)
[0m15:59:39.183317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:39.524974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa96382f-bc55-4ce9-b79d-842d2d2d1e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa26c63b0>]}
[0m15:59:39.526214 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:59:39.527134 [info ] [MainThread]: 
[0m15:59:39.556650 [debug] [Thread-1 (]: Began running node model.coffee_shop.dbtcustomers
[0m15:59:39.557426 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert_project.dbtcustomers ................... [RUN]
[0m15:59:39.558365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert_project, now model.coffee_shop.dbtcustomers)
[0m15:59:39.558831 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.dbtcustomers
[0m15:59:39.563832 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.dbtcustomers"
[0m15:59:39.564702 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (compile): 15:59:39.559126 => 15:59:39.564367
[0m15:59:39.565170 [debug] [Thread-1 (]: Began executing node model.coffee_shop.dbtcustomers
[0m15:59:39.580642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:39.939577 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.dbtcustomers"
[0m15:59:39.940594 [debug] [Thread-1 (]: On model.coffee_shop.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert_project`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m15:59:44.802789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:07adbfac-085c-4015-9d61-f87522f650ca&page=queryresults
[0m15:59:44.820108 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (execute): 15:59:39.565501 => 15:59:44.819869
[0m15:59:44.821076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa96382f-bc55-4ce9-b79d-842d2d2d1e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa25693c0>]}
[0m15:59:44.821879 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert_project.dbtcustomers .............. [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 5.26s]
[0m15:59:44.823142 [debug] [Thread-1 (]: Finished running node model.coffee_shop.dbtcustomers
[0m15:59:44.824978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:44.825346 [debug] [MainThread]: Connection 'model.coffee_shop.dbtcustomers' was properly closed.
[0m15:59:44.825750 [info ] [MainThread]: 
[0m15:59:44.827296 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.51 seconds (10.51s).
[0m15:59:44.829115 [debug] [MainThread]: Command end result
[0m15:59:44.836893 [info ] [MainThread]: 
[0m15:59:44.837700 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:44.838445 [info ] [MainThread]: 
[0m15:59:44.839236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:59:44.840399 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:44.840257 after 12.32 seconds
[0m15:59:44.840849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa53763b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa27e1570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa26c6e90>]}
[0m15:59:44.841395 [debug] [MainThread]: Flushing usage events
[0m16:10:57.613434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dd7be410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dc6ca560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dc6ca500>]}


============================== 16:10:57.616191 | b592f707-cb9e-445b-9129-a8d15ffcefbd ==============================
[0m16:10:57.616191 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:10:57.617240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:10:57.986257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b592f707-cb9e-445b-9129-a8d15ffcefbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dd71f460>]}
[0m16:10:58.003601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b592f707-cb9e-445b-9129-a8d15ffcefbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dabb15a0>]}
[0m16:10:58.004524 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:10:58.016120 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:10:58.040424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:10:58.041050 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/dbtcustomers.sql
[0m16:10:58.066201 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m16:10:58.084290 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_robert.example
[0m16:10:58.091843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b592f707-cb9e-445b-9129-a8d15ffcefbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05da9d40d0>]}
[0m16:10:58.102574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b592f707-cb9e-445b-9129-a8d15ffcefbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05daa96c80>]}
[0m16:10:58.103314 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:10:58.104057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b592f707-cb9e-445b-9129-a8d15ffcefbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05daa96d10>]}
[0m16:10:58.105949 [info ] [MainThread]: 
[0m16:10:58.107277 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:10:58.109754 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:10:58.111693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:59.498308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert_project)
[0m16:10:59.498977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:59.849696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b592f707-cb9e-445b-9129-a8d15ffcefbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05daa940d0>]}
[0m16:10:59.850913 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:10:59.851774 [info ] [MainThread]: 
[0m16:10:59.856624 [debug] [Thread-1 (]: Began running node model.coffee_shop.dbtcustomers
[0m16:10:59.857284 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert_project.dbtcustomers ................... [RUN]
[0m16:10:59.858380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert_project, now model.coffee_shop.dbtcustomers)
[0m16:10:59.858856 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.dbtcustomers
[0m16:10:59.862323 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.dbtcustomers"
[0m16:10:59.863321 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (compile): 16:10:59.859157 => 16:10:59.862926
[0m16:10:59.863758 [debug] [Thread-1 (]: Began executing node model.coffee_shop.dbtcustomers
[0m16:10:59.882683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:00.254785 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.dbtcustomers"
[0m16:11:00.255810 [debug] [Thread-1 (]: On model.coffee_shop.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert_project`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m16:11:07.996676 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e80dd278-9088-4e21-b85a-bc58ec54b9be&page=queryresults
[0m16:11:08.013959 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (execute): 16:10:59.864054 => 16:11:08.013694
[0m16:11:08.014886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b592f707-cb9e-445b-9129-a8d15ffcefbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05da9d4310>]}
[0m16:11:08.015642 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert_project.dbtcustomers .............. [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 8.16s]
[0m16:11:08.016635 [debug] [Thread-1 (]: Finished running node model.coffee_shop.dbtcustomers
[0m16:11:08.018516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:08.018882 [debug] [MainThread]: Connection 'model.coffee_shop.dbtcustomers' was properly closed.
[0m16:11:08.019282 [info ] [MainThread]: 
[0m16:11:08.019847 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.91 seconds (9.91s).
[0m16:11:08.020811 [debug] [MainThread]: Command end result
[0m16:11:08.035402 [info ] [MainThread]: 
[0m16:11:08.036187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:08.037188 [info ] [MainThread]: 
[0m16:11:08.038208 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:11:08.039348 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:08.039213 after 10.43 seconds
[0m16:11:08.039789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dd7be410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05da9f3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dd586b30>]}
[0m16:11:08.040524 [debug] [MainThread]: Flushing usage events
[0m16:12:40.173603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ac682380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ab3ce4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ab3ce470>]}


============================== 16:12:40.176372 | 5fc66ebb-16db-42e7-8ab1-6c52a1357ca7 ==============================
[0m16:12:40.176372 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:12:40.177172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:12:40.547999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fc66ebb-16db-42e7-8ab1-6c52a1357ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ac3be020>]}
[0m16:12:40.565731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fc66ebb-16db-42e7-8ab1-6c52a1357ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43a98b7820>]}
[0m16:12:40.566695 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:12:40.578488 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:12:40.586439 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:12:40.587167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fc66ebb-16db-42e7-8ab1-6c52a1357ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ac1b71f0>]}
[0m16:12:41.359056 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m16:12:41.408673 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_robert.example
[0m16:12:41.415115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fc66ebb-16db-42e7-8ab1-6c52a1357ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43a9817fa0>]}
[0m16:12:41.423059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fc66ebb-16db-42e7-8ab1-6c52a1357ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43a92bc820>]}
[0m16:12:41.423799 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:12:41.424398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc66ebb-16db-42e7-8ab1-6c52a1357ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43a92bd270>]}
[0m16:12:41.426006 [info ] [MainThread]: 
[0m16:12:41.427252 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:12:41.429000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:12:41.429538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:42.808990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now create_aec-students_dbt_robert)
[0m16:12:42.810259 [debug] [ThreadPool]: Creating schema "database: "aec-students"
schema: "dbt_robert"
"
[0m16:12:42.821552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:42.822078 [debug] [ThreadPool]: On create_aec-students_dbt_robert: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "connection_name": "create_aec-students_dbt_robert"} */
create schema if not exists `aec-students`.`dbt_robert`
  
[0m16:12:44.127791 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a61d83da-fc6c-4387-ade8-e8082da491b3&page=queryresults
[0m16:12:44.130947 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m16:12:44.131695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:44.461614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc66ebb-16db-42e7-8ab1-6c52a1357ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43a9873a30>]}
[0m16:12:44.462756 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:12:44.463413 [info ] [MainThread]: 
[0m16:12:44.468142 [debug] [Thread-1 (]: Began running node model.coffee_shop.dbtcustomers
[0m16:12:44.468769 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m16:12:44.469725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.coffee_shop.dbtcustomers)
[0m16:12:44.470187 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.dbtcustomers
[0m16:12:44.474323 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.dbtcustomers"
[0m16:12:44.475246 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (compile): 16:12:44.470536 => 16:12:44.474848
[0m16:12:44.475690 [debug] [Thread-1 (]: Began executing node model.coffee_shop.dbtcustomers
[0m16:12:44.510123 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.dbtcustomers"
[0m16:12:44.511037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:44.511538 [debug] [Thread-1 (]: On model.coffee_shop.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.coffee_shop.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m16:12:49.004845 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f206e033-d11e-420d-8e79-e31bcdd05ecb&page=queryresults
[0m16:12:49.020393 [debug] [Thread-1 (]: Timing info for model.coffee_shop.dbtcustomers (execute): 16:12:44.475983 => 16:12:49.020171
[0m16:12:49.021317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc66ebb-16db-42e7-8ab1-6c52a1357ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43a932c1c0>]}
[0m16:12:49.022092 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.55s]
[0m16:12:49.023295 [debug] [Thread-1 (]: Finished running node model.coffee_shop.dbtcustomers
[0m16:12:49.025541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:49.025910 [debug] [MainThread]: Connection 'create_aec-students_dbt_robert' was properly closed.
[0m16:12:49.026280 [debug] [MainThread]: Connection 'model.coffee_shop.dbtcustomers' was properly closed.
[0m16:12:49.026669 [info ] [MainThread]: 
[0m16:12:49.027224 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.60 seconds (7.60s).
[0m16:12:49.029085 [debug] [MainThread]: Command end result
[0m16:12:49.044480 [info ] [MainThread]: 
[0m16:12:49.045126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:49.045746 [info ] [MainThread]: 
[0m16:12:49.046847 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:12:49.048051 [debug] [MainThread]: Command `dbt run` succeeded at 16:12:49.047721 after 8.88 seconds
[0m16:12:49.048701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ac682380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ac1b6860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43a9817f70>]}
[0m16:12:49.049381 [debug] [MainThread]: Flushing usage events
[0m12:58:19.039325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c6482380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c53c64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c53c6470>]}


============================== 12:58:19.042049 | d23991b1-4bf2-45c5-9354-8b668be7dd19 ==============================
[0m12:58:19.042049 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:58:19.042840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:58:19.395955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd23991b1-4bf2-45c5-9354-8b668be7dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c63ba020>]}
[0m12:58:19.412909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd23991b1-4bf2-45c5-9354-8b668be7dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c38b1300>]}
[0m12:58:19.413769 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:58:19.424874 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:58:19.454695 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:58:19.455559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd23991b1-4bf2-45c5-9354-8b668be7dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c38cb2e0>]}
[0m12:58:20.191607 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m12:58:20.243536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd23991b1-4bf2-45c5-9354-8b668be7dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c3289d20>]}
[0m12:58:20.250422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd23991b1-4bf2-45c5-9354-8b668be7dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c32c5c00>]}
[0m12:58:20.251121 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:58:20.251689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd23991b1-4bf2-45c5-9354-8b668be7dd19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c32c4b50>]}
[0m12:58:20.253053 [info ] [MainThread]: 
[0m12:58:20.253737 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:58:20.254602 [debug] [MainThread]: Command end result
[0m12:58:20.261725 [debug] [MainThread]: Command `dbt test` succeeded at 12:58:20.261502 after 1.23 seconds
[0m12:58:20.262313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c6482380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c61a9960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49c38b1300>]}
[0m12:58:20.262785 [debug] [MainThread]: Flushing usage events
[0m12:59:40.754772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b34ba350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b23c64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b23c6440>]}


============================== 12:59:40.757568 | 98f1f97c-f6dc-431d-9a5e-1a3b8beac1da ==============================
[0m12:59:40.757568 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:59:40.758355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:59:41.171343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98f1f97c-f6dc-431d-9a5e-1a3b8beac1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b339e8f0>]}
[0m12:59:41.203143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98f1f97c-f6dc-431d-9a5e-1a3b8beac1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b08b1030>]}
[0m12:59:41.204087 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:59:41.215599 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:59:41.223489 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:59:41.224304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98f1f97c-f6dc-431d-9a5e-1a3b8beac1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b08cacb0>]}
[0m12:59:41.957828 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m12:59:42.011789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98f1f97c-f6dc-431d-9a5e-1a3b8beac1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b0813fd0>]}
[0m12:59:42.018987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98f1f97c-f6dc-431d-9a5e-1a3b8beac1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b02ba6b0>]}
[0m12:59:42.019667 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:59:42.020433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f1f97c-f6dc-431d-9a5e-1a3b8beac1da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b08ca200>]}
[0m12:59:42.021925 [info ] [MainThread]: 
[0m12:59:42.022545 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:59:42.023288 [debug] [MainThread]: Command end result
[0m12:59:42.029496 [debug] [MainThread]: Command `dbt test` succeeded at 12:59:42.029303 after 1.28 seconds
[0m12:59:42.030071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b34ba350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b34045b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b08c99c0>]}
[0m12:59:42.030514 [debug] [MainThread]: Flushing usage events
[0m13:55:39.153991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8a3aa380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8910e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8910e470>]}


============================== 13:55:39.169908 | 0f7ff086-7e00-440b-81c5-46ce67b33187 ==============================
[0m13:55:39.169908 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:55:39.171356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:55:40.608608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f7ff086-7e00-440b-81c5-46ce67b33187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8a2da020>]}
[0m13:55:40.627408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f7ff086-7e00-440b-81c5-46ce67b33187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe877f94e0>]}
[0m13:55:40.628560 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:55:40.641084 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:55:40.740089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:40.740670 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:40.747431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f7ff086-7e00-440b-81c5-46ce67b33187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe875c00d0>]}
[0m13:55:40.754926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f7ff086-7e00-440b-81c5-46ce67b33187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe876de890>]}
[0m13:55:40.755638 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:55:40.756252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f7ff086-7e00-440b-81c5-46ce67b33187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe876de920>]}
[0m13:55:40.757852 [info ] [MainThread]: 
[0m13:55:40.759153 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:55:40.760663 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:55:40.761453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:45.403370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m13:55:45.404300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:45.756373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f7ff086-7e00-440b-81c5-46ce67b33187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe876ddcf0>]}
[0m13:55:45.757587 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:55:45.758882 [info ] [MainThread]: 
[0m13:55:45.783440 [debug] [Thread-1 (]: Began running node model.dbtcustomers.dbtcustomers
[0m13:55:45.784381 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m13:55:45.785508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbtcustomers.dbtcustomers)
[0m13:55:45.786000 [debug] [Thread-1 (]: Began compiling node model.dbtcustomers.dbtcustomers
[0m13:55:45.790400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcustomers.dbtcustomers"
[0m13:55:45.791263 [debug] [Thread-1 (]: Timing info for model.dbtcustomers.dbtcustomers (compile): 13:55:45.786299 => 13:55:45.791020
[0m13:55:45.791807 [debug] [Thread-1 (]: Began executing node model.dbtcustomers.dbtcustomers
[0m13:55:45.811489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:46.175098 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcustomers.dbtcustomers"
[0m13:55:46.176111 [debug] [Thread-1 (]: On model.dbtcustomers.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbtcustomers.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m13:55:50.522632 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a4d693ed-4c96-4f53-8a7e-fd53eb25b06b&page=queryresults
[0m13:55:50.561764 [debug] [Thread-1 (]: Timing info for model.dbtcustomers.dbtcustomers (execute): 13:55:45.792120 => 13:55:50.561386
[0m13:55:50.563186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f7ff086-7e00-440b-81c5-46ce67b33187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe87581060>]}
[0m13:55:50.564360 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.78s]
[0m13:55:50.565958 [debug] [Thread-1 (]: Finished running node model.dbtcustomers.dbtcustomers
[0m13:55:50.569499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:50.570025 [debug] [MainThread]: Connection 'model.dbtcustomers.dbtcustomers' was properly closed.
[0m13:55:50.571659 [info ] [MainThread]: 
[0m13:55:50.572764 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.81 seconds (9.81s).
[0m13:55:50.574831 [debug] [MainThread]: Command end result
[0m13:55:50.581726 [info ] [MainThread]: 
[0m13:55:50.582472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:50.583175 [info ] [MainThread]: 
[0m13:55:50.583862 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:55:50.585242 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:50.585104 after 11.46 seconds
[0m13:55:50.585723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8a3aa380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe875ac820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe8a0d9960>]}
[0m13:55:50.586214 [debug] [MainThread]: Flushing usage events
[0m13:56:44.551367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7deb4a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7ddac6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7ddac6410>]}


============================== 13:56:44.555367 | 5be7f579-3bda-4666-b70f-b5495ecab62f ==============================
[0m13:56:44.555367 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:56:44.556751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:56:44.975518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5be7f579-3bda-4666-b70f-b5495ecab62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7dea80dc0>]}
[0m13:56:45.001527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5be7f579-3bda-4666-b70f-b5495ecab62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7dbfb1570>]}
[0m13:56:45.002517 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:56:45.014207 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:56:45.038375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:45.038879 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:45.045035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5be7f579-3bda-4666-b70f-b5495ecab62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7dbd780d0>]}
[0m13:56:45.052541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5be7f579-3bda-4666-b70f-b5495ecab62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7dbe96860>]}
[0m13:56:45.053303 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:56:45.053971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5be7f579-3bda-4666-b70f-b5495ecab62f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7dbe968f0>]}
[0m13:56:45.055749 [info ] [MainThread]: 
[0m13:56:45.056335 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:56:45.057230 [debug] [MainThread]: Command end result
[0m13:56:45.064299 [debug] [MainThread]: Command `dbt test` succeeded at 13:56:45.064105 after 0.52 seconds
[0m13:56:45.064870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7deb4a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7de919600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7dbe96560>]}
[0m13:56:45.065329 [debug] [MainThread]: Flushing usage events
[0m14:09:58.760082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65021a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64f1ee4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64f1ee470>]}


============================== 14:09:58.762943 | 43f51290-5094-4bce-84f2-75fc73a08ffc ==============================
[0m14:09:58.762943 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:09:58.763769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:09:59.143131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43f51290-5094-4bce-84f2-75fc73a08ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff650146020>]}
[0m14:09:59.160478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43f51290-5094-4bce-84f2-75fc73a08ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64d6c9570>]}
[0m14:09:59.161448 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:09:59.173514 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:09:59.181463 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:09:59.182123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43f51290-5094-4bce-84f2-75fc73a08ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64d6c8f70>]}
[0m14:09:59.942483 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m14:09:59.994183 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.tests
[0m14:10:00.001282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43f51290-5094-4bce-84f2-75fc73a08ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64d627fd0>]}
[0m14:10:00.009205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43f51290-5094-4bce-84f2-75fc73a08ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64d4d57e0>]}
[0m14:10:00.009961 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:10:00.010571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43f51290-5094-4bce-84f2-75fc73a08ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64d4d5b40>]}
[0m14:10:00.012088 [info ] [MainThread]: 
[0m14:10:00.012757 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:10:00.013765 [debug] [MainThread]: Command end result
[0m14:10:00.020695 [debug] [MainThread]: Command `dbt test` succeeded at 14:10:00.020499 after 1.27 seconds
[0m14:10:00.021333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff65021a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64d471ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64d627d90>]}
[0m14:10:00.021967 [debug] [MainThread]: Flushing usage events
[0m14:30:05.098030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7883463b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7870ca500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7870ca4a0>]}


============================== 14:30:05.100806 | 6bdf8f67-f86a-4e18-8637-a254d92f1508 ==============================
[0m14:30:05.100806 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:30:05.101613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:30:05.465788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bdf8f67-f86a-4e18-8637-a254d92f1508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7880c78b0>]}
[0m14:30:05.483945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bdf8f67-f86a-4e18-8637-a254d92f1508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7855b01f0>]}
[0m14:30:05.485037 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:30:05.497102 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:30:05.505085 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:30:05.505751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6bdf8f67-f86a-4e18-8637-a254d92f1508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7880039a0>]}
[0m14:30:06.290706 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m14:30:06.344470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bdf8f67-f86a-4e18-8637-a254d92f1508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd785513fa0>]}
[0m14:30:06.351775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bdf8f67-f86a-4e18-8637-a254d92f1508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd784fba7d0>]}
[0m14:30:06.352591 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:30:06.353193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bdf8f67-f86a-4e18-8637-a254d92f1508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd784fba830>]}
[0m14:30:06.354667 [info ] [MainThread]: 
[0m14:30:06.355324 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:30:06.356317 [debug] [MainThread]: Command end result
[0m14:30:06.363206 [debug] [MainThread]: Command `dbt test` succeeded at 14:30:06.363013 after 1.27 seconds
[0m14:30:06.363891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7883463b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd785513fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd788003dc0>]}
[0m14:30:06.364458 [debug] [MainThread]: Flushing usage events
[0m14:31:55.280298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bbabe350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ba7ce4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51ba7ce440>]}


============================== 14:31:55.283320 | 5ab26a19-0ed6-4406-9412-6f874a579e0d ==============================
[0m14:31:55.283320 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:31:55.284191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:31:55.644033 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'dbtcustomers'}, {'columns': [{'name': 'id', 'tests': ['unique', 'not_null']}]}] is not of type 'object'

Error encountered in /home/vscode/dbt_robert_project/dbt_project.yml
[0m14:31:55.645307 [debug] [MainThread]: Command `dbt test` failed at 14:31:55.645090 after 0.37 seconds
[0m14:31:55.645845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bbabe350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51b8cb6d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51b8cb6d10>]}
[0m14:31:55.646339 [debug] [MainThread]: Flushing usage events
[0m14:36:40.424801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e7d22380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e6faa4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e6faa470>]}


============================== 14:36:40.427610 | 7b843a26-809e-4f16-a93f-2425dc6b6ddb ==============================
[0m14:36:40.427610 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:36:40.428465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:36:40.791047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b843a26-809e-4f16-a93f-2425dc6b6ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e7c4d2a0>]}
[0m14:36:40.810988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b843a26-809e-4f16-a93f-2425dc6b6ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e51cd600>]}
[0m14:36:40.812251 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:36:40.829379 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:36:40.842096 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:36:40.842879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b843a26-809e-4f16-a93f-2425dc6b6ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e51e4ee0>]}
[0m14:36:41.608034 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m14:36:41.656621 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtcustomers.columns.id
[0m14:36:41.665068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b843a26-809e-4f16-a93f-2425dc6b6ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e512bf70>]}
[0m14:36:41.677663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b843a26-809e-4f16-a93f-2425dc6b6ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e4fd9ba0>]}
[0m14:36:41.678496 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:36:41.679289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b843a26-809e-4f16-a93f-2425dc6b6ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e4fd8a30>]}
[0m14:36:41.681310 [info ] [MainThread]: 
[0m14:36:41.682162 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:36:41.683171 [debug] [MainThread]: Command end result
[0m14:36:41.693543 [debug] [MainThread]: Command `dbt test` succeeded at 14:36:41.693333 after 1.28 seconds
[0m14:36:41.694311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e7d22380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e4f75e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e512bf40>]}
[0m14:36:41.695073 [debug] [MainThread]: Flushing usage events
[0m14:40:19.319097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f099ea063e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f099d7d2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f099d7d24d0>]}


============================== 14:40:19.321917 | 47300f4a-2b20-4a67-86ab-0ad2664a5df8 ==============================
[0m14:40:19.321917 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:40:19.322732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:40:19.324096 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/vscode/.dbt/profiles.yml
  
[0m14:40:19.325477 [debug] [MainThread]: Command `dbt test` failed at 14:40:19.325334 after 0.01 seconds
[0m14:40:19.325886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f099ea063e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f099d7d25f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f099d7d2800>]}
[0m14:40:19.326339 [debug] [MainThread]: Flushing usage events
[0m14:40:42.889986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7401aa3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73eeca500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73eeca4a0>]}


============================== 14:40:42.893065 | 76a3b463-e888-48f0-a592-bd0589875142 ==============================
[0m14:40:42.893065 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:40:42.894112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:40:43.283961 [error] [MainThread]: Encountered an error:
Runtime Error
  Required "name" field not present in project

Error encountered in /home/vscode/dbt_robert_project/dbt_project.yml
[0m14:40:43.285292 [debug] [MainThread]: Command `dbt test` failed at 14:40:43.285126 after 0.40 seconds
[0m14:40:43.285786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7401aa3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73d3be8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73d3be650>]}
[0m14:40:43.286370 [debug] [MainThread]: Flushing usage events
[0m14:40:57.993102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08c452320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08b20a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08b20a410>]}


============================== 14:40:57.995833 | 18864e48-fa2e-4a45-b3ed-02222b06c0d6 ==============================
[0m14:40:57.995833 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:40:57.996940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:40:58.419228 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['version']: '2' is not valid under any of the given schemas

Error encountered in /home/vscode/dbt_robert_project/dbt_project.yml
[0m14:40:58.420563 [debug] [MainThread]: Command `dbt test` failed at 14:40:58.420382 after 0.43 seconds
[0m14:40:58.421066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc08c452320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0898f5f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0898f4160>]}
[0m14:40:58.421587 [debug] [MainThread]: Flushing usage events
[0m14:41:22.040820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a132a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a010a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a010a4a0>]}


============================== 14:41:22.045561 | 0d4a058d-097e-4c64-8287-9c2bc3de0bf1 ==============================
[0m14:41:22.045561 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:41:22.046610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:41:22.426912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d4a058d-097e-4c64-8287-9c2bc3de0bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a10febf0>]}
[0m14:41:22.444735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d4a058d-097e-4c64-8287-9c2bc3de0bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659e7e6a70>]}
[0m14:41:22.445729 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:41:22.457849 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:41:22.465743 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:41:22.466589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d4a058d-097e-4c64-8287-9c2bc3de0bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659e7fdcf0>]}
[0m14:41:23.286011 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m14:41:23.340834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d4a058d-097e-4c64-8287-9c2bc3de0bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659e54bfd0>]}
[0m14:41:23.348157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d4a058d-097e-4c64-8287-9c2bc3de0bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659e5f0610>]}
[0m14:41:23.348897 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:41:23.349470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d4a058d-097e-4c64-8287-9c2bc3de0bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659e5f29e0>]}
[0m14:41:23.350888 [info ] [MainThread]: 
[0m14:41:23.351528 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:41:23.352424 [debug] [MainThread]: Command end result
[0m14:41:23.359060 [debug] [MainThread]: Command `dbt test` succeeded at 14:41:23.358862 after 1.33 seconds
[0m14:41:23.359660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a132a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a0edae30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659e54be50>]}
[0m14:41:23.360124 [debug] [MainThread]: Flushing usage events
[0m14:44:10.329974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0266f923b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0265cca500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0265cca4a0>]}


============================== 14:44:10.332819 | 1acaa142-e1b4-4613-86f6-b282fcfd4b51 ==============================
[0m14:44:10.332819 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:44:10.333642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:44:10.747434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1acaa142-e1b4-4613-86f6-b282fcfd4b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0266b67550>]}
[0m14:44:10.777354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1acaa142-e1b4-4613-86f6-b282fcfd4b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02641b1c00>]}
[0m14:44:10.778957 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:44:10.800275 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:44:10.801509 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:44:10.807855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1acaa142-e1b4-4613-86f6-b282fcfd4b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02641b2470>]}
[0m14:44:11.556079 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m14:44:11.671034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1acaa142-e1b4-4613-86f6-b282fcfd4b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0264088ca0>]}
[0m14:44:11.679312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1acaa142-e1b4-4613-86f6-b282fcfd4b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02640889d0>]}
[0m14:44:11.679967 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:44:11.680627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1acaa142-e1b4-4613-86f6-b282fcfd4b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f026408bee0>]}
[0m14:44:11.682123 [info ] [MainThread]: 
[0m14:44:11.682909 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:44:11.684188 [debug] [MainThread]: Command end result
[0m14:44:11.690840 [debug] [MainThread]: Command `dbt test` succeeded at 14:44:11.690652 after 1.37 seconds
[0m14:44:11.691421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0266f923b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0264089450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02640889d0>]}
[0m14:44:11.691876 [debug] [MainThread]: Flushing usage events
[0m14:45:36.038084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde66d5e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde65b0e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde65b0e470>]}


============================== 14:45:36.041025 | 4d306e7e-2a9e-479c-9893-aec6a78efc34 ==============================
[0m14:45:36.041025 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:45:36.041886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:45:36.453244 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'dbtcustomers', 'columns': [{'name': 'id', 'tests': ['unique', 'not_null']}]}] is not of type 'object'

Error encountered in /home/vscode/dbt_robert_project/dbt_project.yml
[0m14:45:36.454479 [debug] [MainThread]: Command `dbt test` failed at 14:45:36.454256 after 0.42 seconds
[0m14:45:36.454970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde66d5e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde64206e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde64204d60>]}
[0m14:45:36.455459 [debug] [MainThread]: Flushing usage events
[0m14:48:01.397954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfeac6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfd7ce4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfd7ce440>]}


============================== 14:48:01.402719 | 7c5ffc83-bdd3-4498-81fb-f17c1a4b610f ==============================
[0m14:48:01.402719 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:48:01.404961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:48:01.794315 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'dbtcustomers', 'columns': [{'name': 'id', 'tests': ['unique', 'not_null']}]}] is not of type 'object'

Error encountered in /home/vscode/dbt_robert_project/dbt_project.yml
[0m14:48:01.795533 [debug] [MainThread]: Command `dbt test` failed at 14:48:01.795325 after 0.41 seconds
[0m14:48:01.796419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfeac6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfbcc0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facfbcc2e30>]}
[0m14:48:01.796920 [debug] [MainThread]: Flushing usage events
[0m14:48:50.801042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2b956380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2a70e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2a70e470>]}


============================== 14:48:50.803782 | 376fdcb3-76f6-43ac-a68f-9c4e4ae547b6 ==============================
[0m14:48:50.803782 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:48:50.804864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:48:51.195977 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'dbtcustomers', 'columns': [{'name': 'id', 'tests': ['unique', 'not_null']}]}] is not of type 'object'

Error encountered in /home/vscode/dbt_robert_project/dbt_project.yml
[0m14:48:51.199231 [debug] [MainThread]: Command `dbt test` failed at 14:48:51.199008 after 0.41 seconds
[0m14:48:51.200348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f2b956380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f28dfadd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f28dfb880>]}
[0m14:48:51.201101 [debug] [MainThread]: Flushing usage events
[0m14:50:27.307432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8312a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb81f0e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb81f0e440>]}


============================== 14:50:27.310335 | 3f3ee357-a032-49f3-b010-df0d2b4befa2 ==============================
[0m14:50:27.310335 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:50:27.311140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:50:27.687911 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'dbtcustomers', 'columns': [{'name': 'id', 'tests': ['unique', 'not_null']}]}] is not of type 'object'

Error encountered in /home/vscode/dbt_robert_project/dbt_project.yml
[0m14:50:27.689336 [debug] [MainThread]: Command `dbt run` failed at 14:50:27.689156 after 0.39 seconds
[0m14:50:27.689835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8312a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb805ea7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb805e8130>]}
[0m14:50:27.690358 [debug] [MainThread]: Flushing usage events
[0m14:50:51.052055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6442bda320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f644190e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f644190e410>]}


============================== 14:50:51.055160 | b6f1fbca-7384-4dea-a239-e4e8be3cce87 ==============================
[0m14:50:51.055160 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:50:51.055990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:50:51.420445 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'dbtcustomers', 'columns': [{'name': 'id', 'tests': ['unique', 'not_null']}]}] is not of type 'object'

Error encountered in /home/vscode/dbt_robert_project/dbt_project.yml
[0m14:50:51.421709 [debug] [MainThread]: Command `dbt run` failed at 14:50:51.421500 after 0.38 seconds
[0m14:50:51.422201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6442bda320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6440004dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6440004d90>]}
[0m14:50:51.422719 [debug] [MainThread]: Flushing usage events
[0m14:51:23.309973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e5ffa350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e52864a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e5286440>]}


============================== 14:51:23.312843 | a91f22d7-23c5-4601-9a58-dcea28b2fd05 ==============================
[0m14:51:23.312843 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:51:23.313671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:51:23.683763 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'dbtcustomers', 'columns': [{'name': 'id', 'tests': ['unique', 'not_null']}]}] is not of type 'object'

Error encountered in /home/vscode/dbt_robert_project/dbt_project.yml
[0m14:51:23.685046 [debug] [MainThread]: Command `dbt test` failed at 14:51:23.684843 after 0.38 seconds
[0m14:51:23.685544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e5ffa350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e33ec040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8e33ed450>]}
[0m14:51:23.686048 [debug] [MainThread]: Flushing usage events
[0m14:52:32.093531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f187a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f060a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f060a410>]}


============================== 14:52:32.097811 | abc328d7-6055-482f-b0a0-c1db753f8782 ==============================
[0m14:52:32.097811 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:52:32.098746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:32.490542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abc328d7-6055-482f-b0a0-c1db753f8782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f17a8dc0>]}
[0m14:52:32.510236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abc328d7-6055-482f-b0a0-c1db753f8782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eecf62c0>]}
[0m14:52:32.511271 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:52:32.526288 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:52:32.536263 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:52:32.537098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'abc328d7-6055-482f-b0a0-c1db753f8782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eecf7e20>]}
[0m14:52:33.343316 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m14:52:33.399364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abc328d7-6055-482f-b0a0-c1db753f8782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eea5bf40>]}
[0m14:52:33.409151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abc328d7-6055-482f-b0a0-c1db753f8782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eeb13160>]}
[0m14:52:33.410007 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:52:33.410668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abc328d7-6055-482f-b0a0-c1db753f8782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eeb129b0>]}
[0m14:52:33.412289 [info ] [MainThread]: 
[0m14:52:33.413492 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:52:33.414923 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:52:33.415543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:34.731987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m14:52:34.732781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:35.055890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abc328d7-6055-482f-b0a0-c1db753f8782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eec46ad0>]}
[0m14:52:35.057222 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:52:35.058240 [info ] [MainThread]: 
[0m14:52:35.063080 [debug] [Thread-1 (]: Began running node model.dbtcustomers.dbtcustomers
[0m14:52:35.063730 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m14:52:35.064713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbtcustomers.dbtcustomers)
[0m14:52:35.065131 [debug] [Thread-1 (]: Began compiling node model.dbtcustomers.dbtcustomers
[0m14:52:35.068538 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcustomers.dbtcustomers"
[0m14:52:35.069383 [debug] [Thread-1 (]: Timing info for model.dbtcustomers.dbtcustomers (compile): 14:52:35.065398 => 14:52:35.069063
[0m14:52:35.070224 [debug] [Thread-1 (]: Began executing node model.dbtcustomers.dbtcustomers
[0m14:52:35.086473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:35.470450 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcustomers.dbtcustomers"
[0m14:52:35.471399 [debug] [Thread-1 (]: On model.dbtcustomers.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbtcustomers.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m14:52:58.851411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:32c7607f-8590-41c0-9590-04ed545ee1fb&page=queryresults
[0m14:52:58.870554 [debug] [Thread-1 (]: Timing info for model.dbtcustomers.dbtcustomers (execute): 14:52:35.070725 => 14:52:58.870308
[0m14:52:58.871578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc328d7-6055-482f-b0a0-c1db753f8782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eeab98a0>]}
[0m14:52:58.872446 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 23.81s]
[0m14:52:58.873469 [debug] [Thread-1 (]: Finished running node model.dbtcustomers.dbtcustomers
[0m14:52:58.876181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:58.876559 [debug] [MainThread]: Connection 'model.dbtcustomers.dbtcustomers' was properly closed.
[0m14:52:58.876977 [info ] [MainThread]: 
[0m14:52:58.878119 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 25.46 seconds (25.46s).
[0m14:52:58.879433 [debug] [MainThread]: Command end result
[0m14:52:58.893339 [info ] [MainThread]: 
[0m14:52:58.894288 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:58.894972 [info ] [MainThread]: 
[0m14:52:58.895678 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:58.896843 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:58.896697 after 26.82 seconds
[0m14:52:58.897298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8f187a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eeb5dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8eef6d630>]}
[0m14:52:58.897879 [debug] [MainThread]: Flushing usage events
[0m14:54:20.483196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81acdfa3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81abbce500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81abbce4a0>]}


============================== 14:54:20.485961 | 5a45b116-641d-4013-9a33-a7308b0dc8cc ==============================
[0m14:54:20.485961 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:54:20.486989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:54:20.848451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a45b116-641d-4013-9a33-a7308b0dc8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ac9cf520>]}
[0m14:54:20.867660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a45b116-641d-4013-9a33-a7308b0dc8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81aa0a3490>]}
[0m14:54:20.868584 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:54:20.880807 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:54:20.904775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:54:20.905321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:54:20.911423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a45b116-641d-4013-9a33-a7308b0dc8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a9e664d0>]}
[0m14:54:20.918554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a45b116-641d-4013-9a33-a7308b0dc8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a9f961a0>]}
[0m14:54:20.919217 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:54:20.919894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a45b116-641d-4013-9a33-a7308b0dc8cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a9f961d0>]}
[0m14:54:20.921287 [info ] [MainThread]: 
[0m14:54:20.921946 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:54:20.922945 [debug] [MainThread]: Command end result
[0m14:54:20.929529 [debug] [MainThread]: Command `dbt test` succeeded at 14:54:20.929329 after 0.45 seconds
[0m14:54:20.930110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81acdfa3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ac96f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81a9f95b40>]}
[0m14:54:20.930564 [debug] [MainThread]: Flushing usage events
[0m14:56:40.600505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fb29263b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fb170e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fb170e4a0>]}


============================== 14:56:40.603286 | 50688000-0248-4fa0-8c0f-5b9ce22aa580 ==============================
[0m14:56:40.603286 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:56:40.604388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:56:40.973288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50688000-0248-4fa0-8c0f-5b9ce22aa580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fb26fff70>]}
[0m14:56:40.990755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50688000-0248-4fa0-8c0f-5b9ce22aa580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fafde5240>]}
[0m14:56:40.991803 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:56:41.004002 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:56:41.028228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:41.028737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:41.035026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50688000-0248-4fa0-8c0f-5b9ce22aa580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fafbac0d0>]}
[0m14:56:41.042253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50688000-0248-4fa0-8c0f-5b9ce22aa580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fafccab60>]}
[0m14:56:41.042998 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:56:41.043925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50688000-0248-4fa0-8c0f-5b9ce22aa580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fafccabf0>]}
[0m14:56:41.045415 [info ] [MainThread]: 
[0m14:56:41.046311 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:56:41.047393 [debug] [MainThread]: Command end result
[0m14:56:41.053664 [debug] [MainThread]: Command `dbt test` succeeded at 14:56:41.053475 after 0.46 seconds
[0m14:56:41.054245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fb29263b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fb24dae30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fafcca860>]}
[0m14:56:41.054693 [debug] [MainThread]: Flushing usage events
[0m14:58:04.502089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c6bcf22f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c6aa0a440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c6aa0a3e0>]}


============================== 14:58:04.504817 | 51a0cf6d-bc60-456f-b12b-8a422ded0650 ==============================
[0m14:58:04.504817 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:58:04.505650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:58:04.872701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a0cf6d-bc60-456f-b12b-8a422ded0650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c6bc2cd30>]}
[0m14:58:04.890285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51a0cf6d-bc60-456f-b12b-8a422ded0650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c690f4880>]}
[0m14:58:04.891232 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:58:04.902734 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:58:04.926814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:04.927262 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:04.933422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51a0cf6d-bc60-456f-b12b-8a422ded0650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c68eba770>]}
[0m14:58:04.940540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51a0cf6d-bc60-456f-b12b-8a422ded0650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c68fea440>]}
[0m14:58:04.941206 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:58:04.941991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a0cf6d-bc60-456f-b12b-8a422ded0650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c68fea470>]}
[0m14:58:04.943391 [info ] [MainThread]: 
[0m14:58:04.944370 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:58:04.945159 [debug] [MainThread]: Command end result
[0m14:58:04.953451 [debug] [MainThread]: Command `dbt test` succeeded at 14:58:04.953257 after 0.46 seconds
[0m14:58:04.954013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c6bcf22f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c6bacb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c68fe9de0>]}
[0m14:58:04.954458 [debug] [MainThread]: Flushing usage events
[0m15:09:46.985707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccf37a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cce2c6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cce2c6410>]}


============================== 15:09:46.988806 | b31422be-7d9e-425f-b8b7-034858ae3d78 ==============================
[0m15:09:46.988806 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:09:46.989658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:09:47.368159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b31422be-7d9e-425f-b8b7-034858ae3d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccf2b0310>]}
[0m15:09:47.386541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b31422be-7d9e-425f-b8b7-034858ae3d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccc7b1540>]}
[0m15:09:47.387575 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:09:47.399540 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:09:47.407338 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:09:47.408162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b31422be-7d9e-425f-b8b7-034858ae3d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccc7cab30>]}
[0m15:09:48.181344 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m15:09:48.251782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b31422be-7d9e-425f-b8b7-034858ae3d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccc713fa0>]}
[0m15:09:48.259639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b31422be-7d9e-425f-b8b7-034858ae3d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccc1b9270>]}
[0m15:09:48.260539 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:09:48.261381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b31422be-7d9e-425f-b8b7-034858ae3d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccc1b9e40>]}
[0m15:09:48.262909 [info ] [MainThread]: 
[0m15:09:48.263662 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:09:48.264493 [debug] [MainThread]: Command end result
[0m15:09:48.271977 [debug] [MainThread]: Command `dbt test` succeeded at 15:09:48.271767 after 1.29 seconds
[0m15:09:48.272598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccf37a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccf14b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ccc713e80>]}
[0m15:09:48.273055 [debug] [MainThread]: Flushing usage events
[0m15:13:45.100174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5f646350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5e5f24a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5e5f2440>]}


============================== 15:13:45.102954 | a004363e-dd8f-4deb-85a0-fd0f361f80e6 ==============================
[0m15:13:45.102954 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:13:45.103851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:13:45.476124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a004363e-dd8f-4deb-85a0-fd0f361f80e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5f52d900>]}
[0m15:13:45.494132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a004363e-dd8f-4deb-85a0-fd0f361f80e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5cadd4e0>]}
[0m15:13:45.495128 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:13:45.506573 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:13:45.514811 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:13:45.515614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a004363e-dd8f-4deb-85a0-fd0f361f80e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5caf6f20>]}
[0m15:13:45.519373 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbtcustomers.yml is invalid because the value of 'models' is not a list
[0m15:13:45.520386 [debug] [MainThread]: Command `dbt test` failed at 15:13:45.520245 after 0.43 seconds
[0m15:13:45.520833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5f646350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5ca43e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e5ca43d90>]}
[0m15:13:45.521399 [debug] [MainThread]: Flushing usage events
[0m15:14:31.302071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7730076320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772efc6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772efc6410>]}


============================== 15:14:31.304862 | 4793f84e-0a6e-4ec2-a02d-c2c76b141823 ==============================
[0m15:14:31.304862 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:14:31.305665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:14:31.670439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4793f84e-0a6e-4ec2-a02d-c2c76b141823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772ffacb20>]}
[0m15:14:31.688409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4793f84e-0a6e-4ec2-a02d-c2c76b141823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d4b08b0>]}
[0m15:14:31.689444 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:14:31.701343 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:14:31.709498 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:14:31.710379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4793f84e-0a6e-4ec2-a02d-c2c76b141823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d4cae60>]}
[0m15:14:31.714085 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbtcustomers.yml is invalid because the value of 'models' is not a list
[0m15:14:31.715120 [debug] [MainThread]: Command `dbt test` failed at 15:14:31.714975 after 0.42 seconds
[0m15:14:31.715566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7730076320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d413d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772d413d30>]}
[0m15:14:31.716148 [debug] [MainThread]: Flushing usage events
[0m15:14:45.940046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51697a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd515c0a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd515c0a440>]}


============================== 15:14:45.942926 | 53ab6401-e141-4474-9929-611ef024910c ==============================
[0m15:14:45.942926 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:14:45.943761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:14:46.314641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53ab6401-e141-4474-9929-611ef024910c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd516861900>]}
[0m15:14:46.332183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53ab6401-e141-4474-9929-611ef024910c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd513de13f0>]}
[0m15:14:46.333169 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:14:46.344896 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:14:46.352859 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:14:46.353537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '53ab6401-e141-4474-9929-611ef024910c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd513dfaf50>]}
[0m15:14:46.357505 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  | 
    6  | models:
    7  |    -name: dbtcustomers
    8  |      columns: 
    9  |       - name: id
    10 |         tests: 
    11 |           - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 8, column 13
[0m15:14:46.358476 [debug] [MainThread]: Command `dbt test` failed at 15:14:46.358333 after 0.43 seconds
[0m15:14:46.358920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51697a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd513d43e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd513d43b80>]}
[0m15:14:46.359436 [debug] [MainThread]: Flushing usage events
[0m15:15:09.375485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144c9a6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b6c64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144b6c6470>]}


============================== 15:15:09.378292 | 99618b9e-8c8a-4042-930b-be6fdaf8d65f ==============================
[0m15:15:09.378292 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:15:09.379106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:15:09.757150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99618b9e-8c8a-4042-930b-be6fdaf8d65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1449b6ba60>]}
[0m15:15:09.776599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99618b9e-8c8a-4042-930b-be6fdaf8d65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1449bb23e0>]}
[0m15:15:09.777516 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:15:09.788951 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:15:09.796824 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:15:09.797598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99618b9e-8c8a-4042-930b-be6fdaf8d65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1449bcaaa0>]}
[0m15:15:10.574974 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m15:15:10.662178 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbtcustomers.example
[0m15:15:10.668876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99618b9e-8c8a-4042-930b-be6fdaf8d65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1449b13fa0>]}
[0m15:15:10.676902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99618b9e-8c8a-4042-930b-be6fdaf8d65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1449bb3790>]}
[0m15:15:10.677608 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:15:10.678208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99618b9e-8c8a-4042-930b-be6fdaf8d65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1449b44460>]}
[0m15:15:10.680053 [info ] [MainThread]: 
[0m15:15:10.681356 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:15:10.682982 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m15:15:10.683621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:11.799482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99618b9e-8c8a-4042-930b-be6fdaf8d65f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1449a91f30>]}
[0m15:15:11.800874 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:15:11.801621 [info ] [MainThread]: 
[0m15:15:11.806553 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:15:11.807020 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:15:11.807621 [info ] [Thread-1 (]: 1 of 2 START test not_null_dbtcustomers_id ..................................... [RUN]
[0m15:15:11.808446 [info ] [Thread-2 (]: 2 of 2 START test unique_dbtcustomers_id ....................................... [RUN]
[0m15:15:11.809415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c)
[0m15:15:11.810281 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245'
[0m15:15:11.810837 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:15:11.811412 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:15:11.825235 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m15:15:11.835546 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m15:15:11.836954 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 15:15:11.825602 => 15:15:11.836602
[0m15:15:11.837545 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:15:11.838097 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 15:15:11.811758 => 15:15:11.837869
[0m15:15:11.856878 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m15:15:11.857383 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:15:11.860474 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m15:15:11.861541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:11.862203 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_robert`.`dbtcustomers`
where id is null



      
    ) dbt_internal_test
[0m15:15:11.864338 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:15:11.865212 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_id.0c18a9f245: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:15:13.649027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ac3b4f0e-3145-4dfc-8034-9ca66897f541&page=queryresults
[0m15:15:13.651493 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 15:15:11.857960 => 15:15:13.651125
[0m15:15:13.652747 [info ] [Thread-1 (]: 1 of 2 PASS not_null_dbtcustomers_id ........................................... [[32mPASS[0m in 1.84s]
[0m15:15:13.654133 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:15:13.757731 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6f17644f-95b9-4656-abf4-7e56ed62db90&page=queryresults
[0m15:15:13.759375 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 15:15:11.838378 => 15:15:13.758980
[0m15:15:13.761305 [info ] [Thread-2 (]: 2 of 2 PASS unique_dbtcustomers_id ............................................. [[32mPASS[0m in 1.95s]
[0m15:15:13.762725 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:15:13.773430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:13.774063 [debug] [MainThread]: Connection 'test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c' was properly closed.
[0m15:15:13.774577 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245' was properly closed.
[0m15:15:13.775227 [info ] [MainThread]: 
[0m15:15:13.776718 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m15:15:13.788263 [debug] [MainThread]: Command end result
[0m15:15:13.818152 [info ] [MainThread]: 
[0m15:15:13.819698 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:13.821464 [info ] [MainThread]: 
[0m15:15:13.822660 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:15:13.823652 [debug] [MainThread]: Command `dbt test` succeeded at 15:15:13.823516 after 4.46 seconds
[0m15:15:13.824236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144c9a6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144955a140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144a021c60>]}
[0m15:15:13.825104 [debug] [MainThread]: Flushing usage events
[0m15:16:46.724689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66e266350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66d00a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66d00a440>]}


============================== 15:16:46.727439 | 98a2a98f-a4e2-4cab-83f8-e6bab06779a0 ==============================
[0m15:16:46.727439 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:16:46.728409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:16:47.099941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98a2a98f-a4e2-4cab-83f8-e6bab06779a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66e14cd90>]}
[0m15:16:47.117393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98a2a98f-a4e2-4cab-83f8-e6bab06779a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66b6f14e0>]}
[0m15:16:47.118442 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:16:47.130471 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:16:47.139113 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:16:47.139792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98a2a98f-a4e2-4cab-83f8-e6bab06779a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66b70ef20>]}
[0m15:16:47.925698 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m15:16:48.018345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98a2a98f-a4e2-4cab-83f8-e6bab06779a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66b563460>]}
[0m15:16:48.025881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98a2a98f-a4e2-4cab-83f8-e6bab06779a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66b6f24a0>]}
[0m15:16:48.026564 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:16:48.027159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a2a98f-a4e2-4cab-83f8-e6bab06779a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66b6f23b0>]}
[0m15:16:48.028979 [info ] [MainThread]: 
[0m15:16:48.030059 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:16:48.031529 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m15:16:48.032034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:49.057884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a2a98f-a4e2-4cab-83f8-e6bab06779a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66b70ca00>]}
[0m15:16:49.059159 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:16:49.059813 [info ] [MainThread]: 
[0m15:16:49.064119 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:16:49.064587 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:16:49.065807 [info ] [Thread-2 (]: 2 of 2 START test unique_dbtcustomers_id ....................................... [RUN]
[0m15:16:49.066927 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245'
[0m15:16:49.067376 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:16:49.065104 [info ] [Thread-1 (]: 1 of 2 START test not_null_dbtcustomers_id ..................................... [RUN]
[0m15:16:49.079016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c)
[0m15:16:49.079469 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:16:49.085959 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m15:16:49.093379 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m15:16:49.094327 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 15:16:49.067712 => 15:16:49.093987
[0m15:16:49.095015 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:16:49.106252 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 15:16:49.079739 => 15:16:49.105993
[0m15:16:49.114006 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m15:16:49.114516 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:16:49.115324 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:16:49.118036 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m15:16:49.118577 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_id.0c18a9f245: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:16:49.119483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:49.122346 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_robert`.`dbtcustomers`
where id is null



      
    ) dbt_internal_test
[0m15:16:50.676140 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f325e34e-075b-4186-b310-b415acc2b7c0&page=queryresults
[0m15:16:50.678985 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 15:16:49.095429 => 15:16:50.678656
[0m15:16:50.680176 [info ] [Thread-2 (]: 2 of 2 PASS unique_dbtcustomers_id ............................................. [[32mPASS[0m in 1.61s]
[0m15:16:50.681241 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:16:50.707953 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e4fa9eba-c788-44b1-8f0f-8e3293285e08&page=queryresults
[0m15:16:50.709186 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 15:16:49.115664 => 15:16:50.708908
[0m15:16:50.710165 [info ] [Thread-1 (]: 1 of 2 PASS not_null_dbtcustomers_id ........................................... [[32mPASS[0m in 1.63s]
[0m15:16:50.711173 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:16:50.713099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:50.713498 [debug] [MainThread]: Connection 'test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c' was properly closed.
[0m15:16:50.713850 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245' was properly closed.
[0m15:16:50.714252 [info ] [MainThread]: 
[0m15:16:50.714808 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m15:16:50.715858 [debug] [MainThread]: Command end result
[0m15:16:50.723892 [info ] [MainThread]: 
[0m15:16:50.724903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:50.725581 [info ] [MainThread]: 
[0m15:16:50.726387 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:16:50.727464 [debug] [MainThread]: Command `dbt test` succeeded at 15:16:50.727335 after 4.01 seconds
[0m15:16:50.727901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66e266350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66b04ab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff66b4a62c0>]}
[0m15:16:50.728603 [debug] [MainThread]: Flushing usage events
[0m15:24:39.754936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc124ab23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12380e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12380e4d0>]}


============================== 15:24:39.757679 | 33ef9bf7-59e9-4929-9cf4-5e52079db0b9 ==============================
[0m15:24:39.757679 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:24:39.758496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:24:40.137592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33ef9bf7-59e9-4929-9cf4-5e52079db0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc12485d300>]}
[0m15:24:40.155223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33ef9bf7-59e9-4929-9cf4-5e52079db0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc121ef1d80>]}
[0m15:24:40.156326 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:24:40.168509 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:24:40.194517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:24:40.195447 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/dbtcustomers.yml
[0m15:24:40.221087 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers.sql
[0m15:24:40.281997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33ef9bf7-59e9-4929-9cf4-5e52079db0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc121784ac0>]}
[0m15:24:40.290333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33ef9bf7-59e9-4929-9cf4-5e52079db0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc121d3d240>]}
[0m15:24:40.291040 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:24:40.291623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33ef9bf7-59e9-4929-9cf4-5e52079db0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc121d3d2a0>]}
[0m15:24:40.293932 [info ] [MainThread]: 
[0m15:24:40.295140 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:24:40.296632 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m15:24:40.297161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:41.344836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33ef9bf7-59e9-4929-9cf4-5e52079db0b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc121d14400>]}
[0m15:24:41.346167 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:24:41.347629 [info ] [MainThread]: 
[0m15:24:41.353062 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:24:41.353706 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:24:41.354222 [info ] [Thread-1 (]: 1 of 2 START test not_null_dbtcustomers_id ..................................... [RUN]
[0m15:24:41.354872 [info ] [Thread-2 (]: 2 of 2 START test unique_dbtcustomers_id ....................................... [RUN]
[0m15:24:41.355848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c)
[0m15:24:41.357094 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245'
[0m15:24:41.357663 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:24:41.358134 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:24:41.372340 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m15:24:41.379285 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m15:24:41.380355 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 15:24:41.358459 => 15:24:41.379906
[0m15:24:41.380995 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:24:41.392229 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 15:24:41.372706 => 15:24:41.391958
[0m15:24:41.400034 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m15:24:41.400475 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:24:41.407011 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m15:24:41.407673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:41.408515 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_robert`.`dbtcustomers`
where id is null



      
    ) dbt_internal_test
[0m15:24:41.411395 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:24:41.411865 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_id.0c18a9f245: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:24:42.984143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:128fcbf2-9e81-4817-8b1c-f96aa666bbd3&page=queryresults
[0m15:24:42.986865 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 15:24:41.381376 => 15:24:42.986497
[0m15:24:42.988272 [info ] [Thread-1 (]: 1 of 2 PASS not_null_dbtcustomers_id ........................................... [[32mPASS[0m in 1.63s]
[0m15:24:42.989582 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:24:43.445402 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fa2bd422-5595-4e30-b2a7-9b4f1689d76a&page=queryresults
[0m15:24:43.446576 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 15:24:41.403151 => 15:24:43.446288
[0m15:24:43.447613 [info ] [Thread-2 (]: 2 of 2 PASS unique_dbtcustomers_id ............................................. [[32mPASS[0m in 2.09s]
[0m15:24:43.448655 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:24:43.450931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:43.451315 [debug] [MainThread]: Connection 'test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c' was properly closed.
[0m15:24:43.451671 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245' was properly closed.
[0m15:24:43.452100 [info ] [MainThread]: 
[0m15:24:43.452677 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m15:24:43.453808 [debug] [MainThread]: Command end result
[0m15:24:43.467556 [info ] [MainThread]: 
[0m15:24:43.468357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:43.469034 [info ] [MainThread]: 
[0m15:24:43.470584 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:24:43.471589 [debug] [MainThread]: Command `dbt test` succeeded at 15:24:43.471459 after 3.72 seconds
[0m15:24:43.472059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc124ab23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1246610f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc121d3d2d0>]}
[0m15:24:43.472723 [debug] [MainThread]: Flushing usage events
[0m15:25:03.755634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc56f32380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc561be620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc561be5c0>]}


============================== 15:25:03.758485 | 102f5c0d-e0e2-4509-9d8e-fc1f3e54c2a1 ==============================
[0m15:25:03.758485 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:25:03.759324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:25:04.188473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '102f5c0d-e0e2-4509-9d8e-fc1f3e54c2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc56e5a650>]}
[0m15:25:04.206195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '102f5c0d-e0e2-4509-9d8e-fc1f3e54c2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc543dc880>]}
[0m15:25:04.207249 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:25:04.219567 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:25:04.245078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:25:04.245600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:25:04.251950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '102f5c0d-e0e2-4509-9d8e-fc1f3e54c2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc541c00d0>]}
[0m15:25:04.253543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '102f5c0d-e0e2-4509-9d8e-fc1f3e54c2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc54183760>]}
[0m15:25:04.254121 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:25:04.254671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '102f5c0d-e0e2-4509-9d8e-fc1f3e54c2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc54183700>]}
[0m15:25:04.256342 [info ] [MainThread]: 
[0m15:25:04.257579 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:25:04.258988 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m15:25:04.259527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:05.310572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '102f5c0d-e0e2-4509-9d8e-fc1f3e54c2a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc54183850>]}
[0m15:25:05.311909 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:25:05.312721 [info ] [MainThread]: 
[0m15:25:05.317750 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m15:25:05.318552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m15:25:05.319028 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m15:25:05.322612 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m15:25:05.323406 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 15:25:05.319327 => 15:25:05.323123
[0m15:25:05.323842 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m15:25:05.324413 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 15:25:05.324153 => 15:25:05.324177
[0m15:25:05.325368 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m15:25:05.327441 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:25:05.326332 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:25:05.330850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now test.dbt_robert.unique_dbtcustomers_id.0c18a9f245)
[0m15:25:05.331713 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c'
[0m15:25:05.332265 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:25:05.332739 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:25:05.343553 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m15:25:05.352766 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m15:25:05.354024 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 15:25:05.333055 => 15:25:05.353775
[0m15:25:05.354563 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:25:05.355244 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 15:25:05.354950 => 15:25:05.354969
[0m15:25:05.356429 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:25:05.356887 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 15:25:05.343893 => 15:25:05.356674
[0m15:25:05.357535 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:25:05.358083 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 15:25:05.357827 => 15:25:05.357839
[0m15:25:05.359024 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:25:05.360105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:05.360469 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245' was properly closed.
[0m15:25:05.360812 [debug] [MainThread]: Connection 'test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c' was properly closed.
[0m15:25:05.361735 [debug] [MainThread]: Command end result
[0m15:25:05.408733 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:25:05.409280 [info ] [MainThread]: Building catalog
[0m15:25:05.410387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:05.772068 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m15:25:05.789093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:05.790098 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_robert`.__TABLES__
        where (upper(dataset_id) = upper('dbt_robert'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:25:09.219187 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ddc1daf4-a59d-40ca-9e2a-89f136d196fe&page=queryresults
[0m15:25:09.236650 [info ] [MainThread]: Catalog written to /home/vscode/dbt_robert_project/target/catalog.json
[0m15:25:09.238381 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:25:09.237943 after 5.49 seconds
[0m15:25:09.238833 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:25:09.239213 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m15:25:09.239823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc56f32380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc544cac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc51853e20>]}
[0m15:25:09.240472 [debug] [MainThread]: Flushing usage events
[0m15:25:21.128825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74629aa2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746170e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f746170e3e0>]}


============================== 15:25:21.131596 | dbf39ba0-b956-45d9-8687-7f8f60396df0 ==============================
[0m15:25:21.131596 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:25:21.132450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:25:21.526633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbf39ba0-b956-45d9-8687-7f8f60396df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74628e5660>]}
[0m15:25:21.558609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbf39ba0-b956-45d9-8687-7f8f60396df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745fdf5030>]}
[0m15:30:22.114403 [error] [MainThread]: Encountered an error:

[0m15:30:22.138616 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m15:30:22.143556 [debug] [MainThread]: Command `dbt docs serve` failed at 15:30:22.141777 after 301.02 seconds
[0m15:30:22.144481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74629aa2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745fdf45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f745fdf4460>]}
[0m15:30:22.145302 [debug] [MainThread]: Flushing usage events
[0m15:44:05.749221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82445a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8233f2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8233f25f0>]}


============================== 15:44:05.753582 | 0f2edb43-40b7-42f2-8cc1-22545bb541b1 ==============================
[0m15:44:05.753582 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:44:05.754523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:44:06.118483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f2edb43-40b7-42f2-8cc1-22545bb541b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82422b520>]}
[0m15:44:06.136513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f2edb43-40b7-42f2-8cc1-22545bb541b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8218d9d20>]}
[0m15:44:06.137481 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:44:06.149236 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:44:06.174471 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m15:44:06.175142 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/dbtcustomers/dbtcustomers.sql
[0m15:44:06.175664 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/dbtcustomers/schema.yml
[0m15:44:06.176120 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/dbtcustomers/dbtcustomers.md
[0m15:44:06.176571 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/dbtcustomers.sql
[0m15:44:06.201560 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers/dbtcustomers.sql
[0m15:44:06.260994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f2edb43-40b7-42f2-8cc1-22545bb541b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff821190df0>]}
[0m15:44:06.262974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f2edb43-40b7-42f2-8cc1-22545bb541b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82167fa00>]}
[0m15:44:06.263558 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:44:06.264130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f2edb43-40b7-42f2-8cc1-22545bb541b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82167fb20>]}
[0m15:44:06.265976 [info ] [MainThread]: 
[0m15:44:06.267195 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:44:06.270798 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m15:44:06.271383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:07.477804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f2edb43-40b7-42f2-8cc1-22545bb541b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff821721630>]}
[0m15:44:07.479124 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:44:07.480041 [info ] [MainThread]: 
[0m15:44:07.484876 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m15:44:07.485796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m15:44:07.486306 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m15:44:07.490405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m15:44:07.491270 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 15:44:07.486824 => 15:44:07.491013
[0m15:44:07.491709 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m15:44:07.492271 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 15:44:07.491992 => 15:44:07.492037
[0m15:44:07.493225 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m15:44:07.494187 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:44:07.494605 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:44:07.495454 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c'
[0m15:44:07.496210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now test.dbt_robert.unique_dbtcustomers_id.0c18a9f245)
[0m15:44:07.496701 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:44:07.497156 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:44:07.510552 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m15:44:07.517413 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m15:44:07.518415 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 15:44:07.497474 => 15:44:07.518169
[0m15:44:07.518854 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:44:07.519389 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 15:44:07.519146 => 15:44:07.519162
[0m15:44:07.520373 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:44:07.521131 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 15:44:07.510913 => 15:44:07.520829
[0m15:44:07.521657 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:44:07.522192 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 15:44:07.521951 => 15:44:07.521962
[0m15:44:07.523403 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:44:07.524613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:07.524981 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245' was properly closed.
[0m15:44:07.525330 [debug] [MainThread]: Connection 'test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c' was properly closed.
[0m15:44:07.526263 [debug] [MainThread]: Command end result
[0m15:44:07.542386 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:44:07.542950 [info ] [MainThread]: Building catalog
[0m15:44:07.543950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:08.090129 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m15:44:08.106505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:08.107539 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_robert`.__TABLES__
        where (upper(dataset_id) = upper('dbt_robert'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:44:10.804276 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:90f1cfe8-2e25-475c-b557-86d8d449f81f&page=queryresults
[0m15:44:10.823133 [info ] [MainThread]: Catalog written to /home/vscode/dbt_robert_project/target/catalog.json
[0m15:44:10.824708 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:44:10.824492 after 5.08 seconds
[0m15:44:10.825274 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:44:10.825766 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m15:44:10.826223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82445a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff824017910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff821721630>]}
[0m15:44:10.826703 [debug] [MainThread]: Flushing usage events
[0m15:44:23.286031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ef5ee3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ee87a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ee87a4d0>]}


============================== 15:44:23.288808 | 4055b166-86a4-4cc4-8000-d2c00a9bc703 ==============================
[0m15:44:23.288808 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:44:23.289798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:44:23.655590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4055b166-86a4-4cc4-8000-d2c00a9bc703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ef3bf520>]}
[0m15:44:23.672991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4055b166-86a4-4cc4-8000-d2c00a9bc703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec9dd390>]}
[0m15:46:31.896348 [error] [MainThread]: Encountered an error:

[0m15:46:31.910526 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/usr/lib/python3.10/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib/python3.10/http/server.py", line 658, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/lib/python3.10/socketserver.py", line 747, in __init__
    self.handle()
  File "/usr/lib/python3.10/http/server.py", line 432, in handle
    self.handle_one_request()
  File "/usr/lib/python3.10/http/server.py", line 400, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m15:46:31.912110 [debug] [MainThread]: Command `dbt docs serve` failed at 15:46:31.911851 after 128.63 seconds
[0m15:46:31.912770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ef5ee3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec9dcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ec9dd030>]}
[0m15:46:31.913262 [debug] [MainThread]: Flushing usage events
[0m15:46:37.936246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab0e522f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aafdc6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aafdc6530>]}


============================== 15:46:37.939172 | 26371d0c-8c3d-4fdc-a276-8712fc0caeaf ==============================
[0m15:46:37.939172 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:46:37.940235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:46:38.311739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26371d0c-8c3d-4fdc-a276-8712fc0caeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aae2ac580>]}
[0m15:46:38.329682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26371d0c-8c3d-4fdc-a276-8712fc0caeaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aae2b1a20>]}
[0m15:46:38.330726 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:46:38.342745 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:46:38.368498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:46:38.369344 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/dbtcustomers/schema.yml
[0m15:46:38.395030 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers/dbtcustomers.sql
[0m15:46:38.422540 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/dbtcustomers/schema.yml @ models: {'name': 'dbtcustomers', 'description': '{{ doc("dbt_customers_table") }}', 'columns': [{'name': 'id', 'description': 'this column is a unique customer identifier. it can also be used as the Primary Key in this table', 'tests': ['unique', 'not_null']}, {'name': 'name', 'description': 'Customer name', 'tests': [None]}], 'original_file_path': 'models/dbtcustomers/schema.yml', 'yaml_key': 'models', 'package_name': 'dbt_robert'} - at path ['columns'][1]['tests'][0]: None is not valid under any of the given schemas
[0m15:46:38.423898 [debug] [MainThread]: Command `dbt docs generate` failed at 15:46:38.423730 after 0.50 seconds
[0m15:46:38.424410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ab0e522f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aae0e3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aae0e3670>]}
[0m15:46:38.425021 [debug] [MainThread]: Flushing usage events
[0m15:48:46.810305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e473a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e350e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e350e410>]}


============================== 15:48:46.813078 | 030700ff-5e6f-4482-82ae-db12e00d4112 ==============================
[0m15:48:46.813078 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:48:46.813871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:48:47.179665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '030700ff-5e6f-4482-82ae-db12e00d4112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e4674dc0>]}
[0m15:48:47.197411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '030700ff-5e6f-4482-82ae-db12e00d4112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e1bf54e0>]}
[0m15:48:47.198283 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:48:47.211929 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:48:47.238520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:48:47.239309 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/dbtcustomers/schema.yml
[0m15:48:47.264415 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers/dbtcustomers.sql
[0m15:48:47.326083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '030700ff-5e6f-4482-82ae-db12e00d4112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e1488fa0>]}
[0m15:48:47.334189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '030700ff-5e6f-4482-82ae-db12e00d4112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e1a1a110>]}
[0m15:48:47.335024 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:48:47.335859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030700ff-5e6f-4482-82ae-db12e00d4112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e1a1af50>]}
[0m15:48:47.337595 [info ] [MainThread]: 
[0m15:48:47.338973 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:48:47.340430 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m15:48:47.341081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:48.435611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030700ff-5e6f-4482-82ae-db12e00d4112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e1a1bdf0>]}
[0m15:48:48.436765 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:48:48.437503 [info ] [MainThread]: 
[0m15:48:48.442398 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:48:48.443406 [info ] [Thread-1 (]: 1 of 3 START test not_null_dbtcustomers_id ..................................... [RUN]
[0m15:48:48.442867 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:48:48.444420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c)
[0m15:48:48.444993 [info ] [Thread-2 (]: 2 of 3 START test unique_dbtcustomers_id ....................................... [RUN]
[0m15:48:48.446516 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:48:48.447437 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245'
[0m15:48:48.461810 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m15:48:48.462330 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:48:48.463394 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 15:48:48.448095 => 15:48:48.463133
[0m15:48:48.470320 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m15:48:48.470843 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:48:48.471784 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 15:48:48.463657 => 15:48:48.471434
[0m15:48:48.490162 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m15:48:48.490688 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:48:48.493648 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m15:48:48.494479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:48.494978 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_robert`.`dbtcustomers`
where id is null



      
    ) dbt_internal_test
[0m15:48:48.499945 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:48:48.501549 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_id.0c18a9f245: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:48:50.012456 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:319b47e9-4be0-4d8c-b0de-e18e6af33d8c&page=queryresults
[0m15:48:50.014581 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 15:48:48.491243 => 15:48:50.014281
[0m15:48:50.015677 [info ] [Thread-2 (]: 2 of 3 PASS unique_dbtcustomers_id ............................................. [[32mPASS[0m in 1.57s]
[0m15:48:50.016887 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:48:50.017455 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m15:48:50.018038 [info ] [Thread-2 (]: 3 of 3 START test unique_dbtcustomers_name ..................................... [RUN]
[0m15:48:50.019382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.unique_dbtcustomers_id.0c18a9f245, now test.dbt_robert.unique_dbtcustomers_name.079d8f26d5)
[0m15:48:50.019965 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m15:48:50.026921 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_name.079d8f26d5"
[0m15:48:50.027789 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_name.079d8f26d5 (compile): 15:48:50.020542 => 15:48:50.027457
[0m15:48:50.028256 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m15:48:50.030936 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_name.079d8f26d5"
[0m15:48:50.031659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:48:50.032191 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_name.079d8f26d5: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_name.079d8f26d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select name as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:48:50.066284 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:656602e6-85e2-423c-bdd1-740381bbc61b&page=queryresults
[0m15:48:50.067652 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 15:48:48.472143 => 15:48:50.067267
[0m15:48:50.069207 [info ] [Thread-1 (]: 1 of 3 PASS not_null_dbtcustomers_id ........................................... [[32mPASS[0m in 1.62s]
[0m15:48:50.070846 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:48:51.940239 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ef31d89d-a038-4d5d-869e-29ffc5312ac6&page=queryresults
[0m15:48:51.941554 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_name.079d8f26d5 (execute): 15:48:50.028555 => 15:48:51.941267
[0m15:48:51.942594 [info ] [Thread-2 (]: 3 of 3 PASS unique_dbtcustomers_name ........................................... [[32mPASS[0m in 1.92s]
[0m15:48:51.943613 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m15:48:51.945928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:51.946347 [debug] [MainThread]: Connection 'test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c' was properly closed.
[0m15:48:51.946698 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_name.079d8f26d5' was properly closed.
[0m15:48:51.947096 [info ] [MainThread]: 
[0m15:48:51.947858 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 4.61 seconds (4.61s).
[0m15:48:51.949256 [debug] [MainThread]: Command end result
[0m15:48:51.958875 [info ] [MainThread]: 
[0m15:48:51.959828 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:48:51.960467 [info ] [MainThread]: 
[0m15:48:51.961086 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:48:51.962255 [debug] [MainThread]: Command `dbt test` succeeded at 15:48:51.962119 after 5.16 seconds
[0m15:48:51.962704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e473a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e19ce110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7e45112a0>]}
[0m15:48:51.963376 [debug] [MainThread]: Flushing usage events
[0m15:49:00.949332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267be5a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267adf25f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267adf2590>]}


============================== 15:49:00.952140 | acd02b6f-1624-48d2-9ca4-ec2a9f46b8e8 ==============================
[0m15:49:00.952140 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:49:00.952973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:49:01.326206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acd02b6f-1624-48d2-9ca4-ec2a9f46b8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26792d85b0>]}
[0m15:49:01.344494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acd02b6f-1624-48d2-9ca4-ec2a9f46b8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26792df370>]}
[0m15:49:01.345515 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:49:01.357155 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:49:01.382922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:49:01.383465 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:49:01.390075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acd02b6f-1624-48d2-9ca4-ec2a9f46b8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26790bc5b0>]}
[0m15:49:01.391705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acd02b6f-1624-48d2-9ca4-ec2a9f46b8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2679080280>]}
[0m15:49:01.392385 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:49:01.392949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acd02b6f-1624-48d2-9ca4-ec2a9f46b8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26790802b0>]}
[0m15:49:01.394804 [info ] [MainThread]: 
[0m15:49:01.395956 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:49:01.397434 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m15:49:01.397935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:02.477122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acd02b6f-1624-48d2-9ca4-ec2a9f46b8e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2679080040>]}
[0m15:49:02.478270 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:49:02.479143 [info ] [MainThread]: 
[0m15:49:02.483960 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m15:49:02.484812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m15:49:02.485283 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m15:49:02.488871 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m15:49:02.489835 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 15:49:02.485579 => 15:49:02.489565
[0m15:49:02.490278 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m15:49:02.490824 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 15:49:02.490570 => 15:49:02.490593
[0m15:49:02.491784 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m15:49:02.493848 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:49:02.496678 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:49:02.497446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now test.dbt_robert.unique_dbtcustomers_id.0c18a9f245)
[0m15:49:02.498318 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c'
[0m15:49:02.498839 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:49:02.499325 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:49:02.535175 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m15:49:02.548415 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m15:49:02.549976 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 15:49:02.499642 => 15:49:02.549672
[0m15:49:02.550657 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:49:02.551429 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 15:49:02.551125 => 15:49:02.551149
[0m15:49:02.552865 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m15:49:02.553573 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 15:49:02.507984 => 15:49:02.553263
[0m15:49:02.556340 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:49:02.557112 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 15:49:02.556770 => 15:49:02.556786
[0m15:49:02.558419 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m15:49:02.554227 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m15:49:02.559555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.unique_dbtcustomers_id.0c18a9f245, now test.dbt_robert.unique_dbtcustomers_name.079d8f26d5)
[0m15:49:02.560168 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m15:49:02.567485 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_name.079d8f26d5"
[0m15:49:02.568573 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_name.079d8f26d5 (compile): 15:49:02.560576 => 15:49:02.568230
[0m15:49:02.569166 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m15:49:02.569710 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_name.079d8f26d5 (execute): 15:49:02.569461 => 15:49:02.569478
[0m15:49:02.570655 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m15:49:02.571816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:02.572247 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_name.079d8f26d5' was properly closed.
[0m15:49:02.572597 [debug] [MainThread]: Connection 'test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c' was properly closed.
[0m15:49:02.573669 [debug] [MainThread]: Command end result
[0m15:49:02.586800 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:49:02.587238 [info ] [MainThread]: Building catalog
[0m15:49:02.588128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:03.096823 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m15:49:03.113380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:03.114357 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_robert`.__TABLES__
        where (upper(dataset_id) = upper('dbt_robert'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:49:06.056789 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6e98a7e8-822b-41d4-8d02-a2977f34733a&page=queryresults
[0m15:49:06.076816 [info ] [MainThread]: Catalog written to /home/vscode/dbt_robert_project/target/catalog.json
[0m15:49:06.078698 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:49:06.078527 after 5.14 seconds
[0m15:49:06.079166 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:49:06.079574 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m15:49:06.080206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267be5a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267d46aec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f267bc27850>]}
[0m15:49:06.080875 [debug] [MainThread]: Flushing usage events
[0m15:49:12.686591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa52a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a92ca4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a92ca3b0>]}


============================== 15:49:12.689418 | b35ee4ef-4ccb-4bd9-afd1-ac2842a8fc8c ==============================
[0m15:49:12.689418 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:49:12.690235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:49:13.087622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b35ee4ef-4ccb-4bd9-afd1-ac2842a8fc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa058850>]}
[0m15:49:13.105354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b35ee4ef-4ccb-4bd9-afd1-ac2842a8fc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a77ad690>]}
[0m15:55:03.393454 [error] [MainThread]: Encountered an error:

[0m15:55:03.395887 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m15:55:03.397379 [debug] [MainThread]: Command `dbt docs serve` failed at 15:55:03.397160 after 350.72 seconds
[0m15:55:03.397895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0aa52a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a77ac580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a77af460>]}
[0m15:55:03.398402 [debug] [MainThread]: Flushing usage events
[0m15:55:08.538303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fb2a36380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fb19f24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fb19f2470>]}


============================== 15:55:08.541192 | db6d5c9c-8ca5-4a1c-93f5-4c43ee5b9ce1 ==============================
[0m15:55:08.541192 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:55:08.542003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:55:08.925243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db6d5c9c-8ca5-4a1c-93f5-4c43ee5b9ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fafe97610>]}
[0m15:55:08.943293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db6d5c9c-8ca5-4a1c-93f5-4c43ee5b9ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fafedb610>]}
[0m15:55:08.944290 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:55:08.955810 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:55:08.967463 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/schema.yml - Runtime Error
    Syntax error near line 24
    ------------------------------
    21 | sources: 
    22 |   - name: dbtcustomers
    23 |     project: aec-students
    24 |   freshness: 
    25 |     error_after:
    26 |       count: 12
    27 |       period: hour
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 22, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 24, column 3
[0m15:55:08.968574 [debug] [MainThread]: Command `dbt test` failed at 15:55:08.968390 after 0.44 seconds
[0m15:55:08.969057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fb2a36380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fafc6dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fafc6dd50>]}
[0m15:55:08.969532 [debug] [MainThread]: Flushing usage events
[0m15:56:52.933260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4172af62c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41719c6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41719c63b0>]}


============================== 15:56:52.936635 | 687ded76-a024-449c-8788-9d0b09e58ba1 ==============================
[0m15:56:52.936635 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:56:52.937644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:56:53.308044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '687ded76-a024-449c-8788-9d0b09e58ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4172a2d660>]}
[0m15:56:53.325411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '687ded76-a024-449c-8788-9d0b09e58ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416fead120>]}
[0m15:56:53.326404 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:56:53.338535 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:56:53.350255 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbtcustomers/schema.yml is invalid because a list element for 'sources' does not have a name attribute.
[0m15:56:53.351215 [debug] [MainThread]: Command `dbt test` failed at 15:56:53.351064 after 0.43 seconds
[0m15:56:53.351674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4172af62c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416fe36050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f416fe360e0>]}
[0m15:56:53.352185 [debug] [MainThread]: Flushing usage events
[0m16:02:53.890937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceee8de3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceed5ce500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceed5ce4a0>]}


============================== 16:02:53.893691 | 9ece4db8-aa97-47f4-bddc-cac0abab2add ==============================
[0m16:02:53.893691 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:02:53.894523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:02:54.258666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ece4db8-aa97-47f4-bddc-cac0abab2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceee4b3520>]}
[0m16:02:54.276273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ece4db8-aa97-47f4-bddc-cac0abab2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceebab1450>]}
[0m16:02:54.277221 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:02:54.288569 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:02:54.299918 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbtcustomers/dbtcustomers_schema.yml is invalid because a list element for 'sources' does not have a name attribute.
[0m16:02:54.300926 [debug] [MainThread]: Command `dbt test` failed at 16:02:54.300771 after 0.42 seconds
[0m16:02:54.301387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceee8de3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceeba45ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceeba45f30>]}
[0m16:02:54.301866 [debug] [MainThread]: Flushing usage events
[0m16:04:12.355503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61624aa2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61613c6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61613c63b0>]}


============================== 16:04:12.358398 | 5a0b42b0-d491-4d33-950c-99ad13c1a790 ==============================
[0m16:04:12.358398 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:04:12.359218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:04:12.727716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a0b42b0-d491-4d33-950c-99ad13c1a790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61623e1660>]}
[0m16:04:12.745529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a0b42b0-d491-4d33-950c-99ad13c1a790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615f8ad6c0>]}
[0m16:04:12.746483 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:04:12.758326 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:04:12.769772 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbtcustomers/dbtcustomers_schema.yml is invalid because a list element for 'sources' does not have a name attribute.
[0m16:04:12.770921 [debug] [MainThread]: Command `dbt test` failed at 16:04:12.770764 after 0.42 seconds
[0m16:04:12.771398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61624aa2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615f841f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f615f842020>]}
[0m16:04:12.771948 [debug] [MainThread]: Flushing usage events
[0m16:04:36.777095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e6374e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e626c24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e626c2470>]}


============================== 16:04:36.781801 | 227a49f5-5600-4470-ab42-cf495ba900ba ==============================
[0m16:04:36.781801 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:04:36.783720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:04:37.195928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '227a49f5-5600-4470-ab42-cf495ba900ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e63686650>]}
[0m16:04:37.213397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '227a49f5-5600-4470-ab42-cf495ba900ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e60bad600>]}
[0m16:04:37.214327 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:04:37.225751 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:04:37.237169 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbtcustomers/dbtcustomers_schema.yml is invalid because a list element for 'sources' does not have a name attribute.
[0m16:04:37.238200 [debug] [MainThread]: Command `dbt test` failed at 16:04:37.238018 after 0.47 seconds
[0m16:04:37.238839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e6374e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e60b3e0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e60b3e140>]}
[0m16:04:37.239378 [debug] [MainThread]: Flushing usage events
[0m16:07:21.167597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2c2ba320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2afce470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2afce410>]}


============================== 16:07:21.170446 | da617424-86e9-4455-b96f-234ca0bdd25b ==============================
[0m16:07:21.170446 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:07:21.171527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:07:21.597396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da617424-86e9-4455-b96f-234ca0bdd25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2bff4b20>]}
[0m16:07:21.615064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da617424-86e9-4455-b96f-234ca0bdd25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d294b0880>]}
[0m16:07:21.616233 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:07:21.635980 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:07:21.655139 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbtcustomers/dbtcustomers_schema.yml is invalid because a list element for 'sources' does not have a name attribute.
[0m16:07:21.657326 [debug] [MainThread]: Command `dbt test` failed at 16:07:21.657128 after 0.50 seconds
[0m16:07:21.658087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2c2ba320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d29441d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d29441de0>]}
[0m16:07:21.658862 [debug] [MainThread]: Flushing usage events
[0m16:08:07.687874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc7b5a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc68c6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc68c6410>]}


============================== 16:08:07.690714 | 5b8bd467-093e-419e-adac-e5162861d1ab ==============================
[0m16:08:07.690714 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:08:07.691540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:08:08.071713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b8bd467-093e-419e-adac-e5162861d1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc7894dc0>]}
[0m16:08:08.089404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b8bd467-093e-419e-adac-e5162861d1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc4dadc00>]}
[0m16:08:08.090903 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:08:08.102657 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:08:08.114612 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbtcustomers/dbtcustomers_schema.yml is invalid because a list element for 'sources' does not have a name attribute.
[0m16:08:08.115604 [debug] [MainThread]: Command `dbt test` failed at 16:08:08.115448 after 0.44 seconds
[0m16:08:08.116095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc7b5a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc4d3dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc4d3e080>]}
[0m16:08:08.116612 [debug] [MainThread]: Flushing usage events
[0m16:18:03.298553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccb466320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cca3c6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cca3c6410>]}


============================== 16:18:03.301316 | c69c9876-4f36-47c3-8fdc-bf46d7ce8623 ==============================
[0m16:18:03.301316 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:18:03.302122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:18:03.747404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c69c9876-4f36-47c3-8fdc-bf46d7ce8623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccb39cdc0>]}
[0m16:18:03.772824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c69c9876-4f36-47c3-8fdc-bf46d7ce8623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc88ad570>]}
[0m16:18:03.773874 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:18:03.791790 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:18:03.812087 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models/dbtcustomers/dbtcustomers_schema.yml is invalid because a list element for 'sources' does not have a name attribute.
[0m16:18:03.813370 [debug] [MainThread]: Command `dbt test` failed at 16:18:03.813210 after 0.52 seconds
[0m16:18:03.813884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ccb466320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc883a1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cc883a230>]}
[0m16:18:03.814630 [debug] [MainThread]: Flushing usage events
[0m16:19:03.820435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3162a5a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316180a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316180a410>]}


============================== 16:19:03.823150 | 75c00223-71cc-4c87-bfc5-d2f348aba92e ==============================
[0m16:19:03.823150 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:19:03.824111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:19:04.220721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75c00223-71cc-4c87-bfc5-d2f348aba92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3162980dc0>]}
[0m16:19:04.239560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75c00223-71cc-4c87-bfc5-d2f348aba92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315fef16f0>]}
[0m16:19:04.240562 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:19:04.252153 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:19:04.280693 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:19:04.281388 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/dbtcustomers/dbtcustomers_schema.yml
[0m16:19:04.306546 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers/dbtcustomers.sql
[0m16:19:04.371715 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/dbtcustomers/dbtcustomers_schema.yml @ sources: {'name': ['dbtcustomers']} - at path ['name']: ['dbtcustomers'] is not of type 'string'
[0m16:19:04.372964 [debug] [MainThread]: Command `dbt test` failed at 16:19:04.372777 after 0.56 seconds
[0m16:19:04.373462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3162a5a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315fd22410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315fd31990>]}
[0m16:19:04.373989 [debug] [MainThread]: Flushing usage events
[0m16:19:35.464135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ab77e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9aa6c64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9aa6c6470>]}


============================== 16:19:35.466975 | 50f6053d-957e-40da-bb53-ca125f682302 ==============================
[0m16:19:35.466975 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:19:35.468701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:19:35.837093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50f6053d-957e-40da-bb53-ca125f682302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a8bab190>]}
[0m16:19:35.854798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50f6053d-957e-40da-bb53-ca125f682302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a8bb33a0>]}
[0m16:19:35.855829 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:19:35.867692 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:19:35.893705 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:19:35.894469 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/dbtcustomers/dbtcustomers_schema.yml
[0m16:19:35.919829 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers/dbtcustomers.sql
[0m16:19:35.997205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50f6053d-957e-40da-bb53-ca125f682302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a8993460>]}
[0m16:19:36.004703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50f6053d-957e-40da-bb53-ca125f682302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a8950280>]}
[0m16:19:36.005405 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:19:36.006118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f6053d-957e-40da-bb53-ca125f682302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a8950220>]}
[0m16:19:36.008063 [info ] [MainThread]: 
[0m16:19:36.009222 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:19:36.011254 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m16:19:36.011731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:37.140864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f6053d-957e-40da-bb53-ca125f682302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a89502e0>]}
[0m16:19:37.142014 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:19:37.142771 [info ] [MainThread]: 
[0m16:19:37.146929 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m16:19:37.147473 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m16:19:37.148051 [info ] [Thread-1 (]: 1 of 3 START test not_null_dbtcustomers_id ..................................... [RUN]
[0m16:19:37.148760 [info ] [Thread-2 (]: 2 of 3 START test unique_dbtcustomers_id ....................................... [RUN]
[0m16:19:37.149785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c)
[0m16:19:37.150790 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245'
[0m16:19:37.151389 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m16:19:37.151910 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m16:19:37.165835 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m16:19:37.172982 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m16:19:37.174078 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 16:19:37.152264 => 16:19:37.173799
[0m16:19:37.174642 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m16:19:37.175335 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 16:19:37.166240 => 16:19:37.175053
[0m16:19:37.196005 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m16:19:37.221879 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m16:19:37.223814 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m16:19:37.225322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:37.226046 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_robert`.`dbtcustomers`
where id is null



      
    ) dbt_internal_test
[0m16:19:37.226532 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:19:37.229514 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_id.0c18a9f245: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:19:38.727071 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9702272c-4f7a-403d-bb61-5ce1cf80446d&page=queryresults
[0m16:19:38.729144 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 16:19:37.175578 => 16:19:38.728835
[0m16:19:38.730353 [info ] [Thread-1 (]: 1 of 3 PASS not_null_dbtcustomers_id ........................................... [[32mPASS[0m in 1.58s]
[0m16:19:38.731488 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m16:19:38.732130 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m16:19:38.732908 [info ] [Thread-1 (]: 3 of 3 START test unique_dbtcustomers_name ..................................... [RUN]
[0m16:19:38.734183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c, now test.dbt_robert.unique_dbtcustomers_name.079d8f26d5)
[0m16:19:38.734747 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m16:19:38.740342 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_name.079d8f26d5"
[0m16:19:38.741206 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_name.079d8f26d5 (compile): 16:19:38.735052 => 16:19:38.740880
[0m16:19:38.741647 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m16:19:38.744530 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_name.079d8f26d5"
[0m16:19:38.745277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:38.745790 [debug] [Thread-1 (]: On test.dbt_robert.unique_dbtcustomers_name.079d8f26d5: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_name.079d8f26d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select name as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:19:39.101589 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c19b6e3e-e976-4aa9-86cf-400cb0c94661&page=queryresults
[0m16:19:39.103051 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 16:19:37.196613 => 16:19:39.102686
[0m16:19:39.104365 [info ] [Thread-2 (]: 2 of 3 PASS unique_dbtcustomers_id ............................................. [[32mPASS[0m in 1.95s]
[0m16:19:39.105446 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m16:19:40.018192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4f4ee8a8-2ce7-42dc-b2af-293be1a2d54f&page=queryresults
[0m16:19:40.019683 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_name.079d8f26d5 (execute): 16:19:38.741935 => 16:19:40.019318
[0m16:19:40.021045 [info ] [Thread-1 (]: 3 of 3 PASS unique_dbtcustomers_name ........................................... [[32mPASS[0m in 1.29s]
[0m16:19:40.022493 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m16:19:40.025217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:40.025850 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_name.079d8f26d5' was properly closed.
[0m16:19:40.026376 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245' was properly closed.
[0m16:19:40.026811 [info ] [MainThread]: 
[0m16:19:40.027450 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m16:19:40.029155 [debug] [MainThread]: Command end result
[0m16:19:40.038192 [info ] [MainThread]: 
[0m16:19:40.040114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:40.040906 [info ] [MainThread]: 
[0m16:19:40.041534 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:19:40.042691 [debug] [MainThread]: Command `dbt test` succeeded at 16:19:40.042477 after 4.59 seconds
[0m16:19:40.043180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ab77e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a84c7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a8bb33d0>]}
[0m16:19:40.043676 [debug] [MainThread]: Flushing usage events
[0m16:20:12.867898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815475e2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81534ca410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81534ca3b0>]}


============================== 16:20:12.870811 | aa342228-a490-4401-bc77-a5975667eca7 ==============================
[0m16:20:12.870811 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:20:12.871805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:20:13.249318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa342228-a490-4401-bc77-a5975667eca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8154499660>]}
[0m16:20:13.266658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa342228-a490-4401-bc77-a5975667eca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81519ad3c0>]}
[0m16:20:13.267529 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:20:13.278673 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:20:13.292308 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |     error_after:
    28 |       count: 12
    29 |       period: hour
    30 |      loaded_at_field: first_order_at
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 26, column 5
    did not find expected key
      in "<unicode string>", line 30, column 6
[0m16:20:13.293351 [debug] [MainThread]: Command `dbt test` failed at 16:20:13.293199 after 0.43 seconds
[0m16:20:13.293801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815475e2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815193e2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815193e230>]}
[0m16:20:13.294291 [debug] [MainThread]: Flushing usage events
[0m16:21:35.404499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc9e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1ba0a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1ba0a4a0>]}


============================== 16:21:35.407227 | 1891b626-c793-4a5d-8896-49b5b29c6dc4 ==============================
[0m16:21:35.407227 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:21:35.408052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:21:35.789446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1891b626-c793-4a5d-8896-49b5b29c6dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1ca76500>]}
[0m16:21:35.806821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1891b626-c793-4a5d-8896-49b5b29c6dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1a0f23b0>]}
[0m16:21:35.807741 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:21:35.818928 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:21:35.830383 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |     error_after:
    28 |       count: 12
    29 |       period: hour
    30 |      loaded_at_field: first_order_at
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 26, column 5
    did not find expected key
      in "<unicode string>", line 30, column 6
[0m16:21:35.831396 [debug] [MainThread]: Command `dbt test` failed at 16:21:35.831227 after 0.43 seconds
[0m16:21:35.831848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1cc9e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb19e85fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb19e85f30>]}
[0m16:21:35.832366 [debug] [MainThread]: Flushing usage events
[0m16:22:42.038906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3149a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e303f2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e303f24a0>]}


============================== 16:22:42.041765 | a2265994-6a1a-495c-8777-1c06759f8af7 ==============================
[0m16:22:42.041765 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:22:42.042811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:22:42.409532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2265994-6a1a-495c-8777-1c06759f8af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3126f520>]}
[0m16:22:42.427173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2265994-6a1a-495c-8777-1c06759f8af7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2e8d94e0>]}
[0m16:22:42.428141 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:22:42.439972 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:22:42.451369 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_schema.yml - Runtime Error
    Syntax error near line 26
    ------------------------------
    23 |  #   project: [dbt_robert]
    24 |     tables: 
    25 |       - name: dbtcustomers
    26 |       freshness: 
    27 |         error_after:
    28 |           count: 12
    29 |           period: hour
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 25, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 26, column 7
[0m16:22:42.452483 [debug] [MainThread]: Command `dbt test` failed at 16:22:42.452345 after 0.42 seconds
[0m16:22:42.452931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3149a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2e66e2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2e66e260>]}
[0m16:22:42.453460 [debug] [MainThread]: Flushing usage events
[0m16:23:03.878496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17685163b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f176779e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f176779e4a0>]}


============================== 16:23:03.881324 | 035891f3-ef3a-48e1-8f15-de6dd3328363 ==============================
[0m16:23:03.881324 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:23:03.882326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:23:04.262847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '035891f3-ef3a-48e1-8f15-de6dd3328363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17682e7520>]}
[0m16:23:04.280699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '035891f3-ef3a-48e1-8f15-de6dd3328363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17659c9510>]}
[0m16:23:04.281682 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:23:04.293327 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:23:04.307028 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |         error_after:
    28 |           count: 12
    29 |           period: hour
    30 |      loaded_at_field: first_order_at
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 22, column 5
    did not find expected key
      in "<unicode string>", line 30, column 6
[0m16:23:04.308245 [debug] [MainThread]: Command `dbt test` failed at 16:23:04.308093 after 0.44 seconds
[0m16:23:04.308725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17685163b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17657626b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1765762620>]}
[0m16:23:04.309362 [debug] [MainThread]: Flushing usage events
[0m16:23:40.399734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d67ae3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d54ca500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d54ca4a0>]}


============================== 16:23:40.402577 | e640e399-1024-4e9f-bc2f-d4c4bd52a34b ==============================
[0m16:23:40.402577 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:23:40.403365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:23:40.773869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e640e399-1024-4e9f-bc2f-d4c4bd52a34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d6383520>]}
[0m16:23:40.791320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e640e399-1024-4e9f-bc2f-d4c4bd52a34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d39ad630>]}
[0m16:23:40.792262 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:23:40.803599 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:23:40.814782 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |         error_after:
    28 |           count: 12
    29 |           period: hour
    30 |      loaded_at_field: first_order_at
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 22, column 5
    did not find expected key
      in "<unicode string>", line 30, column 6
[0m16:23:40.815745 [debug] [MainThread]: Command `dbt test` failed at 16:23:40.815599 after 0.42 seconds
[0m16:23:40.816206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d67ae3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d393e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49d393e500>]}
[0m16:23:40.816673 [debug] [MainThread]: Flushing usage events
[0m16:31:25.674625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589b31a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589a0ca4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589a0ca440>]}


============================== 16:31:25.679557 | 214494e7-9e29-4e13-977a-0ca2b14de645 ==============================
[0m16:31:25.679557 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:31:25.681570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:31:26.099468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '214494e7-9e29-4e13-977a-0ca2b14de645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589b004040>]}
[0m16:31:26.117192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '214494e7-9e29-4e13-977a-0ca2b14de645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58985adde0>]}
[0m16:31:26.118182 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:31:26.130270 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:31:26.142285 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |     project: dbt_robert
    6  |     tables: 
    7  |       - name: dbtcustomers
    8  |        freshness: 
    9  |         error_after:
    10 |           count: 12
    11 |           period: hour
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 8, column 8
[0m16:31:26.143423 [debug] [MainThread]: Command `dbt test` failed at 16:31:26.143233 after 0.48 seconds
[0m16:31:26.143908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589b31a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589853de70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589853de10>]}
[0m16:31:26.144437 [debug] [MainThread]: Flushing usage events
[0m16:31:54.801545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba0256380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9f1c64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9f1c6470>]}


============================== 16:31:54.804338 | f4539125-0460-449e-9131-c123090393dc ==============================
[0m16:31:54.804338 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:31:54.805162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:31:55.175370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4539125-0460-449e-9131-c123090393dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba018a650>]}
[0m16:31:55.193097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4539125-0460-449e-9131-c123090393dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9d6ad540>]}
[0m16:31:55.194078 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:31:55.205666 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:31:55.217370 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |     project: dbt_robert
    6  |     tables: 
    7  |       - name: dbtcustomers
    8  |        freshness: 
    9  |         error_after:
    10 |           count: 12
    11 |           period: hour
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 8, column 8
[0m16:31:55.218428 [debug] [MainThread]: Command `dbt test` failed at 16:31:55.218248 after 0.42 seconds
[0m16:31:55.218902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ba0256380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9d63e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9d63e320>]}
[0m16:31:55.219376 [debug] [MainThread]: Flushing usage events
[0m16:32:18.179108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d99776380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d98a064d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d98a06470>]}


============================== 16:32:18.181948 | 53d436ce-f628-46eb-af4e-8728860deb02 ==============================
[0m16:32:18.181948 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:32:18.182938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:32:18.563180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53d436ce-f628-46eb-af4e-8728860deb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d96b9a5c0>]}
[0m16:32:18.581079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53d436ce-f628-46eb-af4e-8728860deb02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d96bdde10>]}
[0m16:32:18.582015 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:32:18.593572 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:32:18.605204 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         error_after:
    10 |           count: 12
    11 |           period: hour
    12 |      loaded_at_field: "first_order_at"
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 12, column 6
[0m16:32:18.606237 [debug] [MainThread]: Command `dbt test` failed at 16:32:18.606063 after 0.43 seconds
[0m16:32:18.606708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d99776380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d96971e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d96971db0>]}
[0m16:32:18.607170 [debug] [MainThread]: Flushing usage events
[0m16:33:29.674500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec3102350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec1eca4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec1eca440>]}


============================== 16:33:29.677412 | 2807103c-61fc-45ad-9cb6-1aba7ece1972 ==============================
[0m16:33:29.677412 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:33:29.678438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:33:30.053283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2807103c-61fc-45ad-9cb6-1aba7ece1972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec2decd90>]}
[0m16:33:30.071279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2807103c-61fc-45ad-9cb6-1aba7ece1972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec03adc60>]}
[0m16:33:30.072234 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:33:30.083987 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:33:30.095666 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         error_after:
    10 |           count: 12
    11 |           period: hour
    12 |       loaded_at_field: "first_order_at"
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 12, column 7
[0m16:33:30.096771 [debug] [MainThread]: Command `dbt test` failed at 16:33:30.096566 after 0.43 seconds
[0m16:33:30.097546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec3102350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec0341f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec0341f30>]}
[0m16:33:30.098073 [debug] [MainThread]: Flushing usage events
[0m16:33:42.419078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd286286320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2851c6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2851c6410>]}


============================== 16:33:42.421982 | 56967dfa-527f-4fa8-ab0a-fac42f6fa961 ==============================
[0m16:33:42.421982 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:33:42.422817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:33:42.793716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56967dfa-527f-4fa8-ab0a-fac42f6fa961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2861bcb20>]}
[0m16:33:42.811221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56967dfa-527f-4fa8-ab0a-fac42f6fa961', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2836ade40>]}
[0m16:33:42.812178 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:33:42.823837 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:33:42.835581 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         error_after:
    10 |           count: 12
    11 |           period: hour
    12 |       loaded_at_field: first_order_at
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 12, column 7
[0m16:33:42.836680 [debug] [MainThread]: Command `dbt test` failed at 16:33:42.836496 after 0.43 seconds
[0m16:33:42.837138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd286286320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd283639e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd283639de0>]}
[0m16:33:42.837625 [debug] [MainThread]: Flushing usage events
[0m16:35:06.827695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a61c563e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a60bf6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a60bf64d0>]}


============================== 16:35:06.830652 | 835adac2-47f0-475e-b2a1-4ef02d6023cc ==============================
[0m16:35:06.830652 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:35:06.831734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:35:07.231223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '835adac2-47f0-475e-b2a1-4ef02d6023cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a61a026b0>]}
[0m16:35:07.249708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '835adac2-47f0-475e-b2a1-4ef02d6023cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5f0d9390>]}
[0m16:35:07.250686 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:35:07.263059 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:35:07.274954 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         error_after:
    10 |           count: 12
    11 |           period: hour
    12 |       loaded_at_field: "first_order_at"
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 12, column 7
[0m16:35:07.276071 [debug] [MainThread]: Command `dbt test` failed at 16:35:07.275863 after 0.46 seconds
[0m16:35:07.276556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a61c563e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5ee6e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a5ee6e0b0>]}
[0m16:35:07.277069 [debug] [MainThread]: Flushing usage events
[0m16:35:25.097317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2be14e2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2be03c64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2be03c6470>]}


============================== 16:35:25.100071 | fe309d57-66a2-45ef-926e-74cff0d2bc81 ==============================
[0m16:35:25.100071 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:35:25.101035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:35:25.537830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe309d57-66a2-45ef-926e-74cff0d2bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bde8ab190>]}
[0m16:35:25.567577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe309d57-66a2-45ef-926e-74cff0d2bc81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bde8b33d0>]}
[0m16:35:25.571469 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:35:25.589113 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:35:25.601114 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         error_after:
    10 |           count: 12
    11 |           period: hour
    12 |       loaded_at_field: "first_order_at"
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 12, column 7
[0m16:35:25.602254 [debug] [MainThread]: Command `dbt test` failed at 16:35:25.602049 after 0.51 seconds
[0m16:35:25.602750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2be14e2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bde83a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bde83a530>]}
[0m16:35:25.603275 [debug] [MainThread]: Flushing usage events
[0m16:36:22.258937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4504c663b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4503bc6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4503bc64a0>]}


============================== 16:36:22.263237 | afb480d9-b94a-4875-80dd-83678e474296 ==============================
[0m16:36:22.263237 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:36:22.264478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:36:22.650513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afb480d9-b94a-4875-80dd-83678e474296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4504a37520>]}
[0m16:36:22.668134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afb480d9-b94a-4875-80dd-83678e474296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45020ad660>]}
[0m16:36:22.669397 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:36:22.681287 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:36:22.693268 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         error_after:
    10 |           count: 12
    11 |           period: hour
    12 |       loaded_at_field: "first_order_at"
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 12, column 7
[0m16:36:22.694477 [debug] [MainThread]: Command `dbt test` failed at 16:36:22.694322 after 0.45 seconds
[0m16:36:22.694968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4504c663b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450203e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f450203e230>]}
[0m16:36:22.695518 [debug] [MainThread]: Flushing usage events
[0m16:37:26.768760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2599002290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2597dce3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2597dce380>]}


============================== 16:37:26.772011 | 03b139ed-e119-4ccd-9ed1-7e27f3f54e18 ==============================
[0m16:37:26.772011 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:37:26.773089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:37:27.154166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03b139ed-e119-4ccd-9ed1-7e27f3f54e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f259626ffa0>]}
[0m16:37:27.171911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03b139ed-e119-4ccd-9ed1-7e27f3f54e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25962b3670>]}
[0m16:37:27.173192 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:37:27.184728 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:37:27.201828 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |           error_after:
    10 |            count: 12
    11 |            period: hour
    12 |       loaded_at_field: "first_order_at"
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 12, column 7
[0m16:37:27.203249 [debug] [MainThread]: Command `dbt test` failed at 16:37:27.203022 after 0.44 seconds
[0m16:37:27.203929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2599002290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2596241b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2596241ab0>]}
[0m16:37:27.204637 [debug] [MainThread]: Flushing usage events
[0m16:37:40.278990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24002a22f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ff1ee440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ff1ee3e0>]}


============================== 16:37:40.281835 | a1c6cf94-6a71-4039-85d4-d1f81caf8c32 ==============================
[0m16:37:40.281835 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:37:40.282659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:37:40.643941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1c6cf94-6a71-4039-85d4-d1f81caf8c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24001d0d30>]}
[0m16:37:40.661600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1c6cf94-6a71-4039-85d4-d1f81caf8c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fd6d93f0>]}
[0m16:37:40.662651 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:37:40.674277 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:37:40.686361 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |           error_after:
    10 |            count: 12
    11 |            period: hour
    12 |       loaded_at_field: first_order_at
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 12, column 7
[0m16:37:40.687498 [debug] [MainThread]: Command `dbt test` failed at 16:37:40.687295 after 0.42 seconds
[0m16:37:40.688001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24002a22f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fd46e080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fd46e020>]}
[0m16:37:40.688530 [debug] [MainThread]: Flushing usage events
[0m16:40:24.065686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89255a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8917ea500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8917ea4a0>]}


============================== 16:40:24.068513 | 8d4167a9-af5a-49ef-9c3b-37698e66a6a7 ==============================
[0m16:40:24.068513 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:40:24.069466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:40:24.440448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d4167a9-af5a-49ef-9c3b-37698e66a6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff88f9db280>]}
[0m16:40:24.457863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d4167a9-af5a-49ef-9c3b-37698e66a6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff88f9dd990>]}
[0m16:40:24.458737 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:40:24.470534 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:40:24.482069 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |           error_after:
    10 |            count: 12
    11 |            period: hour
    12 |       loaded_at_field: first_order_at
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 12, column 7
[0m16:40:24.483159 [debug] [MainThread]: Command `dbt test` failed at 16:40:24.483016 after 0.43 seconds
[0m16:40:24.483612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89255a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff88f76e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff88f76e3b0>]}
[0m16:40:24.484117 [debug] [MainThread]: Flushing usage events
[0m16:40:43.769755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b57d7a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b56b0e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b56b0e440>]}


============================== 16:40:43.772962 | a03738c6-8b05-4990-8dca-3db9a3b81de1 ==============================
[0m16:40:43.772962 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:40:43.773991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:40:44.141891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a03738c6-8b05-4990-8dca-3db9a3b81de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b57c64d90>]}
[0m16:40:44.159326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a03738c6-8b05-4990-8dca-3db9a3b81de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b551f5450>]}
[0m16:40:44.160220 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:40:44.172329 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:40:44.183894 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: dbtcustomers/dbtcustomers_sources.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |     project: aec-students
    6  |     tables: 
    7  |       - name: dbtcustomers
    8  |         - freshness: 
    9  |           error_after:
    10 |            count: 12
    11 |            period: hour
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 7, column 9
    did not find expected key
      in "<unicode string>", line 8, column 9
[0m16:40:44.185049 [debug] [MainThread]: Command `dbt test` failed at 16:40:44.184899 after 0.42 seconds
[0m16:40:44.185511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b57d7a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b54f8a0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b54f8a050>]}
[0m16:40:44.186009 [debug] [MainThread]: Flushing usage events
[0m16:41:34.608152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c90f0e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8fc0a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8fc0a4a0>]}


============================== 16:41:34.610987 | 50f13c9c-b0c4-4b30-b308-0e09dd174d1f ==============================
[0m16:41:34.610987 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:41:34.611806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:41:34.982931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50f13c9c-b0c4-4b30-b308-0e09dd174d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c90ce7520>]}
[0m16:41:35.000626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50f13c9c-b0c4-4b30-b308-0e09dd174d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8e2f10f0>]}
[0m16:41:35.001573 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:41:35.013132 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:41:35.039463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:41:35.040192 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/dbtcustomers/dbtcustomers_sources.yml
[0m16:41:35.040752 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/dbtcustomers/dbtcustomers_schema.yml
[0m16:41:35.071764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50f13c9c-b0c4-4b30-b308-0e09dd174d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8e0fe920>]}
[0m16:41:35.079643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50f13c9c-b0c4-4b30-b308-0e09dd174d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8e090100>]}
[0m16:41:35.080406 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:41:35.081157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f13c9c-b0c4-4b30-b308-0e09dd174d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8e090130>]}
[0m16:41:35.083422 [info ] [MainThread]: 
[0m16:41:35.084591 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:41:35.086137 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m16:41:35.086628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:36.143552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f13c9c-b0c4-4b30-b308-0e09dd174d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8e090100>]}
[0m16:41:36.144719 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:41:36.145483 [info ] [MainThread]: 
[0m16:41:36.150202 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m16:41:36.150680 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m16:41:36.151218 [info ] [Thread-1 (]: 1 of 3 START test not_null_dbtcustomers_id ..................................... [RUN]
[0m16:41:36.151939 [info ] [Thread-2 (]: 2 of 3 START test unique_dbtcustomers_id ....................................... [RUN]
[0m16:41:36.153040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c)
[0m16:41:36.154253 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245'
[0m16:41:36.154793 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m16:41:36.155259 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m16:41:36.177351 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m16:41:36.182157 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m16:41:36.183353 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 16:41:36.162636 => 16:41:36.183068
[0m16:41:36.183973 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m16:41:36.195110 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 16:41:36.155580 => 16:41:36.194853
[0m16:41:36.203434 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m16:41:36.203969 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m16:41:36.206850 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m16:41:36.207903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:36.208537 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_robert`.`dbtcustomers`
where id is null



      
    ) dbt_internal_test
[0m16:41:36.211143 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:36.211837 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_id.0c18a9f245: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:37.678191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1a3dc380-5c0d-48db-8c9b-4e2ba4c160dd&page=queryresults
[0m16:41:37.680293 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 16:41:36.204495 => 16:41:37.679941
[0m16:41:37.681406 [info ] [Thread-1 (]: 1 of 3 PASS not_null_dbtcustomers_id ........................................... [[32mPASS[0m in 1.53s]
[0m16:41:37.682474 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m16:41:37.683029 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m16:41:37.683807 [info ] [Thread-1 (]: 3 of 3 START test unique_dbtcustomers_name ..................................... [RUN]
[0m16:41:37.685137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c, now test.dbt_robert.unique_dbtcustomers_name.079d8f26d5)
[0m16:41:37.685611 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m16:41:37.691071 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_name.079d8f26d5"
[0m16:41:37.691990 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_name.079d8f26d5 (compile): 16:41:37.685960 => 16:41:37.691657
[0m16:41:37.692526 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m16:41:37.695482 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_name.079d8f26d5"
[0m16:41:37.696268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:37.696846 [debug] [Thread-1 (]: On test.dbt_robert.unique_dbtcustomers_name.079d8f26d5: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_name.079d8f26d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select name as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where name is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:37.755560 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:45fb523b-5b72-4578-9968-5abc9a856b4f&page=queryresults
[0m16:41:37.757183 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 16:41:36.184414 => 16:41:37.756770
[0m16:41:37.758647 [info ] [Thread-2 (]: 2 of 3 PASS unique_dbtcustomers_id ............................................. [[32mPASS[0m in 1.60s]
[0m16:41:37.762384 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m16:41:39.068218 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:659504be-6528-46ec-a89b-30234cab2b75&page=queryresults
[0m16:41:39.069650 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_name.079d8f26d5 (execute): 16:41:37.692816 => 16:41:39.069290
[0m16:41:39.070914 [info ] [Thread-1 (]: 3 of 3 PASS unique_dbtcustomers_name ........................................... [[32mPASS[0m in 1.39s]
[0m16:41:39.072268 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m16:41:39.075040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:39.075439 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_name.079d8f26d5' was properly closed.
[0m16:41:39.075789 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245' was properly closed.
[0m16:41:39.076242 [info ] [MainThread]: 
[0m16:41:39.076826 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m16:41:39.078134 [debug] [MainThread]: Command end result
[0m16:41:39.092078 [info ] [MainThread]: 
[0m16:41:39.093035 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:39.093974 [info ] [MainThread]: 
[0m16:41:39.094913 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:41:39.095893 [debug] [MainThread]: Command `dbt test` succeeded at 16:41:39.095757 after 4.50 seconds
[0m16:41:39.096369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c90f0e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c8e0cf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c90ac2b90>]}
[0m16:41:39.096964 [debug] [MainThread]: Flushing usage events
[0m16:44:57.248238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa710be350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa6fdce650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa6fdce5f0>]}


============================== 16:44:57.250949 | 9b07b2d3-6623-4c65-ac1b-02368372f94e ==============================
[0m16:44:57.250949 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:44:57.251800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:44:57.613585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b07b2d3-6623-4c65-ac1b-02368372f94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa70da8d90>]}
[0m16:44:57.630961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b07b2d3-6623-4c65-ac1b-02368372f94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa6e2b5660>]}
[0m16:44:57.631852 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:44:57.643923 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:44:57.669853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:57.670272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:57.676565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b07b2d3-6623-4c65-ac1b-02368372f94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa6e09feb0>]}
[0m16:44:57.684264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b07b2d3-6623-4c65-ac1b-02368372f94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa6e05c640>]}
[0m16:44:57.684866 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:44:57.685434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b07b2d3-6623-4c65-ac1b-02368372f94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa6e05c670>]}
[0m16:44:57.686344 [warn ] [MainThread]: The selection criterion 'source:' does not match any nodes
[0m16:44:57.687713 [info ] [MainThread]: 
[0m16:44:57.688421 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:44:57.694850 [info ] [MainThread]: Done.
[0m16:44:57.696113 [debug] [MainThread]: Command `dbt source freshness` succeeded at 16:44:57.695898 after 0.46 seconds
[0m16:44:57.696576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa710be350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa70e105b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa6e05c100>]}
[0m16:44:57.697004 [debug] [MainThread]: Flushing usage events
[0m16:45:27.644935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95df8f6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95de7c6680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95de7c6620>]}


============================== 16:45:27.647822 | 1658ad89-07f6-4054-bcf1-41f1873176ba ==============================
[0m16:45:27.647822 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:45:27.648699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:45:28.033031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1658ad89-07f6-4054-bcf1-41f1873176ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dcc6f520>]}
[0m16:45:28.053013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1658ad89-07f6-4054-bcf1-41f1873176ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dccb3670>]}
[0m16:45:28.054095 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:45:28.067041 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:45:28.093618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:28.094153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:28.100976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1658ad89-07f6-4054-bcf1-41f1873176ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dca94190>]}
[0m16:45:28.109658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1658ad89-07f6-4054-bcf1-41f1873176ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dca5be50>]}
[0m16:45:28.110318 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:45:28.111040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1658ad89-07f6-4054-bcf1-41f1873176ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dca5bdf0>]}
[0m16:45:28.112007 [warn ] [MainThread]: The selection criterion 'source:' does not match any nodes
[0m16:45:28.113630 [info ] [MainThread]: 
[0m16:45:28.114219 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:45:28.122040 [info ] [MainThread]: Done.
[0m16:45:28.123077 [debug] [MainThread]: Command `dbt source freshness` succeeded at 16:45:28.122935 after 0.49 seconds
[0m16:45:28.123527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95df8f6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dca60070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95dca5bb80>]}
[0m16:45:28.124151 [debug] [MainThread]: Flushing usage events
[0m16:45:52.907856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed1eae2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed0df25f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed0df2590>]}


============================== 16:45:52.910627 | 7afc5d0f-0da4-4a67-bcc9-5ea803d06bc1 ==============================
[0m16:45:52.910627 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:45:52.911461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:45:53.301589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7afc5d0f-0da4-4a67-bcc9-5ea803d06bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed1de4d30>]}
[0m16:45:53.318916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7afc5d0f-0da4-4a67-bcc9-5ea803d06bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecf2dd600>]}
[0m16:45:53.319916 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:45:53.331655 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:45:53.358203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:53.358668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:53.364976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7afc5d0f-0da4-4a67-bcc9-5ea803d06bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecf0c0a00>]}
[0m16:45:53.372927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7afc5d0f-0da4-4a67-bcc9-5ea803d06bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecf084610>]}
[0m16:45:53.373532 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:45:53.374253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7afc5d0f-0da4-4a67-bcc9-5ea803d06bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecf0846d0>]}
[0m16:45:53.375170 [warn ] [MainThread]: The selection criterion 'source:dbtcustomer_sources' does not match any nodes
[0m16:45:53.376704 [info ] [MainThread]: 
[0m16:45:53.377734 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:45:53.384990 [info ] [MainThread]: Done.
[0m16:45:53.386225 [debug] [MainThread]: Command `dbt source freshness` succeeded at 16:45:53.386034 after 0.49 seconds
[0m16:45:53.386696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed1eae2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecf0842e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecf084280>]}
[0m16:45:53.387137 [debug] [MainThread]: Flushing usage events
[0m14:29:35.387013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eafbd6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaee665c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaee66560>]}


============================== 14:29:35.407255 | 0daa2ec0-6967-45df-b8cf-326e0dd80046 ==============================
[0m14:29:35.407255 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:29:35.408121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:29:36.937706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0daa2ec0-6967-45df-b8cf-326e0dd80046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eafb0f430>]}
[0m14:29:36.954999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0daa2ec0-6967-45df-b8cf-326e0dd80046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eacfde4d0>]}
[0m14:29:36.955897 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:29:36.973417 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:29:37.086853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:29:37.087382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:29:37.094190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0daa2ec0-6967-45df-b8cf-326e0dd80046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eacdc42e0>]}
[0m14:29:37.095994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0daa2ec0-6967-45df-b8cf-326e0dd80046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eacd76dd0>]}
[0m14:29:37.096521 [info ] [MainThread]: Found 1 model, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m14:29:37.097462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0daa2ec0-6967-45df-b8cf-326e0dd80046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eacd900d0>]}
[0m14:29:37.099261 [info ] [MainThread]: 
[0m14:29:37.100588 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:29:37.101954 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m14:29:37.102470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:41.625512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0daa2ec0-6967-45df-b8cf-326e0dd80046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eacfdfca0>]}
[0m14:29:41.626837 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:29:41.627583 [info ] [MainThread]: 
[0m14:29:41.648760 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m14:29:41.649581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m14:29:41.650050 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m14:29:41.657517 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m14:29:41.658462 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 14:29:41.650350 => 14:29:41.658057
[0m14:29:41.658902 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m14:29:41.659437 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 14:29:41.659190 => 14:29:41.659213
[0m14:29:41.660426 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m14:29:41.661409 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m14:29:41.661835 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m14:29:41.662813 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c'
[0m14:29:41.663527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now test.dbt_robert.unique_dbtcustomers_id.0c18a9f245)
[0m14:29:41.664023 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m14:29:41.664522 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m14:29:41.677777 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m14:29:41.685899 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 14:29:41.664842 => 14:29:41.685548
[0m14:29:41.686552 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m14:29:41.687365 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 14:29:41.687010 => 14:29:41.687027
[0m14:29:41.692640 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m14:29:41.693468 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m14:29:41.694868 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c, now test.dbt_robert.unique_dbtcustomers_name.079d8f26d5)
[0m14:29:41.701000 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m14:29:41.707436 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m14:29:41.708355 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_name.079d8f26d5"
[0m14:29:41.709388 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 14:29:41.680087 => 14:29:41.709123
[0m14:29:41.709966 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m14:29:41.710665 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 14:29:41.710357 => 14:29:41.710375
[0m14:29:41.711814 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m14:29:41.712294 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_name.079d8f26d5 (compile): 14:29:41.701527 => 14:29:41.712081
[0m14:29:41.713010 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m14:29:41.713559 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_name.079d8f26d5 (execute): 14:29:41.713308 => 14:29:41.713321
[0m14:29:41.715227 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_name.079d8f26d5
[0m14:29:41.716329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:41.716784 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245' was properly closed.
[0m14:29:41.717129 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_name.079d8f26d5' was properly closed.
[0m14:29:41.718196 [debug] [MainThread]: Command end result
[0m14:29:41.770676 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m14:29:41.771434 [info ] [MainThread]: Building catalog
[0m14:29:41.774210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:42.197782 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m14:29:42.214257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:42.215117 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_robert`.__TABLES__
        where (upper(dataset_id) = upper('dbt_robert'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m14:29:45.024264 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:20b0648a-ee8b-4305-a03d-c508991f9f0e&page=queryresults
[0m14:29:45.039241 [info ] [MainThread]: Catalog written to /home/vscode/dbt_robert_project/target/catalog.json
[0m14:29:45.040773 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:29:45.040575 after 9.69 seconds
[0m14:29:45.041312 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:29:45.042049 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m14:29:45.042473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eafbd6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eaf9a92a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eacd90190>]}
[0m14:29:45.042949 [debug] [MainThread]: Flushing usage events
[0m14:30:15.018357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540029e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fefce560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fefce470>]}


============================== 14:30:15.021080 | e63357b3-7695-4046-9155-d80eace16f06 ==============================
[0m14:30:15.021080 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:30:15.021926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:30:15.379592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e63357b3-7695-4046-9155-d80eace16f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fff88d90>]}
[0m14:30:15.400191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e63357b3-7695-4046-9155-d80eace16f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fd4b1630>]}
[0m14:36:17.440865 [error] [MainThread]: Encountered an error:

[0m14:36:17.451007 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m14:36:17.452220 [debug] [MainThread]: Command `dbt docs serve` failed at 14:36:17.452067 after 362.44 seconds
[0m14:36:17.452712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f540029e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fd4b3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fd4b0940>]}
[0m14:36:17.453317 [debug] [MainThread]: Flushing usage events
[0m11:09:41.641284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69522823e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6950fd2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6950fd24d0>]}


============================== 11:09:41.662539 | 0ecf803e-5002-48dc-bf0c-6f7d6f5b049d ==============================
[0m11:09:41.662539 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:09:41.663684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:09:43.561511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ecf803e-5002-48dc-bf0c-6f7d6f5b049d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f695202c9a0>]}
[0m11:09:43.579064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ecf803e-5002-48dc-bf0c-6f7d6f5b049d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694f4b2350>]}
[0m11:09:43.580241 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:09:43.592764 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:09:43.728336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:09:43.729531 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/dbtcustomers/dbtcustomers_schema.yml
[0m11:09:43.757250 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers/dbtcustomers.sql
[0m11:09:43.837585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ecf803e-5002-48dc-bf0c-6f7d6f5b049d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694f3480d0>]}
[0m11:09:43.845492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ecf803e-5002-48dc-bf0c-6f7d6f5b049d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694f25c130>]}
[0m11:09:43.846168 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:09:43.846815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ecf803e-5002-48dc-bf0c-6f7d6f5b049d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694f25c0d0>]}
[0m11:09:43.849044 [info ] [MainThread]: 
[0m11:09:43.850200 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:09:43.851950 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m11:09:43.852435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:49.646446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ecf803e-5002-48dc-bf0c-6f7d6f5b049d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694f25c0d0>]}
[0m11:09:49.647645 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:09:49.648304 [info ] [MainThread]: 
[0m11:09:49.678454 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:09:49.680042 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:09:49.679348 [info ] [Thread-1 (]: 1 of 8 START test not_null_dbtcustomers_email .................................. [RUN]
[0m11:09:49.682664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.not_null_dbtcustomers_email.6c384897fd)
[0m11:09:49.684023 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:09:49.680616 [info ] [Thread-2 (]: 2 of 8 START test not_null_dbtcustomers_first_order_at ......................... [RUN]
[0m11:09:49.690676 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2'
[0m11:09:49.691355 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:09:49.720447 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_email.6c384897fd"
[0m11:09:49.721739 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_email.6c384897fd (compile): 11:09:49.684534 => 11:09:49.721326
[0m11:09:49.722430 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:09:49.723655 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2"
[0m11:09:49.734713 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2 (compile): 11:09:49.691797 => 11:09:49.733578
[0m11:09:49.745998 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:09:49.777501 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_email.6c384897fd"
[0m11:09:49.778754 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2"
[0m11:09:49.779839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:49.780690 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:09:49.781251 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_email.6c384897fd: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_email.6c384897fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `aec-students`.`dbt_robert`.`dbtcustomers`
where email is null



      
    ) dbt_internal_test
[0m11:09:49.781801 [debug] [Thread-2 (]: On test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_order_at
from `aec-students`.`dbt_robert`.`dbtcustomers`
where first_order_at is null



      
    ) dbt_internal_test
[0m11:09:51.514711 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:33cc2361-8a57-4aa0-ab1e-17aeb3786050&page=queryresults
[0m11:09:51.516582 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2a3214c4-0cbe-411a-b97b-dc3651afd12e&page=queryresults
[0m11:09:51.518835 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_email.6c384897fd (execute): 11:09:49.724774 => 11:09:51.518439
[0m11:09:51.519956 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2 (execute): 11:09:49.746770 => 11:09:51.519659
[0m11:09:51.521068 [info ] [Thread-1 (]: 1 of 8 PASS not_null_dbtcustomers_email ........................................ [[32mPASS[0m in 1.84s]
[0m11:09:51.523674 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:09:51.522562 [info ] [Thread-2 (]: 2 of 8 PASS not_null_dbtcustomers_first_order_at ............................... [[32mPASS[0m in 1.83s]
[0m11:09:51.524552 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:09:51.525393 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:09:51.525927 [info ] [Thread-1 (]: 3 of 8 START test not_null_dbtcustomers_id ..................................... [RUN]
[0m11:09:51.526900 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:09:51.528827 [info ] [Thread-2 (]: 4 of 8 START test not_null_dbtcustomers_name ................................... [RUN]
[0m11:09:51.528172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_email.6c384897fd, now test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c)
[0m11:09:51.530031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2, now test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513)
[0m11:09:51.530828 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:09:51.531327 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:09:51.537215 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m11:09:51.541944 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513"
[0m11:09:51.542912 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 11:09:51.531965 => 11:09:51.542574
[0m11:09:51.543537 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:09:51.546361 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m11:09:51.546917 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513 (compile): 11:09:51.537566 => 11:09:51.546682
[0m11:09:51.547639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:51.548094 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:09:51.548595 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_robert`.`dbtcustomers`
where id is null



      
    ) dbt_internal_test
[0m11:09:51.551244 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513"
[0m11:09:51.554783 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:09:51.555282 [debug] [Thread-2 (]: On test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from `aec-students`.`dbt_robert`.`dbtcustomers`
where name is null



      
    ) dbt_internal_test
[0m11:09:53.215088 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:be503b4e-ed9d-476f-b794-c61ae76b94bb&page=queryresults
[0m11:09:53.216634 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 11:09:51.543943 => 11:09:53.216268
[0m11:09:53.217937 [info ] [Thread-1 (]: 3 of 8 PASS not_null_dbtcustomers_id ........................................... [[32mPASS[0m in 1.69s]
[0m11:09:53.219316 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:09:53.220008 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c
[0m11:09:53.220823 [info ] [Thread-1 (]: 5 of 8 START test not_null_dbtcustomers_number_of_orders ....................... [RUN]
[0m11:09:53.222441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c, now test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c)
[0m11:09:53.223130 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c
[0m11:09:53.234359 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c"
[0m11:09:53.235266 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c (compile): 11:09:53.223721 => 11:09:53.234920
[0m11:09:53.235737 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c
[0m11:09:53.298450 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c"
[0m11:09:53.299447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:53.300028 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number-of_orders
from `aec-students`.`dbt_robert`.`dbtcustomers`
where number-of_orders is null



      
    ) dbt_internal_test
[0m11:09:53.377441 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e7142f55-f54e-4bd0-8455-84de82513484&page=queryresults
[0m11:09:53.378682 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513 (execute): 11:09:51.548937 => 11:09:53.378366
[0m11:09:53.379776 [info ] [Thread-2 (]: 4 of 8 PASS not_null_dbtcustomers_name ......................................... [[32mPASS[0m in 1.85s]
[0m11:09:53.381115 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:09:53.381764 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:09:53.382524 [info ] [Thread-2 (]: 6 of 8 START test unique_dbtcustomers_email .................................... [RUN]
[0m11:09:53.384046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513, now test.dbt_robert.unique_dbtcustomers_email.cc133877c6)
[0m11:09:53.384549 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:09:53.393992 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_email.cc133877c6"
[0m11:09:53.394895 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_email.cc133877c6 (compile): 11:09:53.385046 => 11:09:53.394549
[0m11:09:53.395347 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:09:53.398158 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_email.cc133877c6"
[0m11:09:53.398923 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:09:53.399459 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_email.cc133877c6: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_email.cc133877c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select email as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:09:53.749944 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: number; Did you mean name? at [15:7]')
[0m11:09:54.831606 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b92df268-c245-424f-b54c-2350601c6c7e&page=queryresults
[0m11:09:54.833281 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c (execute): 11:09:53.236032 => 11:09:54.832742
[0m11:09:54.868546 [debug] [Thread-1 (]: Database Error in test not_null_dbtcustomers_number_of_orders (models/dbtcustomers/dbtcustomers_schema.yml)
  Unrecognized name: number; Did you mean name? at [15:7]
  compiled Code at target/run/dbt_robert/models/dbtcustomers/dbtcustomers_schema.yml/not_null_dbtcustomers_number_of_orders.sql
[0m11:09:54.869569 [error] [Thread-1 (]: 5 of 8 ERROR not_null_dbtcustomers_number_of_orders ............................ [[31mERROR[0m in 1.65s]
[0m11:09:54.870484 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c
[0m11:09:54.871201 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:09:54.872162 [info ] [Thread-1 (]: 7 of 8 START test unique_dbtcustomers_first_order_at ........................... [RUN]
[0m11:09:54.873546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_number_of_orders.ae2ad1c92c, now test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c)
[0m11:09:54.874038 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:09:54.880397 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c"
[0m11:09:54.881319 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c (compile): 11:09:54.874363 => 11:09:54.880966
[0m11:09:54.881795 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:09:54.884624 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c"
[0m11:09:54.885378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:54.885926 [debug] [Thread-1 (]: On test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select first_order_at as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where first_order_at is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:09:55.052212 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7e30dbe2-4b74-4c89-bf2d-659d1d1d8505&page=queryresults
[0m11:09:55.053750 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_email.cc133877c6 (execute): 11:09:53.395643 => 11:09:55.053372
[0m11:09:55.055220 [info ] [Thread-2 (]: 6 of 8 PASS unique_dbtcustomers_email .......................................... [[32mPASS[0m in 1.67s]
[0m11:09:55.057790 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:09:55.058628 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:09:55.059898 [info ] [Thread-2 (]: 8 of 8 START test unique_dbtcustomers_id ....................................... [RUN]
[0m11:09:55.061519 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.unique_dbtcustomers_email.cc133877c6, now test.dbt_robert.unique_dbtcustomers_id.0c18a9f245)
[0m11:09:55.062022 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:09:55.067517 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m11:09:55.068497 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 11:09:55.062359 => 11:09:55.068137
[0m11:09:55.069099 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:09:55.071937 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m11:09:55.072712 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:09:55.073256 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_id.0c18a9f245: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:09:56.434535 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0773e51a-628a-4d77-8b79-926b781a9bb1&page=queryresults
[0m11:09:56.436045 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c (execute): 11:09:54.882089 => 11:09:56.435687
[0m11:09:56.437310 [info ] [Thread-1 (]: 7 of 8 PASS unique_dbtcustomers_first_order_at ................................. [[32mPASS[0m in 1.56s]
[0m11:09:56.438848 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:09:57.072080 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:43d4059a-22e6-4125-9e63-e1bb42969ff0&page=queryresults
[0m11:09:57.073490 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 11:09:55.069396 => 11:09:57.073185
[0m11:09:57.074641 [info ] [Thread-2 (]: 8 of 8 PASS unique_dbtcustomers_id ............................................. [[32mPASS[0m in 2.01s]
[0m11:09:57.075684 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:09:57.078023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:57.078450 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c' was properly closed.
[0m11:09:57.078817 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245' was properly closed.
[0m11:09:57.079268 [info ] [MainThread]: 
[0m11:09:57.079856 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 13.23 seconds (13.23s).
[0m11:09:57.082486 [debug] [MainThread]: Command end result
[0m11:09:57.096783 [info ] [MainThread]: 
[0m11:09:57.097446 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:09:57.098090 [info ] [MainThread]: 
[0m11:09:57.098812 [error] [MainThread]: [33mDatabase Error in test not_null_dbtcustomers_number_of_orders (models/dbtcustomers/dbtcustomers_schema.yml)[0m
[0m11:09:57.099522 [error] [MainThread]:   Unrecognized name: number; Did you mean name? at [15:7]
[0m11:09:57.100224 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/dbtcustomers/dbtcustomers_schema.yml/not_null_dbtcustomers_number_of_orders.sql
[0m11:09:57.100985 [info ] [MainThread]: 
[0m11:09:57.101663 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m11:09:57.102787 [debug] [MainThread]: Command `dbt test` failed at 11:09:57.102582 after 15.50 seconds
[0m11:09:57.103401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69522823e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694edfcfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694edfd060>]}
[0m11:09:57.104131 [debug] [MainThread]: Flushing usage events
[0m11:11:09.185261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4f99a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4e6ca3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4e6ca380>]}


============================== 11:11:09.188112 | 94a233a6-95b7-4363-9a15-bd1bf49db9d3 ==============================
[0m11:11:09.188112 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:11:09.189099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:11:09.637233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94a233a6-95b7-4363-9a15-bd1bf49db9d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4f4c8850>]}
[0m11:11:09.655052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94a233a6-95b7-4363-9a15-bd1bf49db9d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4cbad390>]}
[0m11:11:09.656172 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:11:09.668992 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:11:09.696356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:11:09.697368 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/dbtcustomers/dbtcustomers_schema.yml
[0m11:11:09.723983 [debug] [MainThread]: 1699: static parser successfully parsed dbtcustomers/dbtcustomers.sql
[0m11:11:09.804701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94a233a6-95b7-4363-9a15-bd1bf49db9d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4ca480d0>]}
[0m11:11:09.812797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94a233a6-95b7-4363-9a15-bd1bf49db9d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4c965360>]}
[0m11:11:09.813464 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:11:09.814066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94a233a6-95b7-4363-9a15-bd1bf49db9d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4c965300>]}
[0m11:11:09.816341 [info ] [MainThread]: 
[0m11:11:09.817498 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:11:09.819673 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m11:11:09.820213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:10.945643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94a233a6-95b7-4363-9a15-bd1bf49db9d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4c992dd0>]}
[0m11:11:10.947101 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:11:10.948361 [info ] [MainThread]: 
[0m11:11:10.952960 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:11:10.953513 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:11:10.954060 [info ] [Thread-1 (]: 1 of 8 START test not_null_dbtcustomers_email .................................. [RUN]
[0m11:11:10.955058 [info ] [Thread-2 (]: 2 of 8 START test not_null_dbtcustomers_first_order_at ......................... [RUN]
[0m11:11:10.956093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.not_null_dbtcustomers_email.6c384897fd)
[0m11:11:10.957025 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2'
[0m11:11:10.957529 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:11:10.958201 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:11:10.972513 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_email.6c384897fd"
[0m11:11:10.977477 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2"
[0m11:11:10.978548 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_email.6c384897fd (compile): 11:11:10.958710 => 11:11:10.978179
[0m11:11:10.979192 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:11:10.983463 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2 (compile): 11:11:10.972924 => 11:11:10.983099
[0m11:11:10.984094 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:11:11.032937 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2"
[0m11:11:11.036227 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_email.6c384897fd"
[0m11:11:11.037297 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:11:11.038115 [debug] [Thread-2 (]: On test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_order_at
from `aec-students`.`dbt_robert`.`dbtcustomers`
where first_order_at is null



      
    ) dbt_internal_test
[0m11:11:11.041162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:11.041776 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_email.6c384897fd: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_email.6c384897fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `aec-students`.`dbt_robert`.`dbtcustomers`
where email is null



      
    ) dbt_internal_test
[0m11:11:12.615577 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3a9e375e-fc5c-4c09-bd1e-39979766b6b7&page=queryresults
[0m11:11:12.618081 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2 (execute): 11:11:10.985501 => 11:11:12.617685
[0m11:11:12.619518 [info ] [Thread-2 (]: 2 of 8 PASS not_null_dbtcustomers_first_order_at ............................... [[32mPASS[0m in 1.66s]
[0m11:11:12.621045 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:11:12.622036 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:11:12.623088 [info ] [Thread-2 (]: 3 of 8 START test not_null_dbtcustomers_id ..................................... [RUN]
[0m11:11:12.630041 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2, now test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c)
[0m11:11:12.630879 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:11:12.639495 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m11:11:12.640363 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:56922889-97f3-4921-aa00-86b2cd572645&page=queryresults
[0m11:11:12.641475 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_email.6c384897fd (execute): 11:11:10.979711 => 11:11:12.641214
[0m11:11:12.643660 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 11:11:12.631429 => 11:11:12.642976
[0m11:11:12.642630 [info ] [Thread-1 (]: 1 of 8 PASS not_null_dbtcustomers_email ........................................ [[32mPASS[0m in 1.69s]
[0m11:11:12.645486 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:11:12.646042 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:11:12.646707 [info ] [Thread-1 (]: 4 of 8 START test not_null_dbtcustomers_name ................................... [RUN]
[0m11:11:12.647800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_email.6c384897fd, now test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513)
[0m11:11:12.648269 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:11:12.644316 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:11:12.653809 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513"
[0m11:11:12.656713 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m11:11:12.657682 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513 (compile): 11:11:12.648569 => 11:11:12.657331
[0m11:11:12.658405 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:11:12.661367 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513"
[0m11:11:12.662166 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:11:12.662858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:12.663336 [debug] [Thread-2 (]: On test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_robert`.`dbtcustomers`
where id is null



      
    ) dbt_internal_test
[0m11:11:12.663859 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from `aec-students`.`dbt_robert`.`dbtcustomers`
where name is null



      
    ) dbt_internal_test
[0m11:11:14.086176 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c12a76ce-5431-4da8-8249-00c2b3a6eb2c&page=queryresults
[0m11:11:14.087495 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 11:11:12.654178 => 11:11:14.087185
[0m11:11:14.088595 [info ] [Thread-2 (]: 3 of 8 PASS not_null_dbtcustomers_id ........................................... [[32mPASS[0m in 1.46s]
[0m11:11:14.089624 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:11:14.090625 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m11:11:14.091256 [info ] [Thread-2 (]: 5 of 8 START test not_null_dbtcustomers_number_of_orders ....................... [RUN]
[0m11:11:14.092372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c, now test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a)
[0m11:11:14.092850 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m11:11:14.100770 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a"
[0m11:11:14.101673 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a (compile): 11:11:14.093185 => 11:11:14.101329
[0m11:11:14.102156 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m11:11:14.104911 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a"
[0m11:11:14.105672 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:11:14.106261 [debug] [Thread-2 (]: On test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_orders
from `aec-students`.`dbt_robert`.`dbtcustomers`
where number_of_orders is null



      
    ) dbt_internal_test
[0m11:11:14.157096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d9b60c5b-03a4-449f-9db3-fbff30534eb0&page=queryresults
[0m11:11:14.163519 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513 (execute): 11:11:12.658874 => 11:11:14.163119
[0m11:11:14.165975 [info ] [Thread-1 (]: 4 of 8 PASS not_null_dbtcustomers_name ......................................... [[32mPASS[0m in 1.52s]
[0m11:11:14.180693 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:11:14.181580 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:11:14.182896 [info ] [Thread-1 (]: 6 of 8 START test unique_dbtcustomers_email .................................... [RUN]
[0m11:11:14.192368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513, now test.dbt_robert.unique_dbtcustomers_email.cc133877c6)
[0m11:11:14.193123 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:11:14.262440 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_email.cc133877c6"
[0m11:11:14.263560 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_email.cc133877c6 (compile): 11:11:14.193704 => 11:11:14.263200
[0m11:11:14.264079 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:11:14.266842 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_email.cc133877c6"
[0m11:11:14.268161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:14.268657 [debug] [Thread-1 (]: On test.dbt_robert.unique_dbtcustomers_email.cc133877c6: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_email.cc133877c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select email as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:11:15.551345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:28093311-ffff-4394-a713-7459ccd6dcf6&page=queryresults
[0m11:11:15.552855 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_email.cc133877c6 (execute): 11:11:14.264387 => 11:11:15.552471
[0m11:11:15.554117 [info ] [Thread-1 (]: 6 of 8 PASS unique_dbtcustomers_email .......................................... [[32mPASS[0m in 1.36s]
[0m11:11:15.555547 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:11:15.556273 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:11:15.557196 [info ] [Thread-1 (]: 7 of 8 START test unique_dbtcustomers_first_order_at ........................... [RUN]
[0m11:11:15.558407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.unique_dbtcustomers_email.cc133877c6, now test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c)
[0m11:11:15.558893 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:11:15.566186 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c"
[0m11:11:15.567153 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c (compile): 11:11:15.559198 => 11:11:15.566798
[0m11:11:15.567631 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:11:15.570382 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c"
[0m11:11:15.571346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:15.571884 [debug] [Thread-1 (]: On test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select first_order_at as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where first_order_at is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:11:15.749813 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4e3549ef-2298-47c3-b6cd-bb2a697a9559&page=queryresults
[0m11:11:15.751293 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a (execute): 11:11:14.102483 => 11:11:15.750925
[0m11:11:15.752464 [info ] [Thread-2 (]: 5 of 8 PASS not_null_dbtcustomers_number_of_orders ............................. [[32mPASS[0m in 1.66s]
[0m11:11:15.753740 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m11:11:15.754342 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:11:15.755413 [info ] [Thread-2 (]: 8 of 8 START test unique_dbtcustomers_id ....................................... [RUN]
[0m11:11:15.756538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a, now test.dbt_robert.unique_dbtcustomers_id.0c18a9f245)
[0m11:11:15.757016 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:11:15.763047 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m11:11:15.763966 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 11:11:15.757379 => 11:11:15.763621
[0m11:11:15.764430 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:11:15.769209 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m11:11:15.770193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:11:15.770918 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_id.0c18a9f245: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:11:17.027177 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2bae5175-80b8-4154-bc45-54a904ce7406&page=queryresults
[0m11:11:17.028701 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c (execute): 11:11:15.567931 => 11:11:17.028330
[0m11:11:17.030023 [info ] [Thread-1 (]: 7 of 8 PASS unique_dbtcustomers_first_order_at ................................. [[32mPASS[0m in 1.47s]
[0m11:11:17.031593 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:11:17.081427 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5e7f358c-c336-412b-bec1-3505fa8d24f2&page=queryresults
[0m11:11:17.082694 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 11:11:15.764723 => 11:11:17.082387
[0m11:11:17.083800 [info ] [Thread-2 (]: 8 of 8 PASS unique_dbtcustomers_id ............................................. [[32mPASS[0m in 1.33s]
[0m11:11:17.085115 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:11:17.087511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:17.087916 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c' was properly closed.
[0m11:11:17.088286 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245' was properly closed.
[0m11:11:17.088777 [info ] [MainThread]: 
[0m11:11:17.089394 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 7.27 seconds (7.27s).
[0m11:11:17.091993 [debug] [MainThread]: Command end result
[0m11:11:17.103622 [info ] [MainThread]: 
[0m11:11:17.104373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:17.104992 [info ] [MainThread]: 
[0m11:11:17.105793 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:11:17.106865 [debug] [MainThread]: Command `dbt test` succeeded at 11:11:17.106730 after 7.93 seconds
[0m11:11:17.107534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4f99a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4c499540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf4c4996f0>]}
[0m11:11:17.108257 [debug] [MainThread]: Flushing usage events
[0m11:16:11.181547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330084e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ff5ce3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ff5ce380>]}


============================== 11:16:11.184634 | 7b44144f-bb2c-4059-b244-dc56a1d975b4 ==============================
[0m11:16:11.184634 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:16:11.185777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:16:11.552533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b44144f-bb2c-4059-b244-dc56a1d975b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fdaaf1f0>]}
[0m11:16:11.570220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b44144f-bb2c-4059-b244-dc56a1d975b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fdab1a20>]}
[0m11:16:11.571186 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:16:11.582766 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:16:11.609906 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 0 files changed.
[0m11:16:11.610585 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:16:11.611074 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/staging/revenue/dbtcustomers.md
[0m11:16:11.611572 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/staging/revenue/dbtcustomers_schema.yml
[0m11:16:11.612035 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/staging/revenue/dbtcustomers_sources.yml
[0m11:16:11.612518 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/dbtcustomers/dbtcustomers.sql
[0m11:16:11.612893 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/dbtcustomers/dbtcustomers.md
[0m11:16:11.638409 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:16:11.740688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b44144f-bb2c-4059-b244-dc56a1d975b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd91bdc0>]}
[0m11:16:11.749051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b44144f-bb2c-4059-b244-dc56a1d975b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd869720>]}
[0m11:16:11.749713 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:16:11.750577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b44144f-bb2c-4059-b244-dc56a1d975b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fd8696c0>]}
[0m11:16:11.752769 [info ] [MainThread]: 
[0m11:16:11.753877 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:16:11.755534 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m11:16:11.756027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:12.924254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b44144f-bb2c-4059-b244-dc56a1d975b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fda6bcd0>]}
[0m11:16:12.925514 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:16:12.926458 [info ] [MainThread]: 
[0m11:16:12.931843 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:16:12.932399 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:16:12.932994 [info ] [Thread-1 (]: 1 of 8 START test not_null_dbtcustomers_email .................................. [RUN]
[0m11:16:12.934799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.not_null_dbtcustomers_email.6c384897fd)
[0m11:16:12.935284 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:16:12.933700 [info ] [Thread-2 (]: 2 of 8 START test not_null_dbtcustomers_first_order_at ......................... [RUN]
[0m11:16:12.949772 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_email.6c384897fd"
[0m11:16:12.950730 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2'
[0m11:16:12.951553 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:16:12.953410 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_email.6c384897fd (compile): 11:16:12.935714 => 11:16:12.953129
[0m11:16:12.960076 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:16:12.961180 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2"
[0m11:16:12.979853 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_email.6c384897fd"
[0m11:16:12.980528 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2 (compile): 11:16:12.952084 => 11:16:12.980258
[0m11:16:12.981222 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:16:12.984374 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2"
[0m11:16:12.985318 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:16:12.986021 [debug] [Thread-2 (]: On test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_order_at
from `aec-students`.`dbt_robert`.`dbtcustomers`
where first_order_at is null



      
    ) dbt_internal_test
[0m11:16:12.986584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:12.988934 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_email.6c384897fd: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_email.6c384897fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `aec-students`.`dbt_robert`.`dbtcustomers`
where email is null



      
    ) dbt_internal_test
[0m11:16:14.514844 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1449816a-e76d-473c-a24a-0b2f56bd001c&page=queryresults
[0m11:16:14.517044 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2 (execute): 11:16:12.981583 => 11:16:14.516728
[0m11:16:14.518270 [info ] [Thread-2 (]: 2 of 8 PASS not_null_dbtcustomers_first_order_at ............................... [[32mPASS[0m in 1.57s]
[0m11:16:14.519914 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m11:16:14.520580 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:16:14.521575 [info ] [Thread-2 (]: 3 of 8 START test not_null_dbtcustomers_id ..................................... [RUN]
[0m11:16:14.522834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2, now test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c)
[0m11:16:14.523631 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:16:14.531868 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m11:16:14.533010 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 11:16:14.524133 => 11:16:14.532657
[0m11:16:14.533733 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:16:14.538357 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m11:16:14.539710 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:16:14.540418 [debug] [Thread-2 (]: On test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_robert`.`dbtcustomers`
where id is null



      
    ) dbt_internal_test
[0m11:16:14.549415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:24b7109b-380f-46b2-8d57-9f53d228cb9e&page=queryresults
[0m11:16:14.551296 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_email.6c384897fd (execute): 11:16:12.961524 => 11:16:14.551001
[0m11:16:14.554107 [info ] [Thread-1 (]: 1 of 8 PASS not_null_dbtcustomers_email ........................................ [[32mPASS[0m in 1.62s]
[0m11:16:14.560610 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m11:16:14.563075 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:16:14.566839 [info ] [Thread-1 (]: 4 of 8 START test not_null_dbtcustomers_name ................................... [RUN]
[0m11:16:14.569503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_email.6c384897fd, now test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513)
[0m11:16:14.570233 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:16:14.579895 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513"
[0m11:16:14.581035 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513 (compile): 11:16:14.571549 => 11:16:14.580657
[0m11:16:14.581708 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:16:14.586278 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513"
[0m11:16:14.587219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:14.587911 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from `aec-students`.`dbt_robert`.`dbtcustomers`
where name is null



      
    ) dbt_internal_test
[0m11:16:16.017249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6531debe-1d21-4d9a-8b05-d9fc2e32b07f&page=queryresults
[0m11:16:16.018729 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513 (execute): 11:16:14.582152 => 11:16:16.018426
[0m11:16:16.019784 [info ] [Thread-1 (]: 4 of 8 PASS not_null_dbtcustomers_name ......................................... [[32mPASS[0m in 1.45s]
[0m11:16:16.021069 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m11:16:16.021620 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m11:16:16.022690 [info ] [Thread-1 (]: 5 of 8 START test not_null_dbtcustomers_number_of_orders ....................... [RUN]
[0m11:16:16.023868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513, now test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a)
[0m11:16:16.024342 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m11:16:16.102598 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5473a9c4-0b68-4b01-82ff-a4880a009fe3&page=queryresults
[0m11:16:16.109031 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 11:16:14.534243 => 11:16:16.108716
[0m11:16:16.111152 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a"
[0m11:16:16.112280 [info ] [Thread-2 (]: 3 of 8 PASS not_null_dbtcustomers_id ........................................... [[32mPASS[0m in 1.59s]
[0m11:16:16.113625 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m11:16:16.114227 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:16:16.114923 [info ] [Thread-2 (]: 6 of 8 START test unique_dbtcustomers_email .................................... [RUN]
[0m11:16:16.116428 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a (compile): 11:16:16.024961 => 11:16:16.116171
[0m11:16:16.117896 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m11:16:16.121255 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a"
[0m11:16:16.117064 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c, now test.dbt_robert.unique_dbtcustomers_email.cc133877c6)
[0m11:16:16.121891 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:16:16.128961 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_email.cc133877c6"
[0m11:16:16.129795 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_email.cc133877c6 (compile): 11:16:16.122233 => 11:16:16.129516
[0m11:16:16.130239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:16.130757 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:16:16.131278 [debug] [Thread-1 (]: On test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select number_of_orders
from `aec-students`.`dbt_robert`.`dbtcustomers`
where number_of_orders is null



      
    ) dbt_internal_test
[0m11:16:16.134499 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_email.cc133877c6"
[0m11:16:16.138041 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:16:16.138624 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_email.cc133877c6: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_email.cc133877c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select email as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where email is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:16:17.595869 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:530bf666-d588-468a-969a-f5485306cf30&page=queryresults
[0m11:16:17.597182 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a (execute): 11:16:16.118339 => 11:16:17.596875
[0m11:16:17.598268 [info ] [Thread-1 (]: 5 of 8 PASS not_null_dbtcustomers_number_of_orders ............................. [[32mPASS[0m in 1.57s]
[0m11:16:17.599562 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m11:16:17.600135 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:16:17.601026 [info ] [Thread-1 (]: 7 of 8 START test unique_dbtcustomers_first_order_at ........................... [RUN]
[0m11:16:17.602212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a, now test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c)
[0m11:16:17.602708 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:16:17.608327 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c"
[0m11:16:17.609108 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c (compile): 11:16:17.603113 => 11:16:17.608863
[0m11:16:17.609549 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:16:17.612337 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c"
[0m11:16:17.613088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:17.613639 [debug] [Thread-1 (]: On test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select first_order_at as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where first_order_at is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:16:17.733405 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:763137d3-e021-4650-8551-8a6d53632a7e&page=queryresults
[0m11:16:17.734660 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_email.cc133877c6 (execute): 11:16:16.131631 => 11:16:17.734356
[0m11:16:17.735959 [info ] [Thread-2 (]: 6 of 8 PASS unique_dbtcustomers_email .......................................... [[32mPASS[0m in 1.62s]
[0m11:16:17.737891 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m11:16:17.738602 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:16:17.739454 [info ] [Thread-2 (]: 8 of 8 START test unique_dbtcustomers_id ....................................... [RUN]
[0m11:16:17.740649 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.unique_dbtcustomers_email.cc133877c6, now test.dbt_robert.unique_dbtcustomers_id.0c18a9f245)
[0m11:16:17.741289 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:16:17.748112 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m11:16:17.748867 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 11:16:17.741705 => 11:16:17.748624
[0m11:16:17.749305 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:16:17.758632 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m11:16:17.759428 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:16:17.759981 [debug] [Thread-2 (]: On test.dbt_robert.unique_dbtcustomers_id.0c18a9f245: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_robert`.`dbtcustomers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:16:18.967985 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fe2bc39e-278c-4b9b-82b2-e979b3ff91d0&page=queryresults
[0m11:16:18.969482 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c (execute): 11:16:17.609844 => 11:16:18.969122
[0m11:16:18.970849 [info ] [Thread-1 (]: 7 of 8 PASS unique_dbtcustomers_first_order_at ................................. [[32mPASS[0m in 1.37s]
[0m11:16:18.972282 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m11:16:19.100226 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:88fa41e9-6085-4c3c-b07d-9e339ebac800&page=queryresults
[0m11:16:19.102004 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 11:16:17.749599 => 11:16:19.101567
[0m11:16:19.103609 [info ] [Thread-2 (]: 8 of 8 PASS unique_dbtcustomers_id ............................................. [[32mPASS[0m in 1.36s]
[0m11:16:19.107217 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m11:16:19.109661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:19.110115 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c' was properly closed.
[0m11:16:19.110591 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_id.0c18a9f245' was properly closed.
[0m11:16:19.111077 [info ] [MainThread]: 
[0m11:16:19.111677 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 7.36 seconds (7.36s).
[0m11:16:19.114174 [debug] [MainThread]: Command end result
[0m11:16:19.129079 [info ] [MainThread]: 
[0m11:16:19.130060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:19.131327 [info ] [MainThread]: 
[0m11:16:19.132146 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:16:19.133432 [debug] [MainThread]: Command `dbt test` succeeded at 11:16:19.133244 after 7.96 seconds
[0m11:16:19.134267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330084e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fdaccb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3300423fa0>]}
[0m11:16:19.135034 [debug] [MainThread]: Flushing usage events
[0m11:16:24.403199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8052906350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80516ca4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80516ca440>]}


============================== 11:16:24.406388 | 15dfc940-6cc8-4aa3-a17f-2fdaaad9d837 ==============================
[0m11:16:24.406388 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:16:24.407267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:16:24.830292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15dfc940-6cc8-4aa3-a17f-2fdaaad9d837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804fbab1c0>]}
[0m11:16:24.847848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15dfc940-6cc8-4aa3-a17f-2fdaaad9d837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804fbad990>]}
[0m11:16:24.848762 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:16:24.860612 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:16:24.887988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:16:24.888407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:16:24.894605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15dfc940-6cc8-4aa3-a17f-2fdaaad9d837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804f995930>]}
[0m11:16:24.902511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15dfc940-6cc8-4aa3-a17f-2fdaaad9d837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804f961600>]}
[0m11:16:24.903046 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:16:24.903615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15dfc940-6cc8-4aa3-a17f-2fdaaad9d837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804f961630>]}
[0m11:16:24.905324 [info ] [MainThread]: 
[0m11:16:24.906567 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:16:24.908105 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:16:24.908644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:26.080118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m11:16:26.080929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:26.364437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15dfc940-6cc8-4aa3-a17f-2fdaaad9d837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804fb47c10>]}
[0m11:16:26.365743 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:16:26.366549 [info ] [MainThread]: 
[0m11:16:26.370952 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:16:26.371625 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:16:26.372632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:16:26.373098 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:16:26.376947 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:16:26.377843 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:16:26.373551 => 11:16:26.377596
[0m11:16:26.378280 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:16:26.394203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:16:26.748481 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:16:26.749563 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m11:16:31.648737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9e017748-99cb-4001-bb16-fcd3dfeae70a&page=queryresults
[0m11:16:31.666597 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:16:26.378597 => 11:16:31.666301
[0m11:16:31.667612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15dfc940-6cc8-4aa3-a17f-2fdaaad9d837', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804fa271c0>]}
[0m11:16:31.668629 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 5.30s]
[0m11:16:31.669984 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:16:31.672682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:31.673060 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:16:31.673502 [info ] [MainThread]: 
[0m11:16:31.674079 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m11:16:31.675359 [debug] [MainThread]: Command end result
[0m11:16:31.684918 [info ] [MainThread]: 
[0m11:16:31.685744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:31.686353 [info ] [MainThread]: 
[0m11:16:31.687092 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:16:31.688890 [debug] [MainThread]: Command `dbt run` succeeded at 11:16:31.688635 after 7.29 seconds
[0m11:16:31.689563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8052906350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804fa11c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804ff6edd0>]}
[0m11:16:31.690190 [debug] [MainThread]: Flushing usage events
[0m11:26:11.896192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5d8aa380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5c7c64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5c7c6470>]}


============================== 11:26:11.899208 | 94edf39d-ad0f-4ba5-86ab-bcb939b1e660 ==============================
[0m11:26:11.899208 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:26:11.900366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:26:12.280071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94edf39d-ad0f-4ba5-86ab-bcb939b1e660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5d7e2650>]}
[0m11:26:12.299214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94edf39d-ad0f-4ba5-86ab-bcb939b1e660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5acaf820>]}
[0m11:26:12.300316 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:26:12.312255 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:26:12.352506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:26:12.354015 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:26:12.389992 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:26:12.468919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94edf39d-ad0f-4ba5-86ab-bcb939b1e660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5ab480d0>]}
[0m11:26:12.477358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94edf39d-ad0f-4ba5-86ab-bcb939b1e660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5aa65000>]}
[0m11:26:12.478068 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:26:12.478751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94edf39d-ad0f-4ba5-86ab-bcb939b1e660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5aa65030>]}
[0m11:26:12.480742 [info ] [MainThread]: 
[0m11:26:12.481972 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:26:12.483524 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:26:12.484046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:13.646913 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m11:26:13.648232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:13.982093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94edf39d-ad0f-4ba5-86ab-bcb939b1e660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5aa642e0>]}
[0m11:26:13.983511 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:26:13.984365 [info ] [MainThread]: 
[0m11:26:13.989561 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:26:13.990227 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:26:13.991374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:26:13.991853 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:26:13.995739 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:26:13.996594 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:26:13.992206 => 11:26:13.996326
[0m11:26:13.997074 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:26:14.012847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:14.378818 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:26:14.380073 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
, case when number_of_orders >1 then TRUE()
    else FALSE()
    end as is_RETURNING_CUSTOMER

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m11:26:14.651551 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Function call cannot be applied to this expression. Function calls require a path, e.g. a.b.c() at [21:42]')
[0m11:26:15.398962 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:176fbb54-63a3-41ca-a4ad-c940048d580f&page=queryresults
[0m11:26:15.400804 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:26:13.997420 => 11:26:15.400422
[0m11:26:15.405683 [debug] [Thread-1 (]: Database Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)
  Syntax error: Function call cannot be applied to this expression. Function calls require a path, e.g. a.b.c() at [21:42]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:26:15.406528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94edf39d-ad0f-4ba5-86ab-bcb939b1e660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5a5d3d00>]}
[0m11:26:15.407557 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers .................. [[31mERROR[0m in 1.42s]
[0m11:26:15.408387 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:26:15.410756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:15.411134 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m11:26:15.411488 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:26:15.411893 [info ] [MainThread]: 
[0m11:26:15.412498 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m11:26:15.413454 [debug] [MainThread]: Command end result
[0m11:26:15.422718 [info ] [MainThread]: 
[0m11:26:15.423479 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:26:15.424164 [info ] [MainThread]: 
[0m11:26:15.424856 [error] [MainThread]: [33mDatabase Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)[0m
[0m11:26:15.425564 [error] [MainThread]:   Syntax error: Function call cannot be applied to this expression. Function calls require a path, e.g. a.b.c() at [21:42]
[0m11:26:15.426144 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:26:15.426888 [info ] [MainThread]: 
[0m11:26:15.427636 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:26:15.428697 [debug] [MainThread]: Command `dbt run` failed at 11:26:15.428496 after 3.54 seconds
[0m11:26:15.429259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5d8aa380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5acae440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5aa64730>]}
[0m11:26:15.429732 [debug] [MainThread]: Flushing usage events
[0m11:27:14.016741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a26cfe380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a25aca4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a25aca470>]}


============================== 11:27:14.019758 | 6f416284-cee2-4898-89ff-025894bb7ac0 ==============================
[0m11:27:14.019758 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:27:14.020626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:27:14.370299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f416284-cee2-4898-89ff-025894bb7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a26a3a650>]}
[0m11:27:14.387709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f416284-cee2-4898-89ff-025894bb7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a23fadbd0>]}
[0m11:27:14.388485 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:27:14.400078 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:27:14.425463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:27:14.426120 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:27:14.453091 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:27:14.526439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f416284-cee2-4898-89ff-025894bb7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a23e480d0>]}
[0m11:27:14.533672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f416284-cee2-4898-89ff-025894bb7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a23d65300>]}
[0m11:27:14.534163 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:27:14.534730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f416284-cee2-4898-89ff-025894bb7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a23d65330>]}
[0m11:27:14.536253 [info ] [MainThread]: 
[0m11:27:14.537414 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:27:14.539028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:27:14.539566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:15.644486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m11:27:15.645323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:15.967713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f416284-cee2-4898-89ff-025894bb7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a268328c0>]}
[0m11:27:15.968776 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:27:15.969610 [info ] [MainThread]: 
[0m11:27:15.973949 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:27:15.974638 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:27:15.975499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:27:15.975974 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:27:15.979585 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:27:15.980707 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:27:15.976271 => 11:27:15.980245
[0m11:27:15.981195 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:27:15.996591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:16.362514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:27:16.363460 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
, case when (number_of_orders) >1 then TRUE()
    else FALSE()
    end as is_RETURNING_CUSTOMER

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m11:27:16.610159 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Function call cannot be applied to this expression. Function calls require a path, e.g. a.b.c() at [21:44]')
[0m11:27:17.826994 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:863b3372-b0f1-4f39-927e-3ef3c5cab068&page=queryresults
[0m11:27:17.828760 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:27:15.981498 => 11:27:17.828400
[0m11:27:17.833146 [debug] [Thread-1 (]: Database Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)
  Syntax error: Function call cannot be applied to this expression. Function calls require a path, e.g. a.b.c() at [21:44]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:27:17.833760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f416284-cee2-4898-89ff-025894bb7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a238d1b40>]}
[0m11:27:17.834622 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers .................. [[31mERROR[0m in 1.86s]
[0m11:27:17.835420 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:27:17.837653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:27:17.838786 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:27:17.839355 [info ] [MainThread]: 
[0m11:27:17.840680 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m11:27:17.842778 [debug] [MainThread]: Command end result
[0m11:27:17.855473 [info ] [MainThread]: 
[0m11:27:17.856184 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:27:17.856887 [info ] [MainThread]: 
[0m11:27:17.858400 [error] [MainThread]: [33mDatabase Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)[0m
[0m11:27:17.859786 [error] [MainThread]:   Syntax error: Function call cannot be applied to this expression. Function calls require a path, e.g. a.b.c() at [21:44]
[0m11:27:17.860498 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:27:17.861485 [info ] [MainThread]: 
[0m11:27:17.862767 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:27:17.864097 [debug] [MainThread]: Command `dbt run` failed at 11:27:17.863909 after 3.85 seconds
[0m11:27:17.864836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a26cfe380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a2812eef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a268328c0>]}
[0m11:27:17.865555 [debug] [MainThread]: Flushing usage events
[0m11:28:31.068995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffb36a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffa0ca4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffa0ca440>]}


============================== 11:28:31.071695 | 3e7189c5-a869-4b1a-b736-3f6f7e8c0956 ==============================
[0m11:28:31.071695 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:28:31.072525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:28:31.426077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e7189c5-a869-4b1a-b736-3f6f7e8c0956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffb054d90>]}
[0m11:28:31.443057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e7189c5-a869-4b1a-b736-3f6f7e8c0956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff85add20>]}
[0m11:28:31.443789 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:28:31.454789 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:28:31.479978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:28:31.480619 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:28:31.506205 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:28:31.578585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e7189c5-a869-4b1a-b736-3f6f7e8c0956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff84480d0>]}
[0m11:28:31.586358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e7189c5-a869-4b1a-b736-3f6f7e8c0956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff83652d0>]}
[0m11:28:31.586858 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:28:31.587381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e7189c5-a869-4b1a-b736-3f6f7e8c0956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff8365270>]}
[0m11:28:31.588970 [info ] [MainThread]: 
[0m11:28:31.590127 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:28:31.591524 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:28:31.592183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:32.817153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m11:28:32.818070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:33.125867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e7189c5-a869-4b1a-b736-3f6f7e8c0956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff8364340>]}
[0m11:28:33.127173 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:28:33.128130 [info ] [MainThread]: 
[0m11:28:33.132542 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:28:33.133229 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:28:33.134205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:28:33.134724 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:28:33.138124 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:28:33.139092 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:28:33.135083 => 11:28:33.138792
[0m11:28:33.139533 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:28:33.157384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:33.528851 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:28:33.529749 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
, case when number_of_orders >1 then 1
    else 0
    end as is_RETURNING_CUSTOMER

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m11:28:34.413138 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: number_of_orders at [21:13]')
[0m11:28:35.811457 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ae198bcf-2a83-4bf5-a9c0-93bb9f984044&page=queryresults
[0m11:28:35.813143 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:28:33.139991 => 11:28:35.812762
[0m11:28:35.817088 [debug] [Thread-1 (]: Database Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)
  Unrecognized name: number_of_orders at [21:13]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:28:35.817781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e7189c5-a869-4b1a-b736-3f6f7e8c0956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff7e9dea0>]}
[0m11:28:35.818627 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers .................. [[31mERROR[0m in 2.68s]
[0m11:28:35.819530 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:28:35.821886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:35.822274 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:28:35.822717 [info ] [MainThread]: 
[0m11:28:35.823592 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.23 seconds (4.23s).
[0m11:28:35.824539 [debug] [MainThread]: Command end result
[0m11:28:35.832326 [info ] [MainThread]: 
[0m11:28:35.832944 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:28:35.833522 [info ] [MainThread]: 
[0m11:28:35.834107 [error] [MainThread]: [33mDatabase Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)[0m
[0m11:28:35.834823 [error] [MainThread]:   Unrecognized name: number_of_orders at [21:13]
[0m11:28:35.835487 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:28:35.836041 [info ] [MainThread]: 
[0m11:28:35.836909 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:28:35.837884 [debug] [MainThread]: Command `dbt run` failed at 11:28:35.837751 after 4.78 seconds
[0m11:28:35.838361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffb36a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffc79aef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbff8364a30>]}
[0m11:28:35.839093 [debug] [MainThread]: Flushing usage events
[0m11:29:08.449261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f623b3723b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f623a0ca500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f623a0ca4a0>]}


============================== 11:29:08.452042 | 44ac72da-350a-4812-98cf-57450293b696 ==============================
[0m11:29:08.452042 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:29:08.452899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:29:08.815444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44ac72da-350a-4812-98cf-57450293b696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f623af46500>]}
[0m11:29:08.832780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44ac72da-350a-4812-98cf-57450293b696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62385ade40>]}
[0m11:29:08.833655 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:29:08.845055 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:29:08.871873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:29:08.872298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:29:08.878511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44ac72da-350a-4812-98cf-57450293b696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6238395270>]}
[0m11:29:08.886271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44ac72da-350a-4812-98cf-57450293b696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6238368f40>]}
[0m11:29:08.886811 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:29:08.887573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44ac72da-350a-4812-98cf-57450293b696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6238368f70>]}
[0m11:29:08.889321 [info ] [MainThread]: 
[0m11:29:08.890451 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:29:08.892111 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:29:08.892641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:10.028034 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m11:29:10.029235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:10.336623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44ac72da-350a-4812-98cf-57450293b696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62385af0a0>]}
[0m11:29:10.337918 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:29:10.338751 [info ] [MainThread]: 
[0m11:29:10.343757 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:29:10.344549 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:29:10.345718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:29:10.346184 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:29:10.349983 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:29:10.350790 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:29:10.346519 => 11:29:10.350533
[0m11:29:10.351241 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:29:10.366633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:10.737227 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:29:10.738227 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
, case when number_of_orders >1 then 1
    else 0
    end as is_RETURNING_CUSTOMER

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m11:29:11.545880 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: number_of_orders at [21:13]')
[0m11:29:12.485658 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9c4465be-6132-42ef-aeef-bd0109af8110&page=queryresults
[0m11:29:12.487291 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:29:10.351525 => 11:29:12.486954
[0m11:29:12.491185 [debug] [Thread-1 (]: Database Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)
  Unrecognized name: number_of_orders at [21:13]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:29:12.491780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44ac72da-350a-4812-98cf-57450293b696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6238396ce0>]}
[0m11:29:12.492624 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers .................. [[31mERROR[0m in 2.15s]
[0m11:29:12.493511 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:29:12.495478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:12.495853 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m11:29:12.496200 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:29:12.496584 [info ] [MainThread]: 
[0m11:29:12.497151 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m11:29:12.498316 [debug] [MainThread]: Command end result
[0m11:29:12.506150 [info ] [MainThread]: 
[0m11:29:12.506912 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:29:12.507568 [info ] [MainThread]: 
[0m11:29:12.508551 [error] [MainThread]: [33mDatabase Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)[0m
[0m11:29:12.509127 [error] [MainThread]:   Unrecognized name: number_of_orders at [21:13]
[0m11:29:12.509704 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:29:12.510672 [info ] [MainThread]: 
[0m11:29:12.511726 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:29:12.512999 [debug] [MainThread]: Command `dbt run` failed at 11:29:12.512562 after 4.07 seconds
[0m11:29:12.513495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f623b3723b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62385c9ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62385ade40>]}
[0m11:29:12.513956 [debug] [MainThread]: Flushing usage events
[0m11:32:20.411012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe577e2a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe576dee500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe576dee4a0>]}


============================== 11:32:20.414010 | 7be600d7-8ddc-42fc-b6da-b287138f505b ==============================
[0m11:32:20.414010 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:32:20.414917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:32:20.795326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7be600d7-8ddc-42fc-b6da-b287138f505b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5752d7220>]}
[0m11:32:20.812809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7be600d7-8ddc-42fc-b6da-b287138f505b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5752d9990>]}
[0m11:32:20.813918 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:32:20.826014 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:32:20.852940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:32:20.853865 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:32:20.883709 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:32:20.961972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7be600d7-8ddc-42fc-b6da-b287138f505b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe575105f30>]}
[0m11:32:20.970090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7be600d7-8ddc-42fc-b6da-b287138f505b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57508d630>]}
[0m11:32:20.970783 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:32:20.971408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7be600d7-8ddc-42fc-b6da-b287138f505b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57508d5d0>]}
[0m11:32:20.973257 [info ] [MainThread]: 
[0m11:32:20.974494 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:32:20.976001 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:32:20.976569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:22.119483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m11:32:22.120205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:22.435440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7be600d7-8ddc-42fc-b6da-b287138f505b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57507bc10>]}
[0m11:32:22.436809 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:32:22.437657 [info ] [MainThread]: 
[0m11:32:22.443214 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:32:22.443929 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:32:22.444992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:32:22.445465 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:32:22.449249 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:32:22.450079 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:32:22.445801 => 11:32:22.449806
[0m11:32:22.450562 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:32:22.466866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:22.837721 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:32:22.839018 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then 1
    else 0
END as is_RETURNING_CUSTOMER

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m11:32:26.861861 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8195fa0e-192d-4f2a-a286-11e36696a7fc&page=queryresults
[0m11:32:26.883483 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:32:22.450943 => 11:32:26.883224
[0m11:32:26.884555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7be600d7-8ddc-42fc-b6da-b287138f505b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe57507b8b0>]}
[0m11:32:26.885417 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.44s]
[0m11:32:26.886643 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:32:26.889058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:26.889441 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:32:26.889863 [info ] [MainThread]: 
[0m11:32:26.890464 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m11:32:26.891555 [debug] [MainThread]: Command end result
[0m11:32:26.899775 [info ] [MainThread]: 
[0m11:32:26.900509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:32:26.901178 [info ] [MainThread]: 
[0m11:32:26.901839 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:32:26.903109 [debug] [MainThread]: Command `dbt run` succeeded at 11:32:26.902954 after 6.50 seconds
[0m11:32:26.903573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe577e2a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5779eb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5752dbb20>]}
[0m11:32:26.904136 [debug] [MainThread]: Flushing usage events
[0m11:33:07.719883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a9b26320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a8ac6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a8ac6410>]}


============================== 11:33:07.722790 | 06d5fe3d-5f43-4d69-beb3-5b03e43adb49 ==============================
[0m11:33:07.722790 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:33:07.723643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:33:08.156764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06d5fe3d-5f43-4d69-beb3-5b03e43adb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a9a5cdc0>]}
[0m11:33:08.174542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06d5fe3d-5f43-4d69-beb3-5b03e43adb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a6f995a0>]}
[0m11:33:08.175611 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:33:08.188465 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:33:08.216195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:08.217084 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:33:08.243789 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:33:08.326044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06d5fe3d-5f43-4d69-beb3-5b03e43adb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a6e340d0>]}
[0m11:33:08.334575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06d5fe3d-5f43-4d69-beb3-5b03e43adb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a6d554e0>]}
[0m11:33:08.335235 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:33:08.335859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06d5fe3d-5f43-4d69-beb3-5b03e43adb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a6d55480>]}
[0m11:33:08.337691 [info ] [MainThread]: 
[0m11:33:08.339184 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:33:08.340805 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:33:08.341353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:09.496637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m11:33:09.497400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:09.796232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06d5fe3d-5f43-4d69-beb3-5b03e43adb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a6f37250>]}
[0m11:33:09.797513 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:33:09.798454 [info ] [MainThread]: 
[0m11:33:09.803374 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:33:09.804205 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:33:09.805195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:33:09.805664 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:33:09.809086 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:33:09.809974 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:33:09.805963 => 11:33:09.809670
[0m11:33:09.810443 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:33:09.826384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:10.178461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:33:10.179410 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE()
    else FALSE()
END as is_RETURNING_CUSTOMER

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m11:33:10.444770 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Function call cannot be applied to this expression. Function calls require a path, e.g. a.b.c() at [22:35]')
[0m11:33:12.489205 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c53d286a-2a0a-4670-be16-6dfdea8b9b42&page=queryresults
[0m11:33:12.491459 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:33:09.810759 => 11:33:12.491020
[0m11:33:12.497658 [debug] [Thread-1 (]: Database Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)
  Syntax error: Function call cannot be applied to this expression. Function calls require a path, e.g. a.b.c() at [22:35]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:33:12.498646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06d5fe3d-5f43-4d69-beb3-5b03e43adb49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a689b640>]}
[0m11:33:12.499908 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers .................. [[31mERROR[0m in 2.69s]
[0m11:33:12.501593 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:33:12.510832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:12.511312 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:33:12.511814 [info ] [MainThread]: 
[0m11:33:12.512605 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m11:33:12.513682 [debug] [MainThread]: Command end result
[0m11:33:12.522125 [info ] [MainThread]: 
[0m11:33:12.523049 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:33:12.523737 [info ] [MainThread]: 
[0m11:33:12.524866 [error] [MainThread]: [33mDatabase Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)[0m
[0m11:33:12.525685 [error] [MainThread]:   Syntax error: Function call cannot be applied to this expression. Function calls require a path, e.g. a.b.c() at [22:35]
[0m11:33:12.526410 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:33:12.527315 [info ] [MainThread]: 
[0m11:33:12.528166 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:33:12.529517 [debug] [MainThread]: Command `dbt run` failed at 11:33:12.529377 after 4.82 seconds
[0m11:33:12.530054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a9b26320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02ab126ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02a6d54c40>]}
[0m11:33:12.530771 [debug] [MainThread]: Flushing usage events
[0m11:33:43.647821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9acca380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d99a0a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d99a0a470>]}


============================== 11:33:43.650609 | a972b1ed-0487-462f-b609-19bb88b681ce ==============================
[0m11:33:43.650609 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:33:43.651458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:33:44.030846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a972b1ed-0487-462f-b609-19bb88b681ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9ac06650>]}
[0m11:33:44.048579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a972b1ed-0487-462f-b609-19bb88b681ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d980f1ab0>]}
[0m11:33:44.049634 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:33:44.061588 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:33:44.089074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:44.089816 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:33:44.120541 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:33:44.197957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a972b1ed-0487-462f-b609-19bb88b681ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d97f100d0>]}
[0m11:33:44.205854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a972b1ed-0487-462f-b609-19bb88b681ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d97ead030>]}
[0m11:33:44.206501 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:33:44.207344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a972b1ed-0487-462f-b609-19bb88b681ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d97ead060>]}
[0m11:33:44.209351 [info ] [MainThread]: 
[0m11:33:44.210469 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:33:44.212187 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:33:44.212619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:45.396201 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m11:33:45.397419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:45.681779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a972b1ed-0487-462f-b609-19bb88b681ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d980f2440>]}
[0m11:33:45.682921 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:33:45.683580 [info ] [MainThread]: 
[0m11:33:45.688027 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:33:45.688758 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:33:45.689828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:33:45.690308 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:33:45.694116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:33:45.694964 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:33:45.690689 => 11:33:45.694697
[0m11:33:45.695416 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:33:45.711079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:46.045910 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:33:46.046917 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_RETURNING_CUSTOMER

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m11:33:50.712282 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:766d4af1-fd97-4d61-bf28-e5ef9574660d&page=queryresults
[0m11:33:50.730992 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:33:45.695719 => 11:33:50.730751
[0m11:33:50.732236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a972b1ed-0487-462f-b609-19bb88b681ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9810e1a0>]}
[0m11:33:50.733449 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 5.04s]
[0m11:33:50.734998 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:33:50.738041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:50.738567 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m11:33:50.738981 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:33:50.739979 [info ] [MainThread]: 
[0m11:33:50.741143 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m11:33:50.746864 [debug] [MainThread]: Command end result
[0m11:33:50.759883 [info ] [MainThread]: 
[0m11:33:50.760878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:50.761644 [info ] [MainThread]: 
[0m11:33:50.762792 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:33:50.764287 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:50.764050 after 7.12 seconds
[0m11:33:50.764994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9acca380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d97ed6b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d980f1ab0>]}
[0m11:33:50.765772 [debug] [MainThread]: Flushing usage events
[0m11:47:34.535932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dda426380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd920a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd920a470>]}


============================== 11:47:34.538807 | 3955d204-c195-489a-b64b-ec8c29aaa8a5 ==============================
[0m11:47:34.538807 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:47:34.539722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:47:34.916384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3955d204-c195-489a-b64b-ec8c29aaa8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dda362650>]}
[0m11:47:34.934005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3955d204-c195-489a-b64b-ec8c29aaa8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd78dd3c0>]}
[0m11:47:34.934831 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:47:34.945923 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:47:34.972012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:47:34.972671 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:47:34.997860 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:47:35.075857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3955d204-c195-489a-b64b-ec8c29aaa8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd77080d0>]}
[0m11:47:35.083779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3955d204-c195-489a-b64b-ec8c29aaa8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd7695180>]}
[0m11:47:35.084383 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:47:35.085108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3955d204-c195-489a-b64b-ec8c29aaa8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd76951b0>]}
[0m11:47:35.087051 [info ] [MainThread]: 
[0m11:47:35.088127 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:47:35.089614 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:47:35.090181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:36.374453 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m11:47:36.375453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:36.668326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3955d204-c195-489a-b64b-ec8c29aaa8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd767fc70>]}
[0m11:47:36.669645 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:47:36.670544 [info ] [MainThread]: 
[0m11:47:36.675158 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:47:36.675865 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:47:36.677223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:47:36.677704 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:47:36.681579 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:47:36.682510 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:47:36.678009 => 11:47:36.682217
[0m11:47:36.682966 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:47:36.710939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:37.038770 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:47:37.039739 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5
    );
  
[0m11:47:40.790899 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1bf7ca3a-53c1-4b4a-978c-e81f0bc2f0cf&page=queryresults
[0m11:47:40.809614 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:47:36.683264 => 11:47:40.809375
[0m11:47:40.810611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3955d204-c195-489a-b64b-ec8c29aaa8a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd78fa7d0>]}
[0m11:47:40.811420 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.13s]
[0m11:47:40.812455 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:47:40.815014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:40.815669 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m11:47:40.816151 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:47:40.816672 [info ] [MainThread]: 
[0m11:47:40.817372 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m11:47:40.818935 [debug] [MainThread]: Command end result
[0m11:47:40.829407 [info ] [MainThread]: 
[0m11:47:40.830050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:40.830706 [info ] [MainThread]: 
[0m11:47:40.831331 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:47:40.832525 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:40.832395 after 6.30 seconds
[0m11:47:40.832976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dda426380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dda15b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd78fae90>]}
[0m11:47:40.833712 [debug] [MainThread]: Flushing usage events
[0m11:52:53.753384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e3436380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e21ce4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e21ce470>]}


============================== 11:52:53.757714 | 689a5365-3874-41d5-bb4e-c61a1c59e9de ==============================
[0m11:52:53.757714 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:52:53.759858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:52:54.141753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '689a5365-3874-41d5-bb4e-c61a1c59e9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e06af2b0>]}
[0m11:52:54.159442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '689a5365-3874-41d5-bb4e-c61a1c59e9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e06b2800>]}
[0m11:52:54.160426 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:52:54.172185 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:52:54.199842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:54.200784 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:52:54.228007 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:52:54.308126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '689a5365-3874-41d5-bb4e-c61a1c59e9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e05480d0>]}
[0m11:52:54.316152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '689a5365-3874-41d5-bb4e-c61a1c59e9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e0469630>]}
[0m11:52:54.316804 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:52:54.317406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '689a5365-3874-41d5-bb4e-c61a1c59e9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e04695d0>]}
[0m11:52:54.319684 [info ] [MainThread]: 
[0m11:52:54.322817 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:54.324827 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:52:54.325564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:55.558976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m11:52:55.559820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:55.885986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '689a5365-3874-41d5-bb4e-c61a1c59e9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e0453340>]}
[0m11:52:55.887358 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:52:55.888355 [info ] [MainThread]: 
[0m11:52:55.894074 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:52:55.894851 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:52:55.895884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:52:55.896384 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:52:55.900548 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:52:55.901351 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:52:55.897108 => 11:52:55.901088
[0m11:52:55.901845 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:52:55.917145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:56.297935 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:52:56.298971 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,MIN(O.created_at) as first_order_at
,YEARWEEK(O.created_at) year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when number_of_orders > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m11:52:57.395563 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: YEARWEEK at [20:2]')
[0m11:52:59.239157 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0a49bd12-3352-43a4-93dc-439b75778d1c&page=queryresults
[0m11:52:59.241086 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:52:55.902139 => 11:52:59.240692
[0m11:52:59.245873 [debug] [Thread-1 (]: Database Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)
  Function not found: YEARWEEK at [20:2]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:52:59.246667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689a5365-3874-41d5-bb4e-c61a1c59e9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3dbf671f0>]}
[0m11:52:59.247719 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers .................. [[31mERROR[0m in 3.35s]
[0m11:52:59.248546 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:52:59.250913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:59.251286 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:52:59.251689 [info ] [MainThread]: 
[0m11:52:59.252275 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m11:52:59.253072 [debug] [MainThread]: Command end result
[0m11:52:59.261642 [info ] [MainThread]: 
[0m11:52:59.262382 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:52:59.263069 [info ] [MainThread]: 
[0m11:52:59.263873 [error] [MainThread]: [33mDatabase Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)[0m
[0m11:52:59.264555 [error] [MainThread]:   Function not found: YEARWEEK at [20:2]
[0m11:52:59.265176 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:52:59.265997 [info ] [MainThread]: 
[0m11:52:59.266688 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:52:59.267792 [debug] [MainThread]: Command `dbt run` failed at 11:52:59.267614 after 5.52 seconds
[0m11:52:59.268489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e3436380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e06b2800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e4866ef0>]}
[0m11:52:59.269237 [debug] [MainThread]: Flushing usage events
[0m11:53:48.438153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56ad3ca350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56ac0ca4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56ac0ca440>]}


============================== 11:53:48.440901 | 1ca5cd2f-ac31-47e0-a60a-f5f623b68f23 ==============================
[0m11:53:48.440901 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:53:48.441742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:53:48.815409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ca5cd2f-ac31-47e0-a60a-f5f623b68f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56ad0b4d90>]}
[0m11:53:48.833057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ca5cd2f-ac31-47e0-a60a-f5f623b68f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa5ad3f0>]}
[0m11:53:48.834059 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:53:48.845723 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:53:48.872684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:53:48.873483 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:53:48.902223 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:53:48.995100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ca5cd2f-ac31-47e0-a60a-f5f623b68f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa4480d0>]}
[0m11:53:49.003089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ca5cd2f-ac31-47e0-a60a-f5f623b68f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa3651b0>]}
[0m11:53:49.003731 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:53:49.004337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ca5cd2f-ac31-47e0-a60a-f5f623b68f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa365150>]}
[0m11:53:49.006084 [info ] [MainThread]: 
[0m11:53:49.007293 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:53:49.008781 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:53:49.009322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:50.346380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m11:53:50.347222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:50.646284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ca5cd2f-ac31-47e0-a60a-f5f623b68f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa54ae90>]}
[0m11:53:50.647590 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:53:50.648467 [info ] [MainThread]: 
[0m11:53:50.653693 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:53:50.654365 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:53:50.655617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:53:50.656205 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:53:50.660074 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:53:50.660855 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:53:50.656856 => 11:53:50.660597
[0m11:53:50.661367 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:53:50.677007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:51.019249 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:53:51.020190 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,MIN(O.created_at) as first_order_at
,YEARWEEK(O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when number_of_orders > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m11:53:51.983152 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: YEARWEEK at [20:2]')
[0m11:53:53.526303 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d9ad54d6-313b-4cbb-b078-5bccf6e360b6&page=queryresults
[0m11:53:53.527923 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:53:50.661658 => 11:53:53.527424
[0m11:53:53.531948 [debug] [Thread-1 (]: Database Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)
  Function not found: YEARWEEK at [20:2]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:53:53.532598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ca5cd2f-ac31-47e0-a60a-f5f623b68f23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a9ed2d40>]}
[0m11:53:53.533393 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers .................. [[31mERROR[0m in 2.88s]
[0m11:53:53.534228 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:53:53.536650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:53.537026 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:53:53.537436 [info ] [MainThread]: 
[0m11:53:53.538183 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m11:53:53.539485 [debug] [MainThread]: Command end result
[0m11:53:53.547282 [info ] [MainThread]: 
[0m11:53:53.547892 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:53:53.548470 [info ] [MainThread]: 
[0m11:53:53.549064 [error] [MainThread]: [33mDatabase Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)[0m
[0m11:53:53.549889 [error] [MainThread]:   Function not found: YEARWEEK at [20:2]
[0m11:53:53.550479 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:53:53.551054 [info ] [MainThread]: 
[0m11:53:53.551927 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:53:53.552826 [debug] [MainThread]: Command `dbt run` failed at 11:53:53.552695 after 5.12 seconds
[0m11:53:53.553284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56ad3ca350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56acf9b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa364910>]}
[0m11:53:53.554002 [debug] [MainThread]: Flushing usage events
[0m11:55:08.259706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff9cde320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff8bc6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff8bc6410>]}


============================== 11:55:08.264427 | c53c62d5-2a5d-4091-868d-6a691a29ba85 ==============================
[0m11:55:08.264427 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:55:08.265738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:55:08.659938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c53c62d5-2a5d-4091-868d-6a691a29ba85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff9c14b20>]}
[0m11:55:08.682665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c53c62d5-2a5d-4091-868d-6a691a29ba85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff70ae410>]}
[0m11:55:08.683688 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:55:08.695764 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:55:08.722577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:55:08.723395 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:55:08.748983 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:55:08.830235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c53c62d5-2a5d-4091-868d-6a691a29ba85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff6f480d0>]}
[0m11:55:08.838021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c53c62d5-2a5d-4091-868d-6a691a29ba85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff6e64e20>]}
[0m11:55:08.838659 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:55:08.839477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c53c62d5-2a5d-4091-868d-6a691a29ba85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff6e64dc0>]}
[0m11:55:08.841375 [info ] [MainThread]: 
[0m11:55:08.842543 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:55:08.844022 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:55:08.844589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:10.011001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m11:55:10.011871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:10.303669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c53c62d5-2a5d-4091-868d-6a691a29ba85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff6e8e8f0>]}
[0m11:55:10.305163 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:55:10.307983 [info ] [MainThread]: 
[0m11:55:10.314844 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:55:10.315515 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:55:10.316446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:55:10.316880 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:55:10.320894 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:55:10.322292 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:55:10.317177 => 11:55:10.321459
[0m11:55:10.322824 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:55:10.338616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:10.710950 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:55:10.711919 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,MIN(O.created_at) as first_order_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when number_of_orders > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m11:55:11.671463 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: number_of_orders at [23:10]')
[0m11:55:13.068007 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:75cf8b49-9aa6-469b-8b39-207e18a4830c&page=queryresults
[0m11:55:13.070039 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:55:10.323118 => 11:55:13.069666
[0m11:55:13.074079 [debug] [Thread-1 (]: Database Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)
  Unrecognized name: number_of_orders at [23:10]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:55:13.074799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c53c62d5-2a5d-4091-868d-6a691a29ba85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff69d1630>]}
[0m11:55:13.075643 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers .................. [[31mERROR[0m in 2.76s]
[0m11:55:13.076563 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:55:13.078906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:13.079279 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:55:13.079688 [info ] [MainThread]: 
[0m11:55:13.080192 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m11:55:13.080892 [debug] [MainThread]: Command end result
[0m11:55:13.092513 [info ] [MainThread]: 
[0m11:55:13.093694 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:55:13.094676 [info ] [MainThread]: 
[0m11:55:13.095679 [error] [MainThread]: [33mDatabase Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)[0m
[0m11:55:13.096631 [error] [MainThread]:   Unrecognized name: number_of_orders at [23:10]
[0m11:55:13.097617 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:55:13.098652 [info ] [MainThread]: 
[0m11:55:13.099732 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:55:13.101221 [debug] [MainThread]: Command `dbt run` failed at 11:55:13.100962 after 4.85 seconds
[0m11:55:13.101989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff9cde320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcffb2e2ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff6e64580>]}
[0m11:55:13.102689 [debug] [MainThread]: Flushing usage events
[0m11:58:38.939646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92261aa320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92250c6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92250c6410>]}


============================== 11:58:38.942283 | 689ee721-3d6e-4937-a0e3-3baafb31335b ==============================
[0m11:58:38.942283 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:58:38.943293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:58:39.310924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '689ee721-3d6e-4937-a0e3-3baafb31335b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92235ab1c0>]}
[0m11:58:39.328518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '689ee721-3d6e-4937-a0e3-3baafb31335b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92235ad9c0>]}
[0m11:58:39.329470 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:58:39.341199 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:58:39.367711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:39.368529 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:58:39.395105 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:58:39.479634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '689ee721-3d6e-4937-a0e3-3baafb31335b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92234480d0>]}
[0m11:58:39.487623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '689ee721-3d6e-4937-a0e3-3baafb31335b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9223361600>]}
[0m11:58:39.488267 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:58:39.488992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '689ee721-3d6e-4937-a0e3-3baafb31335b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9223361630>]}
[0m11:58:39.490888 [info ] [MainThread]: 
[0m11:58:39.492067 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:58:39.493565 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:58:39.494105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:40.666378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m11:58:40.668146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:40.964535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '689ee721-3d6e-4937-a0e3-3baafb31335b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922354bc10>]}
[0m11:58:40.965858 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:58:40.966963 [info ] [MainThread]: 
[0m11:58:40.972105 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:58:40.972747 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:58:40.973819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:58:40.974293 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:58:40.978391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:58:40.979265 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:58:40.974630 => 11:58:40.978980
[0m11:58:40.979742 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:58:40.995951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:41.368255 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:58:41.369276 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
,O.created_at
--,MIN(O.created_at) as first_order_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m11:58:42.366978 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references O.created_at which is neither grouped nor aggregated at [19:2]')
[0m11:58:43.666881 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:77ea211e-f3b9-4a40-b35e-5e302cb30baf&page=queryresults
[0m11:58:43.668559 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:58:40.980083 => 11:58:43.668222
[0m11:58:43.673101 [debug] [Thread-1 (]: Database Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)
  SELECT list expression references O.created_at which is neither grouped nor aggregated at [19:2]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:58:43.673753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689ee721-3d6e-4937-a0e3-3baafb31335b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9222eaf370>]}
[0m11:58:43.674655 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers .................. [[31mERROR[0m in 2.70s]
[0m11:58:43.675692 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:58:43.677869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:43.678243 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:58:43.678766 [info ] [MainThread]: 
[0m11:58:43.679796 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m11:58:43.681097 [debug] [MainThread]: Command end result
[0m11:58:43.688916 [info ] [MainThread]: 
[0m11:58:43.689605 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:58:43.690484 [info ] [MainThread]: 
[0m11:58:43.691813 [error] [MainThread]: [33mDatabase Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)[0m
[0m11:58:43.692376 [error] [MainThread]:   SELECT list expression references O.created_at which is neither grouped nor aggregated at [19:2]
[0m11:58:43.693005 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:58:43.694054 [info ] [MainThread]: 
[0m11:58:43.694699 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:58:43.696004 [debug] [MainThread]: Command `dbt run` failed at 11:58:43.695565 after 4.76 seconds
[0m11:58:43.696534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92261aa320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9225f79600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9223360e50>]}
[0m11:58:43.697024 [debug] [MainThread]: Flushing usage events
[0m11:59:26.730033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d76be380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d640a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d640a470>]}


============================== 11:59:26.732906 | 0e67fdfe-96d6-492f-b904-d97b970dbf93 ==============================
[0m11:59:26.732906 [info ] [MainThread]: Running with dbt=1.5.3
[0m11:59:26.733942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:59:27.120641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e67fdfe-96d6-492f-b904-d97b970dbf93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d4ab3f40>]}
[0m11:59:27.138595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e67fdfe-96d6-492f-b904-d97b970dbf93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d4af3700>]}
[0m11:59:27.139669 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:59:27.151641 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m11:59:27.184885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:59:27.186408 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m11:59:27.223781 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m11:59:27.303310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e67fdfe-96d6-492f-b904-d97b970dbf93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d491c0d0>]}
[0m11:59:27.311467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e67fdfe-96d6-492f-b904-d97b970dbf93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d48a8b50>]}
[0m11:59:27.312136 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m11:59:27.312766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e67fdfe-96d6-492f-b904-d97b970dbf93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d48a8b80>]}
[0m11:59:27.314647 [info ] [MainThread]: 
[0m11:59:27.315857 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:59:27.317866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:59:27.318424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:28.501785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m11:59:28.503112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:28.805821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e67fdfe-96d6-492f-b904-d97b970dbf93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d48d6650>]}
[0m11:59:28.807185 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:59:28.807865 [info ] [MainThread]: 
[0m11:59:28.814808 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m11:59:28.815506 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m11:59:28.817028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m11:59:28.817544 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m11:59:28.821458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m11:59:28.822265 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 11:59:28.817999 => 11:59:28.822007
[0m11:59:28.822804 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m11:59:28.843812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:29.202177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m11:59:29.203223 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
--,MIN(O.created_at) as first_order_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m11:59:30.153658 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references O.created_at which is neither grouped nor aggregated at [21:23]')
[0m11:59:31.370429 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:81d565d9-7da7-404c-bb7f-edad88905667&page=queryresults
[0m11:59:31.372296 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 11:59:28.823095 => 11:59:31.371913
[0m11:59:31.376726 [debug] [Thread-1 (]: Database Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)
  SELECT list expression references O.created_at which is neither grouped nor aggregated at [21:23]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:59:31.377412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e67fdfe-96d6-492f-b904-d97b970dbf93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d4417580>]}
[0m11:59:31.378417 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers .................. [[31mERROR[0m in 2.56s]
[0m11:59:31.379345 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m11:59:31.381890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:31.382272 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m11:59:31.382720 [info ] [MainThread]: 
[0m11:59:31.383480 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m11:59:31.385405 [debug] [MainThread]: Command end result
[0m11:59:31.393295 [info ] [MainThread]: 
[0m11:59:31.393935 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:59:31.394578 [info ] [MainThread]: 
[0m11:59:31.395172 [error] [MainThread]: [33mDatabase Error in model dbtcustomers (models/marts/revenuereport/dbtcustomers.sql)[0m
[0m11:59:31.396097 [error] [MainThread]:   SELECT list expression references O.created_at which is neither grouped nor aggregated at [21:23]
[0m11:59:31.396688 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers.sql
[0m11:59:31.397627 [info ] [MainThread]: 
[0m11:59:31.398256 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:59:31.399550 [debug] [MainThread]: Command `dbt run` failed at 11:59:31.399413 after 4.68 seconds
[0m11:59:31.400016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d76be380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d8cbaef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48d4af3d00>]}
[0m11:59:31.400895 [debug] [MainThread]: Flushing usage events
[0m12:02:28.372878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039329a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03920064a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0392006440>]}


============================== 12:02:28.375778 | d9daceb1-7600-4464-9f01-af167ede3abd ==============================
[0m12:02:28.375778 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:02:28.376581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:02:28.801804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9daceb1-7600-4464-9f01-af167ede3abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0393184280>]}
[0m12:02:28.819485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9daceb1-7600-4464-9f01-af167ede3abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03906f24a0>]}
[0m12:02:28.820522 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:02:28.836049 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:02:28.863134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:02:28.864000 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers.sql
[0m12:02:28.890512 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m12:02:28.972847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9daceb1-7600-4464-9f01-af167ede3abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039051c0d0>]}
[0m12:02:28.980886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9daceb1-7600-4464-9f01-af167ede3abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03904a8d60>]}
[0m12:02:28.981530 [info ] [MainThread]: Found 1 model, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:02:28.982127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9daceb1-7600-4464-9f01-af167ede3abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03904a8d00>]}
[0m12:02:28.983951 [info ] [MainThread]: 
[0m12:02:28.985229 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:02:28.986705 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:02:28.987428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:30.439855 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m12:02:30.441278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:30.787291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9daceb1-7600-4464-9f01-af167ede3abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03904d6830>]}
[0m12:02:30.788646 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:02:30.789724 [info ] [MainThread]: 
[0m12:02:30.795241 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m12:02:30.795965 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m12:02:30.796969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m12:02:30.797441 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m12:02:30.801299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m12:02:30.802131 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 12:02:30.797778 => 12:02:30.801868
[0m12:02:30.802613 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m12:02:30.818552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:31.242345 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m12:02:31.243338 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:02:35.955262 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:709c3b3d-7fbd-4789-9e0c-d7ffb40312f0&page=queryresults
[0m12:02:35.973551 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 12:02:30.802958 => 12:02:35.973300
[0m12:02:35.974622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9daceb1-7600-4464-9f01-af167ede3abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039070db70>]}
[0m12:02:35.975466 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 5.18s]
[0m12:02:35.976698 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m12:02:35.979358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:35.979737 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m12:02:35.980095 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m12:02:35.980506 [info ] [MainThread]: 
[0m12:02:35.981462 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m12:02:35.982605 [debug] [MainThread]: Command end result
[0m12:02:35.990830 [info ] [MainThread]: 
[0m12:02:35.991486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:02:35.992094 [info ] [MainThread]: 
[0m12:02:35.992827 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:02:35.994905 [debug] [MainThread]: Command `dbt run` succeeded at 12:02:35.994728 after 7.63 seconds
[0m12:02:35.995369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f039329a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03931ec5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03906f24a0>]}
[0m12:02:35.995882 [debug] [MainThread]: Flushing usage events
[0m12:23:56.918192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dcf463b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dc1ce500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dc1ce4a0>]}


============================== 12:23:56.921156 | 6dc35a74-3d38-4087-8741-7a6b3ae4827d ==============================
[0m12:23:56.921156 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:23:56.921987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:23:57.294735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dc35a74-3d38-4087-8741-7a6b3ae4827d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6da3db280>]}
[0m12:23:57.313090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dc35a74-3d38-4087-8741-7a6b3ae4827d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6da3dd990>]}
[0m12:23:57.314109 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:23:57.325989 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:23:57.352902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:23:57.353634 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:23:57.354241 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/revenue/dbtcustomers_sources.yml
[0m12:23:57.380287 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:23:57.422920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dc35a74-3d38-4087-8741-7a6b3ae4827d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6da1d0df0>]}
[0m12:23:57.430861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dc35a74-3d38-4087-8741-7a6b3ae4827d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6da1956c0>]}
[0m12:23:57.431509 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:23:57.432114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dc35a74-3d38-4087-8741-7a6b3ae4827d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6da195660>]}
[0m12:23:57.433950 [info ] [MainThread]: 
[0m12:23:57.435121 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:23:57.436654 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:23:57.437202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:58.814345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:23:58.815111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:59.120348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dc35a74-3d38-4087-8741-7a6b3ae4827d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6da17fd30>]}
[0m12:23:59.121449 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:23:59.122090 [info ] [MainThread]: 
[0m12:23:59.127066 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m12:23:59.127557 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:23:59.128265 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m12:23:59.130196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m12:23:59.131032 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m12:23:59.128971 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:23:59.135115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m12:23:59.136105 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m12:23:59.136765 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:23:59.139904 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:23:59.140732 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 12:23:59.131531 => 12:23:59.140471
[0m12:23:59.141244 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:23:59.137117 => 12:23:59.141009
[0m12:23:59.141703 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m12:23:59.142209 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:23:59.158374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:59.194685 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:23:59.196078 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:23:59.197091 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,dbtC.is_returning_customer
,dbtC.number_of_orders


from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join 'aec-students.dbt_robert.dbtcustomers' as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:23:59.626770 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m12:23:59.627748 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:23:59.632488 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]")
[0m12:24:00.222600 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f6075d9d-f5e1-4e67-9e31-cba9ed13baae&page=queryresults
[0m12:24:00.224347 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:23:59.158923 => 12:24:00.223944
[0m12:24:00.229290 [debug] [Thread-2 (]: Database Error in model dbtcustomers_revenuereport (models/marts/revenuereport/dbtcustomers_revenuereport.sql)
  Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:24:00.230084 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc35a74-3d38-4087-8741-7a6b3ae4827d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6d9d1a4a0>]}
[0m12:24:00.231043 [error] [Thread-2 (]: 2 of 2 ERROR creating sql table model dbt_robert.dbtcustomers_revenuereport .... [[31mERROR[0m in 1.09s]
[0m12:24:00.231860 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:24:03.333854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:92a90c74-7c12-4118-8ac5-36bb89f71afd&page=queryresults
[0m12:24:03.353465 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 12:23:59.142560 => 12:24:03.353218
[0m12:24:03.354485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc35a74-3d38-4087-8741-7a6b3ae4827d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6da207490>]}
[0m12:24:03.355304 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.22s]
[0m12:24:03.356339 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m12:24:03.358509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:03.359092 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m12:24:03.359529 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:24:03.359952 [info ] [MainThread]: 
[0m12:24:03.360525 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m12:24:03.361635 [debug] [MainThread]: Command end result
[0m12:24:03.369279 [info ] [MainThread]: 
[0m12:24:03.369909 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:24:03.370543 [info ] [MainThread]: 
[0m12:24:03.371168 [error] [MainThread]: [33mDatabase Error in model dbtcustomers_revenuereport (models/marts/revenuereport/dbtcustomers_revenuereport.sql)[0m
[0m12:24:03.371928 [error] [MainThread]:   Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]
[0m12:24:03.372567 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:24:03.373132 [info ] [MainThread]: 
[0m12:24:03.373937 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m12:24:03.374909 [debug] [MainThread]: Command `dbt run` failed at 12:24:03.374777 after 6.46 seconds
[0m12:24:03.375394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6dcf463b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6da206d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6da207670>]}
[0m12:24:03.376110 [debug] [MainThread]: Flushing usage events
[0m12:27:06.477353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9edb6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9daca560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9daca4d0>]}


============================== 12:27:06.480165 | 089277b0-a28c-4014-a1de-9ca122c9bff8 ==============================
[0m12:27:06.480165 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:27:06.481204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:27:06.852294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '089277b0-a28c-4014-a1de-9ca122c9bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9eaf2650>]}
[0m12:27:06.870360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '089277b0-a28c-4014-a1de-9ca122c9bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9bfb06d0>]}
[0m12:27:06.871360 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:27:06.883432 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:27:06.910922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:06.911439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:06.918039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '089277b0-a28c-4014-a1de-9ca122c9bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9bda1d20>]}
[0m12:27:06.926605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '089277b0-a28c-4014-a1de-9ca122c9bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9bd699f0>]}
[0m12:27:06.927203 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:27:06.927997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '089277b0-a28c-4014-a1de-9ca122c9bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9bd69a20>]}
[0m12:27:06.929524 [info ] [MainThread]: 
[0m12:27:06.930914 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:27:06.932469 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:27:06.932989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:08.012313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:27:08.013035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:08.284494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '089277b0-a28c-4014-a1de-9ca122c9bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9bd53b80>]}
[0m12:27:08.285618 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:27:08.286566 [info ] [MainThread]: 
[0m12:27:08.290648 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:27:08.291333 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:27:08.292275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:27:08.292703 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:27:08.296475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:27:08.297324 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:27:08.292971 => 12:27:08.297073
[0m12:27:08.297771 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:27:08.355127 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:27:08.356387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:08.357146 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,dbtC.is_returning_customer
,dbtC.number_of_orders


from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join 'aec-students.dbt_robert.dbtcustomers' as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:27:08.722776 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]")
[0m12:27:09.077607 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:843c3389-7ae2-4be5-88a4-0f31e6912769&page=queryresults
[0m12:27:09.079535 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:27:08.298085 => 12:27:09.079048
[0m12:27:09.086827 [debug] [Thread-1 (]: Database Error in model dbtcustomers_revenuereport (models/marts/revenuereport/dbtcustomers_revenuereport.sql)
  Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:27:09.088194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089277b0-a28c-4014-a1de-9ca122c9bff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9bda1720>]}
[0m12:27:09.092898 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers_revenuereport .... [[31mERROR[0m in 0.80s]
[0m12:27:09.094291 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:27:09.097825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:09.098390 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:27:09.098940 [info ] [MainThread]: 
[0m12:27:09.101645 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m12:27:09.103705 [debug] [MainThread]: Command end result
[0m12:27:09.120553 [info ] [MainThread]: 
[0m12:27:09.121736 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:27:09.122503 [info ] [MainThread]: 
[0m12:27:09.123511 [error] [MainThread]: [33mDatabase Error in model dbtcustomers_revenuereport (models/marts/revenuereport/dbtcustomers_revenuereport.sql)[0m
[0m12:27:09.124635 [error] [MainThread]:   Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]
[0m12:27:09.125416 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:27:09.126500 [info ] [MainThread]: 
[0m12:27:09.127219 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:27:09.128375 [debug] [MainThread]: Command `dbt run` failed at 12:27:09.128242 after 2.66 seconds
[0m12:27:09.128840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9edb6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9bd68640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c9bd69780>]}
[0m12:27:09.129653 [debug] [MainThread]: Flushing usage events
[0m12:28:32.560132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cd162350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cc0c6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cc0c64a0>]}


============================== 12:28:32.562898 | fb39bfa8-7647-41dc-878e-e88db1452c3f ==============================
[0m12:28:32.562898 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:28:32.564077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:28:32.937023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb39bfa8-7647-41dc-878e-e88db1452c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ca5ac3a0>]}
[0m12:28:32.954746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb39bfa8-7647-41dc-878e-e88db1452c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ca5b7340>]}
[0m12:28:32.955755 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:28:32.967574 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:28:32.995074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:32.995577 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:33.001992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb39bfa8-7647-41dc-878e-e88db1452c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ca39dea0>]}
[0m12:28:33.010030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb39bfa8-7647-41dc-878e-e88db1452c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ca365b70>]}
[0m12:28:33.010592 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:28:33.011278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb39bfa8-7647-41dc-878e-e88db1452c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ca365ba0>]}
[0m12:28:33.012731 [info ] [MainThread]: 
[0m12:28:33.013928 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:28:33.015569 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:28:33.016131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:34.254723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:28:34.255919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:34.566804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb39bfa8-7647-41dc-878e-e88db1452c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ca353700>]}
[0m12:28:34.567973 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:28:34.568821 [info ] [MainThread]: 
[0m12:28:34.573674 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:28:34.574360 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:28:34.575318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:28:34.575748 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:28:34.579243 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:28:34.580454 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:28:34.576016 => 12:28:34.579801
[0m12:28:34.580914 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:28:34.621339 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:28:34.622285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:34.622894 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,dbtC.is_returning_customer
,dbtC.number_of_orders


from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join 'aec-students.dbt_robert.dbtcustomers' as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:28:34.953795 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]")
[0m12:28:35.340547 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:88bba66e-fa3a-4be6-901a-a90f94b6adb5&page=queryresults
[0m12:28:35.342141 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:28:34.581259 => 12:28:35.341768
[0m12:28:35.346191 [debug] [Thread-1 (]: Database Error in model dbtcustomers_revenuereport (models/marts/revenuereport/dbtcustomers_revenuereport.sql)
  Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:28:35.346916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb39bfa8-7647-41dc-878e-e88db1452c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ca39d6f0>]}
[0m12:28:35.347764 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers_revenuereport .... [[31mERROR[0m in 0.77s]
[0m12:28:35.348897 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:28:35.352564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:35.353111 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:28:35.353560 [info ] [MainThread]: 
[0m12:28:35.354309 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m12:28:35.355525 [debug] [MainThread]: Command end result
[0m12:28:35.362888 [info ] [MainThread]: 
[0m12:28:35.363580 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:28:35.364208 [info ] [MainThread]: 
[0m12:28:35.365131 [error] [MainThread]: [33mDatabase Error in model dbtcustomers_revenuereport (models/marts/revenuereport/dbtcustomers_revenuereport.sql)[0m
[0m12:28:35.365765 [error] [MainThread]:   Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]
[0m12:28:35.366473 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:28:35.367191 [info ] [MainThread]: 
[0m12:28:35.367843 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:28:35.368915 [debug] [MainThread]: Command `dbt run` failed at 12:28:35.368782 after 2.82 seconds
[0m12:28:35.369369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23cd162350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ca5dbac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ca365c60>]}
[0m12:28:35.369961 [debug] [MainThread]: Flushing usage events
[0m12:28:47.501680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8efe350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff7dc6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff7dc64a0>]}


============================== 12:28:47.504561 | 50d6d2e6-6d0b-4264-8b15-fa4ba268f54f ==============================
[0m12:28:47.504561 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:28:47.505382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:28:47.931605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50d6d2e6-6d0b-4264-8b15-fa4ba268f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8de4d90>]}
[0m12:28:47.950304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50d6d2e6-6d0b-4264-8b15-fa4ba268f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff62b1cf0>]}
[0m12:28:47.951327 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:28:47.964498 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:28:47.994893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:28:47.995667 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:28:48.021456 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:28:48.045518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50d6d2e6-6d0b-4264-8b15-fa4ba268f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff61055a0>]}
[0m12:28:48.054605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50d6d2e6-6d0b-4264-8b15-fa4ba268f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff6065720>]}
[0m12:28:48.055199 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:28:48.055984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50d6d2e6-6d0b-4264-8b15-fa4ba268f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff60656c0>]}
[0m12:28:48.057530 [info ] [MainThread]: 
[0m12:28:48.058755 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:28:48.060185 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:28:48.060687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:49.171198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:28:49.172054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:49.483949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50d6d2e6-6d0b-4264-8b15-fa4ba268f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff6053340>]}
[0m12:28:49.485035 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:28:49.485929 [info ] [MainThread]: 
[0m12:28:49.493476 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:28:49.494127 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:28:49.495109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:28:49.495579 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:28:49.499172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:28:49.500001 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:28:49.495980 => 12:28:49.499740
[0m12:28:49.500443 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:28:49.545078 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:28:49.546050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:49.546648 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
--,dbtC.is_returning_customer
--,dbtC.number_of_orders


from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
--left join 'aec-students.dbt_robert.dbtcustomers' as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:28:52.888594 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4ec01c77-45e4-4e11-8d31-004e6e233f05&page=queryresults
[0m12:28:52.904683 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:28:49.500734 => 12:28:52.904347
[0m12:28:52.905625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50d6d2e6-6d0b-4264-8b15-fa4ba268f54f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff6053310>]}
[0m12:28:52.906430 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (5.0 rows, 21.3 MiB processed)[0m in 3.41s]
[0m12:28:52.907444 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:28:52.909354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:52.909733 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:28:52.910139 [info ] [MainThread]: 
[0m12:28:52.911458 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m12:28:52.912923 [debug] [MainThread]: Command end result
[0m12:28:52.920353 [info ] [MainThread]: 
[0m12:28:52.920981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:52.921550 [info ] [MainThread]: 
[0m12:28:52.922162 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:52.923398 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:52.923270 after 5.43 seconds
[0m12:28:52.923827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8efe350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff8e4c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ff6097f10>]}
[0m12:28:52.924340 [debug] [MainThread]: Flushing usage events
[0m12:29:22.272304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e767e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e65ca620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e65ca590>]}


============================== 12:29:22.274994 | 55f3b08d-6832-428c-935f-bfa3b5731800 ==============================
[0m12:29:22.274994 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:29:22.275802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:29:22.646345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55f3b08d-6832-428c-935f-bfa3b5731800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e4aad750>]}
[0m12:29:22.663770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55f3b08d-6832-428c-935f-bfa3b5731800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e4ab74c0>]}
[0m12:29:22.664569 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:29:22.676669 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:29:22.704025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:22.704761 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:29:22.729821 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:29:22.751710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55f3b08d-6832-428c-935f-bfa3b5731800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e48fdba0>]}
[0m12:29:22.759692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55f3b08d-6832-428c-935f-bfa3b5731800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e4869d20>]}
[0m12:29:22.760196 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:29:22.760823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f3b08d-6832-428c-935f-bfa3b5731800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e4869cc0>]}
[0m12:29:22.762160 [info ] [MainThread]: 
[0m12:29:22.763643 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:29:22.766952 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:29:22.767509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:23.815160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:29:23.816017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:24.112679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f3b08d-6832-428c-935f-bfa3b5731800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e4853df0>]}
[0m12:29:24.113759 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:29:24.114545 [info ] [MainThread]: 
[0m12:29:24.121643 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:29:24.122293 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:29:24.123245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:29:24.123671 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:29:24.127283 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:29:24.128136 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:29:24.123941 => 12:29:24.127812
[0m12:29:24.128588 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:29:24.143810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:24.520269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:29:24.521380 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
--,dbtC.is_returning_customer
--,dbtC.number_of_orders


from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join 'aec-students.dbt_robert.dbtcustomers' as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:29:24.769998 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]")
[0m12:29:25.373991 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:914aca8b-92ac-44ba-bdfb-213e215cc778&page=queryresults
[0m12:29:25.375393 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:29:24.128881 => 12:29:25.375066
[0m12:29:25.379147 [debug] [Thread-1 (]: Database Error in model dbtcustomers_revenuereport (models/marts/revenuereport/dbtcustomers_revenuereport.sql)
  Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:29:25.379738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f3b08d-6832-428c-935f-bfa3b5731800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e48ffa30>]}
[0m12:29:25.380592 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers_revenuereport .... [[31mERROR[0m in 1.26s]
[0m12:29:25.381402 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:29:25.383424 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:25.383846 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:29:25.384294 [info ] [MainThread]: 
[0m12:29:25.384794 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m12:29:25.385474 [debug] [MainThread]: Command end result
[0m12:29:25.398103 [info ] [MainThread]: 
[0m12:29:25.398825 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:29:25.399434 [info ] [MainThread]: 
[0m12:29:25.400062 [error] [MainThread]: [33mDatabase Error in model dbtcustomers_revenuereport (models/marts/revenuereport/dbtcustomers_revenuereport.sql)[0m
[0m12:29:25.400816 [error] [MainThread]:   Syntax error: Unexpected string literal 'aec-students.dbt_robert.dbtcustomers' at [26:11]
[0m12:29:25.401742 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:29:25.402582 [info ] [MainThread]: 
[0m12:29:25.403299 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:29:25.404466 [debug] [MainThread]: Command `dbt run` failed at 12:29:25.404317 after 3.14 seconds
[0m12:29:25.404914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e767e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e749a6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92e48b85e0>]}
[0m12:29:25.405491 [debug] [MainThread]: Flushing usage events
[0m12:30:07.984160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7839dca3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783905e5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783905e530>]}


============================== 12:30:07.986771 | 0f0f1d96-e277-4d0c-b5d8-606e67c8ec98 ==============================
[0m12:30:07.986771 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:30:07.987583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:30:08.338457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f0f1d96-e277-4d0c-b5d8-606e67c8ec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7839b749a0>]}
[0m12:30:08.355395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f0f1d96-e277-4d0c-b5d8-606e67c8ec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78371e2380>]}
[0m12:30:08.356143 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:30:08.367091 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:30:08.394052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:30:08.394677 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:30:08.421571 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:30:08.442958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f0f1d96-e277-4d0c-b5d8-606e67c8ec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78370311b0>]}
[0m12:30:08.450434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f0f1d96-e277-4d0c-b5d8-606e67c8ec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7836f99330>]}
[0m12:30:08.450940 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:30:08.451678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f0f1d96-e277-4d0c-b5d8-606e67c8ec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7836f992d0>]}
[0m12:30:08.453156 [info ] [MainThread]: 
[0m12:30:08.454237 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:30:08.455692 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:30:08.456239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:09.533769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:30:09.534653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:09.875740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f0f1d96-e277-4d0c-b5d8-606e67c8ec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7836f98be0>]}
[0m12:30:09.876987 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:30:09.877787 [info ] [MainThread]: 
[0m12:30:09.888322 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:30:09.888985 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:30:09.889878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:30:09.890377 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:30:09.893886 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:30:09.895104 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:30:09.890688 => 12:30:09.894639
[0m12:30:09.895565 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:30:09.910728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:10.239072 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:30:10.239869 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
--,dbtC.is_returning_customer
--,dbtC.number_of_orders


from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:30:13.939430 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2604e167-d91a-441f-be38-cf9c95b07b54&page=queryresults
[0m12:30:13.958614 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:30:09.895913 => 12:30:13.958352
[0m12:30:13.959499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0f1d96-e277-4d0c-b5d8-606e67c8ec98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7837033b50>]}
[0m12:30:13.960235 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (5.0 rows, 21.3 MiB processed)[0m in 4.07s]
[0m12:30:13.961350 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:30:13.963428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:13.963801 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:30:13.964220 [info ] [MainThread]: 
[0m12:30:13.964854 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m12:30:13.965811 [debug] [MainThread]: Command end result
[0m12:30:13.973658 [info ] [MainThread]: 
[0m12:30:13.974283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:30:13.974897 [info ] [MainThread]: 
[0m12:30:13.975686 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:30:13.976582 [debug] [MainThread]: Command `dbt run` succeeded at 12:30:13.976456 after 6.00 seconds
[0m12:30:13.977016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7839dca3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f783998ada0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7836fd7af0>]}
[0m12:30:13.977574 [debug] [MainThread]: Flushing usage events
[0m12:30:27.032511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31c88a440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31b7ca620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31b7ca590>]}


============================== 12:30:27.035221 | 5fdcb5f0-2b7c-44cc-adca-6a9ff45f888c ==============================
[0m12:30:27.035221 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:30:27.036041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:30:27.415406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fdcb5f0-2b7c-44cc-adca-6a9ff45f888c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319caf220>]}
[0m12:30:27.434980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fdcb5f0-2b7c-44cc-adca-6a9ff45f888c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319cb1990>]}
[0m12:30:27.435824 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:30:27.446624 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:30:27.473390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:30:27.474034 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:30:27.498386 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:30:27.519617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fdcb5f0-2b7c-44cc-adca-6a9ff45f888c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319afd960>]}
[0m12:30:27.527439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fdcb5f0-2b7c-44cc-adca-6a9ff45f888c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319a65a80>]}
[0m12:30:27.527940 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:30:27.528690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fdcb5f0-2b7c-44cc-adca-6a9ff45f888c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319a65b70>]}
[0m12:30:27.530061 [info ] [MainThread]: 
[0m12:30:27.531435 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:30:27.532789 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:30:27.533330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:28.592569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:30:28.593275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:28.884677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fdcb5f0-2b7c-44cc-adca-6a9ff45f888c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319a53a90>]}
[0m12:30:28.886157 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:30:28.887006 [info ] [MainThread]: 
[0m12:30:28.894852 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:30:28.895504 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:30:28.896538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:30:28.897137 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:30:28.900997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:30:28.901828 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:30:28.897432 => 12:30:28.901569
[0m12:30:28.902300 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:30:28.917822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:29.283433 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:30:29.284320 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,dbtC.is_returning_customer
,dbtC.number_of_orders


from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:30:31.991713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:22ed8cea-0dfc-4e31-998d-cf4b98afa290&page=queryresults
[0m12:30:32.008801 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:30:28.902642 => 12:30:32.008568
[0m12:30:32.009715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fdcb5f0-2b7c-44cc-adca-6a9ff45f888c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319aff940>]}
[0m12:30:32.010495 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (5.0 rows, 21.3 MiB processed)[0m in 3.11s]
[0m12:30:32.011664 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:30:32.013920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:32.014286 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:30:32.014797 [info ] [MainThread]: 
[0m12:30:32.015404 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m12:30:32.016551 [debug] [MainThread]: Command end result
[0m12:30:32.024351 [info ] [MainThread]: 
[0m12:30:32.024989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:30:32.025569 [info ] [MainThread]: 
[0m12:30:32.026178 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:30:32.027268 [debug] [MainThread]: Command `dbt run` succeeded at 12:30:32.027139 after 5.00 seconds
[0m12:30:32.027697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31c88a440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31956ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa319cb39d0>]}
[0m12:30:32.028229 [debug] [MainThread]: Flushing usage events
[0m12:31:21.119039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0115e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bffeca500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bffeca4a0>]}


============================== 12:31:21.121718 | b843c1fe-3db9-403c-ab02-63e9bb9cafe3 ==============================
[0m12:31:21.121718 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:31:21.122489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:31:21.569908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b843c1fe-3db9-403c-ab02-63e9bb9cafe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c00d33520>]}
[0m12:31:21.587414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b843c1fe-3db9-403c-ab02-63e9bb9cafe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfe3ad630>]}
[0m12:31:21.588176 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:31:21.599264 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:31:21.625712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:21.626088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:21.631994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b843c1fe-3db9-403c-ab02-63e9bb9cafe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfe195c00>]}
[0m12:31:21.639736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b843c1fe-3db9-403c-ab02-63e9bb9cafe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfe1658d0>]}
[0m12:31:21.640260 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:31:21.640824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b843c1fe-3db9-403c-ab02-63e9bb9cafe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfe165900>]}
[0m12:31:21.642660 [info ] [MainThread]: 
[0m12:31:21.643670 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:31:21.645111 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:31:21.645608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:22.694852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:31:22.695692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:22.964974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b843c1fe-3db9-403c-ab02-63e9bb9cafe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfe34b460>]}
[0m12:31:22.966432 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:31:22.967251 [info ] [MainThread]: 
[0m12:31:22.971834 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m12:31:22.972320 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:31:22.972940 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m12:31:22.973781 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:31:22.974762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m12:31:22.975646 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m12:31:22.976182 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m12:31:22.976826 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:31:22.980516 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m12:31:22.984167 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:31:22.985025 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 12:31:22.977161 => 12:31:22.984776
[0m12:31:22.985672 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:31:22.980864 => 12:31:22.985402
[0m12:31:22.986056 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m12:31:22.986550 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:31:23.001777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:23.004046 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:31:23.465577 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:31:23.464038 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m12:31:23.467059 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,dbtC.is_returning_customer
,dbtC.number_of_orders


from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:31:23.467543 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:31:26.497359 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:906b0819-643b-46cd-96cc-98228a6895d9&page=queryresults
[0m12:31:26.521340 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:31:23.002112 => 12:31:26.521110
[0m12:31:26.522259 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b843c1fe-3db9-403c-ab02-63e9bb9cafe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfe34bac0>]}
[0m12:31:26.523068 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (5.0 rows, 21.3 MiB processed)[0m in 3.55s]
[0m12:31:26.524173 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:31:27.703490 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:78f8cafb-6394-43b0-9729-e3dd12b479c2&page=queryresults
[0m12:31:27.706659 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 12:31:22.986887 => 12:31:27.706374
[0m12:31:27.707754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b843c1fe-3db9-403c-ab02-63e9bb9cafe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfe234a30>]}
[0m12:31:27.708650 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.73s]
[0m12:31:27.709839 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m12:31:27.712265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:27.712640 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m12:31:27.712998 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:31:27.713445 [info ] [MainThread]: 
[0m12:31:27.714206 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m12:31:27.715860 [debug] [MainThread]: Command end result
[0m12:31:27.723339 [info ] [MainThread]: 
[0m12:31:27.724058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:31:27.724615 [info ] [MainThread]: 
[0m12:31:27.725579 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:31:27.726787 [debug] [MainThread]: Command `dbt run` succeeded at 12:31:27.726652 after 6.62 seconds
[0m12:31:27.727261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c0115e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfe3ad630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfe34bbe0>]}
[0m12:31:27.727733 [debug] [MainThread]: Flushing usage events
[0m12:40:52.799911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2fb223e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2e8ce5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2e8ce530>]}


============================== 12:40:52.802566 | 9cd33d5c-c932-42a0-8ddc-bc58c2b71d99 ==============================
[0m12:40:52.802566 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:40:52.803368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:40:53.145487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cd33d5c-c932-42a0-8ddc-bc58c2b71d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2f8cd300>]}
[0m12:40:53.163163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cd33d5c-c932-42a0-8ddc-bc58c2b71d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2cdb2290>]}
[0m12:40:53.163930 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:40:53.174729 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:40:53.201042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:53.201600 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:40:53.225480 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:40:53.248544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cd33d5c-c932-42a0-8ddc-bc58c2b71d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2cc052a0>]}
[0m12:40:53.255841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cd33d5c-c932-42a0-8ddc-bc58c2b71d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2cb65420>]}
[0m12:40:53.256345 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:40:53.257014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cd33d5c-c932-42a0-8ddc-bc58c2b71d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2cb653c0>]}
[0m12:40:53.258277 [info ] [MainThread]: 
[0m12:40:53.259820 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:40:53.261742 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:40:53.262286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:54.319370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:40:54.320201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:54.609251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cd33d5c-c932-42a0-8ddc-bc58c2b71d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2cb64cd0>]}
[0m12:40:54.610242 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:40:54.611052 [info ] [MainThread]: 
[0m12:40:54.618413 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:40:54.619051 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:40:54.619953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:40:54.620389 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:40:54.624282 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:40:54.625094 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:40:54.620665 => 12:40:54.624837
[0m12:40:54.625544 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:40:54.644296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:55.010062 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:40:55.010914 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,O.total
,dbtC.is_returning_customer
,dbtC.number_of_orders


from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:40:58.839037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cd6e845c-dbb4-4290-bbda-444b11a01e09&page=queryresults
[0m12:40:58.856755 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:40:54.625878 => 12:40:58.856526
[0m12:40:58.857650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cd33d5c-c932-42a0-8ddc-bc58c2b71d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2cc079a0>]}
[0m12:40:58.858418 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (5.0 rows, 43.6 MiB processed)[0m in 4.24s]
[0m12:40:58.859547 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:40:58.861702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:58.862106 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:40:58.862532 [info ] [MainThread]: 
[0m12:40:58.863350 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.60 seconds (5.60s).
[0m12:40:58.864697 [debug] [MainThread]: Command end result
[0m12:40:58.872343 [info ] [MainThread]: 
[0m12:40:58.872947 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:58.873495 [info ] [MainThread]: 
[0m12:40:58.874160 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:40:58.875230 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:58.875103 after 6.08 seconds
[0m12:40:58.875649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2fb223e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2c66c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2f696da0>]}
[0m12:40:58.876539 [debug] [MainThread]: Flushing usage events
[0m12:42:36.954606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b12b4e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b1190e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b1190e500>]}


============================== 12:42:36.957223 | 3911a0af-bf22-4c7c-9ded-affd491df3a9 ==============================
[0m12:42:36.957223 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:42:36.958038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:42:37.303012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3911a0af-bf22-4c7c-9ded-affd491df3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0fff7220>]}
[0m12:42:37.324350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3911a0af-bf22-4c7c-9ded-affd491df3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0fff9990>]}
[0m12:42:37.325444 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:42:37.336618 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:42:37.362853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:37.363454 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:42:37.388354 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:42:37.409793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3911a0af-bf22-4c7c-9ded-affd491df3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0fe35930>]}
[0m12:42:37.417155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3911a0af-bf22-4c7c-9ded-affd491df3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0fdada50>]}
[0m12:42:37.417677 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:42:37.418560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3911a0af-bf22-4c7c-9ded-affd491df3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0fdadb40>]}
[0m12:42:37.419917 [info ] [MainThread]: 
[0m12:42:37.421138 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:42:37.422547 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:42:37.423163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:38.462818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:42:38.463638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:38.769464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3911a0af-bf22-4c7c-9ded-affd491df3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0fd97a60>]}
[0m12:42:38.770668 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:42:38.771319 [info ] [MainThread]: 
[0m12:42:38.778551 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:42:38.779198 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:42:38.780132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:42:38.780591 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:42:38.784388 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:42:38.785201 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:42:38.781046 => 12:42:38.784945
[0m12:42:38.785651 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:42:38.801508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:42:39.154093 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:42:39.154979 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,O.total
,dbtC.is_returning_customer
,dbtC.number_of_orders


from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:42:42.851721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:af8edc50-c359-487d-b348-d8376b933cf0&page=queryresults
[0m12:42:42.869643 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:42:38.786728 => 12:42:42.869425
[0m12:42:42.870503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3911a0af-bf22-4c7c-9ded-affd491df3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0fe37a90>]}
[0m12:42:42.871258 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (5.0 rows, 46.5 MiB processed)[0m in 4.09s]
[0m12:42:42.872271 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:42:42.874136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:42.874585 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:42:42.875409 [info ] [MainThread]: 
[0m12:42:42.875959 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m12:42:42.876970 [debug] [MainThread]: Command end result
[0m12:42:42.884637 [info ] [MainThread]: 
[0m12:42:42.885265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:42.885821 [info ] [MainThread]: 
[0m12:42:42.886556 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:42:42.887520 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:42.887392 after 5.94 seconds
[0m12:42:42.887958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b12b4e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0f8b0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0fff9a20>]}
[0m12:42:42.888462 [debug] [MainThread]: Flushing usage events
[0m12:44:11.351573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924536e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92442c6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92442c64d0>]}


============================== 12:44:11.354269 | 822371ea-9d96-400d-9580-94eaba538ba0 ==============================
[0m12:44:11.354269 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:44:11.355291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:44:11.699227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '822371ea-9d96-400d-9580-94eaba538ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92452a2650>]}
[0m12:44:11.718123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '822371ea-9d96-400d-9580-94eaba538ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92427b1660>]}
[0m12:44:11.718901 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:44:11.731662 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:44:11.760283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:44:11.760996 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:44:11.786718 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:44:11.808859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '822371ea-9d96-400d-9580-94eaba538ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9242605720>]}
[0m12:44:11.816223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '822371ea-9d96-400d-9580-94eaba538ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9242569870>]}
[0m12:44:11.816747 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:44:11.817490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822371ea-9d96-400d-9580-94eaba538ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92425698a0>]}
[0m12:44:11.818909 [info ] [MainThread]: 
[0m12:44:11.820157 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:44:11.821579 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:44:11.822127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:12.878425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:44:12.879170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:13.171711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822371ea-9d96-400d-9580-94eaba538ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9242553850>]}
[0m12:44:13.172961 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:44:13.173968 [info ] [MainThread]: 
[0m12:44:13.181988 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:44:13.182684 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:44:13.183826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:44:13.184572 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:44:13.188413 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:44:13.189212 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:44:13.184850 => 12:44:13.188923
[0m12:44:13.189650 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:44:13.204607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:13.524607 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:44:13.525472 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,O.total
,P.category
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:44:17.883121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:bcfa2594-4663-440d-9ed3-7bdef661841a&page=queryresults
[0m12:44:17.900546 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:44:13.189935 => 12:44:17.900317
[0m12:44:17.901478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822371ea-9d96-400d-9580-94eaba538ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9242079f00>]}
[0m12:44:17.902275 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (5.0 rows, 46.5 MiB processed)[0m in 4.72s]
[0m12:44:17.903455 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:44:17.905954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:17.906369 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:44:17.906799 [info ] [MainThread]: 
[0m12:44:17.907385 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.09 seconds (6.09s).
[0m12:44:17.908556 [debug] [MainThread]: Command end result
[0m12:44:17.915983 [info ] [MainThread]: 
[0m12:44:17.916603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:44:17.917174 [info ] [MainThread]: 
[0m12:44:17.917998 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:44:17.918948 [debug] [MainThread]: Command `dbt run` succeeded at 12:44:17.918822 after 6.57 seconds
[0m12:44:17.919372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924536e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f924206c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92427cceb0>]}
[0m12:44:17.919887 [debug] [MainThread]: Flushing usage events
[0m12:44:23.454743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072e20e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072cf0e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072cf0e440>]}


============================== 12:44:23.457341 | 1cbff57f-5ee4-4d98-ab4f-03413953d419 ==============================
[0m12:44:23.457341 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:44:23.458139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:44:23.830668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cbff57f-5ee4-4d98-ab4f-03413953d419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072e0f8d90>]}
[0m12:44:23.847430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cbff57f-5ee4-4d98-ab4f-03413953d419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072b5f56f0>]}
[0m12:44:23.848185 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:44:23.858775 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:44:23.884748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:44:23.885106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:44:23.890965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cbff57f-5ee4-4d98-ab4f-03413953d419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072b3e1b40>]}
[0m12:44:23.898403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cbff57f-5ee4-4d98-ab4f-03413953d419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072b3ad810>]}
[0m12:44:23.898865 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:44:23.899577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cbff57f-5ee4-4d98-ab4f-03413953d419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072b3ad840>]}
[0m12:44:23.901445 [info ] [MainThread]: 
[0m12:44:23.902574 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:44:23.903999 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:44:23.904525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:24.995873 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m12:44:24.997057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:25.296833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cbff57f-5ee4-4d98-ab4f-03413953d419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072b397eb0>]}
[0m12:44:25.298076 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:44:25.299177 [info ] [MainThread]: 
[0m12:44:25.303127 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m12:44:25.303605 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:44:25.304617 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m12:44:25.305732 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:44:25.306960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m12:44:25.307764 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_aec-students, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:44:25.308276 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m12:44:25.308747 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:44:25.312399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m12:44:25.315432 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:44:25.316403 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:44:25.312750 => 12:44:25.316146
[0m12:44:25.319189 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:44:25.318395 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 12:44:25.309085 => 12:44:25.316666
[0m12:44:25.335013 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:44:25.335500 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m12:44:25.340143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:25.772410 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:44:25.773350 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,O.total
,P.category
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:44:25.790388 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m12:44:25.791062 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:44:29.322768 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6b4ef890-b740-440e-bc1f-4d907d2a4c94&page=queryresults
[0m12:44:29.347244 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:44:25.319730 => 12:44:29.347018
[0m12:44:29.348127 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cbff57f-5ee4-4d98-ab4f-03413953d419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072b27c910>]}
[0m12:44:29.348873 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (5.0 rows, 46.5 MiB processed)[0m in 4.04s]
[0m12:44:29.349950 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:44:29.460566 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a05e8c55-7f78-40b9-a859-f158cdd32077&page=queryresults
[0m12:44:29.463561 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 12:44:25.337468 => 12:44:29.463299
[0m12:44:29.464619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cbff57f-5ee4-4d98-ab4f-03413953d419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072b2cf9a0>]}
[0m12:44:29.465524 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.16s]
[0m12:44:29.466751 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m12:44:29.470441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:29.470819 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:44:29.471174 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m12:44:29.471648 [info ] [MainThread]: 
[0m12:44:29.472210 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m12:44:29.473715 [debug] [MainThread]: Command end result
[0m12:44:29.482180 [info ] [MainThread]: 
[0m12:44:29.482848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:44:29.483413 [info ] [MainThread]: 
[0m12:44:29.484012 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:44:29.485200 [debug] [MainThread]: Command `dbt run` succeeded at 12:44:29.485010 after 6.04 seconds
[0m12:44:29.485824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072e20e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072e1605b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072b5f56f0>]}
[0m12:44:29.486449 [debug] [MainThread]: Flushing usage events
[0m12:48:34.853432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75c0863b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75ae0a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75ae0a500>]}


============================== 12:48:34.856107 | fcdbbb90-4f02-4d4d-a43b-e661272a3402 ==============================
[0m12:48:34.856107 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:48:34.856919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:48:35.225660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcdbbb90-4f02-4d4d-a43b-e661272a3402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7594f1780>]}
[0m12:48:35.242341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcdbbb90-4f02-4d4d-a43b-e661272a3402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7594fb430>]}
[0m12:48:35.243075 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:48:35.253364 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:48:35.281381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:48:35.281975 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:48:35.306169 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:48:35.327037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcdbbb90-4f02-4d4d-a43b-e661272a3402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff759335b10>]}
[0m12:48:35.334365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcdbbb90-4f02-4d4d-a43b-e661272a3402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7592a9c60>]}
[0m12:48:35.334837 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:48:35.335494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcdbbb90-4f02-4d4d-a43b-e661272a3402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7592a9c90>]}
[0m12:48:35.336886 [info ] [MainThread]: 
[0m12:48:35.338165 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:48:35.339627 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:48:35.340201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:36.466026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:48:36.466885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:36.835698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcdbbb90-4f02-4d4d-a43b-e661272a3402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff759297850>]}
[0m12:48:36.836813 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:48:36.837787 [info ] [MainThread]: 
[0m12:48:36.845914 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:48:36.846582 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:48:36.847370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:48:36.847802 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:48:36.851961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:48:36.853004 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:48:36.848110 => 12:48:36.852521
[0m12:48:36.853527 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:48:36.868704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:37.231615 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:48:37.232500 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:48:41.399493 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:63192181-9aa7-4c53-aedc-44b0fee8b0de&page=queryresults
[0m12:48:41.416845 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:48:36.853828 => 12:48:41.416629
[0m12:48:41.417689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcdbbb90-4f02-4d4d-a43b-e661272a3402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff759337af0>]}
[0m12:48:41.418455 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (5.0 rows, 45.1 MiB processed)[0m in 4.57s]
[0m12:48:41.419433 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:48:41.421307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:41.421675 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:48:41.422093 [info ] [MainThread]: 
[0m12:48:41.423467 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m12:48:41.424970 [debug] [MainThread]: Command end result
[0m12:48:41.432168 [info ] [MainThread]: 
[0m12:48:41.432803 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:41.433375 [info ] [MainThread]: 
[0m12:48:41.433980 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:48:41.435386 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:41.435193 after 6.59 seconds
[0m12:48:41.435946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75c0863b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff758db0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75951e8f0>]}
[0m12:48:41.436846 [debug] [MainThread]: Flushing usage events
[0m12:48:45.696072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2b9a6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2a70e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2a70e440>]}


============================== 12:48:45.698546 | 0f406e68-d94e-4582-a1e7-51095e91e201 ==============================
[0m12:48:45.698546 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:48:45.699293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:48:46.046728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f406e68-d94e-4582-a1e7-51095e91e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2b890d90>]}
[0m12:48:46.063672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f406e68-d94e-4582-a1e7-51095e91e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa28df53f0>]}
[0m12:48:46.064437 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:48:46.075045 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:48:46.100730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:46.101094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:46.106747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f406e68-d94e-4582-a1e7-51095e91e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa28be1990>]}
[0m12:48:46.114279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f406e68-d94e-4582-a1e7-51095e91e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa28bad660>]}
[0m12:48:46.114817 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:48:46.115479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f406e68-d94e-4582-a1e7-51095e91e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa28bad690>]}
[0m12:48:46.117403 [info ] [MainThread]: 
[0m12:48:46.118366 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:48:46.119761 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:48:46.120280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:47.689649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:48:47.690526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:48.006924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f406e68-d94e-4582-a1e7-51095e91e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa28b971f0>]}
[0m12:48:48.008125 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:48:48.008780 [info ] [MainThread]: 
[0m12:48:48.013409 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m12:48:48.013853 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:48:48.014520 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m12:48:48.015628 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:48:48.016828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m12:48:48.017750 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m12:48:48.018251 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m12:48:48.018758 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:48:48.022435 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m12:48:48.025365 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:48:48.026274 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 12:48:48.019088 => 12:48:48.026043
[0m12:48:48.026884 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:48:48.022761 => 12:48:48.026624
[0m12:48:48.027268 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m12:48:48.027755 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:48:48.042733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:48.044991 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:48:48.480396 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m12:48:48.482231 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:48:48.483100 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:48:48.485219 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:48:52.232187 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:70650887-2413-450d-9284-4a715f4b82fe&page=queryresults
[0m12:48:52.255026 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:48:48.043060 => 12:48:52.254817
[0m12:48:52.255870 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f406e68-d94e-4582-a1e7-51095e91e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa28ae1a20>]}
[0m12:48:52.256598 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (5.0 rows, 45.1 MiB processed)[0m in 4.24s]
[0m12:48:52.257616 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:48:52.390969 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:21ecd8f4-16ac-49c9-acf7-98afe8fce060&page=queryresults
[0m12:48:52.394424 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 12:48:48.028215 => 12:48:52.393925
[0m12:48:52.395587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f406e68-d94e-4582-a1e7-51095e91e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa28a7c790>]}
[0m12:48:52.396782 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.38s]
[0m12:48:52.398424 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m12:48:52.400381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:52.400765 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m12:48:52.401123 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:48:52.401534 [info ] [MainThread]: 
[0m12:48:52.402102 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.28 seconds (6.28s).
[0m12:48:52.403620 [debug] [MainThread]: Command end result
[0m12:48:52.411014 [info ] [MainThread]: 
[0m12:48:52.411745 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:52.412344 [info ] [MainThread]: 
[0m12:48:52.412925 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:48:52.414000 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:52.413877 after 6.73 seconds
[0m12:48:52.414451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2b9a6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2b777850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa28aa82b0>]}
[0m12:48:52.415026 [debug] [MainThread]: Flushing usage events
[0m12:49:52.203652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d6e46350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d5c0a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d5c0a440>]}


============================== 12:49:52.206113 | bf2d7b8c-6849-4d6d-8ac3-9961bf6ee156 ==============================
[0m12:49:52.206113 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:49:52.207092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:49:52.573070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf2d7b8c-6849-4d6d-8ac3-9961bf6ee156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d6d2cd90>]}
[0m12:49:52.590482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf2d7b8c-6849-4d6d-8ac3-9961bf6ee156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d42f1600>]}
[0m12:49:52.591221 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:49:52.601970 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:49:52.628214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:52.628847 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:49:52.654166 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:49:52.676468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf2d7b8c-6849-4d6d-8ac3-9961bf6ee156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d41357b0>]}
[0m12:49:52.684063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf2d7b8c-6849-4d6d-8ac3-9961bf6ee156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d40ad930>]}
[0m12:49:52.684596 [info ] [MainThread]: Found 2 models, 8 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:49:52.685339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2d7b8c-6849-4d6d-8ac3-9961bf6ee156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d40ad8d0>]}
[0m12:49:52.687151 [info ] [MainThread]: 
[0m12:49:52.688153 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:49:52.689557 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:49:52.690090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:53.718053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:49:53.718915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:54.026748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf2d7b8c-6849-4d6d-8ac3-9961bf6ee156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d4093b20>]}
[0m12:49:54.028217 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:49:54.029020 [info ] [MainThread]: 
[0m12:49:54.035869 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m12:49:54.036339 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:49:54.036905 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m12:49:54.037642 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:49:54.038900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m12:49:54.039764 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m12:49:54.040273 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m12:49:54.040759 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:49:54.044353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m12:49:54.047235 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:49:54.048119 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 12:49:54.041094 => 12:49:54.047886
[0m12:49:54.048665 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:49:54.044725 => 12:49:54.048400
[0m12:49:54.049063 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m12:49:54.049534 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:49:54.064666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:54.066949 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:49:54.551490 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:49:54.552419 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m12:49:54.577044 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m12:49:54.577776 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:49:58.211440 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4c559148-c482-4082-8040-4eb39638ce75&page=queryresults
[0m12:49:58.229060 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:49:54.064991 => 12:49:58.228834
[0m12:49:58.229978 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2d7b8c-6849-4d6d-8ac3-9961bf6ee156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d4137970>]}
[0m12:49:58.230773 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.19s]
[0m12:49:58.231843 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:49:58.558027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e5de1df4-1aef-43cc-b23d-d25b4650de8e&page=queryresults
[0m12:49:58.560495 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 12:49:54.049849 => 12:49:58.560287
[0m12:49:58.561355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf2d7b8c-6849-4d6d-8ac3-9961bf6ee156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d41376a0>]}
[0m12:49:58.562066 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.52s]
[0m12:49:58.563022 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m12:49:58.565161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:58.565522 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m12:49:58.565869 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:49:58.566279 [info ] [MainThread]: 
[0m12:49:58.567122 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m12:49:58.568605 [debug] [MainThread]: Command end result
[0m12:49:58.583367 [info ] [MainThread]: 
[0m12:49:58.584162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:58.585704 [info ] [MainThread]: 
[0m12:49:58.586491 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:49:58.588006 [debug] [MainThread]: Command `dbt run` succeeded at 12:49:58.587819 after 6.39 seconds
[0m12:49:58.588743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d6e46350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d843eef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34d6c13eb0>]}
[0m12:49:58.589527 [debug] [MainThread]: Flushing usage events
[0m12:56:01.075759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80b18a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80a0c64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80a0c6440>]}


============================== 12:56:01.078350 | 6ffa095e-4557-47f6-8c17-dff23ae8cbf0 ==============================
[0m12:56:01.078350 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:56:01.079317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:56:01.513416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ffa095e-4557-47f6-8c17-dff23ae8cbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80b070d90>]}
[0m12:56:01.530824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ffa095e-4557-47f6-8c17-dff23ae8cbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8085ad690>]}
[0m12:56:01.531636 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:56:01.542676 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:56:01.569882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:56:01.570691 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/revenue/dbtcustomers_schema.yml
[0m12:56:01.663080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ffa095e-4557-47f6-8c17-dff23ae8cbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8084249a0>]}
[0m12:56:01.672182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ffa095e-4557-47f6-8c17-dff23ae8cbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8083c2590>]}
[0m12:56:01.672771 [info ] [MainThread]: Found 2 models, 19 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:56:01.673478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ffa095e-4557-47f6-8c17-dff23ae8cbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8083c21d0>]}
[0m12:56:01.675623 [info ] [MainThread]: 
[0m12:56:01.676624 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:56:01.678051 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:56:01.678592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:02.714414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:56:02.715272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:03.005114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ffa095e-4557-47f6-8c17-dff23ae8cbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8083c27a0>]}
[0m12:56:03.006276 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:56:03.007079 [info ] [MainThread]: 
[0m12:56:03.011379 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m12:56:03.011900 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:56:03.012534 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m12:56:03.013432 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:56:03.014717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m12:56:03.015582 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m12:56:03.016107 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m12:56:03.016584 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:56:03.020130 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m12:56:03.023184 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:56:03.024122 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 12:56:03.016905 => 12:56:03.023875
[0m12:56:03.024733 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:56:03.020481 => 12:56:03.024466
[0m12:56:03.025096 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m12:56:03.025551 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:56:03.040628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:03.042927 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:56:03.486015 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:56:03.487752 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m12:56:03.488664 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m12:56:03.490990 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:56:06.914430 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ee94fff2-a59a-4d11-ab44-75f0c4cbd168&page=queryresults
[0m12:56:06.935732 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:56:03.040986 => 12:56:06.935517
[0m12:56:06.936435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e258fe34-7c32-4a0d-89dd-4946da8bdf3f&page=queryresults
[0m12:56:06.937341 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ffa095e-4557-47f6-8c17-dff23ae8cbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8085adf90>]}
[0m12:56:06.939641 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 12:56:03.025885 => 12:56:06.939440
[0m12:56:06.940401 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 3.92s]
[0m12:56:06.941710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ffa095e-4557-47f6-8c17-dff23ae8cbf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8082cef50>]}
[0m12:56:06.942545 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:56:06.943560 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 3.93s]
[0m12:56:06.944653 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m12:56:06.946944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:06.947323 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m12:56:06.947798 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m12:56:06.948211 [info ] [MainThread]: 
[0m12:56:06.948864 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m12:56:06.949914 [debug] [MainThread]: Command end result
[0m12:56:06.958164 [info ] [MainThread]: 
[0m12:56:06.958901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:06.959590 [info ] [MainThread]: 
[0m12:56:06.960655 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:56:06.961561 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:06.961433 after 5.89 seconds
[0m12:56:06.961992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80b18a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8083ec940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd80b0d85b0>]}
[0m12:56:06.962806 [debug] [MainThread]: Flushing usage events
[0m12:59:42.377269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb251032410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24fe0e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24fe0e650>]}


============================== 12:59:42.379970 | 14eceb7d-7808-4481-80de-67342513f97d ==============================
[0m12:59:42.379970 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:59:42.380799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:59:42.729169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14eceb7d-7808-4481-80de-67342513f97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb250f95ba0>]}
[0m12:59:42.746504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14eceb7d-7808-4481-80de-67342513f97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e4dd570>]}
[0m12:59:42.747205 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:59:42.760300 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:59:42.788135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:59:42.788509 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:59:42.794700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14eceb7d-7808-4481-80de-67342513f97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e2e40d0>]}
[0m12:59:42.796800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14eceb7d-7808-4481-80de-67342513f97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e36f8b0>]}
[0m12:59:42.797297 [info ] [MainThread]: Found 2 models, 19 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:59:42.797851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14eceb7d-7808-4481-80de-67342513f97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e36f850>]}
[0m12:59:42.800198 [info ] [MainThread]: 
[0m12:59:42.801486 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:59:42.803160 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m12:59:42.803655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:43.851008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14eceb7d-7808-4481-80de-67342513f97d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e36f7f0>]}
[0m12:59:43.852305 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:59:43.853144 [info ] [MainThread]: 
[0m12:59:43.857585 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m12:59:43.858059 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:59:43.858876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m12:59:43.859822 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m12:59:43.860476 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m12:59:43.860964 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:59:43.864522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m12:59:43.867519 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:59:43.868493 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 12:59:43.861297 => 12:59:43.868237
[0m12:59:43.869928 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m12:59:43.869378 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:59:43.864850 => 12:59:43.869031
[0m12:59:43.870657 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 12:59:43.870394 => 12:59:43.870419
[0m12:59:43.871120 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:59:43.872095 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m12:59:43.872619 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:59:43.872387 => 12:59:43.872400
[0m12:59:43.873470 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m12:59:43.874454 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:59:43.875164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now test.dbt_robert.not_null_dbtcustomers_email.6c384897fd)
[0m12:59:43.876571 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m12:59:43.875745 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m12:59:43.889259 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_email.6c384897fd"
[0m12:59:43.889980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2)
[0m12:59:43.890676 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m12:59:43.891169 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_email.6c384897fd (compile): 12:59:43.876859 => 12:59:43.890948
[0m12:59:43.895673 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2"
[0m12:59:43.896203 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m12:59:43.896998 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_email.6c384897fd (execute): 12:59:43.896743 => 12:59:43.896759
[0m12:59:43.897460 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2 (compile): 12:59:43.891460 => 12:59:43.897245
[0m12:59:43.898413 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_email.6c384897fd
[0m12:59:43.898911 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m12:59:43.899449 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m12:59:43.900091 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2 (execute): 12:59:43.899843 => 12:59:43.899856
[0m12:59:43.900771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_email.6c384897fd, now test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c)
[0m12:59:43.901750 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2
[0m12:59:43.902199 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m12:59:43.902743 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m12:59:43.907192 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c"
[0m12:59:43.907922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_first_order_at.f903861eb2, now test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513)
[0m12:59:43.908672 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m12:59:43.909149 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (compile): 12:59:43.903108 => 12:59:43.908930
[0m12:59:43.913385 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513"
[0m12:59:43.913899 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m12:59:43.914741 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c (execute): 12:59:43.914481 => 12:59:43.914495
[0m12:59:43.915191 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513 (compile): 12:59:43.909452 => 12:59:43.914984
[0m12:59:43.916140 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c
[0m12:59:43.916617 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m12:59:43.917152 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m12:59:43.917781 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513 (execute): 12:59:43.917538 => 12:59:43.917550
[0m12:59:43.918500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_id.bcdc85008c, now test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a)
[0m12:59:43.919508 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513
[0m12:59:43.919969 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m12:59:43.920518 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m12:59:43.928232 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a"
[0m12:59:43.929283 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_name.b8d85cc513, now test.dbt_robert.unique_dbtcustomers_email.cc133877c6)
[0m12:59:43.929995 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m12:59:43.930544 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a (compile): 12:59:43.920901 => 12:59:43.930266
[0m12:59:43.936779 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_email.cc133877c6"
[0m12:59:43.937276 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m12:59:43.938081 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a (execute): 12:59:43.937831 => 12:59:43.937847
[0m12:59:43.938632 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_email.cc133877c6 (compile): 12:59:43.930854 => 12:59:43.938337
[0m12:59:43.939833 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a
[0m12:59:43.940327 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m12:59:43.940886 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m12:59:43.942881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_number_of_orders.7b413ffd0a, now test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c)
[0m12:59:43.943447 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m12:59:43.941646 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_email.cc133877c6 (execute): 12:59:43.941274 => 12:59:43.941288
[0m12:59:43.947668 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c"
[0m12:59:43.948685 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_email.cc133877c6
[0m12:59:43.949460 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m12:59:43.950408 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.unique_dbtcustomers_email.cc133877c6, now test.dbt_robert.unique_dbtcustomers_id.0c18a9f245)
[0m12:59:43.951116 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m12:59:43.951833 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c (compile): 12:59:43.943741 => 12:59:43.951548
[0m12:59:43.958783 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m12:59:43.959504 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c (execute): 12:59:43.959179 => 12:59:43.959193
[0m12:59:43.960707 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c
[0m12:59:43.961332 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_revenuereport_category.619e6ac08f
[0m12:59:43.962234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.unique_dbtcustomers_first_order_at.aaf4f1394c, now test.dbt_robert.not_null_dbtcustomers_revenuereport_category.619e6ac08f)
[0m12:59:43.962906 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_revenuereport_category.619e6ac08f
[0m12:59:43.975484 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_id.0c18a9f245"
[0m12:59:43.976472 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (compile): 12:59:43.952201 => 12:59:43.976127
[0m12:59:43.977115 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m12:59:43.977870 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_id.0c18a9f245 (execute): 12:59:43.977540 => 12:59:43.977555
[0m12:59:43.979211 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_id.0c18a9f245
[0m12:59:43.979944 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_revenuereport_created_at.4c24eeecbe
[0m12:59:43.969805 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_revenuereport_category.619e6ac08f"
[0m12:59:43.982006 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_category.619e6ac08f (compile): 12:59:43.963342 => 12:59:43.981651
[0m12:59:43.982619 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_revenuereport_category.619e6ac08f
[0m12:59:43.983367 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_category.619e6ac08f (execute): 12:59:43.983032 => 12:59:43.983044
[0m12:59:43.984686 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_revenuereport_category.619e6ac08f
[0m12:59:43.985739 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_revenuereport_email.37c86c9846
[0m12:59:43.987607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_revenuereport_category.619e6ac08f, now test.dbt_robert.not_null_dbtcustomers_revenuereport_email.37c86c9846)
[0m12:59:43.988253 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_revenuereport_email.37c86c9846
[0m12:59:43.981035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.unique_dbtcustomers_id.0c18a9f245, now test.dbt_robert.not_null_dbtcustomers_revenuereport_created_at.4c24eeecbe)
[0m12:59:43.995568 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_revenuereport_created_at.4c24eeecbe
[0m12:59:44.001408 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_revenuereport_created_at.4c24eeecbe"
[0m12:59:43.994911 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_revenuereport_email.37c86c9846"
[0m12:59:44.002166 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_created_at.4c24eeecbe (compile): 12:59:43.996000 => 12:59:44.001919
[0m12:59:44.002750 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_revenuereport_created_at.4c24eeecbe
[0m12:59:44.003321 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_created_at.4c24eeecbe (execute): 12:59:44.003081 => 12:59:44.003095
[0m12:59:44.003785 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_email.37c86c9846 (compile): 12:59:43.988700 => 12:59:44.003580
[0m12:59:44.004649 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_revenuereport_created_at.4c24eeecbe
[0m12:59:44.005119 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_revenuereport_email.37c86c9846
[0m12:59:44.006729 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_revenuereport_id.1f35873c85
[0m12:59:44.008599 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_email.37c86c9846 (execute): 12:59:44.008369 => 12:59:44.008381
[0m12:59:44.009576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_revenuereport_created_at.4c24eeecbe, now test.dbt_robert.not_null_dbtcustomers_revenuereport_id.1f35873c85)
[0m12:59:44.010720 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_revenuereport_email.37c86c9846
[0m12:59:44.011192 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_revenuereport_id.1f35873c85
[0m12:59:44.011770 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_revenuereport_is_returning_customer.89470eaf5e
[0m12:59:44.016150 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_revenuereport_id.1f35873c85"
[0m12:59:44.016899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_revenuereport_email.37c86c9846, now test.dbt_robert.not_null_dbtcustomers_revenuereport_is_returning_customer.89470eaf5e)
[0m12:59:44.017659 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_id.1f35873c85 (compile): 12:59:44.012144 => 12:59:44.017418
[0m12:59:44.018037 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_revenuereport_is_returning_customer.89470eaf5e
[0m12:59:44.018547 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_revenuereport_id.1f35873c85
[0m12:59:44.024039 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_revenuereport_is_returning_customer.89470eaf5e"
[0m12:59:44.024610 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_id.1f35873c85 (execute): 12:59:44.024358 => 12:59:44.024371
[0m12:59:44.025684 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_revenuereport_id.1f35873c85
[0m12:59:44.026289 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_is_returning_customer.89470eaf5e (compile): 12:59:44.018897 => 12:59:44.026054
[0m12:59:44.026832 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_revenuereport_name.e9c32454ad
[0m12:59:44.027402 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_revenuereport_is_returning_customer.89470eaf5e
[0m12:59:44.028068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_revenuereport_id.1f35873c85, now test.dbt_robert.not_null_dbtcustomers_revenuereport_name.e9c32454ad)
[0m12:59:44.028652 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_is_returning_customer.89470eaf5e (execute): 12:59:44.028426 => 12:59:44.028439
[0m12:59:44.029088 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_revenuereport_name.e9c32454ad
[0m12:59:44.030058 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_revenuereport_is_returning_customer.89470eaf5e
[0m12:59:44.034422 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_revenuereport_name.e9c32454ad"
[0m12:59:44.034941 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_revenuereport_number_of_orders.32b97b7614
[0m12:59:44.035686 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_name.e9c32454ad (compile): 12:59:44.030413 => 12:59:44.035460
[0m12:59:44.036284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_revenuereport_is_returning_customer.89470eaf5e, now test.dbt_robert.not_null_dbtcustomers_revenuereport_number_of_orders.32b97b7614)
[0m12:59:44.036765 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_revenuereport_name.e9c32454ad
[0m12:59:44.037218 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_revenuereport_number_of_orders.32b97b7614
[0m12:59:44.037751 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_name.e9c32454ad (execute): 12:59:44.037517 => 12:59:44.037530
[0m12:59:44.042034 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_revenuereport_number_of_orders.32b97b7614"
[0m12:59:44.043045 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_revenuereport_name.e9c32454ad
[0m12:59:44.043734 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_number_of_orders.32b97b7614 (compile): 12:59:44.038032 => 12:59:44.043495
[0m12:59:44.044147 [debug] [Thread-2 (]: Began running node test.dbt_robert.not_null_dbtcustomers_revenuereport_price.174ee5a482
[0m12:59:44.044656 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_revenuereport_number_of_orders.32b97b7614
[0m12:59:44.045312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_revenuereport_name.e9c32454ad, now test.dbt_robert.not_null_dbtcustomers_revenuereport_price.174ee5a482)
[0m12:59:44.045876 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_number_of_orders.32b97b7614 (execute): 12:59:44.045627 => 12:59:44.045640
[0m12:59:44.046300 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_revenuereport_price.174ee5a482
[0m12:59:44.047324 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_revenuereport_number_of_orders.32b97b7614
[0m12:59:44.051798 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_revenuereport_price.174ee5a482"
[0m12:59:44.052614 [debug] [Thread-1 (]: Began running node test.dbt_robert.not_null_dbtcustomers_revenuereport_year_week_ordercreated.a6aa9367cb
[0m12:59:44.053392 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_price.174ee5a482 (compile): 12:59:44.047640 => 12:59:44.053167
[0m12:59:44.053993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_revenuereport_number_of_orders.32b97b7614, now test.dbt_robert.not_null_dbtcustomers_revenuereport_year_week_ordercreated.a6aa9367cb)
[0m12:59:44.054551 [debug] [Thread-2 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_revenuereport_price.174ee5a482
[0m12:59:44.055042 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.not_null_dbtcustomers_revenuereport_year_week_ordercreated.a6aa9367cb
[0m12:59:44.055626 [debug] [Thread-2 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_price.174ee5a482 (execute): 12:59:44.055375 => 12:59:44.055400
[0m12:59:44.059872 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.not_null_dbtcustomers_revenuereport_year_week_ordercreated.a6aa9367cb"
[0m12:59:44.060881 [debug] [Thread-2 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_revenuereport_price.174ee5a482
[0m12:59:44.061632 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_year_week_ordercreated.a6aa9367cb (compile): 12:59:44.055914 => 12:59:44.061384
[0m12:59:44.062085 [debug] [Thread-2 (]: Began running node test.dbt_robert.unique_dbtcustomers_revenuereport_email.f7e79ac2f5
[0m12:59:44.062639 [debug] [Thread-1 (]: Began executing node test.dbt_robert.not_null_dbtcustomers_revenuereport_year_week_ordercreated.a6aa9367cb
[0m12:59:44.063328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_revenuereport_price.174ee5a482, now test.dbt_robert.unique_dbtcustomers_revenuereport_email.f7e79ac2f5)
[0m12:59:44.063914 [debug] [Thread-1 (]: Timing info for test.dbt_robert.not_null_dbtcustomers_revenuereport_year_week_ordercreated.a6aa9367cb (execute): 12:59:44.063664 => 12:59:44.063676
[0m12:59:44.064337 [debug] [Thread-2 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_revenuereport_email.f7e79ac2f5
[0m12:59:44.065341 [debug] [Thread-1 (]: Finished running node test.dbt_robert.not_null_dbtcustomers_revenuereport_year_week_ordercreated.a6aa9367cb
[0m12:59:44.070895 [debug] [Thread-1 (]: Began running node test.dbt_robert.unique_dbtcustomers_revenuereport_id.e30f6f7b3d
[0m12:59:44.069600 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_revenuereport_email.f7e79ac2f5"
[0m12:59:44.072318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_robert.not_null_dbtcustomers_revenuereport_year_week_ordercreated.a6aa9367cb, now test.dbt_robert.unique_dbtcustomers_revenuereport_id.e30f6f7b3d)
[0m12:59:44.073060 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_revenuereport_email.f7e79ac2f5 (compile): 12:59:44.065657 => 12:59:44.072836
[0m12:59:44.073425 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.unique_dbtcustomers_revenuereport_id.e30f6f7b3d
[0m12:59:44.073936 [debug] [Thread-2 (]: Began executing node test.dbt_robert.unique_dbtcustomers_revenuereport_email.f7e79ac2f5
[0m12:59:44.077970 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.unique_dbtcustomers_revenuereport_id.e30f6f7b3d"
[0m12:59:44.078583 [debug] [Thread-2 (]: Timing info for test.dbt_robert.unique_dbtcustomers_revenuereport_email.f7e79ac2f5 (execute): 12:59:44.078304 => 12:59:44.078318
[0m12:59:44.079383 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_revenuereport_id.e30f6f7b3d (compile): 12:59:44.074253 => 12:59:44.079150
[0m12:59:44.080231 [debug] [Thread-2 (]: Finished running node test.dbt_robert.unique_dbtcustomers_revenuereport_email.f7e79ac2f5
[0m12:59:44.080685 [debug] [Thread-1 (]: Began executing node test.dbt_robert.unique_dbtcustomers_revenuereport_id.e30f6f7b3d
[0m12:59:44.081472 [debug] [Thread-1 (]: Timing info for test.dbt_robert.unique_dbtcustomers_revenuereport_id.e30f6f7b3d (execute): 12:59:44.081220 => 12:59:44.081233
[0m12:59:44.082411 [debug] [Thread-1 (]: Finished running node test.dbt_robert.unique_dbtcustomers_revenuereport_id.e30f6f7b3d
[0m12:59:44.083486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:44.083841 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_revenuereport_id.e30f6f7b3d' was properly closed.
[0m12:59:44.084172 [debug] [MainThread]: Connection 'test.dbt_robert.unique_dbtcustomers_revenuereport_email.f7e79ac2f5' was properly closed.
[0m12:59:44.087272 [debug] [MainThread]: Command end result
[0m12:59:44.201568 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:59:44.202269 [info ] [MainThread]: Building catalog
[0m12:59:44.203606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:44.575760 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m12:59:44.593385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:44.594277 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_robert`.__TABLES__
        where (upper(dataset_id) = upper('dbt_robert'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_robert`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m12:59:47.076954 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9bccf1e8-038d-4b7d-bab6-ffe8ddd9dc3d&page=queryresults
[0m12:59:47.096382 [info ] [MainThread]: Catalog written to /home/vscode/dbt_robert_project/target/catalog.json
[0m12:59:47.097662 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:59:47.097503 after 4.73 seconds
[0m12:59:47.098079 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:59:47.098556 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m12:59:47.099130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb251032410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb250f95ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e8947c0>]}
[0m12:59:47.099700 [debug] [MainThread]: Flushing usage events
[0m12:59:49.426872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b2c5e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b1bc65c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b1bc64d0>]}


============================== 12:59:49.429525 | d190bdb3-6ae3-4ff9-84c8-77d234e61cb1 ==============================
[0m12:59:49.429525 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:59:49.430385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:59:49.798084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd190bdb3-6ae3-4ff9-84c8-77d234e61cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b00af220>]}
[0m12:59:49.815197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd190bdb3-6ae3-4ff9-84c8-77d234e61cb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b0099990>]}
[0m13:08:11.784974 [error] [MainThread]: Encountered an error:

[0m13:08:11.817985 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m13:08:11.819759 [debug] [MainThread]: Command `dbt docs serve` failed at 13:08:11.819565 after 502.40 seconds
[0m13:08:11.820439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b2c5e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b292fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b292d750>]}
[0m13:08:11.821285 [debug] [MainThread]: Flushing usage events
[0m15:45:19.105323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06bcae63b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06bb7ce590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06bb7ce500>]}


============================== 15:45:19.125062 | bbb36d6a-b260-4073-98a3-f70421ded23a ==============================
[0m15:45:19.125062 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:45:19.126307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:45:20.917476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbb36d6a-b260-4073-98a3-f70421ded23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b9cb0370>]}
[0m15:45:20.935874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbb36d6a-b260-4073-98a3-f70421ded23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b9cb5990>]}
[0m15:45:20.936985 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:45:20.948929 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:45:21.095146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:45:21.095971 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m15:45:21.121617 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m15:45:21.146419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbb36d6a-b260-4073-98a3-f70421ded23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b9b280d0>]}
[0m15:45:21.156094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbb36d6a-b260-4073-98a3-f70421ded23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b9a77e20>]}
[0m15:45:21.156687 [info ] [MainThread]: Found 3 models, 19 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:45:21.157481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbb36d6a-b260-4073-98a3-f70421ded23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b9a77eb0>]}
[0m15:45:21.158340 [warn ] [MainThread]: The selection criterion 'pageviews_userstitching' does not match any nodes
[0m15:45:21.160137 [info ] [MainThread]: 
[0m15:45:21.160768 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:45:21.161599 [debug] [MainThread]: Command end result
[0m15:45:21.169021 [debug] [MainThread]: Command `dbt run` succeeded at 15:45:21.168835 after 2.08 seconds
[0m15:45:21.169629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06bcae63b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06bc7a39a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b9cb78e0>]}
[0m15:45:21.170169 [debug] [MainThread]: Flushing usage events
[0m15:46:17.511880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a79dd23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a79062530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a790624d0>]}


============================== 15:46:17.514644 | b91d4104-910c-4ef8-b1b8-66210ea6a207 ==============================
[0m15:46:17.514644 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:46:17.515467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:46:17.901583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b91d4104-910c-4ef8-b1b8-66210ea6a207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a79b79390>]}
[0m15:46:17.918828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b91d4104-910c-4ef8-b1b8-66210ea6a207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a771df820>]}
[0m15:46:17.919839 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:46:17.931649 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:46:17.960359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:17.960886 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:17.967727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b91d4104-910c-4ef8-b1b8-66210ea6a207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a76fe40d0>]}
[0m15:46:17.978344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b91d4104-910c-4ef8-b1b8-66210ea6a207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a770ff850>]}
[0m15:46:17.978929 [info ] [MainThread]: Found 3 models, 19 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m15:46:17.979504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b91d4104-910c-4ef8-b1b8-66210ea6a207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a770ff8e0>]}
[0m15:46:17.981660 [info ] [MainThread]: 
[0m15:46:17.982842 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:46:17.984405 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:46:17.984939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:23.944363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m15:46:23.945203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:24.253162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b91d4104-910c-4ef8-b1b8-66210ea6a207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a770fed40>]}
[0m15:46:24.254447 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:46:24.255208 [info ] [MainThread]: 
[0m15:46:24.283279 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m15:46:24.283812 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:46:24.284519 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m15:46:24.285286 [info ] [Thread-2 (]: 2 of 2 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m15:46:24.286702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m15:46:24.288312 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m15:46:24.287679 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m15:46:24.292905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m15:46:24.293423 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m15:46:24.294399 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 15:46:24.289043 => 15:46:24.293999
[0m15:46:24.297532 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:46:24.298052 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m15:46:24.298998 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 15:46:24.294656 => 15:46:24.298654
[0m15:46:24.314697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:24.315334 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m15:46:24.320298 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:46:24.796334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m15:46:24.798116 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:46:24.799189 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m15:46:24.801355 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m15:46:28.817420 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6761d5b7-5819-40f3-b911-69c1071d693e&page=queryresults
[0m15:46:28.836078 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 15:46:24.317505 => 15:46:28.835846
[0m15:46:28.837012 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91d4104-910c-4ef8-b1b8-66210ea6a207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a771dc3d0>]}
[0m15:46:28.837845 [info ] [Thread-2 (]: 2 of 2 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.55s]
[0m15:46:28.838899 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:46:29.153725 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:24fe15fb-58ef-4a19-9bb1-6409f6161888&page=queryresults
[0m15:46:29.156967 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 15:46:24.299260 => 15:46:29.156684
[0m15:46:29.157996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91d4104-910c-4ef8-b1b8-66210ea6a207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a771fab60>]}
[0m15:46:29.158784 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.87s]
[0m15:46:29.159792 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m15:46:29.162092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:29.162466 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m15:46:29.162822 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m15:46:29.163257 [info ] [MainThread]: 
[0m15:46:29.163976 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 11.18 seconds (11.18s).
[0m15:46:29.165522 [debug] [MainThread]: Command end result
[0m15:46:29.174693 [info ] [MainThread]: 
[0m15:46:29.175416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:29.176105 [info ] [MainThread]: 
[0m15:46:29.176865 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:46:29.178103 [debug] [MainThread]: Command `dbt run` succeeded at 15:46:29.177918 after 11.67 seconds
[0m15:46:29.178742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a79dd23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7998d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a76e7a770>]}
[0m15:46:29.179441 [debug] [MainThread]: Flushing usage events
[0m15:50:31.941380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d7b32380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d6ac64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d6ac6470>]}


============================== 15:50:31.944177 | 2bc50cda-ce2a-48f2-afbc-bbd3dbb0ff46 ==============================
[0m15:50:31.944177 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:50:31.945191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:50:32.368835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bc50cda-ce2a-48f2-afbc-bbd3dbb0ff46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d4f6fbb0>]}
[0m15:50:32.386482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bc50cda-ce2a-48f2-afbc-bbd3dbb0ff46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d4fafd90>]}
[0m15:50:32.387502 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:50:32.399642 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:50:32.429609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:50:32.430367 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/staging/advanced_sql_exercises/advanced_sql_exercises_sources.yml
[0m15:50:32.430959 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m15:50:32.456724 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m15:50:32.500331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bc50cda-ce2a-48f2-afbc-bbd3dbb0ff46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d4e1bf10>]}
[0m15:50:32.509965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bc50cda-ce2a-48f2-afbc-bbd3dbb0ff46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d4edb100>]}
[0m15:50:32.510603 [info ] [MainThread]: Found 3 models, 19 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:50:32.511186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bc50cda-ce2a-48f2-afbc-bbd3dbb0ff46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d4edb190>]}
[0m15:50:32.513466 [info ] [MainThread]: 
[0m15:50:32.514653 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:50:32.517351 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:50:32.517906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:33.723438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m15:50:33.724288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:34.013122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bc50cda-ce2a-48f2-afbc-bbd3dbb0ff46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d4eda410>]}
[0m15:50:34.014431 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:50:34.015400 [info ] [MainThread]: 
[0m15:50:34.021280 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m15:50:34.021856 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:50:34.022573 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m15:50:34.023528 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m15:50:34.024600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m15:50:34.025807 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m15:50:34.026387 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m15:50:34.026898 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m15:50:34.030806 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m15:50:34.034195 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:50:34.035252 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 15:50:34.027236 => 15:50:34.034899
[0m15:50:34.035869 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m15:50:34.040170 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 15:50:34.031177 => 15:50:34.039879
[0m15:50:34.046464 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m15:50:34.086117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:34.090373 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:50:34.523234 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:50:34.525100 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m15:50:34.526169 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m15:50:34.529090 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m15:50:38.479942 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1a46906d-18ea-4e01-94a7-066320d21a0a&page=queryresults
[0m15:50:38.498223 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 15:50:34.053778 => 15:50:38.497976
[0m15:50:38.499235 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bc50cda-ce2a-48f2-afbc-bbd3dbb0ff46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d4e04af0>]}
[0m15:50:38.500051 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.47s]
[0m15:50:38.501280 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:50:38.502126 [debug] [Thread-2 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m15:50:38.502937 [info ] [Thread-2 (]: 3 of 3 START sql view model dbt_robert.pageviews_userstitching ................. [RUN]
[0m15:50:38.503977 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.dbt_robert.pageviews_userstitching)
[0m15:50:38.504450 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m15:50:38.507981 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m15:50:38.509166 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 15:50:38.504780 => 15:50:38.508815
[0m15:50:38.509822 [debug] [Thread-2 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m15:50:38.538571 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m15:50:38.541642 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:50:38.542761 [debug] [Thread-2 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */


  create or replace view `aec-students`.`dbt_robert`.`pageviews_userstitching`
  OPTIONS()
  as Select

id
visitor_id		
device_type		
timestamp		
page		
customer_id

from analytics-engineers-club.web_tracking.pageviews;


[0m15:50:38.761447 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c94b273a-1eb8-45c3-9d13-6e003edccfd2&page=queryresults
[0m15:50:38.764117 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 15:50:34.036223 => 15:50:38.763888
[0m15:50:38.765046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bc50cda-ce2a-48f2-afbc-bbd3dbb0ff46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d4900c40>]}
[0m15:50:38.765924 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.74s]
[0m15:50:38.766974 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m15:50:38.867914 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got identifier "device_type" at [10:1]')
[0m15:50:39.673880 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a4de394f-1436-4e42-8148-062c5c67cbdb&page=queryresults
[0m15:50:39.675693 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 15:50:38.510268 => 15:50:39.675313
[0m15:50:39.706658 [debug] [Thread-2 (]: Database Error in model pageviews_userstitching (models/staging/advanced_sql_exercises/pageviews_userstitching.sql)
  Syntax error: Expected end of input but got identifier "device_type" at [10:1]
  compiled Code at target/run/dbt_robert/models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m15:50:39.707431 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bc50cda-ce2a-48f2-afbc-bbd3dbb0ff46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d490a950>]}
[0m15:50:39.708383 [error] [Thread-2 (]: 3 of 3 ERROR creating sql view model dbt_robert.pageviews_userstitching ........ [[31mERROR[0m in 1.20s]
[0m15:50:39.709234 [debug] [Thread-2 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m15:50:39.711970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:39.712386 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m15:50:39.712774 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m15:50:39.713215 [info ] [MainThread]: 
[0m15:50:39.713795 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m15:50:39.715535 [debug] [MainThread]: Command end result
[0m15:50:39.795119 [info ] [MainThread]: 
[0m15:50:39.796326 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:39.797054 [info ] [MainThread]: 
[0m15:50:39.798060 [error] [MainThread]: [33mDatabase Error in model pageviews_userstitching (models/staging/advanced_sql_exercises/pageviews_userstitching.sql)[0m
[0m15:50:39.798732 [error] [MainThread]:   Syntax error: Expected end of input but got identifier "device_type" at [10:1]
[0m15:50:39.799561 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m15:50:39.800190 [info ] [MainThread]: 
[0m15:50:39.801102 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:50:39.802306 [debug] [MainThread]: Command `dbt run` failed at 15:50:39.802114 after 7.87 seconds
[0m15:50:39.802988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d7b32380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d78e2860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00d553b670>]}
[0m15:50:39.803469 [debug] [MainThread]: Flushing usage events
[0m15:52:04.100852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83e59e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83d4c64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83d4c6470>]}


============================== 15:52:04.103624 | 2d0d965e-7178-4dea-b685-e27953877f7b ==============================
[0m15:52:04.103624 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:52:04.104791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:52:04.516276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d0d965e-7178-4dea-b685-e27953877f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83e4d6650>]}
[0m15:52:04.534639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d0d965e-7178-4dea-b685-e27953877f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83b9ad600>]}
[0m15:52:04.535579 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:52:04.547117 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:52:04.578295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:52:04.579487 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m15:52:04.607389 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m15:52:04.631932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d0d965e-7178-4dea-b685-e27953877f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83b81c0d0>]}
[0m15:52:04.645081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d0d965e-7178-4dea-b685-e27953877f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83e2c68c0>]}
[0m15:52:04.645780 [info ] [MainThread]: Found 3 models, 19 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:52:04.646601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d0d965e-7178-4dea-b685-e27953877f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83b909a50>]}
[0m15:52:04.649286 [info ] [MainThread]: 
[0m15:52:04.650415 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:52:04.652119 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:52:04.652813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:05.799700 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m15:52:05.800863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:06.087709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d0d965e-7178-4dea-b685-e27953877f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83b8c0160>]}
[0m15:52:06.088997 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:52:06.089760 [info ] [MainThread]: 
[0m15:52:06.094457 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m15:52:06.095048 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:52:06.095811 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m15:52:06.097936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m15:52:06.098419 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m15:52:06.096836 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m15:52:06.101914 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m15:52:06.102797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_aec-students, now model.dbt_robert.dbtcustomers_revenuereport)
[0m15:52:06.103425 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m15:52:06.106595 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:52:06.107715 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 15:52:06.103768 => 15:52:06.107409
[0m15:52:06.108190 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 15:52:06.098699 => 15:52:06.107971
[0m15:52:06.108666 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m15:52:06.109157 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m15:52:06.124331 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:52:06.126694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:06.556076 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m15:52:06.555448 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:52:06.557398 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m15:52:06.559912 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m15:52:10.244288 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ba468938-c3e0-4c9a-9012-466b31cd566c&page=queryresults
[0m15:52:10.261812 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 15:52:06.124702 => 15:52:10.261585
[0m15:52:10.262778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d0d965e-7178-4dea-b685-e27953877f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83b2efb20>]}
[0m15:52:10.263562 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.17s]
[0m15:52:10.264584 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m15:52:10.265255 [debug] [Thread-1 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m15:52:10.266072 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_robert.pageviews_userstitching ................. [RUN]
[0m15:52:10.267552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.pageviews_userstitching)
[0m15:52:10.268031 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m15:52:10.270703 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m15:52:10.271595 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 15:52:10.268383 => 15:52:10.271257
[0m15:52:10.272126 [debug] [Thread-1 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m15:52:10.292093 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m15:52:10.292878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:10.293458 [debug] [Thread-1 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */


  create or replace view `aec-students`.`dbt_robert`.`pageviews_userstitching`
  OPTIONS()
  as Select

id,
visitor_id,		
device_type,	
timestamp,	
page,
customer_id

from `analytics-engineers-club.web_tracking.pageviews`;


[0m15:52:10.679652 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b6514265-86ab-42d4-8604-709ea64e08ef&page=queryresults
[0m15:52:10.682492 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 15:52:06.109483 => 15:52:10.682259
[0m15:52:10.683464 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d0d965e-7178-4dea-b685-e27953877f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83b81e950>]}
[0m15:52:10.684228 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.58s]
[0m15:52:10.685395 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:52:11.241319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:eb7c55b2-c072-4a42-9e27-458428850ba3&page=queryresults
[0m15:52:11.244307 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 15:52:10.272438 => 15:52:11.244080
[0m15:52:11.245239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d0d965e-7178-4dea-b685-e27953877f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83b3262f0>]}
[0m15:52:11.246069 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_robert.pageviews_userstitching ............ [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m15:52:11.247209 [debug] [Thread-1 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m15:52:11.249475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:11.249858 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m15:52:11.250220 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m15:52:11.250686 [info ] [MainThread]: 
[0m15:52:11.251272 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 6.60 seconds (6.60s).
[0m15:52:11.252694 [debug] [MainThread]: Command end result
[0m15:52:11.263234 [info ] [MainThread]: 
[0m15:52:11.263996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:11.264733 [info ] [MainThread]: 
[0m15:52:11.265390 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:52:11.266444 [debug] [MainThread]: Command `dbt run` succeeded at 15:52:11.266244 after 7.17 seconds
[0m15:52:11.267174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83e59e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83b9ad600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb83e2c71c0>]}
[0m15:52:11.267665 [debug] [MainThread]: Flushing usage events
[0m15:53:11.115742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b1612410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b08a2560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b08a2500>]}


============================== 15:53:11.118772 | f751c851-e757-495b-8887-fb0420973483 ==============================
[0m15:53:11.118772 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:53:11.119576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:53:11.490674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f751c851-e757-495b-8887-fb0420973483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae99ff70>]}
[0m15:53:11.508933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f751c851-e757-495b-8887-fb0420973483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae9de500>]}
[0m15:53:11.509914 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:53:11.521827 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:53:11.551238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:53:11.551978 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m15:53:11.577158 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m15:53:11.601437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f751c851-e757-495b-8887-fb0420973483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae8280d0>]}
[0m15:53:11.611282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f751c851-e757-495b-8887-fb0420973483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae8ff880>]}
[0m15:53:11.611876 [info ] [MainThread]: Found 3 models, 19 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:53:11.612428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f751c851-e757-495b-8887-fb0420973483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae8ff910>]}
[0m15:53:11.614929 [info ] [MainThread]: 
[0m15:53:11.615987 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:53:11.617613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:53:11.618252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:12.741990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m15:53:12.742839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:13.011466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f751c851-e757-495b-8887-fb0420973483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae8feb90>]}
[0m15:53:13.012829 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:53:13.013695 [info ] [MainThread]: 
[0m15:53:13.019424 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m15:53:13.020002 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:53:13.020719 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m15:53:13.022566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m15:53:13.023011 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m15:53:13.027100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m15:53:13.021465 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m15:53:13.028457 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m15:53:13.029066 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m15:53:13.029860 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 15:53:13.023290 => 15:53:13.029406
[0m15:53:13.032949 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:53:13.033471 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m15:53:13.040840 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 15:53:13.030189 => 15:53:13.040447
[0m15:53:13.041303 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m15:53:13.063756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:13.064665 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:53:13.515905 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:53:13.522210 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m15:53:13.523211 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m15:53:13.525666 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m15:53:17.258829 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fc752cef-1c62-4593-bdd2-3ea76f5a8c75&page=queryresults
[0m15:53:17.278082 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 15:53:13.041593 => 15:53:17.277852
[0m15:53:17.278990 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f751c851-e757-495b-8887-fb0420973483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae2eaa40>]}
[0m15:53:17.279760 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.25s]
[0m15:53:17.280773 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:53:17.281392 [debug] [Thread-2 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m15:53:17.282121 [info ] [Thread-2 (]: 3 of 3 START sql table model dbt_robert.pageviews_userstitching ................ [RUN]
[0m15:53:17.283736 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.dbt_robert.pageviews_userstitching)
[0m15:53:17.284201 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m15:53:17.287628 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m15:53:17.288707 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 15:53:17.284495 => 15:53:17.288339
[0m15:53:17.289217 [debug] [Thread-2 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m15:53:17.291953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:17.731597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4bf855d6-6cda-4fd0-af9a-d018d1b6fefe&page=queryresults
[0m15:53:17.735173 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 15:53:13.033945 => 15:53:17.734888
[0m15:53:17.736341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f751c851-e757-495b-8887-fb0420973483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae2ea230>]}
[0m15:53:17.737186 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.71s]
[0m15:53:17.738205 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m15:53:17.795609 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m15:53:17.796732 [debug] [Thread-2 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

SELECT

id,
visitor_id,		
device_type,	
timestamp,	
page,
customer_id

from `analytics-engineers-club.web_tracking.pageviews`
    );
  
[0m15:53:31.042185 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b545175f-23d6-41ef-9088-a7b0a3e1a4b8&page=queryresults
[0m15:53:31.045555 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 15:53:17.289513 => 15:53:31.045280
[0m15:53:31.046686 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f751c851-e757-495b-8887-fb0420973483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae2ea740>]}
[0m15:53:31.047587 [info ] [Thread-2 (]: 3 of 3 OK created sql table model dbt_robert.pageviews_userstitching ........... [[32mCREATE TABLE (5.8m rows, 606.0 MiB processed)[0m in 13.76s]
[0m15:53:31.048885 [debug] [Thread-2 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m15:53:31.051429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:31.051800 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m15:53:31.052151 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m15:53:31.052560 [info ] [MainThread]: 
[0m15:53:31.053204 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 19.44 seconds (19.44s).
[0m15:53:31.054595 [debug] [MainThread]: Command end result
[0m15:53:31.064037 [info ] [MainThread]: 
[0m15:53:31.064801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:53:31.065500 [info ] [MainThread]: 
[0m15:53:31.066185 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:53:31.067286 [debug] [MainThread]: Command `dbt run` succeeded at 15:53:31.067057 after 19.96 seconds
[0m15:53:31.067847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71b1612410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae9de500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ae8ffac0>]}
[0m15:53:31.068328 [debug] [MainThread]: Flushing usage events
[0m16:15:14.746377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470a863e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f7d25c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646f7d2530>]}


============================== 16:15:14.751415 | 166d9289-41a7-4326-b336-e3aa3c0e5938 ==============================
[0m16:15:14.751415 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:15:14.753847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:15:15.183128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '166d9289-41a7-4326-b336-e3aa3c0e5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470831390>]}
[0m16:15:15.202157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '166d9289-41a7-4326-b336-e3aa3c0e5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646dcb4880>]}
[0m16:15:15.203285 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:15:15.215339 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:15:15.246550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:15:15.247569 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/advanced_sql_exercises_sources.yml
[0m16:15:15.248169 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m16:15:15.278774 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m16:15:15.335899 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_robert.pageviews_userstitching' (models/staging/advanced_sql_exercises/pageviews_userstitching.sql) depends on a source named 'web_tracking.pageviews' which was not found
[0m16:15:15.337231 [debug] [MainThread]: Command `dbt run` failed at 16:15:15.337013 after 0.61 seconds
[0m16:15:15.337771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6470a863e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646db0e830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646db0e980>]}
[0m16:15:15.338338 [debug] [MainThread]: Flushing usage events
[0m16:16:57.637090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde25da2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde186a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde186a3b0>]}


============================== 16:16:57.639789 | 881e1fbf-64f1-4f7c-a7c7-6b44b0fae55a ==============================
[0m16:16:57.639789 [info ] [MainThread]: Running with dbt=1.5.3
[0m16:16:57.640591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:16:58.003590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '881e1fbf-64f1-4f7c-a7c7-6b44b0fae55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde2513bb0>]}
[0m16:16:58.021658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '881e1fbf-64f1-4f7c-a7c7-6b44b0fae55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddf9de320>]}
[0m16:16:58.022639 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:16:58.034246 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m16:16:58.063338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:16:58.064097 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/advanced_sql_exercises_sources.yml
[0m16:16:58.064755 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m16:16:58.090401 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m16:16:58.138189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '881e1fbf-64f1-4f7c-a7c7-6b44b0fae55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddf849d80>]}
[0m16:16:58.147830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '881e1fbf-64f1-4f7c-a7c7-6b44b0fae55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddf8ffaf0>]}
[0m16:16:58.148464 [info ] [MainThread]: Found 3 models, 19 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:16:58.149074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '881e1fbf-64f1-4f7c-a7c7-6b44b0fae55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddf8ffb80>]}
[0m16:16:58.151249 [info ] [MainThread]: 
[0m16:16:58.152490 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:16:58.154490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:16:58.155261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:59.285518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m16:16:59.286257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:59.623857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '881e1fbf-64f1-4f7c-a7c7-6b44b0fae55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddf8fcc40>]}
[0m16:16:59.625042 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:16:59.625919 [info ] [MainThread]: 
[0m16:16:59.630239 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m16:16:59.630772 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m16:16:59.631428 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m16:16:59.632243 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m16:16:59.633300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m16:16:59.634469 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m16:16:59.635113 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m16:16:59.635581 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m16:16:59.639206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m16:16:59.642462 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m16:16:59.643627 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 16:16:59.635902 => 16:16:59.643305
[0m16:16:59.644186 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m16:16:59.646073 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 16:16:59.639553 => 16:16:59.645825
[0m16:16:59.653744 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m16:16:59.665219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:59.667544 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:17:00.178573 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m16:17:00.180684 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m16:17:00.181776 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m16:17:00.184841 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m16:17:03.930195 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6c191822-c8ac-457b-a588-16a57bbdce59&page=queryresults
[0m16:17:03.949257 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 16:16:59.644520 => 16:17:03.949025
[0m16:17:03.950244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '881e1fbf-64f1-4f7c-a7c7-6b44b0fae55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddf9f9ba0>]}
[0m16:17:03.951033 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.32s]
[0m16:17:03.952049 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m16:17:03.952712 [debug] [Thread-1 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m16:17:03.953495 [info ] [Thread-1 (]: 3 of 3 START sql table model dbt_robert.pageviews_userstitching ................ [RUN]
[0m16:17:03.955225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.pageviews_userstitching)
[0m16:17:03.955692 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m16:17:03.959325 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m16:17:03.960237 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 16:17:03.956019 => 16:17:03.959901
[0m16:17:03.960776 [debug] [Thread-1 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m16:17:03.963229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:04.246777 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a392fa03-6e85-468a-b1d7-ef4c67042995&page=queryresults
[0m16:17:04.251338 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 16:16:59.665539 => 16:17:04.250924
[0m16:17:04.252777 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '881e1fbf-64f1-4f7c-a7c7-6b44b0fae55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddf7aedd0>]}
[0m16:17:04.253874 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.62s]
[0m16:17:04.255550 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m16:17:04.337771 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m16:17:04.338803 [debug] [Thread-1 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`
    );
  
[0m16:17:17.690767 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6e3349a5-f2ba-434e-9669-f99f7a28d0c6&page=queryresults
[0m16:17:17.694395 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 16:17:03.961072 => 16:17:17.694115
[0m16:17:17.695364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '881e1fbf-64f1-4f7c-a7c7-6b44b0fae55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddf7af1f0>]}
[0m16:17:17.696609 [info ] [Thread-1 (]: 3 of 3 OK created sql table model dbt_robert.pageviews_userstitching ........... [[32mCREATE TABLE (5.8m rows, 606.0 MiB processed)[0m in 13.74s]
[0m16:17:17.697629 [debug] [Thread-1 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m16:17:17.700666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:17.701047 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m16:17:17.701399 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m16:17:17.701825 [info ] [MainThread]: 
[0m16:17:17.702496 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 19.55 seconds (19.55s).
[0m16:17:17.703878 [debug] [MainThread]: Command end result
[0m16:17:17.775732 [info ] [MainThread]: 
[0m16:17:17.776692 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:17.777424 [info ] [MainThread]: 
[0m16:17:17.778146 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:17:17.779225 [debug] [MainThread]: Command `dbt run` succeeded at 16:17:17.779089 after 20.15 seconds
[0m16:17:17.779656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde0596ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddfb0fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdddfd6fd60>]}
[0m16:17:17.780187 [debug] [MainThread]: Flushing usage events
[0m08:29:57.505462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866872e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866750e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866750e4a0>]}


============================== 08:29:57.527950 | 3b1b0df1-e8a2-465c-becc-3794ec12fdd1 ==============================
[0m08:29:57.527950 [info ] [MainThread]: Running with dbt=1.5.3
[0m08:29:57.528935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:29:59.320167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b1b0df1-e8a2-465c-becc-3794ec12fdd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8668507520>]}
[0m08:29:59.337593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b1b0df1-e8a2-465c-becc-3794ec12fdd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8665be1d20>]}
[0m08:29:59.338566 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m08:29:59.351623 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m08:29:59.506869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m08:29:59.507677 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/staging/advanced_sql_exercises/advanced_sql_exercises_wt_schema.yml
[0m08:29:59.508355 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/advanced_sql_exercises_sources.yml
[0m08:29:59.508822 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m08:29:59.534200 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m08:29:59.596837 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_robert.pageviews_userstitching' (models/staging/advanced_sql_exercises/pageviews_userstitching.sql) depends on a node named 'visitors' which was not found
[0m08:29:59.598016 [debug] [MainThread]: Command `dbt run` failed at 08:29:59.597877 after 2.12 seconds
[0m08:29:59.598491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866872e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866543aec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866543bbe0>]}
[0m08:29:59.599043 [debug] [MainThread]: Flushing usage events
[0m08:33:38.122061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40c0fe350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40aeca4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40aeca440>]}


============================== 08:33:38.124792 | bbc6b330-d302-446b-b815-1a8c8991e5da ==============================
[0m08:33:38.124792 [info ] [MainThread]: Running with dbt=1.5.3
[0m08:33:38.125603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:33:38.495627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbc6b330-d302-446b-b815-1a8c8991e5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40bde4d90>]}
[0m08:33:38.512848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbc6b330-d302-446b-b815-1a8c8991e5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4093996f0>]}
[0m08:33:38.513663 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m08:33:38.524590 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m08:33:38.553495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m08:33:38.554060 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/staging/advanced_sql_exercises/visitors_userstitching.sql
[0m08:33:38.554533 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/staging/advanced_sql_exercises/advanced_sql_exercises_wt_schema.yml
[0m08:33:38.555164 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/advanced_sql_exercises_sources.yml
[0m08:33:38.555606 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m08:33:38.580691 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/visitors_userstitching.sql
[0m08:33:38.594156 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m08:33:38.657590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbc6b330-d302-446b-b815-1a8c8991e5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc409233eb0>]}
[0m08:33:38.666937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbc6b330-d302-446b-b815-1a8c8991e5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4091f58d0>]}
[0m08:33:38.667475 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m08:33:38.668031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbc6b330-d302-446b-b815-1a8c8991e5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4091ef5b0>]}
[0m08:33:38.670228 [info ] [MainThread]: 
[0m08:33:38.671294 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:33:38.672787 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:33:38.673283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:44.302943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m08:33:44.303750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:44.613015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbc6b330-d302-446b-b815-1a8c8991e5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4091634f0>]}
[0m08:33:44.614100 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:33:44.614778 [info ] [MainThread]: 
[0m08:33:44.647071 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m08:33:44.647607 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m08:33:44.648309 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m08:33:44.649338 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m08:33:44.651522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m08:33:44.652438 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m08:33:44.652984 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m08:33:44.653532 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m08:33:44.657068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m08:33:44.660089 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m08:33:44.661048 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 08:33:44.653868 => 08:33:44.660680
[0m08:33:44.661680 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m08:33:44.672869 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 08:33:44.657427 => 08:33:44.672593
[0m08:33:44.677425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:33:44.677995 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m08:33:44.683015 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:33:45.142222 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m08:33:45.144000 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m08:33:45.144996 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m08:33:45.147935 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m08:33:49.167993 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cedd4971-b5f5-4e9b-b6f1-83b275c7e076&page=queryresults
[0m08:33:49.187195 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 08:33:44.662060 => 08:33:49.186957
[0m08:33:49.188156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbc6b330-d302-446b-b815-1a8c8991e5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc409163790>]}
[0m08:33:49.188938 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.54s]
[0m08:33:49.190179 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m08:33:49.190768 [debug] [Thread-1 (]: Began running node model.dbt_robert.visitors_userstitching
[0m08:33:49.191578 [info ] [Thread-1 (]: 3 of 4 START sql view model dbt_robert.visitors_userstitching .................. [RUN]
[0m08:33:49.192848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.visitors_userstitching)
[0m08:33:49.193325 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.visitors_userstitching
[0m08:33:49.197193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.visitors_userstitching"
[0m08:33:49.198065 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_userstitching (compile): 08:33:49.193750 => 08:33:49.197730
[0m08:33:49.198519 [debug] [Thread-1 (]: Began executing node model.dbt_robert.visitors_userstitching
[0m08:33:49.274731 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.visitors_userstitching"
[0m08:33:49.275689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:33:49.276242 [debug] [Thread-1 (]: On model.dbt_robert.visitors_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.visitors_userstitching"} */


  create or replace view `aec-students`.`dbt_robert`.`visitors_userstitching`
  OPTIONS()
  as -- one record per visitor id
with visitors_userstitching as (
    select distinct
        visitor_id,

        first_value(customer_id ignore nulls) over (
            partition by visitor_id
            order by timestamp
            range between unbounded preceding and unbounded following
        ) as first_customer_id,

        min(timestamp) over (
            partition by visitor_id
        ) as first_seen_at,

        max(timestamp) over (
            partition by visitor_id
        ) as last_seen_at


    from `analytics-engineers-club`.`web_tracking`.`pageviews`
)
select
    *,
    first_value(visitor_id) over (
        partition by coalesce(first_customer_id, visitor_id)
        order by first_seen_at
    ) as first_visitor_id
from visitors_userstitching;


[0m08:33:49.814928 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:91a520f8-954b-4816-837b-71e6bd0ec647&page=queryresults
[0m08:33:49.817712 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 08:33:44.680450 => 08:33:49.817493
[0m08:33:49.818591 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbc6b330-d302-446b-b815-1a8c8991e5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4092b9210>]}
[0m08:33:49.819357 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 5.17s]
[0m08:33:49.820518 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m08:33:50.259780 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:42607409-b246-4ef0-bdba-c5932395b763&page=queryresults
[0m08:33:50.262072 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_userstitching (execute): 08:33:49.198851 => 08:33:50.261853
[0m08:33:50.262981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbc6b330-d302-446b-b815-1a8c8991e5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4096715a0>]}
[0m08:33:50.263721 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dbt_robert.visitors_userstitching ............. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m08:33:50.264901 [debug] [Thread-1 (]: Finished running node model.dbt_robert.visitors_userstitching
[0m08:33:50.265964 [debug] [Thread-2 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m08:33:50.266561 [info ] [Thread-2 (]: 4 of 4 START sql table model dbt_robert.pageviews_userstitching ................ [RUN]
[0m08:33:50.268235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.dbt_robert.pageviews_userstitching)
[0m08:33:50.269164 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m08:33:50.273763 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m08:33:50.274882 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 08:33:50.269539 => 08:33:50.274580
[0m08:33:50.275339 [debug] [Thread-2 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m08:33:50.278007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:33:50.617428 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m08:33:50.618484 [debug] [Thread-2 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

-- SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`

with pageviews as (
    select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
),

visitors as (
    select * from `aec-students`.`dbt_robert`.`visitors_userstitching`
),

joined as (
    select
        pageviews.*,
        -- customer id if we have it, else visitor id
        coalesce(
            visitors.first_customer_id,
            pageviews.visitor_id
        ) as blended_user_id,

        visitors.first_visitor_id

    from pageviews
    left join visitors
        on pageviews.visitor_id = visitors.visitor_id
)

select * from joined
    );
  
[0m08:34:08.187796 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c2727454-0203-41a9-8727-326368d23b50&page=queryresults
[0m08:34:08.190881 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 08:33:50.275638 => 08:34:08.190575
[0m08:34:08.192271 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbc6b330-d302-446b-b815-1a8c8991e5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4091630a0>]}
[0m08:34:08.193204 [info ] [Thread-2 (]: 4 of 4 OK created sql table model dbt_robert.pageviews_userstitching ........... [[32mCREATE TABLE (5.8m rows, 606.0 MiB processed)[0m in 17.92s]
[0m08:34:08.194658 [debug] [Thread-2 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m08:34:08.197589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:34:08.198091 [debug] [MainThread]: Connection 'model.dbt_robert.visitors_userstitching' was properly closed.
[0m08:34:08.198540 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m08:34:08.199170 [info ] [MainThread]: 
[0m08:34:08.200211 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 29.53 seconds (29.53s).
[0m08:34:08.202615 [debug] [MainThread]: Command end result
[0m08:34:08.211666 [info ] [MainThread]: 
[0m08:34:08.212399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:34:08.213431 [info ] [MainThread]: 
[0m08:34:08.214046 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:34:08.215726 [debug] [MainThread]: Command `dbt run` succeeded at 08:34:08.215595 after 30.10 seconds
[0m08:34:08.216160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40c0fe350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4096715a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc40939ae90>]}
[0m08:34:08.217029 [debug] [MainThread]: Flushing usage events
[0m08:34:56.420583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb20da350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb0dce4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb0dce440>]}


============================== 08:34:56.423277 | edcc2a82-0a57-4ac9-82e4-ce7e592726a9 ==============================
[0m08:34:56.423277 [info ] [MainThread]: Running with dbt=1.5.3
[0m08:34:56.424318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:34:56.781381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edcc2a82-0a57-4ac9-82e4-ce7e592726a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb1dc4d90>]}
[0m08:34:56.798925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edcc2a82-0a57-4ac9-82e4-ce7e592726a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaf2b1d20>]}
[0m08:34:56.799767 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m08:34:56.812971 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m08:34:56.842220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:34:56.843057 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/visitors_userstitching.sql
[0m08:34:56.868425 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/visitors_userstitching.sql
[0m08:34:56.892069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edcc2a82-0a57-4ac9-82e4-ce7e592726a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaf12ca60>]}
[0m08:34:56.901831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edcc2a82-0a57-4ac9-82e4-ce7e592726a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaf0d40a0>]}
[0m08:34:56.902360 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m08:34:56.903159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edcc2a82-0a57-4ac9-82e4-ce7e592726a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaf0d4910>]}
[0m08:34:56.905313 [info ] [MainThread]: 
[0m08:34:56.906371 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:34:56.907901 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:34:56.908390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:34:57.942172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m08:34:57.942947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:34:58.218362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edcc2a82-0a57-4ac9-82e4-ce7e592726a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaf1d4cd0>]}
[0m08:34:58.219702 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:34:58.220536 [info ] [MainThread]: 
[0m08:34:58.225479 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m08:34:58.226103 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m08:34:58.226823 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m08:34:58.229033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m08:34:58.229595 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m08:34:58.227896 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m08:34:58.233956 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m08:34:58.235086 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m08:34:58.235971 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m08:34:58.239583 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m08:34:58.240399 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 08:34:58.229950 => 08:34:58.240045
[0m08:34:58.241410 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 08:34:58.236394 => 08:34:58.241072
[0m08:34:58.241883 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m08:34:58.242486 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m08:34:58.260161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:58.269048 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:34:58.786447 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m08:34:58.788434 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m08:34:58.789493 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m08:34:58.790419 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m08:35:02.807657 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ad8885c3-af7b-4ed1-9a42-a789ae9ae779&page=queryresults
[0m08:35:02.826346 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 08:34:58.260496 => 08:35:02.826131
[0m08:35:02.827219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edcc2a82-0a57-4ac9-82e4-ce7e592726a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaf1d4a30>]}
[0m08:35:02.827925 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.59s]
[0m08:35:02.829178 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m08:35:02.829939 [debug] [Thread-2 (]: Began running node model.dbt_robert.visitors_userstitching
[0m08:35:02.830602 [info ] [Thread-2 (]: 3 of 4 START sql table model dbt_robert.visitors_userstitching ................. [RUN]
[0m08:35:02.831593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.dbt_robert.visitors_userstitching)
[0m08:35:02.832051 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.visitors_userstitching
[0m08:35:02.835882 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.visitors_userstitching"
[0m08:35:02.836736 [debug] [Thread-2 (]: Timing info for model.dbt_robert.visitors_userstitching (compile): 08:35:02.832348 => 08:35:02.836409
[0m08:35:02.837242 [debug] [Thread-2 (]: Began executing node model.dbt_robert.visitors_userstitching
[0m08:35:02.840006 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:35:03.366003 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.visitors_userstitching"
[0m08:35:03.366944 [debug] [Thread-2 (]: On model.dbt_robert.visitors_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.visitors_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`visitors_userstitching`
    
    

    OPTIONS()
    as (
      


-- one record per visitor id
with visitors_userstitching as (
    select distinct
        visitor_id,

        first_value(customer_id ignore nulls) over (
            partition by visitor_id
            order by timestamp
            range between unbounded preceding and unbounded following
        ) as first_customer_id,

        min(timestamp) over (
            partition by visitor_id
        ) as first_seen_at,

        max(timestamp) over (
            partition by visitor_id
        ) as last_seen_at


    from `analytics-engineers-club`.`web_tracking`.`pageviews`
)
select
    *,
    first_value(visitor_id) over (
        partition by coalesce(first_customer_id, visitor_id)
        order by first_seen_at
    ) as first_visitor_id
from visitors_userstitching
    );
  
[0m08:35:03.693211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:83cc901f-9b87-4034-8651-3f6ef4d3f2da&page=queryresults
[0m08:35:03.695971 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 08:34:58.242895 => 08:35:03.695754
[0m08:35:03.696832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edcc2a82-0a57-4ac9-82e4-ce7e592726a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaf0b8670>]}
[0m08:35:03.697536 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 5.47s]
[0m08:35:03.698634 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m08:35:10.677310 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5517e63c-c5a2-4185-824c-bee5feb51f8f&page=queryresults
[0m08:35:10.680517 [debug] [Thread-2 (]: Timing info for model.dbt_robert.visitors_userstitching (execute): 08:35:02.837532 => 08:35:10.680247
[0m08:35:10.681640 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edcc2a82-0a57-4ac9-82e4-ce7e592726a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaf0b94b0>]}
[0m08:35:10.682446 [info ] [Thread-2 (]: 3 of 4 OK created sql table model dbt_robert.visitors_userstitching ............ [[32mCREATE TABLE (1.4m rows, 292.6 MiB processed)[0m in 7.85s]
[0m08:35:10.683435 [debug] [Thread-2 (]: Finished running node model.dbt_robert.visitors_userstitching
[0m08:35:10.684757 [debug] [Thread-1 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m08:35:10.685449 [info ] [Thread-1 (]: 4 of 4 START sql table model dbt_robert.pageviews_userstitching ................ [RUN]
[0m08:35:10.686412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.pageviews_userstitching)
[0m08:35:10.686996 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m08:35:10.692413 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m08:35:10.693401 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 08:35:10.688063 => 08:35:10.693143
[0m08:35:10.693838 [debug] [Thread-1 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m08:35:10.696271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:35:11.024887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m08:35:11.026002 [debug] [Thread-1 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

-- SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`

with pageviews as (
    select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
),

visitors as (
    select * from `aec-students`.`dbt_robert`.`visitors_userstitching`
),

joined as (
    select
        pageviews.*,
        -- customer id if we have it, else visitor id
        coalesce(
            visitors.first_customer_id,
            pageviews.visitor_id
        ) as blended_user_id,

        visitors.first_visitor_id

    from pageviews
    left join visitors
        on pageviews.visitor_id = visitors.visitor_id
)

select * from joined
    );
  
[0m08:35:29.004308 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:26539628-0f41-4e31-af0e-d5b0d15013f8&page=queryresults
[0m08:35:29.007377 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 08:35:10.694131 => 08:35:29.007102
[0m08:35:29.008498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edcc2a82-0a57-4ac9-82e4-ce7e592726a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaec273d0>]}
[0m08:35:29.009366 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dbt_robert.pageviews_userstitching ........... [[32mCREATE TABLE (5.8m rows, 719.6 MiB processed)[0m in 18.32s]
[0m08:35:29.010771 [debug] [Thread-1 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m08:35:29.013409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:35:29.013931 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m08:35:29.014295 [debug] [MainThread]: Connection 'model.dbt_robert.visitors_userstitching' was properly closed.
[0m08:35:29.014732 [info ] [MainThread]: 
[0m08:35:29.015323 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 32.11 seconds (32.11s).
[0m08:35:29.017485 [debug] [MainThread]: Command end result
[0m08:35:29.079329 [info ] [MainThread]: 
[0m08:35:29.080192 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:35:29.080965 [info ] [MainThread]: 
[0m08:35:29.081662 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:35:29.082754 [debug] [MainThread]: Command `dbt run` succeeded at 08:35:29.082582 after 32.67 seconds
[0m08:35:29.083192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb20da350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbaf820400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbafe6ab60>]}
[0m08:35:29.083645 [debug] [MainThread]: Flushing usage events
[0m09:33:38.157235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfc97a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfb70a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfb70a440>]}


============================== 09:33:38.160507 | 9ea23713-7b4d-4d01-bcc4-05d023fba072 ==============================
[0m09:33:38.160507 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:33:38.161389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:33:39.865628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ea23713-7b4d-4d01-bcc4-05d023fba072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfc864d90>]}
[0m09:33:39.883998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ea23713-7b4d-4d01-bcc4-05d023fba072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf9df5420>]}
[0m09:33:39.884872 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:33:39.895846 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:33:40.017495 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m09:33:40.018223 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/staging/advanced_sql_exercises/visitors_sessionization.sql
[0m09:33:40.018744 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/staging/advanced_sql_exercises/visitors_userstitching.sql
[0m09:33:40.045171 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/visitors_sessionization.sql
[0m09:33:40.059083 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m09:33:40.097059 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_robert.pageviews_userstitching' (models/staging/advanced_sql_exercises/pageviews_userstitching.sql) depends on a node named 'visitors_userstitching' which was not found
[0m09:33:40.098208 [debug] [MainThread]: Command `dbt run` failed at 09:33:40.098060 after 1.97 seconds
[0m09:33:40.098657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bfc97a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf9c30f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bf9be4f70>]}
[0m09:33:40.099120 [debug] [MainThread]: Flushing usage events
[0m09:35:32.946287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8975cb6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8974a0a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8974a0a410>]}


============================== 09:35:32.948812 | e86ed82e-5b2b-474e-8d84-672f215c54d0 ==============================
[0m09:35:32.948812 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:35:32.949560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:35:33.346475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e86ed82e-5b2b-474e-8d84-672f215c54d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8975bf3430>]}
[0m09:35:33.366788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e86ed82e-5b2b-474e-8d84-672f215c54d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89730f3730>]}
[0m09:35:33.367600 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m09:35:33.378442 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m09:35:33.409393 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m09:35:33.409985 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/staging/advanced_sql_exercises/visitors_sessionization.sql
[0m09:35:33.410464 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/staging/advanced_sql_exercises/visitors_userstitching.sql
[0m09:35:33.410868 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m09:35:33.435750 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/visitors_sessionization.sql
[0m09:35:33.449281 [debug] [MainThread]: 1699: static parser successfully parsed staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m09:35:33.499737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e86ed82e-5b2b-474e-8d84-672f215c54d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8972963fd0>]}
[0m09:35:33.509221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e86ed82e-5b2b-474e-8d84-672f215c54d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8972f804f0>]}
[0m09:35:33.509777 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m09:35:33.510471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e86ed82e-5b2b-474e-8d84-672f215c54d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8972f804c0>]}
[0m09:35:33.512654 [info ] [MainThread]: 
[0m09:35:33.513644 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:35:33.515104 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m09:35:33.515621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:38.890137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m09:35:38.890734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:39.198686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e86ed82e-5b2b-474e-8d84-672f215c54d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8972f80190>]}
[0m09:35:39.199624 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m09:35:39.200332 [info ] [MainThread]: 
[0m09:35:39.228563 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m09:35:39.229076 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m09:35:39.229706 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m09:35:39.231421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m09:35:39.232292 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m09:35:39.230597 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m09:35:39.236499 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m09:35:39.237926 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m09:35:39.241758 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m09:35:39.244316 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 09:35:39.238620 => 09:35:39.244065
[0m09:35:39.247865 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m09:35:39.248405 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m09:35:39.249247 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 09:35:39.232777 => 09:35:39.248936
[0m09:35:39.263833 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:35:39.264362 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m09:35:39.268964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:39.697876 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m09:35:39.698821 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m09:35:39.704934 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m09:35:39.705913 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m09:35:43.708202 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b6596a45-1079-4c42-8bdf-d6ef3a811968&page=queryresults
[0m09:35:43.725081 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 09:35:39.249508 => 09:35:43.724857
[0m09:35:43.725921 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e86ed82e-5b2b-474e-8d84-672f215c54d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8972956d10>]}
[0m09:35:43.726641 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.49s]
[0m09:35:43.727557 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m09:35:43.728131 [debug] [Thread-2 (]: Began running node model.dbt_robert.visitors_sessionization
[0m09:35:43.728745 [info ] [Thread-2 (]: 3 of 4 START sql table model dbt_robert.visitors_sessionization ................ [RUN]
[0m09:35:43.729813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.dbt_robert.visitors_sessionization)
[0m09:35:43.730324 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.visitors_sessionization
[0m09:35:43.733771 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.visitors_sessionization"
[0m09:35:43.734920 [debug] [Thread-2 (]: Timing info for model.dbt_robert.visitors_sessionization (compile): 09:35:43.730595 => 09:35:43.734592
[0m09:35:43.735511 [debug] [Thread-2 (]: Began executing node model.dbt_robert.visitors_sessionization
[0m09:35:43.743003 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.visitors_sessionization"
[0m09:35:43.743854 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:43.744538 [debug] [Thread-2 (]: On model.dbt_robert.visitors_sessionization: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.visitors_sessionization"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`visitors_sessionization`
    
    

    OPTIONS()
    as (
      


-- one record per visitor id
with visitors_userstitching as (
    select distinct
        visitor_id,

        first_value(customer_id ignore nulls) over (
            partition by visitor_id
            order by timestamp
            range between unbounded preceding and unbounded following
        ) as first_customer_id,

        min(timestamp) over (
            partition by visitor_id
        ) as first_seen_at,

        max(timestamp) over (
            partition by visitor_id
        ) as last_seen_at


    from `analytics-engineers-club`.`web_tracking`.`pageviews`
)
select
    *,
    first_value(visitor_id) over (
        partition by coalesce(first_customer_id, visitor_id)
        order by first_seen_at
    ) as first_visitor_id
from visitors_userstitching
    );
  
[0m09:35:44.312603 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:69211d72-0d9e-49d0-8e7f-263ef59ecb4f&page=queryresults
[0m09:35:44.314834 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 09:35:39.266229 => 09:35:44.314594
[0m09:35:44.317203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e86ed82e-5b2b-474e-8d84-672f215c54d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8972850f10>]}
[0m09:35:44.317934 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 5.09s]
[0m09:35:44.319621 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m09:35:53.141893 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:423c1114-191d-450c-a2af-2e78b5dff25e&page=queryresults
[0m09:35:53.144203 [debug] [Thread-2 (]: Timing info for model.dbt_robert.visitors_sessionization (execute): 09:35:43.736006 => 09:35:53.143978
[0m09:35:53.145061 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e86ed82e-5b2b-474e-8d84-672f215c54d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8972851540>]}
[0m09:35:53.145778 [info ] [Thread-2 (]: 3 of 4 OK created sql table model dbt_robert.visitors_sessionization ........... [[32mCREATE TABLE (1.4m rows, 292.6 MiB processed)[0m in 9.42s]
[0m09:35:53.146843 [debug] [Thread-2 (]: Finished running node model.dbt_robert.visitors_sessionization
[0m09:35:53.147824 [debug] [Thread-1 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m09:35:53.148528 [info ] [Thread-1 (]: 4 of 4 START sql table model dbt_robert.pageviews_userstitching ................ [RUN]
[0m09:35:53.149319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.pageviews_userstitching)
[0m09:35:53.149733 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m09:35:53.197307 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m09:35:53.198499 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 09:35:53.149991 => 09:35:53.198148
[0m09:35:53.199146 [debug] [Thread-1 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m09:35:53.202978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:53.561098 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m09:35:53.562041 [debug] [Thread-1 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

-- SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`

with pageviews as (
    select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
),

visitors as (
    select * from `aec-students`.`dbt_robert`.`visitors_sessionization`
),

joined as (
    select
        pageviews.*,
        -- customer id if we have it, else visitor id
        coalesce(
            visitors.first_customer_id,
            pageviews.visitor_id
        ) as blended_user_id,

        visitors.first_visitor_id

    from pageviews
    left join visitors
        on pageviews.visitor_id = visitors.visitor_id
)

select * from joined
    );
  
[0m09:36:08.523439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:dc7b46fe-79d7-4897-955e-3e6929d64d53&page=queryresults
[0m09:36:08.525784 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 09:35:53.199546 => 09:36:08.525579
[0m09:36:08.526607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e86ed82e-5b2b-474e-8d84-672f215c54d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8972f02050>]}
[0m09:36:08.527295 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dbt_robert.pageviews_userstitching ........... [[32mCREATE TABLE (5.8m rows, 719.6 MiB processed)[0m in 15.38s]
[0m09:36:08.528767 [debug] [Thread-1 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m09:36:08.530766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:36:08.531127 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m09:36:08.531451 [debug] [MainThread]: Connection 'model.dbt_robert.visitors_sessionization' was properly closed.
[0m09:36:08.531851 [info ] [MainThread]: 
[0m09:36:08.532409 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 35.02 seconds (35.02s).
[0m09:36:08.534194 [debug] [MainThread]: Command end result
[0m09:36:08.541757 [info ] [MainThread]: 
[0m09:36:08.542469 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:36:08.543096 [info ] [MainThread]: 
[0m09:36:08.543739 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:36:08.544743 [debug] [MainThread]: Command `dbt run` succeeded at 09:36:08.544568 after 35.61 seconds
[0m09:36:08.545253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8975cb6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8975a8d2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8972f09840>]}
[0m09:36:08.545675 [debug] [MainThread]: Flushing usage events
[0m14:14:08.043598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570f4be380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570e3c64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570e3c6470>]}


============================== 14:14:08.063743 | 49715d60-fc29-40fc-b8f0-3e2fb2f1667a ==============================
[0m14:14:08.063743 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:14:08.064814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:14:09.743466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49715d60-fc29-40fc-b8f0-3e2fb2f1667a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c8ab2e0>]}
[0m14:14:09.761344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49715d60-fc29-40fc-b8f0-3e2fb2f1667a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c8ae800>]}
[0m14:14:09.762509 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:14:09.774640 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:14:09.929153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:14:09.930335 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport view.sql
[0m14:14:09.956237 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport view.sql
[0m14:14:09.980434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49715d60-fc29-40fc-b8f0-3e2fb2f1667a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c725090>]}
[0m14:14:09.990914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49715d60-fc29-40fc-b8f0-3e2fb2f1667a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c6c8760>]}
[0m14:14:09.991675 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:14:09.992396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49715d60-fc29-40fc-b8f0-3e2fb2f1667a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c6c87f0>]}
[0m14:14:09.994873 [info ] [MainThread]: 
[0m14:14:09.995975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:14:09.999044 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:14:09.999762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:14.874073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m14:14:14.874796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:15.248632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49715d60-fc29-40fc-b8f0-3e2fb2f1667a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c6b34f0>]}
[0m14:14:15.249965 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:14:15.250936 [info ] [MainThread]: 
[0m14:14:15.272098 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m14:14:15.272682 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m14:14:15.273407 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m14:14:15.275665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m14:14:15.274278 [info ] [Thread-2 (]: 2 of 5 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m14:14:15.278599 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m14:14:15.279564 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m14:14:15.283405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m14:14:15.283930 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m14:14:15.284837 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 14:14:15.279949 => 14:14:15.284522
[0m14:14:15.287920 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m14:14:15.288439 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m14:14:15.289378 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 14:14:15.285093 => 14:14:15.289051
[0m14:14:15.305453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:15.306450 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m14:14:15.315867 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:14:15.756918 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m14:14:15.758707 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m14:14:15.759709 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m14:14:15.762292 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m14:14:19.801877 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b780b274-150a-4196-9573-ebe11086e1d8&page=queryresults
[0m14:14:19.820241 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 14:14:15.308613 => 14:14:19.819998
[0m14:14:19.821225 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49715d60-fc29-40fc-b8f0-3e2fb2f1667a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c6b4160>]}
[0m14:14:19.822083 [info ] [Thread-2 (]: 2 of 5 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.54s]
[0m14:14:19.823092 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m14:14:19.824004 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport view
[0m14:14:19.824910 [info ] [Thread-2 (]: 3 of 5 START sql view model dbt_robert.dbtcustomers_revenuereport view ......... [RUN]
[0m14:14:19.826977 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.dbt_robert.dbtcustomers_revenuereport view)
[0m14:14:19.828286 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport view
[0m14:14:19.833989 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport view"
[0m14:14:19.835702 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport view (compile): 14:14:19.828931 => 14:14:19.835188
[0m14:14:19.836506 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport view
[0m14:14:19.874179 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport view"
[0m14:14:19.875454 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:14:19.876244 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport view: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport view"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport view`
  OPTIONS()
  as 

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25;


[0m14:14:20.429419 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8ea13768-fe37-4ab1-be86-5a0da3333be5&page=queryresults
[0m14:14:20.432629 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 14:14:15.289670 => 14:14:20.432359
[0m14:14:20.433724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49715d60-fc29-40fc-b8f0-3e2fb2f1667a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c67f190>]}
[0m14:14:20.434621 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 5.16s]
[0m14:14:20.435681 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m14:14:20.436298 [debug] [Thread-1 (]: Began running node model.dbt_robert.visitors_sessionization
[0m14:14:20.436993 [info ] [Thread-1 (]: 4 of 5 START sql table model dbt_robert.visitors_sessionization ................ [RUN]
[0m14:14:20.438175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.visitors_sessionization)
[0m14:14:20.438784 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.visitors_sessionization
[0m14:14:20.443326 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.visitors_sessionization"
[0m14:14:20.444240 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_sessionization (compile): 14:14:20.439085 => 14:14:20.443901
[0m14:14:20.444689 [debug] [Thread-1 (]: Began executing node model.dbt_robert.visitors_sessionization
[0m14:14:20.447245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:20.853929 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c9d59125-58b3-42cc-9f51-564d1913ce61&page=queryresults
[0m14:14:20.856606 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport view (execute): 14:14:19.837038 => 14:14:20.856383
[0m14:14:20.857523 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49715d60-fc29-40fc-b8f0-3e2fb2f1667a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c239510>]}
[0m14:14:20.858268 [info ] [Thread-2 (]: 3 of 5 OK created sql view model dbt_robert.dbtcustomers_revenuereport view .... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m14:14:20.859259 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport view
[0m14:14:21.071035 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.visitors_sessionization"
[0m14:14:21.072275 [debug] [Thread-1 (]: On model.dbt_robert.visitors_sessionization: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.visitors_sessionization"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`visitors_sessionization`
    
    

    OPTIONS()
    as (
      


-- one record per visitor id
with visitors_userstitching as (
    select distinct
        visitor_id,

        first_value(customer_id ignore nulls) over (
            partition by visitor_id
            order by timestamp
            range between unbounded preceding and unbounded following
        ) as first_customer_id,

        min(timestamp) over (
            partition by visitor_id
        ) as first_seen_at,

        max(timestamp) over (
            partition by visitor_id
        ) as last_seen_at


    from `analytics-engineers-club`.`web_tracking`.`pageviews`
)
select
    *,
    first_value(visitor_id) over (
        partition by coalesce(first_customer_id, visitor_id)
        order by first_seen_at
    ) as first_visitor_id
from visitors_userstitching
    );
  
[0m14:14:31.367967 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0dbaac66-ab1a-432e-92bc-9cf80b9b2df1&page=queryresults
[0m14:14:31.370850 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_sessionization (execute): 14:14:20.444978 => 14:14:31.370630
[0m14:14:31.375363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49715d60-fc29-40fc-b8f0-3e2fb2f1667a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c062c50>]}
[0m14:14:31.376149 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dbt_robert.visitors_sessionization ........... [[32mCREATE TABLE (1.4m rows, 292.6 MiB processed)[0m in 10.94s]
[0m14:14:31.377301 [debug] [Thread-1 (]: Finished running node model.dbt_robert.visitors_sessionization
[0m14:14:31.378586 [debug] [Thread-2 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m14:14:31.379678 [info ] [Thread-2 (]: 5 of 5 START sql table model dbt_robert.pageviews_userstitching ................ [RUN]
[0m14:14:31.380726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport view, now model.dbt_robert.pageviews_userstitching)
[0m14:14:31.381213 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m14:14:31.453403 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m14:14:31.454551 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 14:14:31.381539 => 14:14:31.454182
[0m14:14:31.455042 [debug] [Thread-2 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m14:14:31.457488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:14:31.772678 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m14:14:31.773989 [debug] [Thread-2 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

-- SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`

with pageviews as (
    select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
),

visitors as (
    select * from `aec-students`.`dbt_robert`.`visitors_sessionization`
),

joined as (
    select
        pageviews.*,
        -- customer id if we have it, else visitor id
        coalesce(
            visitors.first_customer_id,
            pageviews.visitor_id
        ) as blended_user_id,

        visitors.first_visitor_id

    from pageviews
    left join visitors
        on pageviews.visitor_id = visitors.visitor_id
)

select * from joined
    );
  
[0m14:14:45.480218 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9ef96392-6ad9-4f53-acfc-75ad9c0de7ba&page=queryresults
[0m14:14:45.483212 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 14:14:31.455342 => 14:14:45.482980
[0m14:14:45.484141 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49715d60-fc29-40fc-b8f0-3e2fb2f1667a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c061cf0>]}
[0m14:14:45.484903 [info ] [Thread-2 (]: 5 of 5 OK created sql table model dbt_robert.pageviews_userstitching ........... [[32mCREATE TABLE (5.8m rows, 719.6 MiB processed)[0m in 14.10s]
[0m14:14:45.486148 [debug] [Thread-2 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m14:14:45.488418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:45.488787 [debug] [MainThread]: Connection 'model.dbt_robert.visitors_sessionization' was properly closed.
[0m14:14:45.489139 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m14:14:45.489613 [info ] [MainThread]: 
[0m14:14:45.490190 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 35.49 seconds (35.49s).
[0m14:14:45.492439 [debug] [MainThread]: Command end result
[0m14:14:45.502097 [info ] [MainThread]: 
[0m14:14:45.502977 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:45.503676 [info ] [MainThread]: 
[0m14:14:45.504533 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:14:45.505717 [debug] [MainThread]: Command `dbt run` succeeded at 14:14:45.505580 after 37.50 seconds
[0m14:14:45.506211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570f4be380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570f1e71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c6c87c0>]}
[0m14:14:45.506854 [debug] [MainThread]: Flushing usage events
[0m14:14:51.929812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82034ba350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82023c64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82023c6440>]}


============================== 14:14:51.932596 | 090fb0da-9067-40c9-834e-c457e8bc09ca ==============================
[0m14:14:51.932596 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:14:51.933795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:14:52.323353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '090fb0da-9067-40c9-834e-c457e8bc09ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82008ab1c0>]}
[0m14:14:52.341094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '090fb0da-9067-40c9-834e-c457e8bc09ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82008ad990>]}
[0m14:14:52.342244 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:14:52.355111 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:14:52.389573 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:14:52.390491 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport_view.sql
[0m14:14:52.390982 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport view.sql
[0m14:14:52.419396 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport_view.sql
[0m14:14:52.446069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '090fb0da-9067-40c9-834e-c457e8bc09ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82006f50f0>]}
[0m14:14:52.457058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '090fb0da-9067-40c9-834e-c457e8bc09ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82006cc940>]}
[0m14:14:52.457785 [info ] [MainThread]: Found 5 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:14:52.458439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '090fb0da-9067-40c9-834e-c457e8bc09ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82006cc7c0>]}
[0m14:14:52.460901 [info ] [MainThread]: 
[0m14:14:52.462071 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:14:52.464552 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:14:52.465212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:53.789825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m14:14:53.790690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:54.076862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '090fb0da-9067-40c9-834e-c457e8bc09ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82006b7400>]}
[0m14:14:54.078000 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:14:54.078897 [info ] [MainThread]: 
[0m14:14:54.083490 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m14:14:54.084034 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m14:14:54.084680 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m14:14:54.087012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m14:14:54.087832 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m14:14:54.085440 [info ] [Thread-2 (]: 2 of 5 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m14:14:54.091757 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m14:14:54.092659 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m14:14:54.093390 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m14:14:54.096522 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m14:14:54.097357 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 14:14:54.088368 => 14:14:54.097102
[0m14:14:54.098041 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m14:14:54.112102 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 14:14:54.093793 => 14:14:54.111849
[0m14:14:54.114042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:54.114547 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m14:14:54.123870 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:14:54.540144 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m14:14:54.541245 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m14:14:54.558313 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m14:14:54.559169 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m14:14:58.639113 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e0622eb7-6af2-437e-a077-7f5fb2a0af37&page=queryresults
[0m14:14:58.658756 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 14:14:54.116575 => 14:14:58.658509
[0m14:14:58.659767 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '090fb0da-9067-40c9-834e-c457e8bc09ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8200687490>]}
[0m14:14:58.660576 [info ] [Thread-2 (]: 2 of 5 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.57s]
[0m14:14:58.661671 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m14:14:58.662296 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m14:14:58.663055 [info ] [Thread-2 (]: 3 of 5 START sql view model dbt_robert.dbtcustomers_revenuereport_view ......... [RUN]
[0m14:14:58.664381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.dbt_robert.dbtcustomers_revenuereport_view)
[0m14:14:58.664854 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport_view
[0m14:14:58.669038 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m14:14:58.670007 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (compile): 14:14:58.665266 => 14:14:58.669677
[0m14:14:58.670452 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport_view
[0m14:14:58.691070 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m14:14:58.691960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:14:58.692517 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport_view: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport_view"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport_view`
  OPTIONS()
  as 

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25;


[0m14:14:59.624314 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4db835fb-81c2-4d57-afe3-1cf8274b25cb&page=queryresults
[0m14:14:59.627364 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (execute): 14:14:58.670746 => 14:14:59.627118
[0m14:14:59.628451 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '090fb0da-9067-40c9-834e-c457e8bc09ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8200687b20>]}
[0m14:14:59.629270 [info ] [Thread-2 (]: 3 of 5 OK created sql view model dbt_robert.dbtcustomers_revenuereport_view .... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m14:14:59.630517 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m14:14:59.631100 [debug] [Thread-2 (]: Began running node model.dbt_robert.visitors_sessionization
[0m14:14:59.631816 [info ] [Thread-2 (]: 4 of 5 START sql table model dbt_robert.visitors_sessionization ................ [RUN]
[0m14:14:59.634189 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport_view, now model.dbt_robert.visitors_sessionization)
[0m14:14:59.634683 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.visitors_sessionization
[0m14:14:59.640338 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.visitors_sessionization"
[0m14:14:59.641255 [debug] [Thread-2 (]: Timing info for model.dbt_robert.visitors_sessionization (compile): 14:14:59.635050 => 14:14:59.640949
[0m14:14:59.641731 [debug] [Thread-2 (]: Began executing node model.dbt_robert.visitors_sessionization
[0m14:14:59.644320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:14:59.952453 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.visitors_sessionization"
[0m14:14:59.953767 [debug] [Thread-2 (]: On model.dbt_robert.visitors_sessionization: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.visitors_sessionization"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`visitors_sessionization`
    
    

    OPTIONS()
    as (
      


-- one record per visitor id
with visitors_userstitching as (
    select distinct
        visitor_id,

        first_value(customer_id ignore nulls) over (
            partition by visitor_id
            order by timestamp
            range between unbounded preceding and unbounded following
        ) as first_customer_id,

        min(timestamp) over (
            partition by visitor_id
        ) as first_seen_at,

        max(timestamp) over (
            partition by visitor_id
        ) as last_seen_at


    from `analytics-engineers-club`.`web_tracking`.`pageviews`
)
select
    *,
    first_value(visitor_id) over (
        partition by coalesce(first_customer_id, visitor_id)
        order by first_seen_at
    ) as first_visitor_id
from visitors_userstitching
    );
  
[0m14:15:08.852088 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9dbb5d00-9285-46cb-9b85-901efac5aa5f&page=queryresults
[0m14:15:08.855093 [debug] [Thread-2 (]: Timing info for model.dbt_robert.visitors_sessionization (execute): 14:14:59.642029 => 14:15:08.854814
[0m14:15:08.856153 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '090fb0da-9067-40c9-834e-c457e8bc09ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82007e0a60>]}
[0m14:15:08.856922 [info ] [Thread-2 (]: 4 of 5 OK created sql table model dbt_robert.visitors_sessionization ........... [[32mCREATE TABLE (1.4m rows, 292.6 MiB processed)[0m in 9.22s]
[0m14:15:08.858195 [debug] [Thread-2 (]: Finished running node model.dbt_robert.visitors_sessionization
[0m14:15:08.859040 [debug] [Thread-2 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m14:15:08.859882 [info ] [Thread-2 (]: 5 of 5 START sql table model dbt_robert.pageviews_userstitching ................ [RUN]
[0m14:15:08.861122 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.visitors_sessionization, now model.dbt_robert.pageviews_userstitching)
[0m14:15:08.867594 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m14:15:08.940464 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m14:15:08.941694 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 14:15:08.867988 => 14:15:08.941280
[0m14:15:08.942233 [debug] [Thread-2 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m14:15:08.944937 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:15:09.267165 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m14:15:09.268353 [debug] [Thread-2 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

-- SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`

with pageviews as (
    select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
),

visitors as (
    select * from `aec-students`.`dbt_robert`.`visitors_sessionization`
),

joined as (
    select
        pageviews.*,
        -- customer id if we have it, else visitor id
        coalesce(
            visitors.first_customer_id,
            pageviews.visitor_id
        ) as blended_user_id,

        visitors.first_visitor_id

    from pageviews
    left join visitors
        on pageviews.visitor_id = visitors.visitor_id
)

select * from joined
    );
  
[0m14:15:11.296120 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c614dd96-827f-4fe3-a53d-a103fa4b9ece&page=queryresults
[0m14:15:11.299940 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 14:14:54.098342 => 14:15:11.299653
[0m14:15:11.301103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '090fb0da-9067-40c9-834e-c457e8bc09ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82006ad6f0>]}
[0m14:15:11.302108 [info ] [Thread-1 (]: 1 of 5 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 17.21s]
[0m14:15:11.303476 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m14:15:25.245219 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fd8de489-705b-4567-a5ea-2cf18ca1bef5&page=queryresults
[0m14:15:25.248455 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 14:15:08.942551 => 14:15:25.248178
[0m14:15:25.249561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '090fb0da-9067-40c9-834e-c457e8bc09ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82006ac880>]}
[0m14:15:25.250467 [info ] [Thread-2 (]: 5 of 5 OK created sql table model dbt_robert.pageviews_userstitching ........... [[32mCREATE TABLE (5.8m rows, 719.6 MiB processed)[0m in 16.39s]
[0m14:15:25.251554 [debug] [Thread-2 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m14:15:25.253924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:25.254307 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers' was properly closed.
[0m14:15:25.254658 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m14:15:25.255087 [info ] [MainThread]: 
[0m14:15:25.255711 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 32.79 seconds (32.79s).
[0m14:15:25.258000 [debug] [MainThread]: Command end result
[0m14:15:25.268127 [info ] [MainThread]: 
[0m14:15:25.268872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:25.269578 [info ] [MainThread]: 
[0m14:15:25.270365 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:15:25.271567 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:25.271414 after 33.35 seconds
[0m14:15:25.272055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82034ba350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82034085b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82006cc8e0>]}
[0m14:15:25.272570 [debug] [MainThread]: Flushing usage events
[0m15:33:46.565750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c088aa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0760e5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c0760e560>]}


============================== 15:33:46.584985 | c8511ffd-4b61-48b2-972a-884e401c508a ==============================
[0m15:33:46.584985 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:33:46.585932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:33:48.089651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8511ffd-4b61-48b2-972a-884e401c508a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c05cb7f40>]}
[0m15:33:48.108534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8511ffd-4b61-48b2-972a-884e401c508a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c05cf6470>]}
[0m15:33:48.109995 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:33:48.122271 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:33:48.248935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:33:48.249834 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/coffee_jinja.sql
[0m15:33:48.250653 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m15:33:48.278610 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_jinja.sql
[0m15:33:48.293164 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m15:33:48.370603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8511ffd-4b61-48b2-972a-884e401c508a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c055e6080>]}
[0m15:33:48.381030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8511ffd-4b61-48b2-972a-884e401c508a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c05b80b50>]}
[0m15:33:48.381686 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:33:48.382397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8511ffd-4b61-48b2-972a-884e401c508a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c05b80b80>]}
[0m15:33:48.383294 [error] [MainThread]: Encountered an error:
Non-relative patterns are unsupported
[0m15:33:48.403443 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 568, in run
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 428, in run
    self._runtime_initialize()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/compile.py", line 158, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 137, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/runnable.py", line 130, in get_graph_queue
    return selector.get_graph_queue(spec)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 302, in get_graph_queue
    selected_nodes = self.get_selected(spec)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 293, in get_selected
    selected_nodes, indirect_only = self.select_nodes(spec)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 156, in select_nodes
    direct_nodes, indirect_nodes = self.select_nodes_recursively(spec)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 128, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 128, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 128, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 128, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 128, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 128, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 126, in select_nodes_recursively
    direct_nodes, indirect_nodes = self.get_nodes_from_criteria(spec)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 80, in get_nodes_from_criteria
    collected = self.select_included(nodes, spec)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector.py", line 66, in select_included
    return set(method.search(included_nodes, spec.value))
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector_methods.py", line 334, in search
    paths = set(p.relative_to(root) for p in root.glob(selector))
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/graph/selector_methods.py", line 334, in <genexpr>
    paths = set(p.relative_to(root) for p in root.glob(selector))
  File "/usr/lib/python3.10/pathlib.py", line 1032, in glob
    raise NotImplementedError("Non-relative patterns are unsupported")
NotImplementedError: Non-relative patterns are unsupported

[0m15:33:48.404999 [debug] [MainThread]: Command `dbt run` failed at 15:33:48.404818 after 1.86 seconds
[0m15:33:48.405454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c088aa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c05b80400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c05b80250>]}
[0m15:33:48.405917 [debug] [MainThread]: Flushing usage events
[0m15:34:31.268940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dda71a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd99a6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd99a64d0>]}


============================== 15:34:31.271723 | 3b85ffc0-ba96-447c-8bd9-7b89ef1bdf7c ==============================
[0m15:34:31.271723 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:34:31.272548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:34:31.630732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b85ffc0-ba96-447c-8bd9-7b89ef1bdf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dda646650>]}
[0m15:34:31.648779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b85ffc0-ba96-447c-8bd9-7b89ef1bdf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd7bcd5a0>]}
[0m15:34:31.649678 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:34:31.661342 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:34:31.691895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:31.692305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:31.699593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b85ffc0-ba96-447c-8bd9-7b89ef1bdf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd79e5930>]}
[0m15:34:31.710156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b85ffc0-ba96-447c-8bd9-7b89ef1bdf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd7add600>]}
[0m15:34:31.710962 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:34:31.711658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b85ffc0-ba96-447c-8bd9-7b89ef1bdf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd7add630>]}
[0m15:34:31.713349 [info ] [MainThread]: 
[0m15:34:31.714757 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:34:31.716272 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:34:31.716806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:37.125418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m15:34:37.126150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:37.405036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b85ffc0-ba96-447c-8bd9-7b89ef1bdf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd7adceb0>]}
[0m15:34:37.406655 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:34:37.407598 [info ] [MainThread]: 
[0m15:34:37.446808 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:34:37.447537 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m15:34:37.448438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m15:34:37.448927 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m15:34:37.453396 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:34:37.455237 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 15:34:37.449233 => 15:34:37.454812
[0m15:34:37.455954 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m15:34:37.476413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:37.802333 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:34:37.803522 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at as sold_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category as product_category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m15:34:41.341646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:aed38277-6ac6-41b9-b50b-4e3e0a8ef52b&page=queryresults
[0m15:34:41.360841 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 15:34:37.456278 => 15:34:41.360597
[0m15:34:41.361832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b85ffc0-ba96-447c-8bd9-7b89ef1bdf7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd7877160>]}
[0m15:34:41.362641 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 3.91s]
[0m15:34:41.363851 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:34:41.365683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:41.366064 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m15:34:41.366480 [info ] [MainThread]: 
[0m15:34:41.367054 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.65 seconds (9.65s).
[0m15:34:41.368029 [debug] [MainThread]: Command end result
[0m15:34:41.381258 [info ] [MainThread]: 
[0m15:34:41.382095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:34:41.382848 [info ] [MainThread]: 
[0m15:34:41.383813 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:34:41.384912 [debug] [MainThread]: Command `dbt run` succeeded at 15:34:41.384714 after 10.12 seconds
[0m15:34:41.385624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dda71a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dda445930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd7bcd5a0>]}
[0m15:34:41.386095 [debug] [MainThread]: Flushing usage events
[0m15:35:26.201128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a55223e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a44ca5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a44ca530>]}


============================== 15:35:26.203901 | 2b325e9d-cf0c-4eba-89c4-8874c156b8c2 ==============================
[0m15:35:26.203901 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:35:26.205013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:35:26.568946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b325e9d-cf0c-4eba-89c4-8874c156b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a52ca6b0>]}
[0m15:35:26.589084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b325e9d-cf0c-4eba-89c4-8874c156b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a299dcc0>]}
[0m15:35:26.590724 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:35:26.606288 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:35:26.636617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:26.637031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:26.644210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b325e9d-cf0c-4eba-89c4-8874c156b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a27b56f0>]}
[0m15:35:26.654402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b325e9d-cf0c-4eba-89c4-8874c156b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a28bd3c0>]}
[0m15:35:26.654975 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:35:26.655792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b325e9d-cf0c-4eba-89c4-8874c156b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a28bd3f0>]}
[0m15:35:26.658591 [info ] [MainThread]: 
[0m15:35:26.659660 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:35:26.661098 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:35:26.661645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:27.761371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m15:35:27.762270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:28.043087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b325e9d-cf0c-4eba-89c4-8874c156b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a2773280>]}
[0m15:35:28.044380 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:35:28.045075 [info ] [MainThread]: 
[0m15:35:28.050022 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:35:28.051177 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m15:35:28.052579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m15:35:28.053297 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m15:35:28.058063 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:35:28.059105 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 15:35:28.053777 => 15:35:28.058643
[0m15:35:28.059661 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m15:35:28.079707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:28.420146 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:35:28.421205 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at as sold_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category as product_category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m15:35:33.137312 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d986e7de-1699-4c20-8cfa-027d581ae1fa&page=queryresults
[0m15:35:33.156033 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 15:35:28.059957 => 15:35:33.155776
[0m15:35:33.157060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b325e9d-cf0c-4eba-89c4-8874c156b8c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a26470a0>]}
[0m15:35:33.157896 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 5.10s]
[0m15:35:33.158924 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:35:33.160923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:33.161309 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m15:35:33.161719 [info ] [MainThread]: 
[0m15:35:33.162296 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.50 seconds (6.50s).
[0m15:35:33.163220 [debug] [MainThread]: Command end result
[0m15:35:33.173863 [info ] [MainThread]: 
[0m15:35:33.174622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:33.175286 [info ] [MainThread]: 
[0m15:35:33.176073 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:35:33.177308 [debug] [MainThread]: Command `dbt run` succeeded at 15:35:33.177171 after 6.98 seconds
[0m15:35:33.177750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a55223e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a299dcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0a2646b30>]}
[0m15:35:33.178295 [debug] [MainThread]: Flushing usage events
[0m15:36:20.410211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14bab82410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b99125f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b9912560>]}


============================== 15:36:20.412989 | 21a74197-f4a0-4b6e-9ae1-d7713c400272 ==============================
[0m15:36:20.412989 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:36:20.414118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:36:20.781318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21a74197-f4a0-4b6e-9ae1-d7713c400272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b7ff7280>]}
[0m15:36:20.799270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21a74197-f4a0-4b6e-9ae1-d7713c400272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b7ffa800>]}
[0m15:36:20.800238 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:36:20.811943 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:36:20.842295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:20.843091 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m15:36:20.869639 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m15:36:20.974301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21a74197-f4a0-4b6e-9ae1-d7713c400272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b789a740>]}
[0m15:36:20.984667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21a74197-f4a0-4b6e-9ae1-d7713c400272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b7f0d810>]}
[0m15:36:20.985487 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:36:20.986070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21a74197-f4a0-4b6e-9ae1-d7713c400272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b7f0d7b0>]}
[0m15:36:20.988355 [info ] [MainThread]: 
[0m15:36:20.989545 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:36:20.991044 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:36:20.991648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:22.229189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m15:36:22.230248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:22.503106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21a74197-f4a0-4b6e-9ae1-d7713c400272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b7866d10>]}
[0m15:36:22.504426 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:36:22.505518 [info ] [MainThread]: 
[0m15:36:22.510726 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:36:22.511392 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m15:36:22.512710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m15:36:22.513376 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m15:36:22.519504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:36:22.521329 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 15:36:22.513815 => 15:36:22.520911
[0m15:36:22.522204 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m15:36:22.538542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:22.863875 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:36:22.864918 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at as sold_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category as product_category
,PP.price s amount
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m15:36:23.122674 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "amount" at [21:13]')
[0m15:36:23.716885 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9ba791cc-d802-440d-b340-7923a2767bcd&page=queryresults
[0m15:36:23.718503 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 15:36:22.522662 => 15:36:23.718163
[0m15:36:23.742310 [debug] [Thread-1 (]: Database Error in model dbtcustomers_revenuereport (models/marts/revenuereport/dbtcustomers_revenuereport.sql)
  Syntax error: Expected ")" but got identifier "amount" at [21:13]
  compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m15:36:23.742936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21a74197-f4a0-4b6e-9ae1-d7713c400272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b7899540>]}
[0m15:36:23.743793 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.dbtcustomers_revenuereport .... [[31mERROR[0m in 1.23s]
[0m15:36:23.744599 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:36:23.746852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:23.747238 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m15:36:23.747724 [info ] [MainThread]: 
[0m15:36:23.748229 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m15:36:23.748951 [debug] [MainThread]: Command end result
[0m15:36:23.765513 [info ] [MainThread]: 
[0m15:36:23.766750 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:36:23.767378 [info ] [MainThread]: 
[0m15:36:23.768050 [error] [MainThread]: [33mDatabase Error in model dbtcustomers_revenuereport (models/marts/revenuereport/dbtcustomers_revenuereport.sql)[0m
[0m15:36:23.769074 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "amount" at [21:13]
[0m15:36:23.769633 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m15:36:23.770573 [info ] [MainThread]: 
[0m15:36:23.771191 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:36:23.772529 [debug] [MainThread]: Command `dbt run` failed at 15:36:23.772370 after 3.37 seconds
[0m15:36:23.773001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14bab82410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b7ffbaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14b7ffbac0>]}
[0m15:36:23.773489 [debug] [MainThread]: Flushing usage events
[0m15:36:52.011128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683d1923e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683bece5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683bece530>]}


============================== 15:36:52.013909 | 969be675-098b-4d83-bf6c-9a2dc9abd747 ==============================
[0m15:36:52.013909 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:36:52.014753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:36:52.390463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '969be675-098b-4d83-bf6c-9a2dc9abd747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683cf3c9a0>]}
[0m15:36:52.407869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '969be675-098b-4d83-bf6c-9a2dc9abd747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683a3b3790>]}
[0m15:36:52.408853 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:36:52.420879 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:36:52.451648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:52.452442 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/revenuereport/dbtcustomers_revenuereport.sql
[0m15:36:52.477825 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m15:36:52.563340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '969be675-098b-4d83-bf6c-9a2dc9abd747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6839ca1bd0>]}
[0m15:36:52.573365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '969be675-098b-4d83-bf6c-9a2dc9abd747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683a2c4ca0>]}
[0m15:36:52.573967 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:36:52.574779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969be675-098b-4d83-bf6c-9a2dc9abd747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683a2c4c40>]}
[0m15:36:52.576648 [info ] [MainThread]: 
[0m15:36:52.577831 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:36:52.579328 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:36:52.579884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:53.628161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m15:36:53.629008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:53.891806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969be675-098b-4d83-bf6c-9a2dc9abd747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683a2c49d0>]}
[0m15:36:53.892893 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:36:53.893538 [info ] [MainThread]: 
[0m15:36:53.898502 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:36:53.899168 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m15:36:53.900241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers_revenuereport)
[0m15:36:53.900675 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m15:36:53.904626 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:36:53.905611 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 15:36:53.900952 => 15:36:53.905250
[0m15:36:53.906186 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m15:36:53.921933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:54.282915 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:36:54.284002 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at as sold_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category as product_category
,PP.price as amount
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m15:37:14.316370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1d1b2363-94e2-4464-9d86-a360da2ba3de&page=queryresults
[0m15:37:14.333686 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 15:36:53.906511 => 15:37:14.333460
[0m15:37:14.334594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '969be675-098b-4d83-bf6c-9a2dc9abd747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6839d0f1f0>]}
[0m15:37:14.335372 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 20.43s]
[0m15:37:14.336434 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:37:14.339008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:14.339387 [debug] [MainThread]: Connection 'model.dbt_robert.dbtcustomers_revenuereport' was properly closed.
[0m15:37:14.339833 [info ] [MainThread]: 
[0m15:37:14.340442 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.76 seconds (21.76s).
[0m15:37:14.341580 [debug] [MainThread]: Command end result
[0m15:37:14.439073 [info ] [MainThread]: 
[0m15:37:14.441088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:14.441826 [info ] [MainThread]: 
[0m15:37:14.442940 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:37:14.444118 [debug] [MainThread]: Command `dbt run` succeeded at 15:37:14.443907 after 22.44 seconds
[0m15:37:14.444671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683d1923e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683a6628c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f683a49e9e0>]}
[0m15:37:14.445162 [debug] [MainThread]: Flushing usage events
[0m15:38:36.327982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d77b6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d66c6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d66c64d0>]}


============================== 15:38:36.330775 | 167473cd-9f7f-4d31-bfb6-7c1fd6db991f ==============================
[0m15:38:36.330775 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:38:36.331620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:38:36.698016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '167473cd-9f7f-4d31-bfb6-7c1fd6db991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d76ee650>]}
[0m15:38:36.715584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '167473cd-9f7f-4d31-bfb6-7c1fd6db991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d4bb1300>]}
[0m15:38:36.716356 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:38:36.727552 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:38:36.757393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:38:36.757791 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:38:36.764853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '167473cd-9f7f-4d31-bfb6-7c1fd6db991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d49cd750>]}
[0m15:38:36.774943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '167473cd-9f7f-4d31-bfb6-7c1fd6db991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d4ad1360>]}
[0m15:38:36.775503 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:38:36.776173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '167473cd-9f7f-4d31-bfb6-7c1fd6db991f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d4ad1420>]}
[0m15:38:36.777241 [warn ] [MainThread]: The selection criterion 'coffee_jinja.sql' does not match any nodes
[0m15:38:36.778631 [info ] [MainThread]: 
[0m15:38:36.779261 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:38:36.780149 [debug] [MainThread]: Command end result
[0m15:38:36.788909 [debug] [MainThread]: Command `dbt run` succeeded at 15:38:36.788757 after 0.47 seconds
[0m15:38:36.789379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d77b6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d4ad1030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d4ad0fd0>]}
[0m15:38:36.789829 [debug] [MainThread]: Flushing usage events
[0m15:39:41.952585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1325f22470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1324cce650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1324cce5c0>]}


============================== 15:39:41.955317 | 4c86c1b5-0e3a-40df-b39e-03a9002463f9 ==============================
[0m15:39:41.955317 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:39:41.956427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:39:42.374670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c86c1b5-0e3a-40df-b39e-03a9002463f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1325a1b0d0>]}
[0m15:39:42.392337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c86c1b5-0e3a-40df-b39e-03a9002463f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13231b1360>]}
[0m15:39:42.393188 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:39:42.404676 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:39:42.434544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:42.435279 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/revenue/dbtcustomers_sources.yml
[0m15:39:42.469813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c86c1b5-0e3a-40df-b39e-03a9002463f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13230080d0>]}
[0m15:39:42.482130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c86c1b5-0e3a-40df-b39e-03a9002463f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1322fc1c30>]}
[0m15:39:42.482696 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:39:42.483400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c86c1b5-0e3a-40df-b39e-03a9002463f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1322fc3eb0>]}
[0m15:39:42.484543 [warn ] [MainThread]: The selection criterion 'coffee_jinja.sql' does not match any nodes
[0m15:39:42.485929 [info ] [MainThread]: 
[0m15:39:42.486624 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:39:42.487580 [debug] [MainThread]: Command end result
[0m15:39:42.495975 [debug] [MainThread]: Command `dbt run` succeeded at 15:39:42.495780 after 0.55 seconds
[0m15:39:42.496574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1325f22470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1322fc2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1322fc3a60>]}
[0m15:39:42.497028 [debug] [MainThread]: Flushing usage events
[0m15:39:52.210344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12f0982410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ef6ce5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ef6ce560>]}


============================== 15:39:52.213157 | 0bb2f8f2-9320-40be-bc79-89227a8fbd15 ==============================
[0m15:39:52.213157 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:39:52.213972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:39:52.585759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bb2f8f2-9320-40be-bc79-89227a8fbd15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12edbad720>]}
[0m15:39:52.604120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bb2f8f2-9320-40be-bc79-89227a8fbd15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12edbb7520>]}
[0m15:39:52.605038 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:39:52.616908 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:39:52.647584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:52.648099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:52.655648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bb2f8f2-9320-40be-bc79-89227a8fbd15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ed9c9cf0>]}
[0m15:39:52.665876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bb2f8f2-9320-40be-bc79-89227a8fbd15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12edadd9c0>]}
[0m15:39:52.666591 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:39:52.667331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bb2f8f2-9320-40be-bc79-89227a8fbd15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12edadd9f0>]}
[0m15:39:52.668336 [warn ] [MainThread]: The selection criterion 'coffee_jinja' does not match any nodes
[0m15:39:52.669965 [info ] [MainThread]: 
[0m15:39:52.670550 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:39:52.671375 [debug] [MainThread]: Command end result
[0m15:39:52.679522 [debug] [MainThread]: Command `dbt run` succeeded at 15:39:52.679273 after 0.48 seconds
[0m15:39:52.680156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12f0982410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12f0552b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12edadd510>]}
[0m15:39:52.680607 [debug] [MainThread]: Flushing usage events
[0m15:40:17.283695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2952d563e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2951b125c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2951b12530>]}


============================== 15:40:17.286511 | c9bf99f4-0c1f-4586-a3dd-850ea720bf5b ==============================
[0m15:40:17.286511 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:40:17.287335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:40:17.655474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9bf99f4-0c1f-4586-a3dd-850ea720bf5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29501f7220>]}
[0m15:40:17.673184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9bf99f4-0c1f-4586-a3dd-850ea720bf5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29501f99c0>]}
[0m15:40:17.674031 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:40:17.685799 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:40:17.716164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:40:17.716823 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/coffee_jinja.sql
[0m15:40:17.746084 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_jinja.sql
[0m15:40:17.771841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9bf99f4-0c1f-4586-a3dd-850ea720bf5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f294fa8d600>]}
[0m15:40:17.782152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9bf99f4-0c1f-4586-a3dd-850ea720bf5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2950014eb0>]}
[0m15:40:17.782741 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:40:17.783411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9bf99f4-0c1f-4586-a3dd-850ea720bf5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2950014df0>]}
[0m15:40:17.785090 [info ] [MainThread]: 
[0m15:40:17.786466 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:40:17.787895 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:40:17.788507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:18.962701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m15:40:18.963571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:19.237714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9bf99f4-0c1f-4586-a3dd-850ea720bf5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29500064d0>]}
[0m15:40:19.238782 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:40:19.239647 [info ] [MainThread]: 
[0m15:40:19.243833 [debug] [Thread-1 (]: Began running node model.dbt_robert.coffee_jinja
[0m15:40:19.244474 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_robert.coffee_jinja ............................ [RUN]
[0m15:40:19.245296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.coffee_jinja)
[0m15:40:19.245745 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.coffee_jinja
[0m15:40:19.249495 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.coffee_jinja"
[0m15:40:19.250385 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (compile): 15:40:19.246038 => 15:40:19.250100
[0m15:40:19.250819 [debug] [Thread-1 (]: Began executing node model.dbt_robert.coffee_jinja
[0m15:40:19.282443 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.coffee_jinja"
[0m15:40:19.283221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:19.283761 [debug] [Thread-1 (]: On model.dbt_robert.coffee_jinja: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.coffee_jinja"} */


  create or replace view `aec-students`.`dbt_robert`.`coffee_jinja`
  OPTIONS()
  as select
  date_trunc(sold_at, month) as date_month,
  sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,
  sum(case when product_category = 'merch' then amount end) as merch_amount,
  sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount
-- you may have to `ref` a different model here, depending on what you've built previously
from `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
group by 1;


[0m15:40:20.273051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6838a19f-40a6-4f45-8596-8b2b6de86cee&page=queryresults
[0m15:40:20.293251 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (execute): 15:40:19.251104 => 15:40:20.293025
[0m15:40:20.294162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9bf99f4-0c1f-4586-a3dd-850ea720bf5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f294fb0d390>]}
[0m15:40:20.294923 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_robert.coffee_jinja ....................... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m15:40:20.296108 [debug] [Thread-1 (]: Finished running node model.dbt_robert.coffee_jinja
[0m15:40:20.298196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:20.298589 [debug] [MainThread]: Connection 'model.dbt_robert.coffee_jinja' was properly closed.
[0m15:40:20.298995 [info ] [MainThread]: 
[0m15:40:20.299835 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m15:40:20.300934 [debug] [MainThread]: Command end result
[0m15:40:20.310379 [info ] [MainThread]: 
[0m15:40:20.311091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:20.312489 [info ] [MainThread]: 
[0m15:40:20.313155 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:40:20.314340 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:20.314192 after 3.04 seconds
[0m15:40:20.314809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2952d563e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2952906da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2950014640>]}
[0m15:40:20.315269 [debug] [MainThread]: Flushing usage events
[0m15:41:30.448456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f3797e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f366ca530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f366ca4a0>]}


============================== 15:41:30.451170 | 41f37197-da1e-448e-9d91-8ae126f1d6d0 ==============================
[0m15:41:30.451170 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:41:30.452039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:41:30.821945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41f37197-da1e-448e-9d91-8ae126f1d6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f37668d90>]}
[0m15:41:30.839494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41f37197-da1e-448e-9d91-8ae126f1d6d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f34bb1390>]}
[0m15:41:30.840309 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:41:30.851437 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:41:30.881856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:30.882551 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/coffee_jinja.sql
[0m15:41:30.908329 [debug] [MainThread]: 1603: static parser failed on marts/coffee_jinja.sql
[0m15:41:30.911463 [error] [MainThread]: Encountered an error:
Compilation Error in model coffee_jinja (models/marts/coffee_jinja.sql)
  expected token 'end of print statement', got ':'
    line 1
      {{config:(
[0m15:41:30.912579 [debug] [MainThread]: Command `dbt run` failed at 15:41:30.912440 after 0.47 seconds
[0m15:41:30.913048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f3797e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f349d9240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f349d9180>]}
[0m15:41:30.913592 [debug] [MainThread]: Flushing usage events
[0m15:42:09.800462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e3576470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e2806650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e28065c0>]}


============================== 15:42:09.803214 | f6f98cd7-ecbe-4183-b275-4c1d3b23cb35 ==============================
[0m15:42:09.803214 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:42:09.804221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:42:10.162155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6f98cd7-ecbe-4183-b275-4c1d3b23cb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e09df280>]}
[0m15:42:10.181179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6f98cd7-ecbe-4183-b275-4c1d3b23cb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e09e1a50>]}
[0m15:42:10.182333 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:42:10.193954 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:42:10.226355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:42:10.227001 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/coffee_jinja.sql
[0m15:42:10.252358 [debug] [MainThread]: 1699: static parser successfully parsed marts/coffee_jinja.sql
[0m15:42:10.276561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6f98cd7-ecbe-4183-b275-4c1d3b23cb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e0285600>]}
[0m15:42:10.287336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6f98cd7-ecbe-4183-b275-4c1d3b23cb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e0800eb0>]}
[0m15:42:10.287949 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:42:10.288531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6f98cd7-ecbe-4183-b275-4c1d3b23cb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e0800df0>]}
[0m15:42:10.290589 [info ] [MainThread]: 
[0m15:42:10.291813 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:10.293731 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:42:10.294236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:11.418511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m15:42:11.419367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:11.734125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6f98cd7-ecbe-4183-b275-4c1d3b23cb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e07f3cd0>]}
[0m15:42:11.735404 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:42:11.736266 [info ] [MainThread]: 
[0m15:42:11.740990 [debug] [Thread-1 (]: Began running node model.dbt_robert.coffee_jinja
[0m15:42:11.741663 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.coffee_jinja ........................... [RUN]
[0m15:42:11.742771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.coffee_jinja)
[0m15:42:11.743287 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.coffee_jinja
[0m15:42:11.747594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.coffee_jinja"
[0m15:42:11.748959 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (compile): 15:42:11.744059 => 15:42:11.748603
[0m15:42:11.749409 [debug] [Thread-1 (]: Began executing node model.dbt_robert.coffee_jinja
[0m15:42:11.765515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:12.302017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.coffee_jinja"
[0m15:42:12.303096 [debug] [Thread-1 (]: On model.dbt_robert.coffee_jinja: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.coffee_jinja"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`coffee_jinja`
    
    

    OPTIONS()
    as (
      

select
  date_trunc(sold_at, month) as date_month,
  sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,
  sum(case when product_category = 'merch' then amount end) as merch_amount,
  sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount
-- you may have to `ref` a different model here, depending on what you've built previously
from `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
group by 1
    );
  
[0m15:42:15.093977 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:136ea8b8-a4b2-4dbc-b005-b8cc23d685dc&page=queryresults
[0m15:42:15.117389 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (execute): 15:42:11.749701 => 15:42:15.117115
[0m15:42:15.118379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f98cd7-ecbe-4183-b275-4c1d3b23cb35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e09fe560>]}
[0m15:42:15.119229 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.coffee_jinja ...................... [[32mCREATE TABLE (5.0 rows, 661.0 Bytes processed)[0m in 3.38s]
[0m15:42:15.120473 [debug] [Thread-1 (]: Finished running node model.dbt_robert.coffee_jinja
[0m15:42:15.122773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:15.123149 [debug] [MainThread]: Connection 'model.dbt_robert.coffee_jinja' was properly closed.
[0m15:42:15.123591 [info ] [MainThread]: 
[0m15:42:15.124175 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m15:42:15.125602 [debug] [MainThread]: Command end result
[0m15:42:15.134412 [info ] [MainThread]: 
[0m15:42:15.135168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:15.135929 [info ] [MainThread]: 
[0m15:42:15.136598 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:15.137695 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:15.137439 after 5.34 seconds
[0m15:42:15.138225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e3576470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e33a1870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e0800640>]}
[0m15:42:15.138731 [debug] [MainThread]: Flushing usage events
[0m08:29:16.129117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd24f263b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd23ec6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd23ec6500>]}


============================== 08:29:16.147721 | dc1203e0-7bf8-414b-b106-30e31ba25f21 ==============================
[0m08:29:16.147721 [info ] [MainThread]: Running with dbt=1.5.3
[0m08:29:16.148892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:29:17.492181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc1203e0-7bf8-414b-b106-30e31ba25f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd24cf7f70>]}
[0m08:29:17.509843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc1203e0-7bf8-414b-b106-30e31ba25f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2239e440>]}
[0m08:29:17.510701 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m08:29:17.521272 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m08:29:17.648109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:29:17.648929 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/coffee_jinja.sql
[0m08:29:17.675233 [debug] [MainThread]: 1603: static parser failed on marts/coffee_jinja.sql
[0m08:29:17.691287 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/coffee_jinja.sql
[0m08:29:17.703751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc1203e0-7bf8-414b-b106-30e31ba25f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd222280d0>]}
[0m08:29:17.714354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc1203e0-7bf8-414b-b106-30e31ba25f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd222bcfd0>]}
[0m08:29:17.714899 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m08:29:17.715429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc1203e0-7bf8-414b-b106-30e31ba25f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd222bcf70>]}
[0m08:29:17.717279 [info ] [MainThread]: 
[0m08:29:17.718319 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:29:17.719681 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:29:17.720101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:21.973879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m08:29:21.974498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:29:22.279164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc1203e0-7bf8-414b-b106-30e31ba25f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd22173d30>]}
[0m08:29:22.280510 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:29:22.282960 [info ] [MainThread]: 
[0m08:29:22.308372 [debug] [Thread-1 (]: Began running node model.dbt_robert.coffee_jinja
[0m08:29:22.309023 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.coffee_jinja ........................... [RUN]
[0m08:29:22.310074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.coffee_jinja)
[0m08:29:22.310664 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.coffee_jinja
[0m08:29:22.316607 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.coffee_jinja"
[0m08:29:22.318161 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (compile): 08:29:22.311155 => 08:29:22.317798
[0m08:29:22.318766 [debug] [Thread-1 (]: Began executing node model.dbt_robert.coffee_jinja
[0m08:29:22.339476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:29:22.734441 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.coffee_jinja"
[0m08:29:22.735396 [debug] [Thread-1 (]: On model.dbt_robert.coffee_jinja: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.coffee_jinja"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`coffee_jinja`
    
    

    OPTIONS()
    as (
      


select
  date_trunc(sold_at, month) as date_month,
 -- sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,
 -- sum(case when product_category = 'merch' then amount end) as merch_amount,
 -- sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount


sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,

sum(case when product_category = 'merch' then amount end) as merch_amount,

sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount,


-- you may have to `ref` a different model here, depending on what you've built previously
from `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
group by 1
    );
  
[0m08:29:25.635267 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:bb829095-fdf0-42af-8405-5422d127fe97&page=queryresults
[0m08:29:25.651954 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (execute): 08:29:22.319188 => 08:29:25.651750
[0m08:29:25.652763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc1203e0-7bf8-414b-b106-30e31ba25f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2239c820>]}
[0m08:29:25.653443 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.coffee_jinja ...................... [[32mCREATE TABLE (5.0 rows, 661.0 Bytes processed)[0m in 3.34s]
[0m08:29:25.654482 [debug] [Thread-1 (]: Finished running node model.dbt_robert.coffee_jinja
[0m08:29:25.656479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:25.656825 [debug] [MainThread]: Connection 'model.dbt_robert.coffee_jinja' was properly closed.
[0m08:29:25.657190 [info ] [MainThread]: 
[0m08:29:25.657655 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.94 seconds (7.94s).
[0m08:29:25.658402 [debug] [MainThread]: Command end result
[0m08:29:25.666437 [info ] [MainThread]: 
[0m08:29:25.667140 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:29:25.667761 [info ] [MainThread]: 
[0m08:29:25.668424 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:29:25.669352 [debug] [MainThread]: Command `dbt run` succeeded at 08:29:25.669175 after 9.56 seconds
[0m08:29:25.669934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd24f263b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd24ac6e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd22093c70>]}
[0m08:29:25.670359 [debug] [MainThread]: Flushing usage events
[0m08:29:32.094601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3e74e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3d4ce590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3d4ce530>]}


============================== 08:29:32.097154 | 7658238a-2e3b-423f-ac6c-9b2dfd5302a3 ==============================
[0m08:29:32.097154 [info ] [MainThread]: Running with dbt=1.5.3
[0m08:29:32.097975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:29:32.425107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b9ab280>]}
[0m08:29:32.445986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b9ad990>]}
[0m08:29:32.446873 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m08:29:32.457695 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m08:29:32.485438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:29:32.485852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:29:32.492826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b7c9a80>]}
[0m08:29:32.502433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b8cd750>]}
[0m08:29:32.503023 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m08:29:32.503543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b8cd780>]}
[0m08:29:32.505740 [info ] [MainThread]: 
[0m08:29:32.506745 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:29:32.508345 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:29:32.508853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:33.531434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m08:29:33.532047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:29:33.843254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b783eb0>]}
[0m08:29:33.844134 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:29:33.844649 [info ] [MainThread]: 
[0m08:29:33.848357 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m08:29:33.848869 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m08:29:33.849360 [info ] [Thread-1 (]: 1 of 6 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m08:29:33.851061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m08:29:33.850209 [info ] [Thread-2 (]: 2 of 6 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m08:29:33.852170 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m08:29:33.852967 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m08:29:33.856174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m08:29:33.856715 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m08:29:33.857846 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 08:29:33.853285 => 08:29:33.857516
[0m08:29:33.860580 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m08:29:33.861079 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m08:29:33.861932 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 08:29:33.858133 => 08:29:33.861672
[0m08:29:33.869773 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m08:29:33.895796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:29:33.897265 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:29:34.394185 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m08:29:34.395628 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m08:29:34.396560 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at as sold_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category as product_category
,PP.price as amount
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m08:29:34.398823 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m08:29:38.437749 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cb9a8f9d-4e5f-4954-9fe0-068c69a2860b&page=queryresults
[0m08:29:38.458048 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 08:29:33.875259 => 08:29:38.457830
[0m08:29:38.458872 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b7c8e80>]}
[0m08:29:38.459610 [info ] [Thread-2 (]: 2 of 6 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.61s]
[0m08:29:38.460546 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m08:29:38.461096 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:29:38.461885 [info ] [Thread-2 (]: 3 of 6 START sql view model dbt_robert.dbtcustomers_revenuereport_view ......... [RUN]
[0m08:29:38.463026 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.dbt_robert.dbtcustomers_revenuereport_view)
[0m08:29:38.463471 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:29:38.466558 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m08:29:38.467449 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (compile): 08:29:38.463734 => 08:29:38.467118
[0m08:29:38.468022 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:29:38.487687 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m08:29:38.488434 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:29:38.488957 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport_view: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport_view"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport_view`
  OPTIONS()
  as 

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25;


[0m08:29:38.693859 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6bf72014-b58c-4d70-93ad-4cd2eec73f8b&page=queryresults
[0m08:29:38.696105 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 08:29:33.862194 => 08:29:38.695902
[0m08:29:38.696900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b692d40>]}
[0m08:29:38.697687 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.85s]
[0m08:29:38.698826 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m08:29:38.699395 [debug] [Thread-1 (]: Began running node model.dbt_robert.visitors_sessionization
[0m08:29:38.700686 [info ] [Thread-1 (]: 4 of 6 START sql table model dbt_robert.visitors_sessionization ................ [RUN]
[0m08:29:38.701830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.visitors_sessionization)
[0m08:29:38.702313 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.visitors_sessionization
[0m08:29:38.709027 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.visitors_sessionization"
[0m08:29:38.709936 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_sessionization (compile): 08:29:38.702645 => 08:29:38.709607
[0m08:29:38.710345 [debug] [Thread-1 (]: Began executing node model.dbt_robert.visitors_sessionization
[0m08:29:38.712473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:29:39.038469 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.visitors_sessionization"
[0m08:29:39.039434 [debug] [Thread-1 (]: On model.dbt_robert.visitors_sessionization: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.visitors_sessionization"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`visitors_sessionization`
    
    

    OPTIONS()
    as (
      


-- one record per visitor id
with visitors_userstitching as (
    select distinct
        visitor_id,

        first_value(customer_id ignore nulls) over (
            partition by visitor_id
            order by timestamp
            range between unbounded preceding and unbounded following
        ) as first_customer_id,

        min(timestamp) over (
            partition by visitor_id
        ) as first_seen_at,

        max(timestamp) over (
            partition by visitor_id
        ) as last_seen_at


    from `analytics-engineers-club`.`web_tracking`.`pageviews`
)
select
    *,
    first_value(visitor_id) over (
        partition by coalesce(first_customer_id, visitor_id)
        order by first_seen_at
    ) as first_visitor_id
from visitors_userstitching
    );
  
[0m08:29:39.417587 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8732ce9b-06a2-44b5-b307-79b5853e2307&page=queryresults
[0m08:29:39.420112 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (execute): 08:29:38.468320 => 08:29:39.419902
[0m08:29:39.420893 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b6cf730>]}
[0m08:29:39.421537 [info ] [Thread-2 (]: 3 of 6 OK created sql view model dbt_robert.dbtcustomers_revenuereport_view .... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m08:29:39.422426 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:29:39.422953 [debug] [Thread-2 (]: Began running node model.dbt_robert.coffee_jinja
[0m08:29:39.423535 [info ] [Thread-2 (]: 5 of 6 START sql table model dbt_robert.coffee_jinja ........................... [RUN]
[0m08:29:39.424805 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport_view, now model.dbt_robert.coffee_jinja)
[0m08:29:39.425224 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.coffee_jinja
[0m08:29:39.429966 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.coffee_jinja"
[0m08:29:39.430848 [debug] [Thread-2 (]: Timing info for model.dbt_robert.coffee_jinja (compile): 08:29:39.425480 => 08:29:39.430606
[0m08:29:39.431276 [debug] [Thread-2 (]: Began executing node model.dbt_robert.coffee_jinja
[0m08:29:39.433397 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:29:39.768701 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.coffee_jinja"
[0m08:29:39.769567 [debug] [Thread-2 (]: On model.dbt_robert.coffee_jinja: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.coffee_jinja"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`coffee_jinja`
    
    

    OPTIONS()
    as (
      


select
  date_trunc(sold_at, month) as date_month,
 -- sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,
 -- sum(case when product_category = 'merch' then amount end) as merch_amount,
 -- sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount


sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,

sum(case when product_category = 'merch' then amount end) as merch_amount,

sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount,


-- you may have to `ref` a different model here, depending on what you've built previously
from `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
group by 1
    );
  
[0m08:29:42.472509 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a75af50f-c84c-49d8-b023-05cb555e55ad&page=queryresults
[0m08:29:42.477915 [debug] [Thread-2 (]: Timing info for model.dbt_robert.coffee_jinja (execute): 08:29:39.431533 => 08:29:42.477561
[0m08:29:42.478944 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b6639d0>]}
[0m08:29:42.479647 [info ] [Thread-2 (]: 5 of 6 OK created sql table model dbt_robert.coffee_jinja ...................... [[32mCREATE TABLE (5.0 rows, 661.0 Bytes processed)[0m in 3.05s]
[0m08:29:42.480578 [debug] [Thread-2 (]: Finished running node model.dbt_robert.coffee_jinja
[0m08:29:48.693603 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a073fba0-1e39-44c4-bcab-8e2fc9ca16fb&page=queryresults
[0m08:29:48.695891 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_sessionization (execute): 08:29:38.710597 => 08:29:48.695684
[0m08:29:48.696665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b96fd00>]}
[0m08:29:48.697317 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dbt_robert.visitors_sessionization ........... [[32mCREATE TABLE (1.4m rows, 292.6 MiB processed)[0m in 10.00s]
[0m08:29:48.698402 [debug] [Thread-1 (]: Finished running node model.dbt_robert.visitors_sessionization
[0m08:29:48.699436 [debug] [Thread-2 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m08:29:48.700730 [info ] [Thread-2 (]: 6 of 6 START sql table model dbt_robert.pageviews_userstitching ................ [RUN]
[0m08:29:48.701642 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.coffee_jinja, now model.dbt_robert.pageviews_userstitching)
[0m08:29:48.702062 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m08:29:48.707275 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m08:29:48.708158 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 08:29:48.702312 => 08:29:48.707883
[0m08:29:48.708584 [debug] [Thread-2 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m08:29:48.710808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:29:49.054765 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m08:29:49.055633 [debug] [Thread-2 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

-- SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`

with pageviews as (
    select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
),

visitors as (
    select * from `aec-students`.`dbt_robert`.`visitors_sessionization`
),

joined as (
    select
        pageviews.*,
        -- customer id if we have it, else visitor id
        coalesce(
            visitors.first_customer_id,
            pageviews.visitor_id
        ) as blended_user_id,

        visitors.first_visitor_id

    from pageviews
    left join visitors
        on pageviews.visitor_id = visitors.visitor_id
)

select * from joined
    );
  
[0m08:30:02.171657 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:be70538c-5d56-4cbe-8c56-8bbce5bb7648&page=queryresults
[0m08:30:02.174240 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 08:29:48.708843 => 08:30:02.174032
[0m08:30:02.175043 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7658238a-2e3b-423f-ac6c-9b2dfd5302a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b7c91b0>]}
[0m08:30:02.175687 [info ] [Thread-2 (]: 6 of 6 OK created sql table model dbt_robert.pageviews_userstitching ........... [[32mCREATE TABLE (5.8m rows, 719.6 MiB processed)[0m in 13.47s]
[0m08:30:02.176598 [debug] [Thread-2 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m08:30:02.178620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:02.179010 [debug] [MainThread]: Connection 'model.dbt_robert.visitors_sessionization' was properly closed.
[0m08:30:02.179348 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m08:30:02.179744 [info ] [MainThread]: 
[0m08:30:02.180248 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 29.67 seconds (29.67s).
[0m08:30:02.181933 [debug] [MainThread]: Command end result
[0m08:30:02.195676 [info ] [MainThread]: 
[0m08:30:02.196443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:30:02.197412 [info ] [MainThread]: 
[0m08:30:02.198445 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:30:02.199432 [debug] [MainThread]: Command `dbt run` succeeded at 08:30:02.199311 after 30.11 seconds
[0m08:30:02.199819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3e74e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3e35e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3b6d6f50>]}
[0m08:30:02.200601 [debug] [MainThread]: Flushing usage events
[0m08:51:50.298772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba2d0e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba1a0a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba1a0a470>]}


============================== 08:51:50.301845 | 21fb9392-67e0-4f13-8519-04848428519b ==============================
[0m08:51:50.301845 [info ] [MainThread]: Running with dbt=1.5.3
[0m08:51:50.302698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:51:50.621897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba2c3e650>]}
[0m08:51:50.639274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba00f0880>]}
[0m08:51:50.640008 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m08:51:50.650919 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m08:51:50.681898 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m08:51:50.682744 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/Jinja_exercises/coffee_jinja.sql
[0m08:51:50.683377 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/advanced_sql_exercises_marts/pageviews_userstitching.sql
[0m08:51:50.683951 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/advanced_sql_exercises_marts/visitors_sessionization.sql
[0m08:51:50.684494 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/staging/advanced_sql_exercises/pageviews_userstitching.sql
[0m08:51:50.684978 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/staging/advanced_sql_exercises/visitors_sessionization.sql
[0m08:51:50.685440 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/marts/coffee_jinja.sql
[0m08:51:50.711305 [debug] [MainThread]: 1603: static parser failed on marts/Jinja_exercises/coffee_jinja.sql
[0m08:51:50.726813 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/Jinja_exercises/coffee_jinja.sql
[0m08:51:50.728952 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/pageviews_userstitching.sql
[0m08:51:50.732507 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/visitors_sessionization.sql
[0m08:51:50.781328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9f992650>]}
[0m08:51:50.790296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba00052a0>]}
[0m08:51:50.790859 [info ] [MainThread]: Found 6 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m08:51:50.791403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba00052d0>]}
[0m08:51:50.793618 [info ] [MainThread]: 
[0m08:51:50.794576 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:51:50.796108 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:51:50.796617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:51.818229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m08:51:51.818840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:52.113815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9fec7af0>]}
[0m08:51:52.114714 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:51:52.115477 [info ] [MainThread]: 
[0m08:51:52.119046 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m08:51:52.119490 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m08:51:52.120069 [info ] [Thread-1 (]: 1 of 6 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m08:51:52.121791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.dbtcustomers)
[0m08:51:52.122627 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m08:51:52.120939 [info ] [Thread-2 (]: 2 of 6 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m08:51:52.125925 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m08:51:52.126901 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers_revenuereport'
[0m08:51:52.127503 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m08:51:52.130267 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m08:51:52.131139 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 08:51:52.123162 => 08:51:52.130804
[0m08:51:52.131827 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 08:51:52.127807 => 08:51:52.131560
[0m08:51:52.132169 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m08:51:52.132597 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m08:51:52.147187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:52.149356 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:51:52.618821 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m08:51:52.620250 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m08:51:52.621737 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m08:51:52.624170 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at as sold_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category as product_category
,PP.price as amount
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m08:51:56.887000 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fbcf011a-5d09-40c8-b1ad-43532160202d&page=queryresults
[0m08:51:56.906068 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 08:51:52.147530 => 08:51:56.905855
[0m08:51:56.906887 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9fec68c0>]}
[0m08:51:56.907743 [info ] [Thread-2 (]: 2 of 6 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.78s]
[0m08:51:56.908847 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m08:51:56.909552 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:51:56.910566 [info ] [Thread-2 (]: 3 of 6 START sql view model dbt_robert.dbtcustomers_revenuereport_view ......... [RUN]
[0m08:51:56.911734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.dbt_robert.dbtcustomers_revenuereport_view)
[0m08:51:56.912371 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:51:56.956702 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m08:51:56.957667 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (compile): 08:51:56.912689 => 08:51:56.957314
[0m08:51:56.958147 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:51:56.978002 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m08:51:56.978760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:51:56.979305 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport_view: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport_view"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport_view`
  OPTIONS()
  as 

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25;


[0m08:51:57.813380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:27b29b77-bdcf-4247-a942-6d95ba9da5eb&page=queryresults
[0m08:51:57.815704 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 08:51:52.132880 => 08:51:57.815495
[0m08:51:57.816490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9f869990>]}
[0m08:51:57.817160 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 5.70s]
[0m08:51:57.818071 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m08:51:57.818565 [debug] [Thread-1 (]: Began running node model.dbt_robert.visitors_sessionization
[0m08:51:57.819259 [info ] [Thread-1 (]: 4 of 6 START sql table model dbt_robert.visitors_sessionization ................ [RUN]
[0m08:51:57.820332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.visitors_sessionization)
[0m08:51:57.820757 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.visitors_sessionization
[0m08:51:57.824668 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.visitors_sessionization"
[0m08:51:57.825741 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_sessionization (compile): 08:51:57.821020 => 08:51:57.825390
[0m08:51:57.826353 [debug] [Thread-1 (]: Began executing node model.dbt_robert.visitors_sessionization
[0m08:51:57.829837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:57.950519 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:796eda8c-0d4d-499b-b6a1-8c2c9282a80f&page=queryresults
[0m08:51:57.953253 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (execute): 08:51:56.958407 => 08:51:57.953042
[0m08:51:57.954045 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9f8c15a0>]}
[0m08:51:57.954736 [info ] [Thread-2 (]: 3 of 6 OK created sql view model dbt_robert.dbtcustomers_revenuereport_view .... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m08:51:57.955632 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:51:57.956130 [debug] [Thread-2 (]: Began running node model.dbt_robert.coffee_jinja
[0m08:51:57.956872 [info ] [Thread-2 (]: 5 of 6 START sql table model dbt_robert.coffee_jinja ........................... [RUN]
[0m08:51:57.957944 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport_view, now model.dbt_robert.coffee_jinja)
[0m08:51:57.958784 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.coffee_jinja
[0m08:51:57.963351 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.coffee_jinja"
[0m08:51:57.964155 [debug] [Thread-2 (]: Timing info for model.dbt_robert.coffee_jinja (compile): 08:51:57.959269 => 08:51:57.963921
[0m08:51:57.964560 [debug] [Thread-2 (]: Began executing node model.dbt_robert.coffee_jinja
[0m08:51:57.966674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:51:58.105095 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.visitors_sessionization"
[0m08:51:58.105942 [debug] [Thread-1 (]: On model.dbt_robert.visitors_sessionization: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.visitors_sessionization"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`visitors_sessionization`
    
    

    OPTIONS()
    as (
      


-- one record per visitor id
with visitors_userstitching as (
    select distinct
        visitor_id,

        first_value(customer_id ignore nulls) over (
            partition by visitor_id
            order by timestamp
            range between unbounded preceding and unbounded following
        ) as first_customer_id,

        min(timestamp) over (
            partition by visitor_id
        ) as first_seen_at,

        max(timestamp) over (
            partition by visitor_id
        ) as last_seen_at


    from `analytics-engineers-club`.`web_tracking`.`pageviews`
)
select
    *,
    first_value(visitor_id) over (
        partition by coalesce(first_customer_id, visitor_id)
        order by first_seen_at
    ) as first_visitor_id
from visitors_userstitching
    );
  
[0m08:51:58.318803 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.coffee_jinja"
[0m08:51:58.319695 [debug] [Thread-2 (]: On model.dbt_robert.coffee_jinja: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.coffee_jinja"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`coffee_jinja`
    
    

    OPTIONS()
    as (
      


select
  date_trunc(sold_at, month) as date_month,
 -- sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,
 -- sum(case when product_category = 'merch' then amount end) as merch_amount,
 -- sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount


sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,

sum(case when product_category = 'merch' then amount end) as merch_amount,

sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount,


-- you may have to `ref` a different model here, depending on what you've built previously
from `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
group by 1
    );
  
[0m08:52:01.079761 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0eb79826-a0fe-481c-a964-5c23d4d3a09a&page=queryresults
[0m08:52:01.082239 [debug] [Thread-2 (]: Timing info for model.dbt_robert.coffee_jinja (execute): 08:51:57.964821 => 08:52:01.082033
[0m08:52:01.083246 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9ff19e70>]}
[0m08:52:01.084261 [info ] [Thread-2 (]: 5 of 6 OK created sql table model dbt_robert.coffee_jinja ...................... [[32mCREATE TABLE (5.0 rows, 661.0 Bytes processed)[0m in 3.13s]
[0m08:52:01.085480 [debug] [Thread-2 (]: Finished running node model.dbt_robert.coffee_jinja
[0m08:52:06.157337 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:519f7da1-d0dd-4f1b-9266-18ff81088e39&page=queryresults
[0m08:52:06.159762 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_sessionization (execute): 08:51:57.826768 => 08:52:06.159554
[0m08:52:06.160595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9f991750>]}
[0m08:52:06.161299 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dbt_robert.visitors_sessionization ........... [[32mCREATE TABLE (1.4m rows, 292.6 MiB processed)[0m in 8.34s]
[0m08:52:06.162736 [debug] [Thread-1 (]: Finished running node model.dbt_robert.visitors_sessionization
[0m08:52:06.163998 [debug] [Thread-2 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m08:52:06.164674 [info ] [Thread-2 (]: 6 of 6 START sql table model dbt_robert.pageviews_userstitching ................ [RUN]
[0m08:52:06.165600 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.coffee_jinja, now model.dbt_robert.pageviews_userstitching)
[0m08:52:06.166047 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m08:52:06.173582 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m08:52:06.174424 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 08:52:06.166315 => 08:52:06.174095
[0m08:52:06.174836 [debug] [Thread-2 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m08:52:06.177010 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:52:06.518943 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m08:52:06.519916 [debug] [Thread-2 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

-- SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`

with pageviews as (
    select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
),

visitors as (
    select * from `aec-students`.`dbt_robert`.`visitors_sessionization`
),

joined as (
    select
        pageviews.*,
        -- customer id if we have it, else visitor id
        coalesce(
            visitors.first_customer_id,
            pageviews.visitor_id
        ) as blended_user_id,

        visitors.first_visitor_id

    from pageviews
    left join visitors
        on pageviews.visitor_id = visitors.visitor_id
)

select * from joined
    );
  
[0m08:52:20.258167 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:10d46791-91fa-4074-abec-0b47437fce54&page=queryresults
[0m08:52:20.260487 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 08:52:06.175119 => 08:52:20.260282
[0m08:52:20.261447 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fb9392-67e0-4f13-8519-04848428519b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb9f9595d0>]}
[0m08:52:20.262430 [info ] [Thread-2 (]: 6 of 6 OK created sql table model dbt_robert.pageviews_userstitching ........... [[32mCREATE TABLE (5.8m rows, 719.6 MiB processed)[0m in 14.10s]
[0m08:52:20.263402 [debug] [Thread-2 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m08:52:20.265488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:20.265859 [debug] [MainThread]: Connection 'model.dbt_robert.visitors_sessionization' was properly closed.
[0m08:52:20.266180 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m08:52:20.266579 [info ] [MainThread]: 
[0m08:52:20.267124 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 29.47 seconds (29.47s).
[0m08:52:20.269266 [debug] [MainThread]: Command end result
[0m08:52:20.276984 [info ] [MainThread]: 
[0m08:52:20.277678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:20.278294 [info ] [MainThread]: 
[0m08:52:20.278905 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:52:20.279957 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:20.279820 after 29.99 seconds
[0m08:52:20.280346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba2d0e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba0004b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba0004c40>]}
[0m08:52:20.280759 [debug] [MainThread]: Flushing usage events
[0m08:59:44.281367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0819ba22f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0818ac6440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0818ac63e0>]}


============================== 08:59:44.283831 | b16ffc09-3d9a-4953-b276-c9adcd40e342 ==============================
[0m08:59:44.283831 [info ] [MainThread]: Running with dbt=1.5.3
[0m08:59:44.284582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:59:44.629453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0819ad8d30>]}
[0m08:59:44.647117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0816fadcc0>]}
[0m08:59:44.647831 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m08:59:44.658389 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m08:59:44.685873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:59:44.686429 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/dbtcustomers/customers.sql
[0m08:59:44.716938 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbtcustomers/customers.sql
[0m08:59:44.739744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0816e255d0>]}
[0m08:59:44.749258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0816dcc670>]}
[0m08:59:44.749805 [info ] [MainThread]: Found 7 models, 21 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m08:59:44.750324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0816dcce20>]}
[0m08:59:44.752614 [info ] [MainThread]: 
[0m08:59:44.753620 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:59:44.755182 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:59:44.755718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:45.757307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m08:59:45.757914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:46.036040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0816db6c80>]}
[0m08:59:46.036960 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m08:59:46.037591 [info ] [MainThread]: 
[0m08:59:46.041368 [debug] [Thread-1 (]: Began running node model.dbt_robert.customers
[0m08:59:46.041800 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers
[0m08:59:46.043304 [info ] [Thread-2 (]: 2 of 7 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m08:59:46.044284 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers'
[0m08:59:46.044700 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m08:59:46.042367 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_robert.customers ............................... [RUN]
[0m08:59:46.048087 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m08:59:46.048785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.customers)
[0m08:59:46.049416 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.customers
[0m08:59:46.050150 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 08:59:46.044956 => 08:59:46.049823
[0m08:59:46.051868 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.customers"
[0m08:59:46.052333 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers
[0m08:59:46.053111 [debug] [Thread-1 (]: Timing info for model.dbt_robert.customers (compile): 08:59:46.050424 => 08:59:46.052871
[0m08:59:46.068113 [debug] [Thread-1 (]: Began executing node model.dbt_robert.customers
[0m08:59:46.067606 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:59:46.101787 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.customers"
[0m08:59:46.103014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:46.103664 [debug] [Thread-1 (]: On model.dbt_robert.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.customers"} */


  create or replace view `aec-students`.`dbt_robert`.`customers`
  OPTIONS()
  as select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5;


[0m08:59:46.538148 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m08:59:46.539002 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m08:59:47.176082 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f73cbf26-58a9-49c2-a016-a7c74d5c9d73&page=queryresults
[0m08:59:47.191819 [debug] [Thread-1 (]: Timing info for model.dbt_robert.customers (execute): 08:59:46.068397 => 08:59:47.191598
[0m08:59:47.192884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08168a8070>]}
[0m08:59:47.193577 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dbt_robert.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m08:59:47.194559 [debug] [Thread-1 (]: Finished running node model.dbt_robert.customers
[0m08:59:47.195074 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m08:59:47.195655 [info ] [Thread-1 (]: 3 of 7 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m08:59:47.196807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.customers, now model.dbt_robert.dbtcustomers_revenuereport)
[0m08:59:47.197222 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m08:59:47.200353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m08:59:47.201343 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 08:59:47.197481 => 08:59:47.201111
[0m08:59:47.201748 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m08:59:47.203986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:47.542783 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m08:59:47.543690 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at as sold_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category as product_category
,PP.price as amount
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m08:59:50.923259 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:21765b16-13d0-4163-9d4c-5b2742d5dca9&page=queryresults
[0m08:59:50.927991 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 08:59:46.053340 => 08:59:50.927791
[0m08:59:50.928754 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0816db8250>]}
[0m08:59:50.929420 [info ] [Thread-2 (]: 2 of 7 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.88s]
[0m08:59:50.930350 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers
[0m08:59:50.930847 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:59:50.931517 [info ] [Thread-2 (]: 4 of 7 START sql view model dbt_robert.dbtcustomers_revenuereport_view ......... [RUN]
[0m08:59:50.932752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.dbtcustomers_revenuereport_view)
[0m08:59:50.933181 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:59:50.936273 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m08:59:50.937270 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (compile): 08:59:50.933442 => 08:59:50.936874
[0m08:59:50.937673 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:59:50.940729 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m08:59:50.941512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:59:50.941971 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport_view: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport_view"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport_view`
  OPTIONS()
  as 

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25;


[0m08:59:51.825484 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c8207b51-7bb1-4662-a67a-73f4d0cadc60&page=queryresults
[0m08:59:51.827874 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (execute): 08:59:50.937931 => 08:59:51.827666
[0m08:59:51.828680 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08168bb640>]}
[0m08:59:51.829335 [info ] [Thread-2 (]: 4 of 7 OK created sql view model dbt_robert.dbtcustomers_revenuereport_view .... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m08:59:51.830230 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m08:59:51.830719 [debug] [Thread-2 (]: Began running node model.dbt_robert.visitors_sessionization
[0m08:59:51.831402 [info ] [Thread-2 (]: 5 of 7 START sql table model dbt_robert.visitors_sessionization ................ [RUN]
[0m08:59:51.832574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport_view, now model.dbt_robert.visitors_sessionization)
[0m08:59:51.832994 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.visitors_sessionization
[0m08:59:51.840713 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.visitors_sessionization"
[0m08:59:51.841631 [debug] [Thread-2 (]: Timing info for model.dbt_robert.visitors_sessionization (compile): 08:59:51.833251 => 08:59:51.841392
[0m08:59:51.842028 [debug] [Thread-2 (]: Began executing node model.dbt_robert.visitors_sessionization
[0m08:59:51.879667 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:59:51.881594 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1e7257b5-ba06-477c-907b-9f1f9eed2d69&page=queryresults
[0m08:59:51.884321 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 08:59:47.201999 => 08:59:51.884126
[0m08:59:51.885225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f081725ef50>]}
[0m08:59:51.885853 [info ] [Thread-1 (]: 3 of 7 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.69s]
[0m08:59:51.886988 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m08:59:51.888192 [debug] [Thread-1 (]: Began running node model.dbt_robert.coffee_jinja
[0m08:59:51.888910 [info ] [Thread-1 (]: 6 of 7 START sql table model dbt_robert.coffee_jinja ........................... [RUN]
[0m08:59:51.890427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.dbt_robert.coffee_jinja)
[0m08:59:51.891192 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.coffee_jinja
[0m08:59:51.898258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.coffee_jinja"
[0m08:59:51.899248 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (compile): 08:59:51.891720 => 08:59:51.898904
[0m08:59:51.900811 [debug] [Thread-1 (]: Began executing node model.dbt_robert.coffee_jinja
[0m08:59:51.904779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:52.277912 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.visitors_sessionization"
[0m08:59:52.278852 [debug] [Thread-2 (]: On model.dbt_robert.visitors_sessionization: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.visitors_sessionization"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`visitors_sessionization`
    
    

    OPTIONS()
    as (
      


-- one record per visitor id
with visitors_userstitching as (
    select distinct
        visitor_id,

        first_value(customer_id ignore nulls) over (
            partition by visitor_id
            order by timestamp
            range between unbounded preceding and unbounded following
        ) as first_customer_id,

        min(timestamp) over (
            partition by visitor_id
        ) as first_seen_at,

        max(timestamp) over (
            partition by visitor_id
        ) as last_seen_at


    from `analytics-engineers-club`.`web_tracking`.`pageviews`
)
select
    *,
    first_value(visitor_id) over (
        partition by coalesce(first_customer_id, visitor_id)
        order by first_seen_at
    ) as first_visitor_id
from visitors_userstitching
    );
  
[0m08:59:52.296535 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.coffee_jinja"
[0m08:59:52.297350 [debug] [Thread-1 (]: On model.dbt_robert.coffee_jinja: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.coffee_jinja"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`coffee_jinja`
    
    

    OPTIONS()
    as (
      


select
  date_trunc(sold_at, month) as date_month,
 -- sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,
 -- sum(case when product_category = 'merch' then amount end) as merch_amount,
 -- sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount


sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,

sum(case when product_category = 'merch' then amount end) as merch_amount,

sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount,


-- you may have to `ref` a different model here, depending on what you've built previously
from `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
group by 1
    );
  
[0m08:59:55.277950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:aa1a9cca-fa22-425d-bcd8-7966e249cc24&page=queryresults
[0m08:59:55.280237 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (execute): 08:59:51.901455 => 08:59:55.280033
[0m08:59:55.281032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0816fac790>]}
[0m08:59:55.281710 [info ] [Thread-1 (]: 6 of 7 OK created sql table model dbt_robert.coffee_jinja ...................... [[32mCREATE TABLE (5.0 rows, 661.0 Bytes processed)[0m in 3.39s]
[0m08:59:55.282704 [debug] [Thread-1 (]: Finished running node model.dbt_robert.coffee_jinja
[0m09:00:01.627387 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0688448c-f4fd-4a2f-81e8-21402a897d5b&page=queryresults
[0m09:00:01.630080 [debug] [Thread-2 (]: Timing info for model.dbt_robert.visitors_sessionization (execute): 08:59:51.842277 => 09:00:01.629877
[0m09:00:01.630869 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0816faed10>]}
[0m09:00:01.631561 [info ] [Thread-2 (]: 5 of 7 OK created sql table model dbt_robert.visitors_sessionization ........... [[32mCREATE TABLE (1.4m rows, 292.6 MiB processed)[0m in 9.80s]
[0m09:00:01.632584 [debug] [Thread-2 (]: Finished running node model.dbt_robert.visitors_sessionization
[0m09:00:01.633503 [debug] [Thread-1 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m09:00:01.634269 [info ] [Thread-1 (]: 7 of 7 START sql table model dbt_robert.pageviews_userstitching ................ [RUN]
[0m09:00:01.635230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.coffee_jinja, now model.dbt_robert.pageviews_userstitching)
[0m09:00:01.635806 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m09:00:01.639976 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m09:00:01.640908 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 09:00:01.636070 => 09:00:01.640497
[0m09:00:01.641324 [debug] [Thread-1 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m09:00:01.643554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:00:01.977050 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m09:00:01.977926 [debug] [Thread-1 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

-- SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`

with pageviews as (
    select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
),

visitors as (
    select * from `aec-students`.`dbt_robert`.`visitors_sessionization`
),

joined as (
    select
        pageviews.*,
        -- customer id if we have it, else visitor id
        coalesce(
            visitors.first_customer_id,
            pageviews.visitor_id
        ) as blended_user_id,

        visitors.first_visitor_id

    from pageviews
    left join visitors
        on pageviews.visitor_id = visitors.visitor_id
)

select * from joined
    );
  
[0m09:00:22.770948 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7f386eca-6de3-446c-9130-f45c0bf62b4d&page=queryresults
[0m09:00:22.773376 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 09:00:01.641589 => 09:00:22.773175
[0m09:00:22.774209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b16ffc09-3d9a-4953-b276-c9adcd40e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07f7f201c0>]}
[0m09:00:22.774896 [info ] [Thread-1 (]: 7 of 7 OK created sql table model dbt_robert.pageviews_userstitching ........... [[32mCREATE TABLE (5.8m rows, 719.6 MiB processed)[0m in 21.14s]
[0m09:00:22.775839 [debug] [Thread-1 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m09:00:22.777798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:00:22.778162 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m09:00:22.778483 [debug] [MainThread]: Connection 'model.dbt_robert.visitors_sessionization' was properly closed.
[0m09:00:22.778867 [info ] [MainThread]: 
[0m09:00:22.779467 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0 hours 0 minutes and 38.03 seconds (38.03s).
[0m09:00:22.781901 [debug] [MainThread]: Command end result
[0m09:00:22.793884 [info ] [MainThread]: 
[0m09:00:22.794752 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:00:22.795450 [info ] [MainThread]: 
[0m09:00:22.796101 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m09:00:22.797392 [debug] [MainThread]: Command `dbt run` succeeded at 09:00:22.797264 after 38.52 seconds
[0m09:00:22.797827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0819ba22f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0819971600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08168f1750>]}
[0m09:00:22.798321 [debug] [MainThread]: Flushing usage events
[0m09:08:03.491903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27536d6440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27525c94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27525c9c00>]}


============================== 09:08:03.494428 | 7dcaa6ed-d966-4c82-b866-d1ae6aae8a43 ==============================
[0m09:08:03.494428 [info ] [MainThread]: Running with dbt=1.5.3
[0m09:08:03.495360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:08:03.524277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dcaa6ed-d966-4c82-b866-d1ae6aae8a43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27525ca7d0>]}
[0m09:08:03.525291 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pjnhvz9z'
[0m09:08:03.525836 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:08:03.723250 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:08:03.724704 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:08:03.823046 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:08:03.831494 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:08:04.103197 [info ] [MainThread]: Installed from version 1.1.1
[0m09:08:04.103962 [info ] [MainThread]: Up to date!
[0m09:08:04.104712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7dcaa6ed-d966-4c82-b866-d1ae6aae8a43', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2752431f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27524326e0>]}
[0m09:08:04.105938 [debug] [MainThread]: Command `dbt deps` succeeded at 09:08:04.105762 after 0.62 seconds
[0m09:08:04.106558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27536d6440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27525ca7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27525ca830>]}
[0m09:08:04.107097 [debug] [MainThread]: Flushing usage events
[0m12:06:11.114800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a02bca3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a018ce500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a018ce470>]}


============================== 12:06:11.134116 | 4309618b-b913-4f88-b88d-407ba06dc02f ==============================
[0m12:06:11.134116 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:06:11.135365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:06:12.671142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4309618b-b913-4f88-b88d-407ba06dc02f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a02975390>]}
[0m12:06:12.691215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4309618b-b913-4f88-b88d-407ba06dc02f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49ffdb1d80>]}
[0m12:06:12.692474 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:06:12.725683 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:06:12.758805 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:06:12.759707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4309618b-b913-4f88-b88d-407ba06dc02f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49ffdcd630>]}
[0m12:06:12.790243 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: staging/dbt_packages_exercise_stg/product_price_history_sources.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version: 2
    2  | 
    3  | - name: coffee_shop
    4  |     project: analytics-engineers-club
    5  |     tables: 
    6  |       - name: product_prices
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 3, column 1
[0m12:06:12.791402 [debug] [MainThread]: Command `dbt test` failed at 12:06:12.791160 after 1.70 seconds
[0m12:06:12.791933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a02bca3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49ffb63130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49ffb63190>]}
[0m12:06:12.792446 [debug] [MainThread]: Flushing usage events
[0m12:07:52.419242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c63c66410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c629d2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c629d24a0>]}


============================== 12:07:52.421856 | 21f35daf-71f3-43a9-a539-a41a10bb4d2d ==============================
[0m12:07:52.421856 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:07:52.422657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:07:52.772458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21f35daf-71f3-43a9-a539-a41a10bb4d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c639cdba0>]}
[0m12:07:52.789436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21f35daf-71f3-43a9-a539-a41a10bb4d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c60eb5600>]}
[0m12:07:52.790323 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:07:52.808480 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:07:52.818607 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:07:52.819238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21f35daf-71f3-43a9-a539-a41a10bb4d2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c60ed3310>]}
[0m12:07:52.825528 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: staging/dbt_packages_exercise_stg/product_price_history_sources.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   - name: coffee_shop
    5  |       project: analytics-engineers-club
    6  |       tables: 
    7  |        - name: product_prices
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 14
[0m12:07:52.826554 [debug] [MainThread]: Command `dbt test` failed at 12:07:52.826406 after 0.41 seconds
[0m12:07:52.826984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c63c66410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c60c63130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c60c631c0>]}
[0m12:07:52.827429 [debug] [MainThread]: Flushing usage events
[0m12:08:38.719805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac95563e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac82ce500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac82ce470>]}


============================== 12:08:38.724683 | 23b9b7ba-a51c-4a56-96a6-c7212f409ddd ==============================
[0m12:08:38.724683 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:08:38.725652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:08:39.147871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23b9b7ba-a51c-4a56-96a6-c7212f409ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac67ac2e0>]}
[0m12:08:39.164944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23b9b7ba-a51c-4a56-96a6-c7212f409ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac67b7370>]}
[0m12:08:39.165899 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:08:39.184146 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:08:39.194295 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:08:39.194981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23b9b7ba-a51c-4a56-96a6-c7212f409ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac67b7670>]}
[0m12:08:39.201931 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_robert: staging/dbt_packages_exercise_stg/product_price_history_sources.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   - name: coffee_shop
    5  |       project: analytics-engineers-club
    6  |       tables: 
    7  |        - name: product_prices
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 14
[0m12:08:39.202945 [debug] [MainThread]: Command `dbt test` failed at 12:08:39.202780 after 0.53 seconds
[0m12:08:39.203420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac95563e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac6563130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac65631c0>]}
[0m12:08:39.203884 [debug] [MainThread]: Flushing usage events
[0m12:09:27.386297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06454a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0634ca500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0634ca470>]}


============================== 12:09:27.388882 | 9929b271-e61f-4b36-b2fa-7b5c779767ee ==============================
[0m12:09:27.388882 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:09:27.389784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:09:27.743684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9929b271-e61f-4b36-b2fa-7b5c779767ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0642f09a0>]}
[0m12:09:27.762121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9929b271-e61f-4b36-b2fa-7b5c779767ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0619b37c0>]}
[0m12:09:27.762932 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:09:27.782934 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:09:27.793150 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:09:27.793850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9929b271-e61f-4b36-b2fa-7b5c779767ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0619ce740>]}
[0m12:09:28.939173 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m12:09:28.960594 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport_view.sql
[0m12:09:28.966268 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:09:28.971749 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbtcustomers/customers.sql
[0m12:09:28.975258 [debug] [MainThread]: 1603: static parser failed on marts/Jinja_exercises/coffee_jinja.sql
[0m12:09:28.982385 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/Jinja_exercises/coffee_jinja.sql
[0m12:09:28.985149 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbt_packages_exercise/product_price_history.sql
[0m12:09:28.992301 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/pageviews_userstitching.sql
[0m12:09:28.995733 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/visitors_sessionization.sql
[0m12:09:29.117197 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/dbt_packages_exercise_stg/product_price_history_schema.yml:
  	test definition dictionary must have exactly one key, got [('dbt_utils.mutually_exclusive_ranges', None), ('lower_bound_column', 'created_at'), ('upper_bound_column', 'ended_at'), ('partition_by', 'product_id'), ('gaps', 'not_allowed')] instead (5 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...[])
[0m12:09:29.122706 [debug] [MainThread]: Command `dbt test` failed at 12:09:29.122483 after 1.74 seconds
[0m12:09:29.124034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06454a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0619194b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe061918760>]}
[0m12:09:29.125203 [debug] [MainThread]: Flushing usage events
[0m12:11:36.942078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ba7be440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b96ca560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b96ca4d0>]}


============================== 12:11:36.944702 | 6fef5e3c-fe71-4d65-9726-28111ab05b70 ==============================
[0m12:11:36.944702 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:11:36.945512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:11:37.296870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fef5e3c-fe71-4d65-9726-28111ab05b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ba6f5f60>]}
[0m12:11:37.314736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fef5e3c-fe71-4d65-9726-28111ab05b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b7bb16f0>]}
[0m12:11:37.315517 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:11:37.336490 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:11:37.346536 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:11:37.347163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fef5e3c-fe71-4d65-9726-28111ab05b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b7bcf3a0>]}
[0m12:11:38.338977 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m12:11:38.351871 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport_view.sql
[0m12:11:38.355313 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m12:11:38.358741 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbtcustomers/customers.sql
[0m12:11:38.362256 [debug] [MainThread]: 1603: static parser failed on marts/Jinja_exercises/coffee_jinja.sql
[0m12:11:38.368040 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/Jinja_exercises/coffee_jinja.sql
[0m12:11:38.369624 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbt_packages_exercise/product_price_history.sql
[0m12:11:38.373025 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/pageviews_userstitching.sql
[0m12:11:38.376405 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/visitors_sessionization.sql
[0m12:11:38.579296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fef5e3c-fe71-4d65-9726-28111ab05b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b813ed10>]}
[0m12:11:38.591493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fef5e3c-fe71-4d65-9726-28111ab05b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b813ed10>]}
[0m12:11:38.592139 [info ] [MainThread]: Found 8 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:11:38.592739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fef5e3c-fe71-4d65-9726-28111ab05b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b813e500>]}
[0m12:11:38.594382 [info ] [MainThread]: 
[0m12:11:38.595607 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:11:38.597699 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m12:11:38.598200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:43.066699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fef5e3c-fe71-4d65-9726-28111ab05b70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b79bb550>]}
[0m12:11:43.067980 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:11:43.069013 [info ] [MainThread]: 
[0m12:11:43.089898 [debug] [Thread-1 (]: Began running node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:11:43.090724 [info ] [Thread-1 (]: 1 of 1 START test dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at  [RUN]
[0m12:11:43.091645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4)
[0m12:11:43.092108 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:11:43.101831 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4"
[0m12:11:43.102704 [debug] [Thread-1 (]: Timing info for test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4 (compile): 12:11:43.092404 => 12:11:43.102448
[0m12:11:43.103147 [debug] [Thread-1 (]: Began executing node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:11:43.122705 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4"
[0m12:11:43.123530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:43.124069 [debug] [Thread-1 (]: On test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        product_id as partition_by_col,
        
        created_at as lower_bound,
        ended_at as upper_bound,

        lead(created_at) over (
            partition by product_id
            order by created_at, ended_at
        ) as next_lower_bound,

        row_number() over (
            partition by product_id
            order by created_at desc, ended_at desc
        ) = 1 as is_last_record

    from `aec-students`.`dbt_robert`.`product_price_history`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m12:11:43.531801 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        product_id as partition_by_col,
        
        created_at as lower_bound,
        ended_at as upper_bound,

        lead(created_at) over (
            partition by product_id
            order by created_at, ended_at
        ) as next_lower_bound,

        row_number() over (
            partition by product_id
            order by created_at desc, ended_at desc
        ) = 1 as is_last_record

    from `aec-students`.`dbt_robert`.`product_price_history`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m12:11:43.532986 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table aec-students:dbt_robert.product_price_history was not found in location US

Location: US
Job ID: 77dcf463-c12a-4c1c-a0f3-176d234e35bf

[0m12:11:43.534838 [debug] [Thread-1 (]: Timing info for test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4 (execute): 12:11:43.103465 => 12:11:43.534443
[0m12:11:43.561541 [debug] [Thread-1 (]: Runtime Error in test dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at (models/staging/dbt_packages_exercise_stg/product_price_history_schema.yml)
  404 Not found: Table aec-students:dbt_robert.product_price_history was not found in location US
  
  Location: US
  Job ID: 77dcf463-c12a-4c1c-a0f3-176d234e35bf
  
[0m12:11:43.562268 [error] [Thread-1 (]: 1 of 1 ERROR dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at  [[31mERROR[0m in 0.47s]
[0m12:11:43.563226 [debug] [Thread-1 (]: Finished running node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:11:43.565669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:43.566044 [debug] [MainThread]: Connection 'test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4' was properly closed.
[0m12:11:43.566472 [info ] [MainThread]: 
[0m12:11:43.567046 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.97 seconds (4.97s).
[0m12:11:43.568077 [debug] [MainThread]: Command end result
[0m12:11:43.585693 [info ] [MainThread]: 
[0m12:11:43.586329 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:11:43.586940 [info ] [MainThread]: 
[0m12:11:43.587810 [error] [MainThread]: [33mRuntime Error in test dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at (models/staging/dbt_packages_exercise_stg/product_price_history_schema.yml)[0m
[0m12:11:43.588447 [error] [MainThread]:   404 Not found: Table aec-students:dbt_robert.product_price_history was not found in location US
[0m12:11:43.589261 [error] [MainThread]:   
[0m12:11:43.589862 [error] [MainThread]:   Location: US
[0m12:11:43.590688 [error] [MainThread]:   Job ID: 77dcf463-c12a-4c1c-a0f3-176d234e35bf
[0m12:11:43.591285 [error] [MainThread]:   
[0m12:11:43.591890 [info ] [MainThread]: 
[0m12:11:43.592598 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:11:43.593697 [debug] [MainThread]: Command `dbt test` failed at 12:11:43.593519 after 6.66 seconds
[0m12:11:43.594301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ba7be440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b7963fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11b7a02e00>]}
[0m12:11:43.595045 [debug] [MainThread]: Flushing usage events
[0m12:12:13.672311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c10e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315aff2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315aff23e0>]}


============================== 12:12:13.674874 | b3ba4583-c927-4cee-9533-47ab222640bd ==============================
[0m12:12:13.674874 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:12:13.675702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:12:14.023212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c0392a0>]}
[0m12:12:14.040395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31594d9de0>]}
[0m12:12:14.041340 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:12:14.059374 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:12:14.097419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:14.097896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:14.105193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315916a3e0>]}
[0m12:12:14.118390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315937b6d0>]}
[0m12:12:14.118968 [info ] [MainThread]: Found 8 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:12:14.119787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315937b670>]}
[0m12:12:14.122174 [info ] [MainThread]: 
[0m12:12:14.123242 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:12:14.125022 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:12:14.125541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:15.196049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:12:15.196836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:15.498992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315937a500>]}
[0m12:12:15.500354 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:12:15.501106 [info ] [MainThread]: 
[0m12:12:15.506335 [debug] [Thread-1 (]: Began running node model.dbt_robert.customers
[0m12:12:15.506794 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers
[0m12:12:15.507576 [info ] [Thread-1 (]: 1 of 8 START sql view model dbt_robert.customers ............................... [RUN]
[0m12:12:15.508309 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt_robert.dbtcustomers ........................... [RUN]
[0m12:12:15.509315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.customers)
[0m12:12:15.510299 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.dbtcustomers'
[0m12:12:15.510935 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.customers
[0m12:12:15.511457 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m12:12:15.513940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.customers"
[0m12:12:15.517195 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m12:12:15.518286 [debug] [Thread-1 (]: Timing info for model.dbt_robert.customers (compile): 12:12:15.511808 => 12:12:15.518039
[0m12:12:15.518893 [debug] [Thread-1 (]: Began executing node model.dbt_robert.customers
[0m12:12:15.536507 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 12:12:15.514341 => 12:12:15.536202
[0m12:12:15.551525 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.customers"
[0m12:12:15.552029 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers
[0m12:12:15.563607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:15.566645 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:12:15.567249 [debug] [Thread-1 (]: On model.dbt_robert.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.customers"} */


  create or replace view `aec-students`.`dbt_robert`.`customers`
  OPTIONS()
  as select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5;


[0m12:12:16.030136 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m12:12:16.031144 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m12:12:16.697703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a81dc23b-369d-4a91-8cf4-dc11159dc31c&page=queryresults
[0m12:12:16.715012 [debug] [Thread-1 (]: Timing info for model.dbt_robert.customers (execute): 12:12:15.519232 => 12:12:16.714786
[0m12:12:16.715997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3159202680>]}
[0m12:12:16.716763 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dbt_robert.customers .......................... [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m12:12:16.717957 [debug] [Thread-1 (]: Finished running node model.dbt_robert.customers
[0m12:12:16.718501 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:12:16.719473 [info ] [Thread-1 (]: 3 of 8 START sql table model dbt_robert.dbtcustomers_revenuereport ............. [RUN]
[0m12:12:16.720573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.customers, now model.dbt_robert.dbtcustomers_revenuereport)
[0m12:12:16.721038 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m12:12:16.724740 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:12:16.725632 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 12:12:16.721336 => 12:12:16.725295
[0m12:12:16.726121 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m12:12:16.728644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:17.043645 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m12:12:17.044774 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at as sold_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category as product_category
,PP.price as amount
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m12:12:19.809781 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:63c4c544-e51c-438e-910a-4793fd4e25ae&page=queryresults
[0m12:12:19.812319 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 12:12:15.552579 => 12:12:19.812100
[0m12:12:19.813143 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3159245630>]}
[0m12:12:19.813835 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt_robert.dbtcustomers ...................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.30s]
[0m12:12:19.814788 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers
[0m12:12:19.815370 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m12:12:19.816075 [info ] [Thread-2 (]: 4 of 8 START sql view model dbt_robert.dbtcustomers_revenuereport_view ......... [RUN]
[0m12:12:19.817275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.dbtcustomers_revenuereport_view)
[0m12:12:19.817726 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport_view
[0m12:12:19.821519 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m12:12:19.822372 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (compile): 12:12:19.818011 => 12:12:19.822044
[0m12:12:19.822847 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport_view
[0m12:12:19.826265 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m12:12:19.826984 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:12:19.827536 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport_view: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport_view"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport_view`
  OPTIONS()
  as 

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25;


[0m12:12:20.748204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e2c1ff00-ed81-4c31-9569-c1d1427069a7&page=queryresults
[0m12:12:20.751415 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 12:12:16.726412 => 12:12:20.751151
[0m12:12:20.752311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31594f49a0>]}
[0m12:12:20.753142 [info ] [Thread-1 (]: 3 of 8 OK created sql table model dbt_robert.dbtcustomers_revenuereport ........ [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.03s]
[0m12:12:20.754369 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m12:12:20.755024 [debug] [Thread-1 (]: Began running node model.dbt_robert.product_price_history
[0m12:12:20.756436 [info ] [Thread-1 (]: 5 of 8 START sql view model dbt_robert.product_price_history ................... [RUN]
[0m12:12:20.757654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.dbt_robert.product_price_history)
[0m12:12:20.758181 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.product_price_history
[0m12:12:20.766566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.product_price_history"
[0m12:12:20.767715 [debug] [Thread-1 (]: Timing info for model.dbt_robert.product_price_history (compile): 12:12:20.758955 => 12:12:20.767414
[0m12:12:20.768183 [debug] [Thread-1 (]: Began executing node model.dbt_robert.product_price_history
[0m12:12:20.829091 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.product_price_history"
[0m12:12:20.830097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:20.830644 [debug] [Thread-1 (]: On model.dbt_robert.product_price_history: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.product_price_history"} */


  create or replace view `aec-students`.`dbt_robert`.`product_price_history`
  OPTIONS()
  as select 

id,
product_id,
price,
created_at,
ended_at

from analytics-engineers-club.coffee_shop.product_prices;


[0m12:12:20.906864 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1c2cb499-d6aa-4b24-8985-810a4edf6267&page=queryresults
[0m12:12:20.911942 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (execute): 12:12:19.823129 => 12:12:20.911653
[0m12:12:20.913615 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31594d9210>]}
[0m12:12:20.914505 [info ] [Thread-2 (]: 4 of 8 OK created sql view model dbt_robert.dbtcustomers_revenuereport_view .... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m12:12:20.915919 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m12:12:20.917092 [debug] [Thread-2 (]: Began running node model.dbt_robert.visitors_sessionization
[0m12:12:20.918236 [info ] [Thread-2 (]: 6 of 8 START sql table model dbt_robert.visitors_sessionization ................ [RUN]
[0m12:12:20.919976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport_view, now model.dbt_robert.visitors_sessionization)
[0m12:12:20.921627 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.visitors_sessionization
[0m12:12:20.925578 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.visitors_sessionization"
[0m12:12:20.926661 [debug] [Thread-2 (]: Timing info for model.dbt_robert.visitors_sessionization (compile): 12:12:20.921951 => 12:12:20.926397
[0m12:12:20.927140 [debug] [Thread-2 (]: Began executing node model.dbt_robert.visitors_sessionization
[0m12:12:20.929973 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:12:21.263058 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.visitors_sessionization"
[0m12:12:21.264475 [debug] [Thread-2 (]: On model.dbt_robert.visitors_sessionization: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.visitors_sessionization"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`visitors_sessionization`
    
    

    OPTIONS()
    as (
      


-- one record per visitor id
with visitors_userstitching as (
    select distinct
        visitor_id,

        first_value(customer_id ignore nulls) over (
            partition by visitor_id
            order by timestamp
            range between unbounded preceding and unbounded following
        ) as first_customer_id,

        min(timestamp) over (
            partition by visitor_id
        ) as first_seen_at,

        max(timestamp) over (
            partition by visitor_id
        ) as last_seen_at


    from `analytics-engineers-club`.`web_tracking`.`pageviews`
)
select
    *,
    first_value(visitor_id) over (
        partition by coalesce(first_customer_id, visitor_id)
        order by first_seen_at
    ) as first_visitor_id
from visitors_userstitching
    );
  
[0m12:12:21.791135 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:19716d94-37c3-4547-8007-ae13ca667fe9&page=queryresults
[0m12:12:21.797459 [debug] [Thread-1 (]: Timing info for model.dbt_robert.product_price_history (execute): 12:12:20.768486 => 12:12:21.794605
[0m12:12:21.800266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31590b4dc0>]}
[0m12:12:21.801009 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dbt_robert.product_price_history .............. [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m12:12:21.802215 [debug] [Thread-1 (]: Finished running node model.dbt_robert.product_price_history
[0m12:12:21.802754 [debug] [Thread-1 (]: Began running node model.dbt_robert.coffee_jinja
[0m12:12:21.803591 [info ] [Thread-1 (]: 7 of 8 START sql table model dbt_robert.coffee_jinja ........................... [RUN]
[0m12:12:21.804711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.product_price_history, now model.dbt_robert.coffee_jinja)
[0m12:12:21.805164 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.coffee_jinja
[0m12:12:21.810661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.coffee_jinja"
[0m12:12:21.811565 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (compile): 12:12:21.805458 => 12:12:21.811209
[0m12:12:21.812042 [debug] [Thread-1 (]: Began executing node model.dbt_robert.coffee_jinja
[0m12:12:21.814769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:22.163943 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.coffee_jinja"
[0m12:12:22.165184 [debug] [Thread-1 (]: On model.dbt_robert.coffee_jinja: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.coffee_jinja"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`coffee_jinja`
    
    

    OPTIONS()
    as (
      


select
  date_trunc(sold_at, month) as date_month,
 -- sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,
 -- sum(case when product_category = 'merch' then amount end) as merch_amount,
 -- sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount


sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,

sum(case when product_category = 'merch' then amount end) as merch_amount,

sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount,


-- you may have to `ref` a different model here, depending on what you've built previously
from `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
group by 1
    );
  
[0m12:12:25.582479 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ad2c9454-9c1a-480d-a6e5-40931203c4aa&page=queryresults
[0m12:12:25.585250 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (execute): 12:12:21.812332 => 12:12:25.584915
[0m12:12:25.586215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3159246bf0>]}
[0m12:12:25.587089 [info ] [Thread-1 (]: 7 of 8 OK created sql table model dbt_robert.coffee_jinja ...................... [[32mCREATE TABLE (5.0 rows, 661.0 Bytes processed)[0m in 3.78s]
[0m12:12:25.588147 [debug] [Thread-1 (]: Finished running node model.dbt_robert.coffee_jinja
[0m12:12:29.372551 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a44c3beb-9859-4557-bc19-ca0e5709fae6&page=queryresults
[0m12:12:29.375297 [debug] [Thread-2 (]: Timing info for model.dbt_robert.visitors_sessionization (execute): 12:12:20.927477 => 12:12:29.375053
[0m12:12:29.376205 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31590b55d0>]}
[0m12:12:29.376914 [info ] [Thread-2 (]: 6 of 8 OK created sql table model dbt_robert.visitors_sessionization ........... [[32mCREATE TABLE (1.4m rows, 292.6 MiB processed)[0m in 8.46s]
[0m12:12:29.378049 [debug] [Thread-2 (]: Finished running node model.dbt_robert.visitors_sessionization
[0m12:12:29.379243 [debug] [Thread-1 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m12:12:29.380001 [info ] [Thread-1 (]: 8 of 8 START sql table model dbt_robert.pageviews_userstitching ................ [RUN]
[0m12:12:29.381007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.coffee_jinja, now model.dbt_robert.pageviews_userstitching)
[0m12:12:29.381468 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m12:12:29.394873 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m12:12:29.395889 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 12:12:29.381777 => 12:12:29.395452
[0m12:12:29.396331 [debug] [Thread-1 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m12:12:29.399126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:29.734025 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m12:12:29.735164 [debug] [Thread-1 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

-- SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`

with pageviews as (
    select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
),

visitors as (
    select * from `aec-students`.`dbt_robert`.`visitors_sessionization`
),

joined as (
    select
        pageviews.*,
        -- customer id if we have it, else visitor id
        coalesce(
            visitors.first_customer_id,
            pageviews.visitor_id
        ) as blended_user_id,

        visitors.first_visitor_id

    from pageviews
    left join visitors
        on pageviews.visitor_id = visitors.visitor_id
)

select * from joined
    );
  
[0m12:12:42.566875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ae9a55b1-a6c9-4284-add4-2922506e5f56&page=queryresults
[0m12:12:42.570717 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 12:12:29.396622 => 12:12:42.570440
[0m12:12:42.571821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba4583-c927-4cee-9533-47ab222640bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315934be50>]}
[0m12:12:42.572728 [info ] [Thread-1 (]: 8 of 8 OK created sql table model dbt_robert.pageviews_userstitching ........... [[32mCREATE TABLE (5.8m rows, 719.6 MiB processed)[0m in 13.19s]
[0m12:12:42.574242 [debug] [Thread-1 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m12:12:42.577045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:42.577437 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m12:12:42.577784 [debug] [MainThread]: Connection 'model.dbt_robert.visitors_sessionization' was properly closed.
[0m12:12:42.578279 [info ] [MainThread]: 
[0m12:12:42.578916 [info ] [MainThread]: Finished running 3 view models, 5 table models in 0 hours 0 minutes and 28.46 seconds (28.46s).
[0m12:12:42.581486 [debug] [MainThread]: Command end result
[0m12:12:42.592220 [info ] [MainThread]: 
[0m12:12:42.592953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:42.593757 [info ] [MainThread]: 
[0m12:12:42.594596 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:12:42.595787 [debug] [MainThread]: Command `dbt run` succeeded at 12:12:42.595589 after 28.93 seconds
[0m12:12:42.596266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315c10e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f315905b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3159159ba0>]}
[0m12:12:42.596784 [debug] [MainThread]: Flushing usage events
[0m12:14:04.764252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36de422440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dd1d2560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dd1d24d0>]}


============================== 12:14:04.766797 | ec7a4c4e-f37d-4dd0-b0bd-e6aafa15eca2 ==============================
[0m12:14:04.766797 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:14:04.767830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:14:05.120469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec7a4c4e-f37d-4dd0-b0bd-e6aafa15eca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36de15df60>]}
[0m12:14:05.137425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec7a4c4e-f37d-4dd0-b0bd-e6aafa15eca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36db6b56f0>]}
[0m12:14:05.138334 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:14:05.159351 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:14:05.196584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:14:05.196987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:14:05.203837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec7a4c4e-f37d-4dd0-b0bd-e6aafa15eca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36db5427a0>]}
[0m12:14:05.215557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec7a4c4e-f37d-4dd0-b0bd-e6aafa15eca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36db617a90>]}
[0m12:14:05.216107 [info ] [MainThread]: Found 8 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:14:05.216661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec7a4c4e-f37d-4dd0-b0bd-e6aafa15eca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36db617a30>]}
[0m12:14:05.218304 [info ] [MainThread]: 
[0m12:14:05.219456 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:14:05.221175 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m12:14:05.221690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:06.275538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec7a4c4e-f37d-4dd0-b0bd-e6aafa15eca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36db6173d0>]}
[0m12:14:06.276571 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:14:06.277358 [info ] [MainThread]: 
[0m12:14:06.281518 [debug] [Thread-1 (]: Began running node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:14:06.282089 [info ] [Thread-1 (]: 1 of 1 START test dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at  [RUN]
[0m12:14:06.282962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4)
[0m12:14:06.283433 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:14:06.304577 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4"
[0m12:14:06.305400 [debug] [Thread-1 (]: Timing info for test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4 (compile): 12:14:06.283973 => 12:14:06.305097
[0m12:14:06.305856 [debug] [Thread-1 (]: Began executing node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:14:06.325076 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4"
[0m12:14:06.325856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:06.326414 [debug] [Thread-1 (]: On test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        product_id as partition_by_col,
        
        created_at as lower_bound,
        ended_at as upper_bound,

        lead(created_at) over (
            partition by product_id
            order by created_at, ended_at
        ) as next_lower_bound,

        row_number() over (
            partition by product_id
            order by created_at desc, ended_at desc
        ) = 1 as is_last_record

    from `aec-students`.`dbt_robert`.`product_price_history`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m12:14:08.211986 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d8aabe28-62c8-436f-b4a7-6ded94f5f501&page=queryresults
[0m12:14:08.214231 [debug] [Thread-1 (]: Timing info for test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4 (execute): 12:14:06.306146 => 12:14:08.213867
[0m12:14:08.215466 [info ] [Thread-1 (]: 1 of 1 PASS dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at  [[32mPASS[0m in 1.93s]
[0m12:14:08.216890 [debug] [Thread-1 (]: Finished running node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:14:08.218991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:08.219418 [debug] [MainThread]: Connection 'test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4' was properly closed.
[0m12:14:08.219816 [info ] [MainThread]: 
[0m12:14:08.220595 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m12:14:08.221896 [debug] [MainThread]: Command end result
[0m12:14:08.234277 [info ] [MainThread]: 
[0m12:14:08.234995 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:08.235651 [info ] [MainThread]: 
[0m12:14:08.236360 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:14:08.237461 [debug] [MainThread]: Command `dbt test` succeeded at 12:14:08.237280 after 3.48 seconds
[0m12:14:08.238067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36de422440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36db7a31c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36db2cc9a0>]}
[0m12:14:08.238797 [debug] [MainThread]: Flushing usage events
[0m12:14:27.686155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3a556410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd394ca530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd394ca4a0>]}


============================== 12:14:27.690652 | 06849cdc-435d-4703-a4cf-437f0ef9af58 ==============================
[0m12:14:27.690652 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:14:27.691707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:14:28.037010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06849cdc-435d-4703-a4cf-437f0ef9af58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd379af2b0>]}
[0m12:14:28.054438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06849cdc-435d-4703-a4cf-437f0ef9af58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3a31eec0>]}
[0m12:14:28.055182 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:14:28.074171 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:14:28.112464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:28.113243 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/dbt_packages_exercise_stg/product_price_history_schema.yml
[0m12:14:28.137146 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbt_packages_exercise/product_price_history.sql
[0m12:14:28.209910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06849cdc-435d-4703-a4cf-437f0ef9af58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd378300a0>]}
[0m12:14:28.221407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06849cdc-435d-4703-a4cf-437f0ef9af58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3792e0e0>]}
[0m12:14:28.221986 [info ] [MainThread]: Found 8 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:14:28.222535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06849cdc-435d-4703-a4cf-437f0ef9af58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3792e050>]}
[0m12:14:28.224175 [info ] [MainThread]: 
[0m12:14:28.225271 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:14:28.227082 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m12:14:28.227570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:29.286155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06849cdc-435d-4703-a4cf-437f0ef9af58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3792dc60>]}
[0m12:14:29.287247 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:14:29.287904 [info ] [MainThread]: 
[0m12:14:29.291915 [debug] [Thread-1 (]: Began running node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a
[0m12:14:29.292443 [info ] [Thread-1 (]: 1 of 1 START test dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at  [RUN]
[0m12:14:29.293393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a)
[0m12:14:29.293864 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a
[0m12:14:29.355375 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a"
[0m12:14:29.356254 [debug] [Thread-1 (]: Timing info for test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a (compile): 12:14:29.294337 => 12:14:29.355982
[0m12:14:29.356727 [debug] [Thread-1 (]: Began executing node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a
[0m12:14:29.376635 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a"
[0m12:14:29.377322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:29.377851 [debug] [Thread-1 (]: On test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        product_id as partition_by_col,
        
        created_at as lower_bound,
        ended_at as upper_bound,

        lead(created_at) over (
            partition by product_id
            order by created_at, ended_at
        ) as next_lower_bound,

        row_number() over (
            partition by product_id
            order by created_at desc, ended_at desc
        ) = 1 as is_last_record

    from `aec-students`.`dbt_robert`.`product_price_history`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound < the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound < next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_less_than_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_less_than_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m12:14:31.248515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3feac49f-62d3-49fc-9b7f-e55ea58f467a&page=queryresults
[0m12:14:31.250505 [debug] [Thread-1 (]: Timing info for test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a (execute): 12:14:29.357018 => 12:14:31.250199
[0m12:14:31.251677 [error] [Thread-1 (]: 1 of 1 FAIL 8 dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at  [[31mFAIL 8[0m in 1.96s]
[0m12:14:31.253089 [debug] [Thread-1 (]: Finished running node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a
[0m12:14:31.255848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:31.256247 [debug] [MainThread]: Connection 'test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at.fd0e78b31a' was properly closed.
[0m12:14:31.256695 [info ] [MainThread]: 
[0m12:14:31.257255 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m12:14:31.258757 [debug] [MainThread]: Command end result
[0m12:14:31.271606 [info ] [MainThread]: 
[0m12:14:31.272405 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:14:31.273384 [info ] [MainThread]: 
[0m12:14:31.274115 [error] [MainThread]: [31mFailure in test dbt_utils_mutually_exclusive_ranges_product_price_history_required__created_at__product_id__ended_at (models/staging/dbt_packages_exercise_stg/product_price_history_schema.yml)[0m
[0m12:14:31.274915 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m12:14:31.275630 [info ] [MainThread]: 
[0m12:14:31.276595 [info ] [MainThread]:   compiled Code at target/compiled/dbt_robert/models/staging/dbt_packages_exercise_stg/product_price_history_schema.yml/dbt_utils_mutually_exclusive_r_3051f4f864181b258dc4105a2cdd0597.sql
[0m12:14:31.277297 [info ] [MainThread]: 
[0m12:14:31.277959 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:14:31.279487 [debug] [MainThread]: Command `dbt test` failed at 12:14:31.279300 after 3.61 seconds
[0m12:14:31.280031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3a556410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3a31eec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd3bb5af50>]}
[0m12:14:31.280494 [debug] [MainThread]: Flushing usage events
[0m12:14:51.699081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e4682410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e340e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e340e4a0>]}


============================== 12:14:51.701815 | 179efb2c-4589-4461-a2e4-ab42d4a2fd64 ==============================
[0m12:14:51.701815 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:14:51.702626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:14:52.050214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '179efb2c-4589-4461-a2e4-ab42d4a2fd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e45e5ba0>]}
[0m12:14:52.067582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '179efb2c-4589-4461-a2e4-ab42d4a2fd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e1af54b0>]}
[0m12:14:52.068420 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:14:52.089319 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:14:52.128297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:52.129072 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/staging/dbt_packages_exercise_stg/product_price_history_schema.yml
[0m12:14:52.153174 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbt_packages_exercise/product_price_history.sql
[0m12:14:52.227222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '179efb2c-4589-4461-a2e4-ab42d4a2fd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e17e5ff0>]}
[0m12:14:52.239447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '179efb2c-4589-4461-a2e4-ab42d4a2fd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e185b8b0>]}
[0m12:14:52.240115 [info ] [MainThread]: Found 8 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:14:52.240712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '179efb2c-4589-4461-a2e4-ab42d4a2fd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e1859cf0>]}
[0m12:14:52.242708 [info ] [MainThread]: 
[0m12:14:52.243925 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:14:52.245855 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m12:14:52.246389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:53.329014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '179efb2c-4589-4461-a2e4-ab42d4a2fd64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e185b1f0>]}
[0m12:14:53.330308 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:14:53.331143 [info ] [MainThread]: 
[0m12:14:53.335723 [debug] [Thread-1 (]: Began running node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:14:53.336535 [info ] [Thread-1 (]: 1 of 1 START test dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at  [RUN]
[0m12:14:53.337582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4)
[0m12:14:53.338092 [debug] [Thread-1 (]: Began compiling node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:14:53.407374 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4"
[0m12:14:53.408767 [debug] [Thread-1 (]: Timing info for test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4 (compile): 12:14:53.338529 => 12:14:53.408371
[0m12:14:53.409635 [debug] [Thread-1 (]: Began executing node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:14:53.436621 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4"
[0m12:14:53.437499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:53.438097 [debug] [Thread-1 (]: On test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    
    


    
    




with window_functions as (

    select
        
        product_id as partition_by_col,
        
        created_at as lower_bound,
        ended_at as upper_bound,

        lead(created_at) over (
            partition by product_id
            order by created_at, ended_at
        ) as next_lower_bound,

        row_number() over (
            partition by product_id
            order by created_at desc, ended_at desc
        ) = 1 as is_last_record

    from `aec-students`.`dbt_robert`.`product_price_history`

),

calc as (
    -- We want to return records where one of our assumptions fails, so we'll use
    -- the `not` function with `and` statements so we can write our assumptions more cleanly
    select
        *,

        -- For each record: lower_bound should be < upper_bound.
        -- Coalesce it to return an error on the null case (implicit assumption
        -- these columns are not_null)
        coalesce(
            lower_bound < upper_bound,
            false
        ) as lower_bound_less_than_upper_bound,

        -- For each record: upper_bound = the next lower_bound.
        -- Coalesce it to handle null cases for the last record.
        coalesce(
            upper_bound = next_lower_bound,
            is_last_record,
            false
        ) as upper_bound_equal_to_next_lower_bound

    from window_functions

),

validation_errors as (

    select
        *
    from calc

    where not(
        -- THE FOLLOWING SHOULD BE TRUE --
        lower_bound_less_than_upper_bound
        and upper_bound_equal_to_next_lower_bound
    )
)

select * from validation_errors

      
    ) dbt_internal_test
[0m12:14:54.906979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c4b92a9e-5a33-4471-b64b-6eb615c4c4b4&page=queryresults
[0m12:14:54.908923 [debug] [Thread-1 (]: Timing info for test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4 (execute): 12:14:53.410185 => 12:14:54.908612
[0m12:14:54.909895 [info ] [Thread-1 (]: 1 of 1 PASS dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at  [[32mPASS[0m in 1.57s]
[0m12:14:54.911078 [debug] [Thread-1 (]: Finished running node test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4
[0m12:14:54.913345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:54.913715 [debug] [MainThread]: Connection 'test.dbt_robert.dbt_utils_mutually_exclusive_ranges_product_price_history_not_allowed__created_at__product_id__ended_at.e57ae990c4' was properly closed.
[0m12:14:54.914101 [info ] [MainThread]: 
[0m12:14:54.914579 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m12:14:54.915769 [debug] [MainThread]: Command end result
[0m12:14:54.928232 [info ] [MainThread]: 
[0m12:14:54.929004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:54.929661 [info ] [MainThread]: 
[0m12:14:54.930676 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:14:54.931611 [debug] [MainThread]: Command `dbt test` succeeded at 12:14:54.931482 after 3.24 seconds
[0m12:14:54.932032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e4682410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e5c82f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e201fe50>]}
[0m12:14:54.932793 [debug] [MainThread]: Flushing usage events
[0m12:52:06.183477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f1dde3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f0ace500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f0ace470>]}


============================== 12:52:06.186077 | 6a111293-8dc1-4476-80a2-90939092748d ==============================
[0m12:52:06.186077 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:52:06.186895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:52:06.538778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a111293-8dc1-4476-80a2-90939092748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f1b8a6b0>]}
[0m12:52:06.555776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a111293-8dc1-4476-80a2-90939092748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1eefb1360>]}
[0m12:52:06.556565 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:52:06.574232 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:52:06.613954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m12:52:06.614624 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/date_spine.sql
[0m12:52:06.615150 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/dbtcustomers/customers.sql
[0m12:52:06.615702 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/dbt_packages_exercise/product_price_history.sql
[0m12:52:06.640313 [debug] [MainThread]: 1699: static parser successfully parsed marts/date_spine.sql
[0m12:52:06.653847 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbtcustomers/customers.sql
[0m12:52:06.657105 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbt_packages_exercise/product_price_history.sql
[0m12:52:06.722572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a111293-8dc1-4476-80a2-90939092748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1eed67160>]}
[0m12:52:06.735454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a111293-8dc1-4476-80a2-90939092748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1eef23c10>]}
[0m12:52:06.736147 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:52:06.736836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a111293-8dc1-4476-80a2-90939092748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1eef22050>]}
[0m12:52:06.738586 [info ] [MainThread]: 
[0m12:52:06.739767 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:52:06.741206 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:52:06.741714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:07.858136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:52:07.858940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:08.136426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a111293-8dc1-4476-80a2-90939092748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f19510f0>]}
[0m12:52:08.137608 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:52:08.138459 [info ] [MainThread]: 
[0m12:52:08.146272 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine
[0m12:52:08.146945 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_robert.date_spine .............................. [RUN]
[0m12:52:08.148013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine)
[0m12:52:08.148660 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine
[0m12:52:08.205723 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.date_spine"
[0m12:52:08.206628 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (compile): 12:52:08.149278 => 12:52:08.206345
[0m12:52:08.207098 [debug] [Thread-1 (]: Began executing node model.dbt_robert.date_spine
[0m12:52:08.238634 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.date_spine"
[0m12:52:08.239482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:08.239984 [debug] [Thread-1 (]: On model.dbt_robert.date_spine: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine"} */


  create or replace view `aec-students`.`dbt_robert`.`date_spine`
  OPTIONS()
  as date_spine(
    "day",
    "to_date('01/01/2023', 'mm/dd/yyyy')",
    "dbt.dateadd(week, 1, current_date)"
);


[0m12:52:08.564336 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "date_spine" at [6:6]')
[0m12:52:08.856597 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5770e29e-a989-4f47-a7ab-65b4a860ae9d&page=queryresults
[0m12:52:08.858487 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (execute): 12:52:08.207429 => 12:52:08.858140
[0m12:52:08.866618 [debug] [Thread-1 (]: Database Error in model date_spine (models/marts/date_spine.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "date_spine" at [6:6]
  compiled Code at target/run/dbt_robert/models/marts/date_spine.sql
[0m12:52:08.867537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a111293-8dc1-4476-80a2-90939092748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1eedfa8f0>]}
[0m12:52:08.871561 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_robert.date_spine ..................... [[31mERROR[0m in 0.72s]
[0m12:52:08.873190 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine
[0m12:52:08.878404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:08.885557 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine' was properly closed.
[0m12:52:08.886148 [info ] [MainThread]: 
[0m12:52:08.887066 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m12:52:08.888542 [debug] [MainThread]: Command end result
[0m12:52:08.908031 [info ] [MainThread]: 
[0m12:52:08.909900 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:52:08.923439 [info ] [MainThread]: 
[0m12:52:08.925617 [error] [MainThread]: [33mDatabase Error in model date_spine (models/marts/date_spine.sql)[0m
[0m12:52:08.928093 [error] [MainThread]:   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "date_spine" at [6:6]
[0m12:52:08.930381 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/date_spine.sql
[0m12:52:08.932877 [info ] [MainThread]: 
[0m12:52:08.934880 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:52:08.939747 [debug] [MainThread]: Command `dbt run` failed at 12:52:08.937237 after 2.76 seconds
[0m12:52:08.940362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1f1dde3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1eefb1300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1eefb0610>]}
[0m12:52:08.943504 [debug] [MainThread]: Flushing usage events
[0m12:53:13.976103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95089963b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950770e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950770e440>]}


============================== 12:53:13.978675 | ed8dd2cd-5c10-4744-ade0-c9010f44be18 ==============================
[0m12:53:13.978675 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:53:13.979470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:53:14.396609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed8dd2cd-5c10-4744-ade0-c9010f44be18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950876f520>]}
[0m12:53:14.414016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed8dd2cd-5c10-4744-ade0-c9010f44be18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9505df94e0>]}
[0m12:53:14.415032 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:53:14.432946 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:53:14.475778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:14.476651 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m12:53:14.501713 [debug] [MainThread]: 1699: static parser successfully parsed marts/date_spine.sql
[0m12:53:14.527868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed8dd2cd-5c10-4744-ade0-c9010f44be18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9505a9fa60>]}
[0m12:53:14.549891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed8dd2cd-5c10-4744-ade0-c9010f44be18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9505c4bca0>]}
[0m12:53:14.550949 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:53:14.552280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8dd2cd-5c10-4744-ade0-c9010f44be18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9505e0b6d0>]}
[0m12:53:14.555123 [info ] [MainThread]: 
[0m12:53:14.556962 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:53:14.559225 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:53:14.560015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:15.743542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:53:15.744240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:16.038945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8dd2cd-5c10-4744-ade0-c9010f44be18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9505e17dc0>]}
[0m12:53:16.040388 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:53:16.041297 [info ] [MainThread]: 
[0m12:53:16.046072 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine
[0m12:53:16.046752 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_robert.date_spine .............................. [RUN]
[0m12:53:16.047777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine)
[0m12:53:16.048245 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine
[0m12:53:16.050811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.date_spine"
[0m12:53:16.051756 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (compile): 12:53:16.048541 => 12:53:16.051377
[0m12:53:16.052196 [debug] [Thread-1 (]: Began executing node model.dbt_robert.date_spine
[0m12:53:16.085873 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.date_spine"
[0m12:53:16.087008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:16.087558 [debug] [Thread-1 (]: On model.dbt_robert.date_spine: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine"} */


  create or replace view `aec-students`.`dbt_robert`.`date_spine`
  OPTIONS()
  as {date_spine(
    "day",
    "to_date('01/01/2023', 'mm/dd/yyyy')",
    "dbt.dateadd(week, 1, current_date)"
)};


[0m12:53:16.410516 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT or keyword WITH but got "{" at [6:6]')
[0m12:53:16.967140 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a4660edc-9c9a-4fc6-a998-bb4e269a5c2e&page=queryresults
[0m12:53:16.968632 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (execute): 12:53:16.052527 => 12:53:16.968314
[0m12:53:16.972146 [debug] [Thread-1 (]: Database Error in model date_spine (models/marts/date_spine.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got "{" at [6:6]
  compiled Code at target/run/dbt_robert/models/marts/date_spine.sql
[0m12:53:16.972758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8dd2cd-5c10-4744-ade0-c9010f44be18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9505ab6470>]}
[0m12:53:16.973585 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_robert.date_spine ..................... [[31mERROR[0m in 0.93s]
[0m12:53:16.974406 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine
[0m12:53:16.976593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:16.976961 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine' was properly closed.
[0m12:53:16.977352 [info ] [MainThread]: 
[0m12:53:16.977834 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m12:53:16.978521 [debug] [MainThread]: Command end result
[0m12:53:17.048276 [info ] [MainThread]: 
[0m12:53:17.049187 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:53:17.049878 [info ] [MainThread]: 
[0m12:53:17.050540 [error] [MainThread]: [33mDatabase Error in model date_spine (models/marts/date_spine.sql)[0m
[0m12:53:17.051200 [error] [MainThread]:   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got "{" at [6:6]
[0m12:53:17.051881 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/date_spine.sql
[0m12:53:17.052538 [info ] [MainThread]: 
[0m12:53:17.053244 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:53:17.054376 [debug] [MainThread]: Command `dbt run` failed at 12:53:17.054181 after 3.09 seconds
[0m12:53:17.055008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95089963b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950854ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9506327e50>]}
[0m12:53:17.055690 [debug] [MainThread]: Flushing usage events
[0m12:54:55.335863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d370f2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d35fc64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d35fc6410>]}


============================== 12:54:55.338438 | 4ad41e9c-6372-43c6-942c-1275bbdb1c0f ==============================
[0m12:54:55.338438 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:54:55.339428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:54:55.696027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ad41e9c-6372-43c6-942c-1275bbdb1c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d3702a650>]}
[0m12:54:55.713833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ad41e9c-6372-43c6-942c-1275bbdb1c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d344b1660>]}
[0m12:54:55.714696 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:54:55.732439 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:54:55.772043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:54:55.772605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:54:55.780017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ad41e9c-6372-43c6-942c-1275bbdb1c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d341500d0>]}
[0m12:54:55.793018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ad41e9c-6372-43c6-942c-1275bbdb1c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d34310160>]}
[0m12:54:55.793680 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:54:55.794283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ad41e9c-6372-43c6-942c-1275bbdb1c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d34310190>]}
[0m12:54:55.796137 [info ] [MainThread]: 
[0m12:54:55.797411 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:54:55.799128 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:54:55.799621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:56.930785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m12:54:56.931622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:57.253995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ad41e9c-6372-43c6-942c-1275bbdb1c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d34423d00>]}
[0m12:54:57.255075 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:54:57.255954 [info ] [MainThread]: 
[0m12:54:57.260348 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine
[0m12:54:57.260980 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_robert.date_spine .............................. [RUN]
[0m12:54:57.262133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine)
[0m12:54:57.262895 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine
[0m12:54:57.265294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.date_spine"
[0m12:54:57.266140 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (compile): 12:54:57.263208 => 12:54:57.265824
[0m12:54:57.266598 [debug] [Thread-1 (]: Began executing node model.dbt_robert.date_spine
[0m12:54:57.302989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.date_spine"
[0m12:54:57.303981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:57.304508 [debug] [Thread-1 (]: On model.dbt_robert.date_spine: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine"} */


  create or replace view `aec-students`.`dbt_robert`.`date_spine`
  OPTIONS()
  as {date_spine(
    "day",
    "to_date('01/01/2023', 'mm/dd/yyyy')",
    "dbt.dateadd(week, 1, current_date)"
)};


[0m12:54:57.629764 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT or keyword WITH but got "{" at [6:6]')
[0m12:54:57.921764 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3f6b7bf8-0272-4a59-bdc3-f416ed74d72e&page=queryresults
[0m12:54:57.923235 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (execute): 12:54:57.266891 => 12:54:57.922883
[0m12:54:57.927594 [debug] [Thread-1 (]: Database Error in model date_spine (models/marts/date_spine.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got "{" at [6:6]
  compiled Code at target/run/dbt_robert/models/marts/date_spine.sql
[0m12:54:57.928186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ad41e9c-6372-43c6-942c-1275bbdb1c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d34302800>]}
[0m12:54:57.928957 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_robert.date_spine ..................... [[31mERROR[0m in 0.67s]
[0m12:54:57.929736 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine
[0m12:54:57.931987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:57.932603 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine' was properly closed.
[0m12:54:57.933000 [info ] [MainThread]: 
[0m12:54:57.933570 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m12:54:57.934517 [debug] [MainThread]: Command end result
[0m12:54:57.952303 [info ] [MainThread]: 
[0m12:54:57.953215 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:54:57.954138 [info ] [MainThread]: 
[0m12:54:57.954708 [error] [MainThread]: [33mDatabase Error in model date_spine (models/marts/date_spine.sql)[0m
[0m12:54:57.955732 [error] [MainThread]:   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got "{" at [6:6]
[0m12:54:57.956349 [error] [MainThread]:   compiled Code at target/run/dbt_robert/models/marts/date_spine.sql
[0m12:54:57.957259 [info ] [MainThread]: 
[0m12:54:57.957865 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:54:57.959109 [debug] [MainThread]: Command `dbt run` failed at 12:54:57.958973 after 2.63 seconds
[0m12:54:57.959616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d370f2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d341d05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d341d04f0>]}
[0m12:54:57.960480 [debug] [MainThread]: Flushing usage events
[0m12:57:54.105913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f004155a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00402ca440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00402ca3b0>]}


============================== 12:57:54.108537 | c7ee5f42-db0f-4ef1-ad3f-4cffdb91b08a ==============================
[0m12:57:54.108537 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:57:54.109322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:57:54.494013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7ee5f42-db0f-4ef1-ad3f-4cffdb91b08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0041294dc0>]}
[0m12:57:54.511572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7ee5f42-db0f-4ef1-ad3f-4cffdb91b08a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003e7b1db0>]}
[0m12:57:54.512459 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:57:54.530594 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:57:54.569866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:54.570562 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m12:57:54.606387 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m12:57:54.612682 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got 'string'
    line 11
      "day",
[0m12:57:54.613692 [debug] [MainThread]: Command `dbt run` failed at 12:57:54.613524 after 0.52 seconds
[0m12:57:54.614152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f004155a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003e462980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f003e462800>]}
[0m12:57:54.614645 [debug] [MainThread]: Flushing usage events
[0m12:58:36.951242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205c29a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205afce4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205afce410>]}


============================== 12:58:36.953871 | 8e3cc609-7c4e-4af8-9d5f-11b0211560d4 ==============================
[0m12:58:36.953871 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:58:36.954657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:58:37.305313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e3cc609-7c4e-4af8-9d5f-11b0211560d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20594b3280>]}
[0m12:58:37.322557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e3cc609-7c4e-4af8-9d5f-11b0211560d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20594b7b20>]}
[0m12:58:37.323343 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:58:37.341150 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:58:37.380498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:58:37.381183 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m12:58:37.405829 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m12:58:37.410065 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token ',', got '('
    line 12
      to_date('01/01/2023', 'mm/dd/yyyy'),
[0m12:58:37.411134 [debug] [MainThread]: Command `dbt run` failed at 12:58:37.410992 after 0.47 seconds
[0m12:58:37.411631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205c29a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2059166e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2059166ce0>]}
[0m12:58:37.412146 [debug] [MainThread]: Flushing usage events
[0m12:59:51.405116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd362c62410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd361bf6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd361bf64a0>]}


============================== 12:59:51.407870 | 4363ca45-f583-4f10-8c79-26f4d1f30f4d ==============================
[0m12:59:51.407870 [info ] [MainThread]: Running with dbt=1.5.3
[0m12:59:51.408679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:59:51.759626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4363ca45-f583-4f10-8c79-26f4d1f30f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3600db190>]}
[0m12:59:51.779298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4363ca45-f583-4f10-8c79-26f4d1f30f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3600e3550>]}
[0m12:59:51.780120 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:59:51.798222 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m12:59:51.837860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:59:51.838609 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m12:59:51.862746 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m12:59:51.866741 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token ',', got '('
    line 12
      to_date('01/01/2023', '01/31/2023'),
[0m12:59:51.867748 [debug] [MainThread]: Command `dbt run` failed at 12:59:51.867549 after 0.47 seconds
[0m12:59:51.868203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd362c62410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35fd8eec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35fd8ed40>]}
[0m12:59:51.868710 [debug] [MainThread]: Flushing usage events
[0m13:00:17.014703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96588a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9645d2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9645d24a0>]}


============================== 13:00:17.017360 | af2be383-6b51-41a7-8d53-1fd90da5ea1c ==============================
[0m13:00:17.017360 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:00:17.018174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:00:17.409387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af2be383-6b51-41a7-8d53-1fd90da5ea1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb962ab3280>]}
[0m13:00:17.440704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af2be383-6b51-41a7-8d53-1fd90da5ea1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb962ab7b20>]}
[0m13:00:17.442022 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:00:17.463036 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:00:17.512087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:00:17.512871 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:00:17.537163 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:00:17.541367 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got 'string'
    line 12
      '01/01/2023', '01/31/2023',
[0m13:00:17.542421 [debug] [MainThread]: Command `dbt run` failed at 13:00:17.542274 after 0.54 seconds
[0m13:00:17.542884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb96588a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb962766e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb962766ce0>]}
[0m13:00:17.543393 [debug] [MainThread]: Flushing usage events
[0m13:00:44.060420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40b652440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40a40e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40a40e4d0>]}


============================== 13:00:44.063138 | 73f4ae02-2c5c-4bc7-a0dc-a24a711380e2 ==============================
[0m13:00:44.063138 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:00:44.064005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:00:44.433514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73f4ae02-2c5c-4bc7-a0dc-a24a711380e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40b58df60>]}
[0m13:00:44.450695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73f4ae02-2c5c-4bc7-a0dc-a24a711380e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff408af5c00>]}
[0m13:00:44.451567 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:00:44.469401 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:00:44.511610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:00:44.512370 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:00:44.536883 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:00:44.541196 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got 'integer'
    line 12
      01/01/2023, 01/31/2023,
[0m13:00:44.542190 [debug] [MainThread]: Command `dbt run` failed at 13:00:44.542008 after 0.49 seconds
[0m13:00:44.542655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40b652440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4087a6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4087a6a10>]}
[0m13:00:44.543158 [debug] [MainThread]: Flushing usage events
[0m13:02:13.139672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89a8c23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89960e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89960e470>]}


============================== 13:02:13.142278 | a278b851-5a5e-44f6-b2cd-d87ac80e674c ==============================
[0m13:02:13.142278 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:02:13.143095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:02:13.533744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a278b851-5a5e-44f6-b2cd-d87ac80e674c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89a6726b0>]}
[0m13:02:13.553415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a278b851-5a5e-44f6-b2cd-d87ac80e674c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff897cf5360>]}
[0m13:02:13.555490 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:02:13.577886 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:02:13.617635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:02:13.618338 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:02:13.642950 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:02:13.646919 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got 'integer'
    line 11
      day,01/01/2023,01/31/2023
[0m13:02:13.648240 [debug] [MainThread]: Command `dbt run` failed at 13:02:13.648052 after 0.52 seconds
[0m13:02:13.648708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff89a8c23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8979aaa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8979aa8c0>]}
[0m13:02:13.649174 [debug] [MainThread]: Flushing usage events
[0m13:02:36.096692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafe8e6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafd5d2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafd5d2500>]}


============================== 13:02:36.099493 | 9caf514c-a9d6-4ad0-afb8-d317a7cc5510 ==============================
[0m13:02:36.099493 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:02:36.100309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:02:36.479895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9caf514c-a9d6-4ad0-afb8-d317a7cc5510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafe3df0d0>]}
[0m13:02:36.497401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9caf514c-a9d6-4ad0-afb8-d317a7cc5510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafbab5690>]}
[0m13:02:36.498347 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:02:36.516280 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:02:36.555580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:02:36.556290 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:02:36.580851 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:02:36.584867 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got 'integer'
    line 11
      day, 01/01/2023, 01/31/2023
[0m13:02:36.586004 [debug] [MainThread]: Command `dbt run` failed at 13:02:36.585868 after 0.50 seconds
[0m13:02:36.586447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafe8e6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafb766c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbafb766b00>]}
[0m13:02:36.586931 [debug] [MainThread]: Flushing usage events
[0m13:04:02.622391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08295a2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08284c64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08284c6410>]}


============================== 13:04:02.624998 | d9c95aed-378c-490c-800d-be56aa0023e4 ==============================
[0m13:04:02.624998 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:04:02.625774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:04:02.972517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9c95aed-378c-490c-800d-be56aa0023e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08294d6650>]}
[0m13:04:02.989536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9c95aed-378c-490c-800d-be56aa0023e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08269b15d0>]}
[0m13:04:02.990331 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:04:03.009264 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:04:03.048388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:04:03.049123 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:04:03.075668 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:04:03.080263 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got 'integer'
    line 11
      day, 1, current_date
[0m13:04:03.081400 [debug] [MainThread]: Command `dbt run` failed at 13:04:03.081251 after 0.47 seconds
[0m13:04:03.082020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08295a2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0826662cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0826662b30>]}
[0m13:04:03.082898 [debug] [MainThread]: Flushing usage events
[0m13:04:43.749871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a7754a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a764ca500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a764ca470>]}


============================== 13:04:43.752692 | e9584219-2042-4c19-bd48-216667d1ecbb ==============================
[0m13:04:43.752692 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:04:43.753582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:04:44.138333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9584219-2042-4c19-bd48-216667d1ecbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a772ec9a0>]}
[0m13:04:44.155617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9584219-2042-4c19-bd48-216667d1ecbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a749b23b0>]}
[0m13:04:44.156506 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:04:44.174893 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:04:44.215491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:04:44.216236 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:04:44.240431 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:04:44.244475 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token ',', got '-'
    line 12
      --dbt.dateadd(week, 1, current_date)
[0m13:04:44.245449 [debug] [MainThread]: Command `dbt run` failed at 13:04:44.245272 after 0.50 seconds
[0m13:04:44.245901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a7754a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a74662770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a746625f0>]}
[0m13:04:44.246393 [debug] [MainThread]: Flushing usage events
[0m13:06:16.694664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a038ba350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0260a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a0260a3e0>]}


============================== 13:06:16.697425 | 1210a7e7-cd53-46b0-a1a1-5c8b947fc32c ==============================
[0m13:06:16.697425 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:06:16.698316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:06:17.100849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1210a7e7-cd53-46b0-a1a1-5c8b947fc32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a00cf3160>]}
[0m13:06:17.118138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1210a7e7-cd53-46b0-a1a1-5c8b947fc32c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a00cf59f0>]}
[0m13:06:17.119152 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:06:17.137530 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:06:17.187616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:06:17.188473 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:06:17.219127 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:06:17.226672 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got 'integer'
    line 10
      {% macro date_spine(day, 01/01/2023, 01/30/2023
[0m13:06:17.228908 [debug] [MainThread]: Command `dbt run` failed at 13:06:17.228706 after 0.54 seconds
[0m13:06:17.229664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a038ba350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a009a6da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a009a6c20>]}
[0m13:06:17.230408 [debug] [MainThread]: Flushing usage events
[0m13:09:29.789591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124ee263b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124ddc64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124ddc6440>]}


============================== 13:09:29.792357 | 1c2e0b50-76f1-43a3-90ce-febf269cfe98 ==============================
[0m13:09:29.792357 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:09:29.793315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:09:30.162215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c2e0b50-76f1-43a3-90ce-febf269cfe98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124ebf7520>]}
[0m13:09:30.179471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c2e0b50-76f1-43a3-90ce-febf269cfe98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124c29d6c0>]}
[0m13:09:30.180441 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:09:30.198242 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:09:30.238220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:09:30.239042 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:09:30.263987 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:09:30.268551 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token ',', got '('
    line 11
      date_spine(day, to_date(01/01/2023, 01/30/2023),
[0m13:09:30.269605 [debug] [MainThread]: Command `dbt run` failed at 13:09:30.269457 after 0.49 seconds
[0m13:09:30.270064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124ee263b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124bf4ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f124bf4ea70>]}
[0m13:09:30.270552 [debug] [MainThread]: Flushing usage events
[0m13:10:13.272116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad4c5e320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad39ce440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad39ce3b0>]}


============================== 13:10:13.274899 | 4183fecf-764f-4413-9d4e-f76ca2fdb9a4 ==============================
[0m13:10:13.274899 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:10:13.275743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:10:13.633650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4183fecf-764f-4413-9d4e-f76ca2fdb9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad4998dc0>]}
[0m13:10:13.650838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4183fecf-764f-4413-9d4e-f76ca2fdb9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad1eb5330>]}
[0m13:10:13.651784 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:10:13.670172 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:10:13.713351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:10:13.714229 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:10:13.739928 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:10:13.744354 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token ',', got '('
    line 11
      date_spine(day, to_date('01/01/2023', '01/30/2023'),
[0m13:10:13.745468 [debug] [MainThread]: Command `dbt run` failed at 13:10:13.745315 after 0.48 seconds
[0m13:10:13.745935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad4c5e320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad1b66b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad1b669b0>]}
[0m13:10:13.746473 [debug] [MainThread]: Flushing usage events
[0m13:11:44.429614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbd62e23b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbd500a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbd500a440>]}


============================== 13:11:44.432257 | 6bd5c3a4-9708-482e-ae15-e93ff68b080f ==============================
[0m13:11:44.432257 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:11:44.433200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:11:44.784676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bd5c3a4-9708-482e-ae15-e93ff68b080f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbd60bb520>]}
[0m13:11:44.802281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bd5c3a4-9708-482e-ae15-e93ff68b080f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbd36f55d0>]}
[0m13:11:44.803147 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:11:44.821381 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:11:44.861281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:11:44.862047 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:11:44.886202 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:11:44.890930 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token ',', got '('
    line 11
      date_spine(day, start_date('01/01/2023', '01/30/2023'),
[0m13:11:44.892021 [debug] [MainThread]: Command `dbt run` failed at 13:11:44.891847 after 0.47 seconds
[0m13:11:44.892505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbd62e23b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbd33a6ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbd33a6b60>]}
[0m13:11:44.893003 [debug] [MainThread]: Flushing usage events
[0m13:12:41.069417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3ee963b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3ddc64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3ddc6440>]}


============================== 13:12:41.073613 | 1ca1babc-fbc4-4653-8ec9-9e398f188790 ==============================
[0m13:12:41.073613 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:12:41.075138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:12:41.434070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ca1babc-fbc4-4653-8ec9-9e398f188790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3ec66bf0>]}
[0m13:12:41.451375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ca1babc-fbc4-4653-8ec9-9e398f188790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3c2b1b10>]}
[0m13:12:41.452258 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:12:41.475359 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:12:41.515627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:12:41.516472 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:12:41.541224 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:12:41.545591 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token ',', got '('
    line 11
      date_spine (day, start_date('01/01/2023', '01/30/2023')),
[0m13:12:41.546560 [debug] [MainThread]: Command `dbt run` failed at 13:12:41.546381 after 0.49 seconds
[0m13:12:41.547016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3ee963b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3bf668c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac3bf66740>]}
[0m13:12:41.547534 [debug] [MainThread]: Flushing usage events
[0m13:13:18.784928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c2aae3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c17d2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c17d2470>]}


============================== 13:13:18.787730 | d734c3d2-6dde-4ca1-8a03-76b013f967af ==============================
[0m13:13:18.787730 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:13:18.788704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:13:19.156487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd734c3d2-6dde-4ca1-8a03-76b013f967af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c28589a0>]}
[0m13:13:19.173709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd734c3d2-6dde-4ca1-8a03-76b013f967af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bfcb77f0>]}
[0m13:13:19.174587 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:13:19.192488 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:13:19.232748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:19.233513 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:13:19.258223 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:13:19.262698 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got 'string'
    line 11
      date_spine (day, start_date,'01/01/2023', '01/30/2023'),
[0m13:13:19.263751 [debug] [MainThread]: Command `dbt run` failed at 13:13:19.263561 after 0.49 seconds
[0m13:13:19.264231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c2aae3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bf9662f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9bf966170>]}
[0m13:13:19.264738 [debug] [MainThread]: Flushing usage events
[0m13:13:40.141174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa85df63e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa84b12500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa84b12470>]}


============================== 13:13:40.143835 | b694f212-98b3-4ae8-9995-d726f48438e4 ==============================
[0m13:13:40.143835 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:13:40.144653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:13:40.516617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b694f212-98b3-4ae8-9995-d726f48438e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa831f7220>]}
[0m13:13:40.534191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b694f212-98b3-4ae8-9995-d726f48438e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa831f9a20>]}
[0m13:13:40.535148 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:13:40.553741 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:13:40.593627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:40.594550 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:13:40.620513 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:13:40.625145 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got 'integer'
    line 11
      date_spine (day, start_date,01/01/2023, 01/30/2023),
[0m13:13:40.626180 [debug] [MainThread]: Command `dbt run` failed at 13:13:40.626008 after 0.49 seconds
[0m13:13:40.626651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa85df63e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa82eaad70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa82eaabf0>]}
[0m13:13:40.627160 [debug] [MainThread]: Flushing usage events
[0m13:14:42.472290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff048a52440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff04780e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff04780e4d0>]}


============================== 13:14:42.474846 | 5bf51b32-78fe-4872-a4b7-cb3f068e2f2e ==============================
[0m13:14:42.474846 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:14:42.475662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:14:42.826526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bf51b32-78fe-4872-a4b7-cb3f068e2f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff048979f60>]}
[0m13:14:42.843782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bf51b32-78fe-4872-a4b7-cb3f068e2f2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045ef5660>]}
[0m13:14:42.844719 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:14:42.863169 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:14:42.902966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:14:42.903808 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:14:42.928386 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:14:42.932598 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token ',', got '('
    line 11
      date_spine (day, start_date(), current_date()),
[0m13:14:42.933590 [debug] [MainThread]: Command `dbt run` failed at 13:14:42.933415 after 0.47 seconds
[0m13:14:42.934050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff048a52440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045ba6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045ba6ad0>]}
[0m13:14:42.934536 [debug] [MainThread]: Flushing usage events
[0m13:15:15.186728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cb49e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ca1d2560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04ca1d24d0>]}


============================== 13:15:15.189482 | 8b836299-9b65-4bf4-9027-6456a8c7a52e ==============================
[0m13:15:15.189482 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:15:15.190288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:15:15.542586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b836299-9b65-4bf4-9027-6456a8c7a52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c86b31f0>]}
[0m13:15:15.560073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b836299-9b65-4bf4-9027-6456a8c7a52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c86b7b80>]}
[0m13:15:15.560921 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:15:15.579684 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:15:15.619560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:15.620351 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:15:15.649110 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:15:15.653506 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'end of statement block', got ','
    line 11
      date_spine (day, start_date, current_date),
[0m13:15:15.654606 [debug] [MainThread]: Command `dbt run` failed at 13:15:15.654467 after 0.48 seconds
[0m13:15:15.655065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cb49e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c8366e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c8366ce0>]}
[0m13:15:15.655602 [debug] [MainThread]: Flushing usage events
[0m13:17:10.165093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe45ae3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe3312500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe3312470>]}


============================== 13:17:10.169859 | afcb5fc5-1dbd-4d02-a53f-7fbe6bda8d65 ==============================
[0m13:17:10.169859 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:17:10.171145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:17:10.576945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afcb5fc5-1dbd-4d02-a53f-7fbe6bda8d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe43589a0>]}
[0m13:17:10.594432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afcb5fc5-1dbd-4d02-a53f-7fbe6bda8d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe19fb640>]}
[0m13:17:10.595348 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:17:10.613614 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:17:10.652929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:17:10.653717 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:17:10.678306 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:17:10.682775 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'end of statement block', got ','
    line 14
      date_spine (datepart= 'day', start_date='01/01/2023', end_date='01/30/2023'),
[0m13:17:10.683893 [debug] [MainThread]: Command `dbt run` failed at 13:17:10.683733 after 0.54 seconds
[0m13:17:10.684354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe45ae3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe16ae4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe16ae320>]}
[0m13:17:10.684865 [debug] [MainThread]: Flushing usage events
[0m13:17:31.992929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe284ace440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2837d2560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2837d24d0>]}


============================== 13:17:31.995591 | e27412f8-cc1f-412d-9637-0649b1f20992 ==============================
[0m13:17:31.995591 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:17:31.997027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:17:32.399651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e27412f8-cc1f-412d-9637-0649b1f20992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe281cb31c0>]}
[0m13:17:32.435043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e27412f8-cc1f-412d-9637-0649b1f20992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe281cb59f0>]}
[0m13:17:32.436432 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:17:32.454644 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:17:32.494578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:17:32.495391 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:17:32.520258 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:17:32.524700 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'end of statement block', got '-'
    line 15
      --  dbt.dateadd(week, 1, current_date)
[0m13:17:32.525815 [debug] [MainThread]: Command `dbt run` failed at 13:17:32.525634 after 0.54 seconds
[0m13:17:32.526480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe284ace440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe281966da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe281966c20>]}
[0m13:17:32.526989 [debug] [MainThread]: Flushing usage events
[0m13:18:44.321232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf7d0e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf6bf24a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf6bf2410>]}


============================== 13:18:44.323833 | 7b496827-668d-49fd-8ff9-8e94b89b17fb ==============================
[0m13:18:44.323833 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:18:44.324623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:18:44.674194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b496827-668d-49fd-8ff9-8e94b89b17fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf50db220>]}
[0m13:18:44.691504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b496827-668d-49fd-8ff9-8e94b89b17fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf50ddd20>]}
[0m13:18:44.692322 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:18:44.710262 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:18:44.750813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:44.751561 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:18:44.776609 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:18:44.781221 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got ')'
    line 14
      date_spine (datepart= 'day', start_date='01/01/2023', end_date='01/30/2023',)
[0m13:18:44.782215 [debug] [MainThread]: Command `dbt run` failed at 13:18:44.782049 after 0.47 seconds
[0m13:18:44.782669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf7d0e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf4d8ee30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf4d8ecb0>]}
[0m13:18:44.783153 [debug] [MainThread]: Flushing usage events
[0m13:19:10.268482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f45dc2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f44b12530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f44b124a0>]}


============================== 13:19:10.272815 | bfff614f-d399-4ae1-8648-d7cade0b0abd ==============================
[0m13:19:10.272815 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:19:10.274818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:19:10.638173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfff614f-d399-4ae1-8648-d7cade0b0abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f45d29ba0>]}
[0m13:19:10.655349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfff614f-d399-4ae1-8648-d7cade0b0abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f431f9420>]}
[0m13:19:10.656195 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:19:10.674316 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:19:10.714591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:10.715362 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:19:10.739815 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:19:10.779994 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/date_spine.sql
[0m13:19:10.793738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfff614f-d399-4ae1-8648-d7cade0b0abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f42f35180>]}
[0m13:19:10.806439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfff614f-d399-4ae1-8648-d7cade0b0abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f42ec70d0>]}
[0m13:19:10.807076 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m13:19:10.807689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfff614f-d399-4ae1-8648-d7cade0b0abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f42ec7040>]}
[0m13:19:10.809441 [info ] [MainThread]: 
[0m13:19:10.810583 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:19:10.812000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:19:10.812509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:11.904130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m13:19:11.904936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:12.193645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfff614f-d399-4ae1-8648-d7cade0b0abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f42e58130>]}
[0m13:19:12.194773 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:19:12.195468 [info ] [MainThread]: 
[0m13:19:12.199875 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine
[0m13:19:12.200527 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.date_spine ............................. [RUN]
[0m13:19:12.201423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine)
[0m13:19:12.201850 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine
[0m13:19:12.212643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:12.213139 [debug] [Thread-1 (]: On model.dbt_robert.date_spine: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine"} */


        select 

    datetime_diff(
        cast(2022-01-01 as datetime),
        cast(2022-01-01 as datetime),
        second
    )

  
[0m13:19:12.679262 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to DATETIME at [7:14]')
[0m13:19:13.688303 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2d063f24-e4ba-4ee6-86c0-ef6e8b1cc867&page=queryresults
[0m13:19:13.691639 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (compile): 13:19:12.202116 => 13:19:13.690536
[0m13:19:13.698444 [debug] [Thread-1 (]: Database Error in model date_spine (models/marts/date_spine.sql)
  Invalid cast from INT64 to DATETIME at [7:14]
[0m13:19:13.699147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfff614f-d399-4ae1-8648-d7cade0b0abd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f43046830>]}
[0m13:19:13.699948 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.date_spine .................... [[31mERROR[0m in 1.50s]
[0m13:19:13.700807 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine
[0m13:19:13.703551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:13.703952 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine' was properly closed.
[0m13:19:13.704698 [info ] [MainThread]: 
[0m13:19:13.705594 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m13:19:13.706785 [debug] [MainThread]: Command end result
[0m13:19:13.788544 [info ] [MainThread]: 
[0m13:19:13.789624 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:19:13.790856 [info ] [MainThread]: 
[0m13:19:13.792037 [error] [MainThread]: [33mDatabase Error in model date_spine (models/marts/date_spine.sql)[0m
[0m13:19:13.792741 [error] [MainThread]:   Invalid cast from INT64 to DATETIME at [7:14]
[0m13:19:13.793878 [info ] [MainThread]: 
[0m13:19:13.794635 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:19:13.795880 [debug] [MainThread]: Command `dbt run` failed at 13:19:13.795687 after 3.54 seconds
[0m13:19:13.796487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f45dc2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f435b3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f435b3970>]}
[0m13:19:13.797101 [debug] [MainThread]: Flushing usage events
[0m13:20:37.601632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768eb6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd767dee470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd767dee3e0>]}


============================== 13:20:37.604271 | 7fe4e05f-3788-496a-ae3a-24ae2665bbfe ==============================
[0m13:20:37.604271 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:20:37.605236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:20:37.969501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fe4e05f-3788-496a-ae3a-24ae2665bbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768d98d90>]}
[0m13:20:37.987183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fe4e05f-3788-496a-ae3a-24ae2665bbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7662dd3f0>]}
[0m13:20:37.988122 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:20:38.006880 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:20:38.046427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:38.047233 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:20:38.071916 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:20:38.076392 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got ')'
    line 14
      date_spine (datepart= 'day', start_date='01/01/2023', end_date='01/30/2023',)
[0m13:20:38.077361 [debug] [MainThread]: Command `dbt run` failed at 13:20:38.077186 after 0.48 seconds
[0m13:20:38.077807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd768eb6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd765f92a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd765f92890>]}
[0m13:20:38.078276 [debug] [MainThread]: Flushing usage events
[0m13:20:47.465253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff54c86e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff54b60e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff54b60e470>]}


============================== 13:20:47.467872 | eb946594-bc8a-4489-8c46-b48bd4d157a6 ==============================
[0m13:20:47.467872 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:20:47.468644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:20:47.813545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb946594-bc8a-4489-8c46-b48bd4d157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff549cf0520>]}
[0m13:20:47.830862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb946594-bc8a-4489-8c46-b48bd4d157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff549cfb3d0>]}
[0m13:20:47.831788 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:20:47.849563 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:20:47.888891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:47.889407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:47.896785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb946594-bc8a-4489-8c46-b48bd4d157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5499900d0>]}
[0m13:20:47.910375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb946594-bc8a-4489-8c46-b48bd4d157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff549954460>]}
[0m13:20:47.910991 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m13:20:47.911598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb946594-bc8a-4489-8c46-b48bd4d157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff549954490>]}
[0m13:20:47.913377 [info ] [MainThread]: 
[0m13:20:47.914470 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:20:47.915874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:20:47.916424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:48.978139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m13:20:48.978813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:49.246479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb946594-bc8a-4489-8c46-b48bd4d157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff549954520>]}
[0m13:20:49.247506 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:20:49.248296 [info ] [MainThread]: 
[0m13:20:49.252710 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine
[0m13:20:49.253334 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.date_spine ............................. [RUN]
[0m13:20:49.254292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine)
[0m13:20:49.254746 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine
[0m13:20:49.280404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:49.281054 [debug] [Thread-1 (]: On model.dbt_robert.date_spine: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine"} */


        select 

    datetime_diff(
        cast(2022-01-01 as datetime),
        cast(2022-01-01 as datetime),
        second
    )

  
[0m13:20:49.709566 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to DATETIME at [7:14]')
[0m13:20:50.482717 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:134f1f62-ba75-4921-907e-d1534c9db131&page=queryresults
[0m13:20:50.485501 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (compile): 13:20:49.255042 => 13:20:50.484994
[0m13:20:50.489238 [debug] [Thread-1 (]: Database Error in model date_spine (models/marts/date_spine.sql)
  Invalid cast from INT64 to DATETIME at [7:14]
[0m13:20:50.489799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb946594-bc8a-4489-8c46-b48bd4d157a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff549d21120>]}
[0m13:20:50.490544 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.date_spine .................... [[31mERROR[0m in 1.24s]
[0m13:20:50.491298 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine
[0m13:20:50.493141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:50.493494 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine' was properly closed.
[0m13:20:50.493887 [info ] [MainThread]: 
[0m13:20:50.494423 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m13:20:50.495156 [debug] [MainThread]: Command end result
[0m13:20:50.512605 [info ] [MainThread]: 
[0m13:20:50.513416 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:20:50.514048 [info ] [MainThread]: 
[0m13:20:50.514697 [error] [MainThread]: [33mDatabase Error in model date_spine (models/marts/date_spine.sql)[0m
[0m13:20:50.515723 [error] [MainThread]:   Invalid cast from INT64 to DATETIME at [7:14]
[0m13:20:50.516301 [info ] [MainThread]: 
[0m13:20:50.517023 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:20:50.517987 [debug] [MainThread]: Command `dbt run` failed at 13:20:50.517856 after 3.06 seconds
[0m13:20:50.518426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff54c86e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff549973fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff549973f70>]}
[0m13:20:50.518962 [debug] [MainThread]: Flushing usage events
[0m13:22:21.795986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42f7de380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42ea6e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42ea6e410>]}


============================== 13:22:21.798844 | 8d5e0f85-6cf7-4893-8484-b86d99590873 ==============================
[0m13:22:21.798844 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:22:21.799711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:22:22.146757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d5e0f85-6cf7-4893-8484-b86d99590873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42f716650>]}
[0m13:22:22.164006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d5e0f85-6cf7-4893-8484-b86d99590873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42cbe1390>]}
[0m13:22:22.164789 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:22:22.182367 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:22:22.224145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:22:22.224969 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:22:22.249689 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:22:22.290388 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/date_spine.sql
[0m13:22:22.304466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d5e0f85-6cf7-4893-8484-b86d99590873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42c934f10>]}
[0m13:22:22.316516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d5e0f85-6cf7-4893-8484-b86d99590873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42c8ac310>]}
[0m13:22:22.317134 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m13:22:22.317724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d5e0f85-6cf7-4893-8484-b86d99590873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42c8ac2e0>]}
[0m13:22:22.319494 [info ] [MainThread]: 
[0m13:22:22.320623 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:22:22.322058 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:22:22.322567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:23.428736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m13:22:23.429408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:23.692402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d5e0f85-6cf7-4893-8484-b86d99590873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42ca3c070>]}
[0m13:22:23.693745 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:22:23.694669 [info ] [MainThread]: 
[0m13:22:23.699922 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine
[0m13:22:23.700859 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.date_spine ............................. [RUN]
[0m13:22:23.701869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine)
[0m13:22:23.702353 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine
[0m13:22:23.713811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:23.714331 [debug] [Thread-1 (]: On model.dbt_robert.date_spine: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine"} */


        select 

    datetime_diff(
        cast(2022-01-01 as datetime),
        cast(2022-01-01 as datetime),
        second
    )

  
[0m13:22:24.140999 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to DATETIME at [7:14]')
[0m13:22:24.870374 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9f71ab5f-82cb-4c55-a0d7-84f08e08436a&page=queryresults
[0m13:22:24.872828 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (compile): 13:22:23.702659 => 13:22:24.872389
[0m13:22:24.877227 [debug] [Thread-1 (]: Database Error in model date_spine (models/marts/date_spine.sql)
  Invalid cast from INT64 to DATETIME at [7:14]
[0m13:22:24.877899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d5e0f85-6cf7-4893-8484-b86d99590873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42ca2eaa0>]}
[0m13:22:24.878652 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.date_spine .................... [[31mERROR[0m in 1.18s]
[0m13:22:24.879470 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine
[0m13:22:24.881523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:24.881926 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine' was properly closed.
[0m13:22:24.882337 [info ] [MainThread]: 
[0m13:22:24.882919 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m13:22:24.884417 [debug] [MainThread]: Command end result
[0m13:22:24.966337 [info ] [MainThread]: 
[0m13:22:24.967514 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:22:24.968394 [info ] [MainThread]: 
[0m13:22:24.969300 [error] [MainThread]: [33mDatabase Error in model date_spine (models/marts/date_spine.sql)[0m
[0m13:22:24.970922 [error] [MainThread]:   Invalid cast from INT64 to DATETIME at [7:14]
[0m13:22:24.972569 [info ] [MainThread]: 
[0m13:22:24.973697 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:22:24.988606 [debug] [MainThread]: Command `dbt run` failed at 13:22:24.988375 after 3.20 seconds
[0m13:22:24.989253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42f7de380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42d10bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa42cb5bb80>]}
[0m13:22:24.989957 [debug] [MainThread]: Flushing usage events
[0m13:23:25.979348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894260e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89418a2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89418a2470>]}


============================== 13:23:25.985449 | 45c8dbdb-b8f6-4135-9297-9e1d0238bba2 ==============================
[0m13:23:25.985449 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:23:25.988128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:23:26.341287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45c8dbdb-b8f6-4135-9297-9e1d0238bba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89423b89a0>]}
[0m13:23:26.358456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45c8dbdb-b8f6-4135-9297-9e1d0238bba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893f9e24d0>]}
[0m13:23:26.359288 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:23:26.380080 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:23:26.420264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:23:26.420724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:23:26.427573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45c8dbdb-b8f6-4135-9297-9e1d0238bba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893f672830>]}
[0m13:23:26.439823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45c8dbdb-b8f6-4135-9297-9e1d0238bba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893f76fb20>]}
[0m13:23:26.440399 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m13:23:26.441098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45c8dbdb-b8f6-4135-9297-9e1d0238bba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893f76fac0>]}
[0m13:23:26.442884 [info ] [MainThread]: 
[0m13:23:26.443919 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:26.445626 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m13:23:26.446089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:27.499341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45c8dbdb-b8f6-4135-9297-9e1d0238bba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893f76d810>]}
[0m13:23:27.500359 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:23:27.501022 [info ] [MainThread]: 
[0m13:23:27.505215 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine
[0m13:23:27.505963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine)
[0m13:23:27.506425 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine
[0m13:23:27.529746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:27.530254 [debug] [Thread-1 (]: On model.dbt_robert.date_spine: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine"} */


        select 

    datetime_diff(
        cast(2022-01-01 as datetime),
        cast(2022-01-01 as datetime),
        second
    )

  
[0m13:23:27.972454 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to DATETIME at [7:14]')
[0m13:23:28.704252 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ead59141-e415-4672-a401-163d65ae1da4&page=queryresults
[0m13:23:28.706699 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (compile): 13:23:27.506753 => 13:23:28.706221
[0m13:23:28.710567 [debug] [Thread-1 (]: Database Error in model date_spine (models/marts/date_spine.sql)
  Invalid cast from INT64 to DATETIME at [7:14]
[0m13:23:28.711192 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine
[0m13:23:28.711963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:28.712559 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine' was properly closed.
[0m13:23:28.713063 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model date_spine (models/marts/date_spine.sql)
    Invalid cast from INT64 to DATETIME at [7:14]
[0m13:23:28.713948 [debug] [MainThread]: Command `dbt compile` failed at 13:23:28.713813 after 2.74 seconds
[0m13:23:28.714378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f894260e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893f76ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893f76ed40>]}
[0m13:23:28.714858 [debug] [MainThread]: Flushing usage events
[0m13:24:41.802271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f6f4e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f5eca530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f5eca4a0>]}


============================== 13:24:41.804901 | 9e5ea47c-9afe-4540-8360-b74d90e9137d ==============================
[0m13:24:41.804901 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:24:41.805693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:24:42.179302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e5ea47c-9afe-4540-8360-b74d90e9137d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f6eaab00>]}
[0m13:24:42.196872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e5ea47c-9afe-4540-8360-b74d90e9137d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f43b1de0>]}
[0m13:24:42.197658 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:24:42.215735 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:24:42.255250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:24:42.256001 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m13:24:42.282474 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m13:24:42.323789 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/date_spine.sql
[0m13:24:42.337780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e5ea47c-9afe-4540-8360-b74d90e9137d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f4118c40>]}
[0m13:24:42.349808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e5ea47c-9afe-4540-8360-b74d90e9137d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f40740a0>]}
[0m13:24:42.350393 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m13:24:42.350950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e5ea47c-9afe-4540-8360-b74d90e9137d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f4074070>]}
[0m13:24:42.352771 [info ] [MainThread]: 
[0m13:24:42.353869 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:24:42.355613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_robert'
[0m13:24:42.356087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:43.382864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e5ea47c-9afe-4540-8360-b74d90e9137d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f405af80>]}
[0m13:24:43.384068 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:24:43.384801 [info ] [MainThread]: 
[0m13:24:43.388907 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine
[0m13:24:43.389653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine)
[0m13:24:43.390104 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine
[0m13:24:43.400850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:43.401329 [debug] [Thread-1 (]: On model.dbt_robert.date_spine: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine"} */


        select 

    datetime_diff(
        cast(2022-01-01 as datetime),
        cast(2022-01-01 as datetime),
        second
    )

  
[0m13:24:43.791527 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to DATETIME at [7:14]')
[0m13:24:44.787790 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5846670b-e78a-46bb-b130-3e79989ec48c&page=queryresults
[0m13:24:44.790990 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (compile): 13:24:43.390416 => 13:24:44.789934
[0m13:24:44.795160 [debug] [Thread-1 (]: Database Error in model date_spine (models/marts/date_spine.sql)
  Invalid cast from INT64 to DATETIME at [7:14]
[0m13:24:44.795828 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine
[0m13:24:44.796534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:44.797138 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine' was properly closed.
[0m13:24:44.797691 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model date_spine (models/marts/date_spine.sql)
    Invalid cast from INT64 to DATETIME at [7:14]
[0m13:24:44.798769 [debug] [MainThread]: Command `dbt compile` failed at 13:24:44.798591 after 3.00 seconds
[0m13:24:44.799315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f6f4e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f4077fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34f405ab30>]}
[0m13:24:44.799956 [debug] [MainThread]: Flushing usage events
[0m14:27:25.680865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e454a440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e32ce560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e32ce4d0>]}


============================== 14:27:25.703781 | 4ee3772e-e25f-40c3-bbd7-f41f8da508a2 ==============================
[0m14:27:25.703781 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:27:25.704785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:27:27.584232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ee3772e-e25f-40c3-bbd7-f41f8da508a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e4285f60>]}
[0m14:27:27.602109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ee3772e-e25f-40c3-bbd7-f41f8da508a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e17b16f0>]}
[0m14:27:27.603258 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:27:27.627403 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:27:27.943867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:27.944899 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m14:27:27.971400 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m14:27:28.015677 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/date_spine.sql
[0m14:27:28.031422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ee3772e-e25f-40c3-bbd7-f41f8da508a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e151d000>]}
[0m14:27:28.044899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ee3772e-e25f-40c3-bbd7-f41f8da508a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e147eb30>]}
[0m14:27:28.045617 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m14:27:28.046492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ee3772e-e25f-40c3-bbd7-f41f8da508a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e147ea40>]}
[0m14:27:28.048479 [info ] [MainThread]: 
[0m14:27:28.049910 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:27:28.051532 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:27:28.052058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:34.002358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m14:27:34.003084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:34.353807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ee3772e-e25f-40c3-bbd7-f41f8da508a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e160c0a0>]}
[0m14:27:34.354821 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:27:34.355429 [info ] [MainThread]: 
[0m14:27:34.384455 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine
[0m14:27:34.385229 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.date_spine ............................. [RUN]
[0m14:27:34.386380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine)
[0m14:27:34.386857 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine
[0m14:27:34.399027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:34.399571 [debug] [Thread-1 (]: On model.dbt_robert.date_spine: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine"} */


        select 

    datetime_diff(
        cast(2022-01-01 as datetime),
        cast(2022-01-01 as datetime),
        second
    )

  
[0m14:27:34.812180 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to DATETIME at [7:14]')
[0m14:27:35.942117 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:858d5702-3687-4d2a-8f9f-6749d7dcbfc1&page=queryresults
[0m14:27:35.944954 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine (compile): 14:27:34.387156 => 14:27:35.944373
[0m14:27:35.986874 [debug] [Thread-1 (]: Database Error in model date_spine (models/marts/date_spine.sql)
  Invalid cast from INT64 to DATETIME at [7:14]
[0m14:27:35.987655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ee3772e-e25f-40c3-bbd7-f41f8da508a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e15fe7d0>]}
[0m14:27:35.988523 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.date_spine .................... [[31mERROR[0m in 1.60s]
[0m14:27:35.989420 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine
[0m14:27:35.991695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:35.992072 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine' was properly closed.
[0m14:27:35.992486 [info ] [MainThread]: 
[0m14:27:35.993811 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.94 seconds (7.94s).
[0m14:27:35.997120 [debug] [MainThread]: Command end result
[0m14:27:36.075036 [info ] [MainThread]: 
[0m14:27:36.076384 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:27:36.077050 [info ] [MainThread]: 
[0m14:27:36.077750 [error] [MainThread]: [33mDatabase Error in model date_spine (models/marts/date_spine.sql)[0m
[0m14:27:36.078384 [error] [MainThread]:   Invalid cast from INT64 to DATETIME at [7:14]
[0m14:27:36.079109 [info ] [MainThread]: 
[0m14:27:36.079835 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:27:36.081106 [debug] [MainThread]: Command `dbt run` failed at 14:27:36.080878 after 10.44 seconds
[0m14:27:36.081825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e454a440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e18dc370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e1b649d0>]}
[0m14:27:36.082293 [debug] [MainThread]: Flushing usage events
[0m14:29:23.317196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0390ea3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd037ece500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd037ece470>]}


============================== 14:29:23.319979 | 5f3c1329-6d6f-4c39-9240-ef889b4b1c0f ==============================
[0m14:29:23.319979 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:29:23.320833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:29:23.692885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f3c1329-6d6f-4c39-9240-ef889b4b1c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd038e966b0>]}
[0m14:29:23.712352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f3c1329-6d6f-4c39-9240-ef889b4b1c0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03639d5d0>]}
[0m14:29:23.713382 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:29:23.733259 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:29:23.777408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:29:23.778288 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine.sql
[0m14:29:23.804100 [debug] [MainThread]: 1603: static parser failed on marts/date_spine.sql
[0m14:29:23.809015 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine (models/marts/date_spine.sql)
  expected token 'name', got 'string'
    line 14
      date_spine ("datepart= "day", start_date='01-01-2023', end_date='01-30-2023'")
[0m14:29:23.810271 [debug] [MainThread]: Command `dbt run` failed at 14:29:23.810120 after 0.50 seconds
[0m14:29:23.810747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0390ea3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03604ecb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd03604eb30>]}
[0m14:29:23.811250 [debug] [MainThread]: Flushing usage events
[0m14:30:06.756088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209f9ce470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209e8ca590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209e8ca500>]}


============================== 14:30:06.758992 | bc00238f-2fe2-424e-be17-1270326077c5 ==============================
[0m14:30:06.758992 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:30:06.759821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:30:07.127146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc00238f-2fe2-424e-be17-1270326077c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209cdaf220>]}
[0m14:30:07.145622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc00238f-2fe2-424e-be17-1270326077c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209cdb1b40>]}
[0m14:30:07.146665 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:30:07.167605 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:30:07.209465 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:30:07.210304 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/date_spine_model.sql
[0m14:30:07.210752 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/marts/date_spine.sql
[0m14:30:07.236968 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:30:07.241968 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token 'name', got 'string'
    line 14
      date_spine ("datepart= "day", start_date='01-01-2023', end_date='01-30-2023'")
[0m14:30:07.243056 [debug] [MainThread]: Command `dbt run` failed at 14:30:07.242857 after 0.50 seconds
[0m14:30:07.243611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209f9ce470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209ca62d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209ca62b90>]}
[0m14:30:07.244078 [debug] [MainThread]: Flushing usage events
[0m14:30:28.591244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266d2fa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266c1f6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266c1f64a0>]}


============================== 14:30:28.594173 | 3f74e505-0d9f-48d7-ac2c-b140e6dba97e ==============================
[0m14:30:28.594173 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:30:28.594989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:30:29.006831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f74e505-0d9f-48d7-ac2c-b140e6dba97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266d259ba0>]}
[0m14:30:29.024652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f74e505-0d9f-48d7-ac2c-b140e6dba97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266a6dd660>]}
[0m14:30:29.025665 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:30:29.044414 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:30:29.086251 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:30:29.086999 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/date_spine_model.sql
[0m14:30:29.087419 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/marts/date_spine.sql
[0m14:30:29.113185 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:30:29.155572 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/date_spine_model.sql
[0m14:30:29.170953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f74e505-0d9f-48d7-ac2c-b140e6dba97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266a430fa0>]}
[0m14:30:29.183839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f74e505-0d9f-48d7-ac2c-b140e6dba97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266a3a4310>]}
[0m14:30:29.184555 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m14:30:29.185180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f74e505-0d9f-48d7-ac2c-b140e6dba97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266a3a42e0>]}
[0m14:30:29.186932 [info ] [MainThread]: 
[0m14:30:29.188203 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:30:29.189752 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:30:29.190282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:30.312036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m14:30:30.312875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:30.640228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f74e505-0d9f-48d7-ac2c-b140e6dba97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266a53c100>]}
[0m14:30:30.641270 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:30:30.642118 [info ] [MainThread]: 
[0m14:30:30.646539 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine_model
[0m14:30:30.647209 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.date_spine_model ....................... [RUN]
[0m14:30:30.648239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine_model)
[0m14:30:30.648973 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine_model
[0m14:30:30.660270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:30.660851 [debug] [Thread-1 (]: On model.dbt_robert.date_spine_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine_model"} */


        select 

    datetime_diff(
        cast(2022-01-01 as datetime),
        cast(2022-01-01 as datetime),
        second
    )

  
[0m14:30:31.044909 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to DATETIME at [7:14]')
[0m14:30:31.610676 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:591c3351-b625-479b-a692-3c42e03464c6&page=queryresults
[0m14:30:31.613668 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine_model (compile): 14:30:30.649494 => 14:30:31.613340
[0m14:30:31.617186 [debug] [Thread-1 (]: Database Error in model date_spine_model (models/marts/date_spine_model.sql)
  Invalid cast from INT64 to DATETIME at [7:14]
[0m14:30:31.617764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f74e505-0d9f-48d7-ac2c-b140e6dba97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266a52ec20>]}
[0m14:30:31.618581 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.date_spine_model .............. [[31mERROR[0m in 0.97s]
[0m14:30:31.619344 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine_model
[0m14:30:31.621516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:31.622080 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine_model' was properly closed.
[0m14:30:31.622583 [info ] [MainThread]: 
[0m14:30:31.623152 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m14:30:31.624083 [debug] [MainThread]: Command end result
[0m14:30:31.696753 [info ] [MainThread]: 
[0m14:30:31.697644 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:30:31.698331 [info ] [MainThread]: 
[0m14:30:31.698988 [error] [MainThread]: [33mDatabase Error in model date_spine_model (models/marts/date_spine_model.sql)[0m
[0m14:30:31.699713 [error] [MainThread]:   Invalid cast from INT64 to DATETIME at [7:14]
[0m14:30:31.700407 [info ] [MainThread]: 
[0m14:30:31.701133 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:30:31.702289 [debug] [MainThread]: Command `dbt run` failed at 14:30:31.702140 after 3.12 seconds
[0m14:30:31.702741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266d2fa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266a98b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266aa91600>]}
[0m14:30:31.703226 [debug] [MainThread]: Flushing usage events
[0m14:30:57.918308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7cafee3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c9ec64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c9ec6440>]}


============================== 14:30:57.921191 | 7260a1dc-4941-4210-b061-310f01030cde ==============================
[0m14:30:57.921191 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:30:57.922311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:30:58.298065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7260a1dc-4941-4210-b061-310f01030cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7caf6b8b0>]}
[0m14:30:58.316280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7260a1dc-4941-4210-b061-310f01030cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c83b3a90>]}
[0m14:30:58.317282 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:30:58.336048 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:30:58.378742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:30:58.379673 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:30:58.407338 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:30:58.415453 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token 'name', got 'string'
    line 14
      "date_spine (datepart= "day", start_date='01-01-2023', end_date='01-30-2023')"
[0m14:30:58.416959 [debug] [MainThread]: Command `dbt run` failed at 14:30:58.416731 after 0.51 seconds
[0m14:30:58.417749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7cafee3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c8062e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c8062ce0>]}
[0m14:30:58.418510 [debug] [MainThread]: Flushing usage events
[0m14:32:06.243085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e215a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e0ece500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e0ece470>]}


============================== 14:32:06.245827 | 51f3cd61-9b5b-4b78-af35-429af0946b31 ==============================
[0m14:32:06.245827 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:32:06.246878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:32:06.605071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51f3cd61-9b5b-4b78-af35-429af0946b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e1f05300>]}
[0m14:32:06.622891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51f3cd61-9b5b-4b78-af35-429af0946b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61df3b2290>]}
[0m14:32:06.623827 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:32:06.642341 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:32:06.683850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:06.684733 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:32:06.710160 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:32:06.715070 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token 'name', got '-'
    line 14
      --   date_spine (datepart= "day", start_date='01-01-2023', end_date='01-30-2023')
[0m14:32:06.716301 [debug] [MainThread]: Command `dbt run` failed at 14:32:06.716146 after 0.48 seconds
[0m14:32:06.716825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e215a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61df0627a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61df062620>]}
[0m14:32:06.717370 [debug] [MainThread]: Flushing usage events
[0m14:32:27.663668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31a702410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31940e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31940e4a0>]}


============================== 14:32:27.666447 | 729fbd71-f2c5-42e3-b205-706532d24a2e ==============================
[0m14:32:27.666447 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:32:27.667386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:32:28.112712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '729fbd71-f2c5-42e3-b205-706532d24a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31a665ba0>]}
[0m14:32:28.130477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '729fbd71-f2c5-42e3-b205-706532d24a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb317af56c0>]}
[0m14:32:28.131326 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:32:28.149720 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:32:28.190928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:28.191793 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:32:28.229939 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:32:28.242543 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token 'name', got 'string'
    line 15
      "day",
[0m14:32:28.243805 [debug] [MainThread]: Command `dbt run` failed at 14:32:28.243647 after 0.59 seconds
[0m14:32:28.244285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31a702410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3177a6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3177a6a40>]}
[0m14:32:28.244833 [debug] [MainThread]: Flushing usage events
[0m14:32:43.637884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a8220e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a810ca500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a810ca470>]}


============================== 14:32:43.640549 | 020a398a-37ae-480c-89f1-20c60a26255c ==============================
[0m14:32:43.640549 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:32:43.641363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:32:44.011375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '020a398a-37ae-480c-89f1-20c60a26255c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a81fb66b0>]}
[0m14:32:44.029436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '020a398a-37ae-480c-89f1-20c60a26255c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a7f5b1690>]}
[0m14:32:44.030444 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:32:44.051039 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:32:44.092723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:44.093586 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:32:44.119193 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:32:44.123853 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token '(', got '='
    line 15
      datepar="day",
[0m14:32:44.124919 [debug] [MainThread]: Command `dbt run` failed at 14:32:44.124717 after 0.49 seconds
[0m14:32:44.125428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a8220e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a7f262bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a7f262a70>]}
[0m14:32:44.125901 [debug] [MainThread]: Flushing usage events
[0m14:33:00.877780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d424a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d2fd2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d2fd2470>]}


============================== 14:33:00.880650 | f09f3ae0-3ccc-4781-8c69-c54324cd4840 ==============================
[0m14:33:00.880650 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:33:00.881533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:33:01.244385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f09f3ae0-3ccc-4781-8c69-c54324cd4840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d3ff66b0>]}
[0m14:33:01.268400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f09f3ae0-3ccc-4781-8c69-c54324cd4840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d14b5330>]}
[0m14:33:01.269836 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:33:01.296714 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:33:01.337373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:01.338182 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:33:01.363825 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:33:01.368567 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token '(', got '='
    line 15
      datepart="day",
[0m14:33:01.369574 [debug] [MainThread]: Command `dbt run` failed at 14:33:01.369386 after 0.50 seconds
[0m14:33:01.370090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d424a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d116ad40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64d116abc0>]}
[0m14:33:01.370565 [debug] [MainThread]: Flushing usage events
[0m14:33:18.599337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be481e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be35d2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be35d24a0>]}


============================== 14:33:18.602051 | 82353a61-f04b-4382-933a-e97753e0fea7 ==============================
[0m14:33:18.602051 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:33:18.602855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:33:18.960132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82353a61-f04b-4382-933a-e97753e0fea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be4581ba0>]}
[0m14:33:18.978266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82353a61-f04b-4382-933a-e97753e0fea7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be1ab5570>]}
[0m14:33:18.979149 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:33:18.998007 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:33:19.041525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:19.042349 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:33:19.069693 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:33:19.074495 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token 'name', got '('
    line 15
      (datepart="day",
[0m14:33:19.075521 [debug] [MainThread]: Command `dbt run` failed at 14:33:19.075330 after 0.48 seconds
[0m14:33:19.076043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be481e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be1766d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be1766b90>]}
[0m14:33:19.076552 [debug] [MainThread]: Flushing usage events
[0m14:34:30.250650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29be02a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bcff24a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bcff2410>]}


============================== 14:34:30.254644 | 63980227-213e-4ca6-98e9-bb5f3d9ee7e5 ==============================
[0m14:34:30.254644 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:34:30.255620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:34:30.640974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63980227-213e-4ca6-98e9-bb5f3d9ee7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bdf5e650>]}
[0m14:34:30.659270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63980227-213e-4ca6-98e9-bb5f3d9ee7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bb4ddc90>]}
[0m14:34:30.660269 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:34:30.680731 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:34:30.722188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:34:30.723065 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:34:30.748810 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:34:30.753712 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token 'name', got '('
    line 15
      (datepart= "day", to_date('01/01/2023', 'mm/dd/yyyy'),dbt.dateadd(week, 1, current_date))
[0m14:34:30.754979 [debug] [MainThread]: Command `dbt run` failed at 14:34:30.754823 after 0.51 seconds
[0m14:34:30.755472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29be02a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bb18e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bb18e830>]}
[0m14:34:30.756004 [debug] [MainThread]: Flushing usage events
[0m14:35:16.426662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e75306410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e741ca530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e741ca4a0>]}


============================== 14:35:16.429304 | 17e853b2-d3a2-4d24-a468-57dd2f51bcc7 ==============================
[0m14:35:16.429304 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:35:16.430100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:35:16.882575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17e853b2-d3a2-4d24-a468-57dd2f51bcc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e75265ba0>]}
[0m14:35:16.900158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17e853b2-d3a2-4d24-a468-57dd2f51bcc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e726b1660>]}
[0m14:35:16.901056 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:35:16.919487 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:35:16.960300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:35:16.961200 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:35:16.987534 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:35:16.992293 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token 'name', got '('
    line 15
      (datepart= "day", to_date='01/01/2023',dbt.dateadd(week, 1, current_date))
[0m14:35:16.993539 [debug] [MainThread]: Command `dbt run` failed at 14:35:16.993396 after 0.57 seconds
[0m14:35:16.994012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e75306410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e72362c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e72362aa0>]}
[0m14:35:16.994522 [debug] [MainThread]: Flushing usage events
[0m14:36:48.833486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c0c6a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59bfa0e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59bfa0e4a0>]}


============================== 14:36:48.836132 | c84f07c7-b8d5-4445-987f-8818e90ff0d6 ==============================
[0m14:36:48.836132 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:36:48.837088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:36:49.204565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c84f07c7-b8d5-4445-987f-8818e90ff0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59be0f3190>]}
[0m14:36:49.222598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c84f07c7-b8d5-4445-987f-8818e90ff0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59be0fb3d0>]}
[0m14:36:49.223547 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:36:49.242711 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:36:49.284437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:36:49.285234 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:36:49.310454 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:36:49.315356 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token 'name', got '('
    line 15
      (datepart= "day", to_date='01/01/2023',dbt.dateadd(week, 1, current_date))
[0m14:36:49.316640 [debug] [MainThread]: Command `dbt run` failed at 14:36:49.316481 after 0.49 seconds
[0m14:36:49.317127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c0c6a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59bdda6e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59bdda6d10>]}
[0m14:36:49.317673 [debug] [MainThread]: Flushing usage events
[0m14:37:44.162038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff85dfe410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff84cca530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff84cca4a0>]}


============================== 14:37:44.165103 | 3c498a3d-98ff-40eb-ad9e-8c6cdfb5b58c ==============================
[0m14:37:44.165103 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:37:44.166066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:37:44.528080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c498a3d-98ff-40eb-ad9e-8c6cdfb5b58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff85d5dba0>]}
[0m14:37:44.545946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c498a3d-98ff-40eb-ad9e-8c6cdfb5b58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff831b1660>]}
[0m14:37:44.546870 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:37:44.566068 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:37:44.608805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:37:44.609691 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:37:44.635169 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:37:44.680248 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/date_spine_model.sql
[0m14:37:44.694792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c498a3d-98ff-40eb-ad9e-8c6cdfb5b58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff82f199c0>]}
[0m14:37:44.707797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c498a3d-98ff-40eb-ad9e-8c6cdfb5b58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff82e95d80>]}
[0m14:37:44.708495 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m14:37:44.709488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c498a3d-98ff-40eb-ad9e-8c6cdfb5b58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff82e950c0>]}
[0m14:37:44.711589 [info ] [MainThread]: 
[0m14:37:44.712889 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:37:44.714547 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:37:44.715066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:45.825490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m14:37:45.826186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:46.140631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c498a3d-98ff-40eb-ad9e-8c6cdfb5b58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff82e94a60>]}
[0m14:37:46.141913 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:37:46.142826 [info ] [MainThread]: 
[0m14:37:46.148550 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine_model
[0m14:37:46.149541 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.date_spine_model ....................... [RUN]
[0m14:37:46.150776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine_model)
[0m14:37:46.151250 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine_model
[0m14:37:46.162829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:46.163374 [debug] [Thread-1 (]: On model.dbt_robert.date_spine_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine_model"} */


        select 

    datetime_diff(
        cast(2022-01-01 as datetime),
        cast(2022-01-01 as datetime),
        second
    )

  
[0m14:37:46.573012 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to DATETIME at [7:14]')
[0m14:37:47.388057 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ae4ae758-4696-43e2-9461-058e90091182&page=queryresults
[0m14:37:47.390494 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine_model (compile): 14:37:46.151577 => 14:37:47.390061
[0m14:37:47.394642 [debug] [Thread-1 (]: Database Error in model date_spine_model (models/marts/date_spine_model.sql)
  Invalid cast from INT64 to DATETIME at [7:14]
[0m14:37:47.395280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c498a3d-98ff-40eb-ad9e-8c6cdfb5b58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff82fff4c0>]}
[0m14:37:47.396083 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.date_spine_model .............. [[31mERROR[0m in 1.24s]
[0m14:37:47.396907 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine_model
[0m14:37:47.398904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:47.399278 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine_model' was properly closed.
[0m14:37:47.399688 [info ] [MainThread]: 
[0m14:37:47.400256 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m14:37:47.401497 [debug] [MainThread]: Command end result
[0m14:37:47.472207 [info ] [MainThread]: 
[0m14:37:47.473196 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:37:47.473898 [info ] [MainThread]: 
[0m14:37:47.474589 [error] [MainThread]: [33mDatabase Error in model date_spine_model (models/marts/date_spine_model.sql)[0m
[0m14:37:47.475210 [error] [MainThread]:   Invalid cast from INT64 to DATETIME at [7:14]
[0m14:37:47.475889 [info ] [MainThread]: 
[0m14:37:47.476666 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:37:47.477737 [debug] [MainThread]: Command `dbt run` failed at 14:37:47.477537 after 3.32 seconds
[0m14:37:47.478346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff85dfe410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8345f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8355b9d0>]}
[0m14:37:47.478823 [debug] [MainThread]: Flushing usage events
[0m14:38:43.236569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33845e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3373f24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3373f2440>]}


============================== 14:38:43.239179 | 91de74a1-7285-41e2-ad6f-54afda5c98a7 ==============================
[0m14:38:43.239179 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:38:43.239956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:38:43.593431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91de74a1-7285-41e2-ad6f-54afda5c98a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe338233520>]}
[0m14:38:43.611089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91de74a1-7285-41e2-ad6f-54afda5c98a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3358dd420>]}
[0m14:38:43.611968 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:38:43.633360 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:38:43.675507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:38:43.676381 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:38:43.701804 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:38:43.706652 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token ',', got 'integer'
    line 14
      dbt_utils.date_spine (datepart= "day", start_date=date(01-01-2023), end_date='01-30-2023')
[0m14:38:43.707863 [debug] [MainThread]: Command `dbt run` failed at 14:38:43.707716 after 0.48 seconds
[0m14:38:43.708372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33845e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe335593340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe335592f20>]}
[0m14:38:43.708928 [debug] [MainThread]: Flushing usage events
[0m14:39:20.119520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e6daa440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e5cca560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e5cca4d0>]}


============================== 14:39:20.122238 | 5c69f3e5-3fd3-43fe-ab66-0d2b8a5696b1 ==============================
[0m14:39:20.122238 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:39:20.123048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:39:20.488864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c69f3e5-3fd3-43fe-ab66-0d2b8a5696b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e41af190>]}
[0m14:39:20.506758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c69f3e5-3fd3-43fe-ab66-0d2b8a5696b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e41b19f0>]}
[0m14:39:20.507736 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:39:20.526506 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:39:20.567694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:20.568608 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:39:20.594091 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:39:20.598912 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token ',', got 'integer'
    line 14
      dbt_utils.date_spine (datepart= "day", start_date=date(01-01-2023), end_date=date(01-30-2023))
[0m14:39:20.600119 [debug] [MainThread]: Command `dbt run` failed at 14:39:20.599972 after 0.49 seconds
[0m14:39:20.600628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e6daa440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e3e635b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e3e63190>]}
[0m14:39:20.601230 [debug] [MainThread]: Flushing usage events
[0m14:39:52.590702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e4b9a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e3912590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e3912500>]}


============================== 14:39:52.593450 | 39b06e94-b98e-4d3d-90b4-dcdc4d2f23cb ==============================
[0m14:39:52.593450 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:39:52.594258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:39:52.967443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39b06e94-b98e-4d3d-90b4-dcdc4d2f23cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e1fbbc70>]}
[0m14:39:52.985380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39b06e94-b98e-4d3d-90b4-dcdc4d2f23cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e1ffa2f0>]}
[0m14:39:52.986359 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:39:53.005300 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:39:53.046030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:53.046918 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:39:53.073492 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:39:53.078517 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  expected token ',', got 'integer'
    line 14
      dbt_utils.date_spine (datepart= "day", start_date= date(01-01-2023), end_date= date(01-30-2023))
[0m14:39:53.079580 [debug] [MainThread]: Command `dbt run` failed at 14:39:53.079388 after 0.50 seconds
[0m14:39:53.080072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e4b9a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e1caafb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e1caab90>]}
[0m14:39:53.080601 [debug] [MainThread]: Flushing usage events
[0m14:40:40.063490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196ecf23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196dbf6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196dbf6470>]}


============================== 14:40:40.066368 | 957817a5-09ee-4f3b-aa92-772e0bcd1f8d ==============================
[0m14:40:40.066368 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:40:40.067229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:40:40.435916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '957817a5-09ee-4f3b-aa92-772e0bcd1f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196ea9e6b0>]}
[0m14:40:40.457309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '957817a5-09ee-4f3b-aa92-772e0bcd1f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196c0ddc60>]}
[0m14:40:40.458610 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:40:40.480298 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:40:40.521300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:40:40.522196 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:40:40.547833 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:40:40.592832 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/date_spine_model.sql
[0m14:40:40.607672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '957817a5-09ee-4f3b-aa92-772e0bcd1f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196be35720>]}
[0m14:40:40.621446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '957817a5-09ee-4f3b-aa92-772e0bcd1f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196bdc2f80>]}
[0m14:40:40.622230 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m14:40:40.622890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '957817a5-09ee-4f3b-aa92-772e0bcd1f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196bdc0970>]}
[0m14:40:40.624714 [info ] [MainThread]: 
[0m14:40:40.626082 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:40:40.627654 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:40:40.628172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:41.753254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m14:40:41.754027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:42.035723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '957817a5-09ee-4f3b-aa92-772e0bcd1f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196bda4160>]}
[0m14:40:42.036803 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:40:42.037600 [info ] [MainThread]: 
[0m14:40:42.041623 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine_model
[0m14:40:42.042331 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.date_spine_model ....................... [RUN]
[0m14:40:42.043311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine_model)
[0m14:40:42.043739 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine_model
[0m14:40:42.054779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:42.055377 [debug] [Thread-1 (]: On model.dbt_robert.date_spine_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine_model"} */


        select 

    datetime_diff(
        cast(2022-01-01 as datetime),
        cast(2022-01-01 as datetime),
        second
    )

  
[0m14:40:42.477003 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to DATETIME at [7:14]')
[0m14:40:43.385468 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2843759a-e250-489c-86e7-02cd2fd7169a&page=queryresults
[0m14:40:43.388389 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine_model (compile): 14:40:42.044083 => 14:40:43.387834
[0m14:40:43.392856 [debug] [Thread-1 (]: Database Error in model date_spine_model (models/marts/date_spine_model.sql)
  Invalid cast from INT64 to DATETIME at [7:14]
[0m14:40:43.393473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '957817a5-09ee-4f3b-aa92-772e0bcd1f8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196bf2af20>]}
[0m14:40:43.394224 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.date_spine_model .............. [[31mERROR[0m in 1.35s]
[0m14:40:43.395014 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine_model
[0m14:40:43.397270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:43.397645 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine_model' was properly closed.
[0m14:40:43.398047 [info ] [MainThread]: 
[0m14:40:43.398637 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m14:40:43.399792 [debug] [MainThread]: Command end result
[0m14:40:43.474839 [info ] [MainThread]: 
[0m14:40:43.475909 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:40:43.477803 [info ] [MainThread]: 
[0m14:40:43.478627 [error] [MainThread]: [33mDatabase Error in model date_spine_model (models/marts/date_spine_model.sql)[0m
[0m14:40:43.479463 [error] [MainThread]:   Invalid cast from INT64 to DATETIME at [7:14]
[0m14:40:43.480239 [info ] [MainThread]: 
[0m14:40:43.481136 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:40:43.482488 [debug] [MainThread]: Command `dbt run` failed at 14:40:43.482294 after 3.43 seconds
[0m14:40:43.483229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196ecf23e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196c60bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f196c057d60>]}
[0m14:40:43.484133 [debug] [MainThread]: Flushing usage events
[0m14:41:54.648644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbdf363e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbceca500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbceca470>]}


============================== 14:41:54.651353 | dbd87e38-06e2-451f-b97c-c2db01d7516c ==============================
[0m14:41:54.651353 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:41:54.652432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:41:55.020821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbd87e38-06e2-451f-b97c-c2db01d7516c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbb3af220>]}
[0m14:41:55.038513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbd87e38-06e2-451f-b97c-c2db01d7516c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbb3b1a20>]}
[0m14:41:55.039527 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:41:55.058723 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:41:55.099940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:41:55.100819 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:41:55.126412 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:41:55.168533 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/date_spine_model.sql
[0m14:41:55.183281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbd87e38-06e2-451f-b97c-c2db01d7516c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbb119570>]}
[0m14:41:55.195978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbd87e38-06e2-451f-b97c-c2db01d7516c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbb075b70>]}
[0m14:41:55.196662 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m14:41:55.197460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd87e38-06e2-451f-b97c-c2db01d7516c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbb075c00>]}
[0m14:41:55.199296 [info ] [MainThread]: 
[0m14:41:55.200565 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:41:55.202051 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:41:55.202466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:56.242137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m14:41:56.242823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:56.506086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbd87e38-06e2-451f-b97c-c2db01d7516c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbb063760>]}
[0m14:41:56.507304 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:41:56.508061 [info ] [MainThread]: 
[0m14:41:56.512315 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine_model
[0m14:41:56.513005 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.date_spine_model ....................... [RUN]
[0m14:41:56.513895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine_model)
[0m14:41:56.514350 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine_model
[0m14:41:56.526008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:56.526601 [debug] [Thread-1 (]: On model.dbt_robert.date_spine_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine_model"} */


        select 

    datetime_diff(
        cast(2022-01-01 as datetime),
        cast(2022-01-01 as datetime),
        second
    )

  
[0m14:41:56.917303 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Invalid cast from INT64 to DATETIME at [7:14]')
[0m14:41:57.268508 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:adcf7b00-c895-49be-ba00-08589efadd58&page=queryresults
[0m14:41:57.271014 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine_model (compile): 14:41:56.514647 => 14:41:57.270429
[0m14:41:57.275003 [debug] [Thread-1 (]: Database Error in model date_spine_model (models/marts/date_spine_model.sql)
  Invalid cast from INT64 to DATETIME at [7:14]
[0m14:41:57.275657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbd87e38-06e2-451f-b97c-c2db01d7516c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbb1fefe0>]}
[0m14:41:57.276460 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_robert.date_spine_model .............. [[31mERROR[0m in 0.76s]
[0m14:41:57.277375 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine_model
[0m14:41:57.279404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:57.279832 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine_model' was properly closed.
[0m14:41:57.280330 [info ] [MainThread]: 
[0m14:41:57.281128 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m14:41:57.281842 [debug] [MainThread]: Command end result
[0m14:41:57.369200 [info ] [MainThread]: 
[0m14:41:57.370852 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:41:57.373113 [info ] [MainThread]: 
[0m14:41:57.373835 [error] [MainThread]: [33mDatabase Error in model date_spine_model (models/marts/date_spine_model.sql)[0m
[0m14:41:57.374507 [error] [MainThread]:   Invalid cast from INT64 to DATETIME at [7:14]
[0m14:41:57.375619 [info ] [MainThread]: 
[0m14:41:57.376413 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:41:57.378356 [debug] [MainThread]: Command `dbt run` failed at 14:41:57.378153 after 2.74 seconds
[0m14:41:57.379086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbdf363e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbb65f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabbb4d0520>]}
[0m14:41:57.379827 [debug] [MainThread]: Flushing usage events
[0m14:43:16.070221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4cf6ae3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ce3ce4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ce3ce440>]}


============================== 14:43:16.072977 | 80e0a15d-e1e2-4f69-a688-76110d8f100f ==============================
[0m14:43:16.072977 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:43:16.073795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:43:16.440228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80e0a15d-e1e2-4f69-a688-76110d8f100f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4cf282bf0>]}
[0m14:43:16.458379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80e0a15d-e1e2-4f69-a688-76110d8f100f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4cc8b7b80>]}
[0m14:43:16.459559 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:43:16.478894 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:43:16.520082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:16.520968 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:43:16.547345 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:43:16.556015 [error] [MainThread]: Encountered an error:
Compilation Error in model date_spine_model (models/marts/date_spine_model.sql)
  unexpected 'end of print statement'
    line 15
      --}}
[0m14:43:16.557767 [debug] [MainThread]: Command `dbt run` failed at 14:43:16.557621 after 0.50 seconds
[0m14:43:16.558263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4cf6ae3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4cc567070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4cc566c50>]}
[0m14:43:16.558965 [debug] [MainThread]: Flushing usage events
[0m14:43:38.727912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b9cea410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b89d2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b89d24a0>]}


============================== 14:43:38.730637 | f55534fe-18ec-4fdb-8743-5961559d6849 ==============================
[0m14:43:38.730637 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:43:38.731654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:43:39.126636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f55534fe-18ec-4fdb-8743-5961559d6849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6eb32b0>]}
[0m14:43:39.144735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f55534fe-18ec-4fdb-8743-5961559d6849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6eb5d20>]}
[0m14:43:39.145656 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:43:39.164496 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:43:39.205065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:39.205900 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:43:39.232451 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:43:39.278062 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/date_spine_model.sql
[0m14:43:39.292696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f55534fe-18ec-4fdb-8743-5961559d6849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6c191e0>]}
[0m14:43:39.305339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f55534fe-18ec-4fdb-8743-5961559d6849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6b7bf70>]}
[0m14:43:39.306138 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m14:43:39.306754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f55534fe-18ec-4fdb-8743-5961559d6849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6b78a00>]}
[0m14:43:39.308453 [info ] [MainThread]: 
[0m14:43:39.309684 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:43:39.311196 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:43:39.311723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:40.370998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m14:43:40.371682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:40.652401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f55534fe-18ec-4fdb-8743-5961559d6849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6d10100>]}
[0m14:43:40.653640 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:43:40.654429 [info ] [MainThread]: 
[0m14:43:40.658537 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine_model
[0m14:43:40.659246 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.date_spine_model ....................... [RUN]
[0m14:43:40.660425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine_model)
[0m14:43:40.660846 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine_model
[0m14:43:40.670153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:40.670636 [debug] [Thread-1 (]: On model.dbt_robert.date_spine_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine_model"} */


        select 

    datetime_diff(
        cast(cast('2023-01-30' as date) as datetime),
        cast(cast('2023-01-01' as date) as datetime),
        day
    )

  
[0m14:43:42.127075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:40390b55-314b-4f77-a4b7-045bb3bcd6ec&page=queryresults
[0m14:43:42.129681 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.date_spine_model"
[0m14:43:42.130809 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine_model (compile): 14:43:40.661109 => 14:43:42.130425
[0m14:43:42.131391 [debug] [Thread-1 (]: Began executing node model.dbt_robert.date_spine_model
[0m14:43:42.232848 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.date_spine_model"
[0m14:43:42.233809 [debug] [Thread-1 (]: On model.dbt_robert.date_spine_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine_model"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`date_spine_model`
    
    

    OPTIONS()
    as (
      








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 29
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2023-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2023-01-30' as date)

)

select * from filtered


    );
  
[0m14:43:45.249611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1fbe6590-22a4-44ac-8538-0e3e6f2c7fc7&page=queryresults
[0m14:43:45.269324 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine_model (execute): 14:43:42.131760 => 14:43:45.269084
[0m14:43:45.270267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f55534fe-18ec-4fdb-8743-5961559d6849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6d43d00>]}
[0m14:43:45.271063 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.date_spine_model .................. [[32mCREATE TABLE (29.0 rows, 0 processed)[0m in 4.61s]
[0m14:43:45.272645 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine_model
[0m14:43:45.274456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:45.274827 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine_model' was properly closed.
[0m14:43:45.275244 [info ] [MainThread]: 
[0m14:43:45.275808 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.97 seconds (5.97s).
[0m14:43:45.277311 [debug] [MainThread]: Command end result
[0m14:43:45.287400 [info ] [MainThread]: 
[0m14:43:45.288146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:45.288941 [info ] [MainThread]: 
[0m14:43:45.289944 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:43:45.291150 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:45.290987 after 6.57 seconds
[0m14:43:45.291591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b9cea410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6b78b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6b7bf70>]}
[0m14:43:45.292044 [debug] [MainThread]: Flushing usage events
[0m14:46:26.622653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17cd0ae410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17cbe0e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17cbe0e4a0>]}


============================== 14:46:26.625368 | 6d5532a7-489b-4a1d-9027-c690b3b7b84f ==============================
[0m14:46:26.625368 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:46:26.626163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:46:27.005809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d5532a7-489b-4a1d-9027-c690b3b7b84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17cd011ba0>]}
[0m14:46:27.023311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d5532a7-489b-4a1d-9027-c690b3b7b84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ca4f53c0>]}
[0m14:46:27.024193 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:46:27.042280 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:46:27.083623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:46:27.084451 [debug] [MainThread]: Partial parsing: updated file: dbt_robert://models/marts/date_spine_model.sql
[0m14:46:27.109913 [debug] [MainThread]: 1603: static parser failed on marts/date_spine_model.sql
[0m14:46:27.150236 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/date_spine_model.sql
[0m14:46:27.165276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d5532a7-489b-4a1d-9027-c690b3b7b84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ca234e20>]}
[0m14:46:27.178387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d5532a7-489b-4a1d-9027-c690b3b7b84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ca1bbf70>]}
[0m14:46:27.179039 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m14:46:27.179622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d5532a7-489b-4a1d-9027-c690b3b7b84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ca1bbb80>]}
[0m14:46:27.181315 [info ] [MainThread]: 
[0m14:46:27.182501 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:46:27.183955 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:46:27.184535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:28.240071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m14:46:28.240933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:28.572155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d5532a7-489b-4a1d-9027-c690b3b7b84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ca1ba2f0>]}
[0m14:46:28.573173 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:46:28.573963 [info ] [MainThread]: 
[0m14:46:28.579798 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_spine_model
[0m14:46:28.580464 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.date_spine_model ....................... [RUN]
[0m14:46:28.581415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_spine_model)
[0m14:46:28.581839 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_spine_model
[0m14:46:28.591210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:28.591739 [debug] [Thread-1 (]: On model.dbt_robert.date_spine_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine_model"} */


        select 

    datetime_diff(
        cast(cast('2023-01-31' as date) as datetime),
        cast(cast('2023-01-01' as date) as datetime),
        day
    )

  
[0m14:46:30.073588 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cac65c54-93ab-4e63-87b6-03b9b16d9e3d&page=queryresults
[0m14:46:30.075728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.date_spine_model"
[0m14:46:30.076812 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine_model (compile): 14:46:28.582107 => 14:46:30.076389
[0m14:46:30.077497 [debug] [Thread-1 (]: Began executing node model.dbt_robert.date_spine_model
[0m14:46:30.438383 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.date_spine_model"
[0m14:46:30.439380 [debug] [Thread-1 (]: On model.dbt_robert.date_spine_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_spine_model"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`date_spine_model`
    
    

    OPTIONS()
    as (
      








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 30
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2023-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2023-01-31' as date)

)

select * from filtered


    );
  
[0m14:46:33.402551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fff507ce-e2c3-4fb4-98e0-a53b04594bf4&page=queryresults
[0m14:46:33.421037 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_spine_model (execute): 14:46:30.077808 => 14:46:33.420805
[0m14:46:33.421980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5532a7-489b-4a1d-9027-c690b3b7b84f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ca0bc160>]}
[0m14:46:33.422756 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.date_spine_model .................. [[32mCREATE TABLE (30.0 rows, 0 processed)[0m in 4.84s]
[0m14:46:33.423750 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_spine_model
[0m14:46:33.426118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:33.426490 [debug] [MainThread]: Connection 'model.dbt_robert.date_spine_model' was properly closed.
[0m14:46:33.426889 [info ] [MainThread]: 
[0m14:46:33.427464 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.24 seconds (6.24s).
[0m14:46:33.428405 [debug] [MainThread]: Command end result
[0m14:46:33.440058 [info ] [MainThread]: 
[0m14:46:33.440819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:46:33.441452 [info ] [MainThread]: 
[0m14:46:33.442087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:46:33.443691 [debug] [MainThread]: Command `dbt run` succeeded at 14:46:33.443328 after 6.83 seconds
[0m14:46:33.444172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17cd0ae410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ca0bc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ca0bc0a0>]}
[0m14:46:33.444664 [debug] [MainThread]: Flushing usage events
[0m14:47:12.311342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391f1e6440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391e476560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391e4764d0>]}


============================== 14:47:12.314055 | 0aa7e9b1-0fe1-4972-9a00-efea1fad7089 ==============================
[0m14:47:12.314055 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:47:12.315068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:47:12.676441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0aa7e9b1-0fe1-4972-9a00-efea1fad7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391f10df60>]}
[0m14:47:12.694689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0aa7e9b1-0fe1-4972-9a00-efea1fad7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391c5e1330>]}
[0m14:47:12.695553 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:47:12.714400 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:47:12.755570 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:47:12.756360 [debug] [MainThread]: Partial parsing: added file: dbt_robert://models/marts/date_scaffold.sql
[0m14:47:12.756801 [debug] [MainThread]: Partial parsing: deleted file: dbt_robert://models/marts/date_spine_model.sql
[0m14:47:12.785736 [debug] [MainThread]: 1603: static parser failed on marts/date_scaffold.sql
[0m14:47:12.826523 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/date_scaffold.sql
[0m14:47:12.841550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0aa7e9b1-0fe1-4972-9a00-efea1fad7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391c32ce50>]}
[0m14:47:12.854012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0aa7e9b1-0fe1-4972-9a00-efea1fad7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391c2abf70>]}
[0m14:47:12.854654 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 471 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m14:47:12.855366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aa7e9b1-0fe1-4972-9a00-efea1fad7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391c2abb50>]}
[0m14:47:12.857143 [info ] [MainThread]: 
[0m14:47:12.858452 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:47:12.859873 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:47:12.860627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:14.163224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m14:47:14.164083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:14.480592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aa7e9b1-0fe1-4972-9a00-efea1fad7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391c2abb50>]}
[0m14:47:14.482435 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:47:14.484281 [info ] [MainThread]: 
[0m14:47:14.510687 [debug] [Thread-1 (]: Began running node model.dbt_robert.date_scaffold
[0m14:47:14.511798 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_robert.date_scaffold .......................... [RUN]
[0m14:47:14.513547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.date_scaffold)
[0m14:47:14.514927 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.date_scaffold
[0m14:47:14.529458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:14.530151 [debug] [Thread-1 (]: On model.dbt_robert.date_scaffold: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_scaffold"} */


        select 

    datetime_diff(
        cast(cast('2023-01-31' as date) as datetime),
        cast(cast('2023-01-01' as date) as datetime),
        day
    )

  
[0m14:47:16.228736 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b477db5d-b7ea-4184-bbf1-84a4a0e32325&page=queryresults
[0m14:47:16.231124 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.date_scaffold"
[0m14:47:16.232094 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_scaffold (compile): 14:47:14.515415 => 14:47:16.231766
[0m14:47:16.232631 [debug] [Thread-1 (]: Began executing node model.dbt_robert.date_scaffold
[0m14:47:16.322897 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.date_scaffold"
[0m14:47:16.323812 [debug] [Thread-1 (]: On model.dbt_robert.date_scaffold: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_scaffold"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`date_scaffold`
    
    

    OPTIONS()
    as (
      








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 30
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2023-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2023-01-31' as date)

)

select * from filtered


    );
  
[0m14:47:19.039371 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:925ecfba-8c20-4b23-89c7-7e55d966e7cb&page=queryresults
[0m14:47:19.067384 [debug] [Thread-1 (]: Timing info for model.dbt_robert.date_scaffold (execute): 14:47:16.232953 => 14:47:19.067148
[0m14:47:19.068330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aa7e9b1-0fe1-4972-9a00-efea1fad7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391c277d30>]}
[0m14:47:19.069136 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_robert.date_scaffold ..................... [[32mCREATE TABLE (30.0 rows, 0 processed)[0m in 4.56s]
[0m14:47:19.070233 [debug] [Thread-1 (]: Finished running node model.dbt_robert.date_scaffold
[0m14:47:19.071973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:19.072527 [debug] [MainThread]: Connection 'model.dbt_robert.date_scaffold' was properly closed.
[0m14:47:19.073271 [info ] [MainThread]: 
[0m14:47:19.073867 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.22 seconds (6.22s).
[0m14:47:19.074684 [debug] [MainThread]: Command end result
[0m14:47:19.086034 [info ] [MainThread]: 
[0m14:47:19.086839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:47:19.089954 [info ] [MainThread]: 
[0m14:47:19.090624 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:47:19.091812 [debug] [MainThread]: Command `dbt run` succeeded at 14:47:19.091661 after 6.79 seconds
[0m14:47:19.092265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391f1e6440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391c2aa320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f391c2abf70>]}
[0m14:47:19.092748 [debug] [MainThread]: Flushing usage events
[0m14:50:02.492577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf401a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf2fc53c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf2fc5ae0>]}


============================== 14:50:02.495219 | 779465a1-0a42-446a-824a-ed6301785030 ==============================
[0m14:50:02.495219 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:50:02.495999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:50:02.526302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '779465a1-0a42-446a-824a-ed6301785030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf2fc66b0>]}
[0m14:50:02.527419 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9ib0bn6z'
[0m14:50:02.528043 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:50:02.631956 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:50:02.633692 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:50:02.729383 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:50:02.735198 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m14:50:02.841045 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m14:50:02.852558 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:50:03.118554 [info ] [MainThread]: Installed from version 1.1.1
[0m14:50:03.120451 [info ] [MainThread]: Up to date!
[0m14:50:03.123092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '779465a1-0a42-446a-824a-ed6301785030', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf2e30df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf2e33430>]}
[0m14:50:03.123732 [info ] [MainThread]: Installing dbt-labs/codegen
[0m14:50:03.348781 [info ] [MainThread]: Installed from version 0.10.0
[0m14:50:03.349987 [info ] [MainThread]: Up to date!
[0m14:50:03.351051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '779465a1-0a42-446a-824a-ed6301785030', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf2e33670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf2e31d80>]}
[0m14:50:03.352726 [debug] [MainThread]: Command `dbt deps` succeeded at 14:50:03.352541 after 0.87 seconds
[0m14:50:03.353311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf401a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf2fc66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf2fc6710>]}
[0m14:50:03.353875 [debug] [MainThread]: Flushing usage events
[0m15:00:34.307499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b77de2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b650d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b650dab0>]}


============================== 15:00:34.310395 | 7aa986fa-95cf-441b-8440-965deb919c76 ==============================
[0m15:00:34.310395 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:00:34.311220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:00:34.343148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7aa986fa-95cf-441b-8440-965deb919c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b650e650>]}
[0m15:00:34.344261 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m00kq9j8'
[0m15:00:34.344970 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:00:34.463567 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:00:34.465417 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:00:34.563781 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:00:34.569550 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m15:00:34.669678 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m15:00:34.672927 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/github.json
[0m15:00:34.768691 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/github.json 200
[0m15:00:34.774984 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/github_source.json
[0m15:00:34.883281 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/github_source.json 200
[0m15:00:34.886283 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json
[0m15:00:34.981984 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fivetran/fivetran_utils.json 200
[0m15:00:34.986453 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json
[0m15:00:35.081987 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json 200
[0m15:00:35.096720 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:00:35.377181 [info ] [MainThread]: Installed from version 1.1.1
[0m15:00:35.378487 [info ] [MainThread]: Up to date!
[0m15:00:35.379941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7aa986fa-95cf-441b-8440-965deb919c76', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b6578af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b6579300>]}
[0m15:00:35.381094 [info ] [MainThread]: Installing dbt-labs/codegen
[0m15:00:35.636583 [info ] [MainThread]: Installed from version 0.10.0
[0m15:00:35.637896 [info ] [MainThread]: Up to date!
[0m15:00:35.639248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7aa986fa-95cf-441b-8440-965deb919c76', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b657a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b657b730>]}
[0m15:00:35.639910 [info ] [MainThread]: Installing fivetran/github
[0m15:00:35.922309 [info ] [MainThread]: Installed from version 0.7.0
[0m15:00:35.923143 [info ] [MainThread]: Up to date!
[0m15:00:35.923927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7aa986fa-95cf-441b-8440-965deb919c76', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b657b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b657a350>]}
[0m15:00:35.924590 [info ] [MainThread]: Installing fivetran/github_source
[0m15:00:36.229668 [info ] [MainThread]: Installed from version 0.7.0
[0m15:00:36.231767 [info ] [MainThread]: Up to date!
[0m15:00:36.232902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7aa986fa-95cf-441b-8440-965deb919c76', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b657a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b6579300>]}
[0m15:00:36.233538 [info ] [MainThread]: Installing fivetran/fivetran_utils
[0m15:00:36.454216 [info ] [MainThread]: Installed from version 0.4.7
[0m15:00:36.455313 [info ] [MainThread]: Up to date!
[0m15:00:36.456869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7aa986fa-95cf-441b-8440-965deb919c76', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b657bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b657beb0>]}
[0m15:00:36.457514 [info ] [MainThread]: Installing dbt-labs/spark_utils
[0m15:00:36.668420 [info ] [MainThread]: Installed from version 0.3.0
[0m15:00:36.669582 [info ] [MainThread]: Up to date!
[0m15:00:36.670396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7aa986fa-95cf-441b-8440-965deb919c76', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b6579240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b657bd30>]}
[0m15:00:36.672484 [debug] [MainThread]: Command `dbt deps` succeeded at 15:00:36.672243 after 2.37 seconds
[0m15:00:36.673198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b77de2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b650e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38b650e6b0>]}
[0m15:00:36.673840 [debug] [MainThread]: Flushing usage events
[0m15:05:02.016282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a283a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a17ca470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a17ca440>]}


============================== 15:05:02.019072 | 6dcb659b-971f-4e57-81c5-300f7b9968b1 ==============================
[0m15:05:02.019072 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:05:02.020037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:05:02.384754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a25e3730>]}
[0m15:05:02.402684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89fcb1300>]}
[0m15:05:02.403651 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:05:02.459378 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:05:02.474432 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:05:02.475405 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:05:02.476152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89fcb05b0>]}
[0m15:05:04.011163 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m15:05:04.025644 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport_view.sql
[0m15:05:04.029337 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m15:05:04.032840 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbtcustomers/customers.sql
[0m15:05:04.036587 [debug] [MainThread]: 1603: static parser failed on marts/Jinja_exercises/coffee_jinja.sql
[0m15:05:04.043122 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/Jinja_exercises/coffee_jinja.sql
[0m15:05:04.044898 [debug] [MainThread]: 1603: static parser failed on marts/dbt_packages_exercise/date_scaffold.sql
[0m15:05:04.075475 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/dbt_packages_exercise/date_scaffold.sql
[0m15:05:04.077395 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbt_packages_exercise/product_price_history.sql
[0m15:05:04.081141 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/pageviews_userstitching.sql
[0m15:05:04.084815 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/visitors_sessionization.sql
[0m15:05:04.121031 [debug] [MainThread]: 1603: static parser failed on stg_github__pull_request_review.sql
[0m15:05:04.148482 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__pull_request_review.sql
[0m15:05:04.150577 [debug] [MainThread]: 1603: static parser failed on stg_github__requested_reviewer_history.sql
[0m15:05:04.163582 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__requested_reviewer_history.sql
[0m15:05:04.165524 [debug] [MainThread]: 1603: static parser failed on stg_github__label.sql
[0m15:05:04.177413 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__label.sql
[0m15:05:04.179354 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_assignee.sql
[0m15:05:04.189063 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_assignee.sql
[0m15:05:04.190973 [debug] [MainThread]: 1603: static parser failed on stg_github__user.sql
[0m15:05:04.201184 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__user.sql
[0m15:05:04.203109 [debug] [MainThread]: 1603: static parser failed on stg_github__issue.sql
[0m15:05:04.222168 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue.sql
[0m15:05:04.224179 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_closed_history.sql
[0m15:05:04.236264 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_closed_history.sql
[0m15:05:04.238268 [debug] [MainThread]: 1603: static parser failed on stg_github__repository.sql
[0m15:05:04.253624 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__repository.sql
[0m15:05:04.255758 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_label.sql
[0m15:05:04.266180 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_label.sql
[0m15:05:04.268169 [debug] [MainThread]: 1603: static parser failed on stg_github__repo_team.sql
[0m15:05:04.278591 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__repo_team.sql
[0m15:05:04.280445 [debug] [MainThread]: 1603: static parser failed on stg_github__pull_request.sql
[0m15:05:04.298744 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__pull_request.sql
[0m15:05:04.300741 [debug] [MainThread]: 1603: static parser failed on stg_github__team.sql
[0m15:05:04.313972 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__team.sql
[0m15:05:04.315768 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_merged.sql
[0m15:05:04.326799 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_merged.sql
[0m15:05:04.328639 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_comment.sql
[0m15:05:04.342105 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_comment.sql
[0m15:05:04.344104 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__requested_reviewer_history_tmp.sql
[0m15:05:04.350281 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__requested_reviewer_history_tmp.sql
[0m15:05:04.352294 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__team_tmp.sql
[0m15:05:04.358689 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__team_tmp.sql
[0m15:05:04.360627 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__repo_team_tmp.sql
[0m15:05:04.367124 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__repo_team_tmp.sql
[0m15:05:04.368938 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_closed_history_tmp.sql
[0m15:05:04.377670 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_closed_history_tmp.sql
[0m15:05:04.380393 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__repository_tmp.sql
[0m15:05:04.389881 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__repository_tmp.sql
[0m15:05:04.392810 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__pull_request_review_tmp.sql
[0m15:05:04.404413 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__pull_request_review_tmp.sql
[0m15:05:04.407440 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_merged_tmp.sql
[0m15:05:04.417193 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_merged_tmp.sql
[0m15:05:04.420158 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_label_tmp.sql
[0m15:05:04.428647 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_label_tmp.sql
[0m15:05:04.430675 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__label_tmp.sql
[0m15:05:04.437007 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__label_tmp.sql
[0m15:05:04.439062 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__pull_request_tmp.sql
[0m15:05:04.444805 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__pull_request_tmp.sql
[0m15:05:04.446539 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__user_tmp.sql
[0m15:05:04.453325 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__user_tmp.sql
[0m15:05:04.455120 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_tmp.sql
[0m15:05:04.461099 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_tmp.sql
[0m15:05:04.462815 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_assignee_tmp.sql
[0m15:05:04.468553 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_assignee_tmp.sql
[0m15:05:04.470304 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_comment_tmp.sql
[0m15:05:04.475941 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_comment_tmp.sql
[0m15:05:04.596721 [debug] [MainThread]: 1699: static parser successfully parsed github__pull_requests.sql
[0m15:05:04.607432 [debug] [MainThread]: 1603: static parser failed on github__quarterly_metrics.sql
[0m15:05:04.617579 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__quarterly_metrics.sql
[0m15:05:04.619935 [debug] [MainThread]: 1603: static parser failed on github__issues.sql
[0m15:05:04.625662 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__issues.sql
[0m15:05:04.627526 [debug] [MainThread]: 1603: static parser failed on github__weekly_metrics.sql
[0m15:05:04.634483 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__weekly_metrics.sql
[0m15:05:04.636317 [debug] [MainThread]: 1603: static parser failed on github__monthly_metrics.sql
[0m15:05:04.642144 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__monthly_metrics.sql
[0m15:05:04.644067 [debug] [MainThread]: 1603: static parser failed on github__daily_metrics.sql
[0m15:05:04.652767 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__daily_metrics.sql
[0m15:05:04.654962 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_joined.sql
[0m15:05:04.669860 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_joined.sql
[0m15:05:04.673947 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_open_length.sql
[0m15:05:04.690022 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_open_length.sql
[0m15:05:04.692160 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_comments.sql
[0m15:05:04.701495 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_comments.sql
[0m15:05:04.703628 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__pull_request_times.sql
[0m15:05:04.717398 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__pull_request_times.sql
[0m15:05:04.719362 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_labels.sql
[0m15:05:04.728128 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_labels.sql
[0m15:05:04.730128 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_assignees.sql
[0m15:05:04.738195 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_assignees.sql
[0m15:05:04.740443 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_label_joined.sql
[0m15:05:04.747275 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_label_joined.sql
[0m15:05:04.749175 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__pull_request_reviewers.sql
[0m15:05:04.759233 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__pull_request_reviewers.sql
[0m15:05:04.761129 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__repository_teams.sql
[0m15:05:04.770543 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__repository_teams.sql
[0m15:05:05.251673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f2ecb50>]}
[0m15:05:05.367524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f5f6d70>]}
[0m15:05:05.368346 [info ] [MainThread]: Found 52 models, 58 tests, 0 snapshots, 0 analyses, 601 macros, 0 operations, 0 seed files, 19 sources, 0 exposures, 0 metrics, 0 groups
[0m15:05:05.369010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f5f4bb0>]}
[0m15:05:05.374155 [info ] [MainThread]: 
[0m15:05:05.375428 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:05:05.379731 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:05:05.380368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:06.545479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m15:05:06.546170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:06.836612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f5f63b0>]}
[0m15:05:06.837888 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:05:06.838906 [info ] [MainThread]: 
[0m15:05:06.843476 [debug] [Thread-1 (]: Began running node model.dbt_robert.customers
[0m15:05:06.843986 [debug] [Thread-2 (]: Began running node model.dbt_robert.date_scaffold
[0m15:05:06.844634 [info ] [Thread-1 (]: 1 of 43 START sql view model dbt_robert.customers .............................. [RUN]
[0m15:05:06.845586 [info ] [Thread-2 (]: 2 of 43 START sql table model dbt_robert.date_scaffold ......................... [RUN]
[0m15:05:06.846830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.customers)
[0m15:05:06.847758 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.date_scaffold'
[0m15:05:06.848249 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.customers
[0m15:05:06.848777 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.date_scaffold
[0m15:05:06.851396 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.customers"
[0m15:05:06.856448 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:05:06.862243 [debug] [Thread-2 (]: On model.dbt_robert.date_scaffold: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_scaffold"} */


        select 

    datetime_diff(
        cast(cast('2023-01-31' as date) as datetime),
        cast(cast('2023-01-01' as date) as datetime),
        day
    )

  
[0m15:05:06.865306 [debug] [Thread-1 (]: Timing info for model.dbt_robert.customers (compile): 15:05:06.849112 => 15:05:06.864980
[0m15:05:06.865867 [debug] [Thread-1 (]: Began executing node model.dbt_robert.customers
[0m15:05:06.904459 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.customers"
[0m15:05:06.906136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:06.906962 [debug] [Thread-1 (]: On model.dbt_robert.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.customers"} */


  create or replace view `aec-students`.`dbt_robert`.`customers`
  OPTIONS()
  as select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
--I've acceted your change.local
from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5;


[0m15:05:07.945271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:54abcc7f-2e20-4f01-99d7-73280bc3f8a9&page=queryresults
[0m15:05:07.964424 [debug] [Thread-1 (]: Timing info for model.dbt_robert.customers (execute): 15:05:06.866163 => 15:05:07.964160
[0m15:05:07.965389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f62dc30>]}
[0m15:05:07.966181 [info ] [Thread-1 (]: 1 of 43 OK created sql view model dbt_robert.customers ......................... [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m15:05:07.967324 [debug] [Thread-1 (]: Finished running node model.dbt_robert.customers
[0m15:05:07.967898 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m15:05:07.968672 [info ] [Thread-1 (]: 3 of 43 START sql table model dbt_robert.dbtcustomers .......................... [RUN]
[0m15:05:07.969852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.customers, now model.dbt_robert.dbtcustomers)
[0m15:05:07.970335 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m15:05:07.974574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m15:05:07.975497 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 15:05:07.970634 => 15:05:07.975151
[0m15:05:07.975999 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m15:05:07.987674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:08.311217 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4186b552-f8af-4d10-9282-5aadad05108d&page=queryresults
[0m15:05:08.313812 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.date_scaffold"
[0m15:05:08.314999 [debug] [Thread-2 (]: Timing info for model.dbt_robert.date_scaffold (compile): 15:05:06.851732 => 15:05:08.314571
[0m15:05:08.315606 [debug] [Thread-2 (]: Began executing node model.dbt_robert.date_scaffold
[0m15:05:08.350183 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m15:05:08.351251 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m15:05:08.569999 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.date_scaffold"
[0m15:05:08.570964 [debug] [Thread-2 (]: On model.dbt_robert.date_scaffold: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_scaffold"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`date_scaffold`
    
    

    OPTIONS()
    as (
      








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 30
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2023-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2023-01-31' as date)

)

select * from filtered


    );
  
[0m15:05:11.551226 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a5d88f08-f195-45d7-b7a9-7f7c55846468&page=queryresults
[0m15:05:11.554094 [debug] [Thread-2 (]: Timing info for model.dbt_robert.date_scaffold (execute): 15:05:08.315974 => 15:05:11.553872
[0m15:05:11.555038 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f641060>]}
[0m15:05:11.555774 [info ] [Thread-2 (]: 2 of 43 OK created sql table model dbt_robert.date_scaffold .................... [[32mCREATE TABLE (30.0 rows, 0 processed)[0m in 4.71s]
[0m15:05:11.556789 [debug] [Thread-2 (]: Finished running node model.dbt_robert.date_scaffold
[0m15:05:11.557335 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:05:11.558091 [info ] [Thread-2 (]: 4 of 43 START sql table model dbt_robert.dbtcustomers_revenuereport ............ [RUN]
[0m15:05:11.559487 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.date_scaffold, now model.dbt_robert.dbtcustomers_revenuereport)
[0m15:05:11.559949 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m15:05:11.564631 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:05:11.565774 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 15:05:11.560316 => 15:05:11.565378
[0m15:05:11.566213 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m15:05:11.569167 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:11.916201 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:05:11.917533 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at as sold_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category as product_category
,PP.price as amount
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m15:05:12.682340 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c4eea6d2-20f0-4746-a40b-6a6b15f2f05a&page=queryresults
[0m15:05:12.684917 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 15:05:07.976292 => 15:05:12.684696
[0m15:05:12.685811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f5d8280>]}
[0m15:05:12.686545 [info ] [Thread-1 (]: 3 of 43 OK created sql table model dbt_robert.dbtcustomers ..................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 4.72s]
[0m15:05:12.687545 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m15:05:12.688146 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m15:05:12.689075 [info ] [Thread-1 (]: 5 of 43 START sql view model dbt_robert.dbtcustomers_revenuereport_view ........ [RUN]
[0m15:05:12.690243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.dbtcustomers_revenuereport_view)
[0m15:05:12.690719 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport_view
[0m15:05:12.695064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m15:05:12.695953 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (compile): 15:05:12.691104 => 15:05:12.695615
[0m15:05:12.696475 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport_view
[0m15:05:12.701579 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m15:05:12.702535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:12.703295 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport_view: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport_view"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport_view`
  OPTIONS()
  as 

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25;


[0m15:05:13.685123 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:180275f1-5178-4d04-9046-0565a5912d02&page=queryresults
[0m15:05:13.688002 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (execute): 15:05:12.696766 => 15:05:13.687780
[0m15:05:13.688991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f5d8bb0>]}
[0m15:05:13.689788 [info ] [Thread-1 (]: 5 of 43 OK created sql view model dbt_robert.dbtcustomers_revenuereport_view ... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m15:05:13.690855 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m15:05:13.691413 [debug] [Thread-1 (]: Began running node model.dbt_robert.product_price_history
[0m15:05:13.692261 [info ] [Thread-1 (]: 6 of 43 START sql view model dbt_robert.product_price_history .................. [RUN]
[0m15:05:13.693455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport_view, now model.dbt_robert.product_price_history)
[0m15:05:13.693944 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.product_price_history
[0m15:05:13.700167 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.product_price_history"
[0m15:05:13.701066 [debug] [Thread-1 (]: Timing info for model.dbt_robert.product_price_history (compile): 15:05:13.694369 => 15:05:13.700728
[0m15:05:13.701566 [debug] [Thread-1 (]: Began executing node model.dbt_robert.product_price_history
[0m15:05:13.706832 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.product_price_history"
[0m15:05:13.708065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:13.708603 [debug] [Thread-1 (]: On model.dbt_robert.product_price_history: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.product_price_history"} */


  create or replace view `aec-students`.`dbt_robert`.`product_price_history`
  OPTIONS()
  as select 
--test
id,
product_id,
price,
created_at,
ended_at

from analytics-engineers-club.coffee_shop.product_prices;


[0m15:05:14.601235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:493c8a5a-5cff-4aa4-8262-27cc024f8a39&page=queryresults
[0m15:05:14.604968 [debug] [Thread-1 (]: Timing info for model.dbt_robert.product_price_history (execute): 15:05:13.701854 => 15:05:14.604736
[0m15:05:14.605895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f55a4d0>]}
[0m15:05:14.606879 [info ] [Thread-1 (]: 6 of 43 OK created sql view model dbt_robert.product_price_history ............. [[32mCREATE VIEW (0 processed)[0m in 0.91s]
[0m15:05:14.608099 [debug] [Thread-1 (]: Finished running node model.dbt_robert.product_price_history
[0m15:05:14.609198 [debug] [Thread-1 (]: Began running node model.dbt_robert.visitors_sessionization
[0m15:05:14.610011 [info ] [Thread-1 (]: 7 of 43 START sql table model dbt_robert.visitors_sessionization ............... [RUN]
[0m15:05:14.611388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.product_price_history, now model.dbt_robert.visitors_sessionization)
[0m15:05:14.612060 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.visitors_sessionization
[0m15:05:14.625685 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.visitors_sessionization"
[0m15:05:14.626747 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_sessionization (compile): 15:05:14.612513 => 15:05:14.626289
[0m15:05:14.627213 [debug] [Thread-1 (]: Began executing node model.dbt_robert.visitors_sessionization
[0m15:05:14.630294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:14.972084 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.visitors_sessionization"
[0m15:05:14.973166 [debug] [Thread-1 (]: On model.dbt_robert.visitors_sessionization: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.visitors_sessionization"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`visitors_sessionization`
    
    

    OPTIONS()
    as (
      


-- one record per visitor id
with visitors_userstitching as (
    select distinct
        visitor_id,

        first_value(customer_id ignore nulls) over (
            partition by visitor_id
            order by timestamp
            range between unbounded preceding and unbounded following
        ) as first_customer_id,

        min(timestamp) over (
            partition by visitor_id
        ) as first_seen_at,

        max(timestamp) over (
            partition by visitor_id
        ) as last_seen_at


    from `analytics-engineers-club`.`web_tracking`.`pageviews`
)
select
    *,
    first_value(visitor_id) over (
        partition by coalesce(first_customer_id, visitor_id)
        order by first_seen_at
    ) as first_visitor_id
from visitors_userstitching
    );
  
[0m15:05:15.609189 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:85fde13d-a420-41ea-99cd-c9cf3979edde&page=queryresults
[0m15:05:15.612497 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 15:05:11.566498 => 15:05:15.612177
[0m15:05:15.613564 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f3771f0>]}
[0m15:05:15.614556 [info ] [Thread-2 (]: 4 of 43 OK created sql table model dbt_robert.dbtcustomers_revenuereport ....... [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 4.05s]
[0m15:05:15.615577 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:05:15.616140 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_assignee_tmp
[0m15:05:15.617142 [info ] [Thread-2 (]: 8 of 43 START sql view model dbt_robert.stg_github__issue_assignee_tmp ......... [RUN]
[0m15:05:15.618362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.github_source.stg_github__issue_assignee_tmp)
[0m15:05:15.619009 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_assignee_tmp
[0m15:05:15.628188 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_assignee_tmp"
[0m15:05:15.629154 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_assignee_tmp (compile): 15:05:15.619486 => 15:05:15.628899
[0m15:05:15.629607 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_assignee_tmp
[0m15:05:15.635155 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_assignee_tmp"
[0m15:05:15.635954 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:15.636440 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_assignee_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_assignee_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_assignee_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_assignee`;


[0m15:05:16.967020 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0e20c7df-cccd-4783-b02e-25c6206093de&page=queryresults
[0m15:05:16.969600 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_assignee_tmp (execute): 15:05:15.629901 => 15:05:16.969377
[0m15:05:16.970523 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f383a30>]}
[0m15:05:16.971249 [info ] [Thread-2 (]: 8 of 43 OK created sql view model dbt_robert.stg_github__issue_assignee_tmp .... [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m15:05:16.972320 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_assignee_tmp
[0m15:05:16.972906 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_closed_history_tmp
[0m15:05:16.973897 [info ] [Thread-2 (]: 9 of 43 START sql view model dbt_robert.stg_github__issue_closed_history_tmp ... [RUN]
[0m15:05:16.975438 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_assignee_tmp, now model.github_source.stg_github__issue_closed_history_tmp)
[0m15:05:16.975985 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_closed_history_tmp
[0m15:05:16.981016 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_closed_history_tmp"
[0m15:05:16.981751 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_closed_history_tmp (compile): 15:05:16.976492 => 15:05:16.981514
[0m15:05:16.982189 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_closed_history_tmp
[0m15:05:16.986167 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_closed_history_tmp"
[0m15:05:16.986797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:16.987260 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_closed_history_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_closed_history_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_closed_history_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_closed_history`;


[0m15:05:17.928024 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:75cbfd20-0907-4810-81c4-b5d80579b31b&page=queryresults
[0m15:05:17.931019 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_closed_history_tmp (execute): 15:05:16.982476 => 15:05:17.930743
[0m15:05:17.932148 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f55dc60>]}
[0m15:05:17.932893 [info ] [Thread-2 (]: 9 of 43 OK created sql view model dbt_robert.stg_github__issue_closed_history_tmp  [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m15:05:17.934055 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_closed_history_tmp
[0m15:05:17.934597 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_comment_tmp
[0m15:05:17.935707 [info ] [Thread-2 (]: 10 of 43 START sql view model dbt_robert.stg_github__issue_comment_tmp ......... [RUN]
[0m15:05:17.936814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_closed_history_tmp, now model.github_source.stg_github__issue_comment_tmp)
[0m15:05:17.939258 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_comment_tmp
[0m15:05:17.943900 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_comment_tmp"
[0m15:05:17.944642 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_comment_tmp (compile): 15:05:17.939653 => 15:05:17.944405
[0m15:05:17.945084 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_comment_tmp
[0m15:05:17.949025 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_comment_tmp"
[0m15:05:17.949676 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:17.950141 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_comment_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_comment_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_comment_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_comment`;


[0m15:05:18.883080 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4a7b372b-a248-441a-ad5e-7f64e94e2092&page=queryresults
[0m15:05:18.885629 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_comment_tmp (execute): 15:05:17.945372 => 15:05:18.885409
[0m15:05:18.886556 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f373490>]}
[0m15:05:18.887269 [info ] [Thread-2 (]: 10 of 43 OK created sql view model dbt_robert.stg_github__issue_comment_tmp .... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m15:05:18.888240 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_comment_tmp
[0m15:05:18.888802 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_label_tmp
[0m15:05:18.889850 [info ] [Thread-2 (]: 11 of 43 START sql view model dbt_robert.stg_github__issue_label_tmp ........... [RUN]
[0m15:05:18.891091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_comment_tmp, now model.github_source.stg_github__issue_label_tmp)
[0m15:05:18.892055 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_label_tmp
[0m15:05:18.901663 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_label_tmp"
[0m15:05:18.902395 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_label_tmp (compile): 15:05:18.892895 => 15:05:18.902156
[0m15:05:18.902837 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_label_tmp
[0m15:05:18.906751 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_label_tmp"
[0m15:05:18.907384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:18.907851 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_label_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_label_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_label_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_label`;


[0m15:05:19.858714 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d30c27c8-c4ea-40db-8898-b1b71b835620&page=queryresults
[0m15:05:19.861643 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_label_tmp (execute): 15:05:18.903126 => 15:05:19.861417
[0m15:05:19.862564 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f30b820>]}
[0m15:05:19.863335 [info ] [Thread-2 (]: 11 of 43 OK created sql view model dbt_robert.stg_github__issue_label_tmp ...... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m15:05:19.864370 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_label_tmp
[0m15:05:19.864939 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_merged_tmp
[0m15:05:19.866002 [info ] [Thread-2 (]: 12 of 43 START sql view model dbt_robert.stg_github__issue_merged_tmp .......... [RUN]
[0m15:05:19.867106 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_label_tmp, now model.github_source.stg_github__issue_merged_tmp)
[0m15:05:19.867789 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_merged_tmp
[0m15:05:19.876708 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_merged_tmp"
[0m15:05:19.877578 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_merged_tmp (compile): 15:05:19.868212 => 15:05:19.877273
[0m15:05:19.878124 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_merged_tmp
[0m15:05:19.882246 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_merged_tmp"
[0m15:05:19.882921 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:19.883396 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_merged_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_merged_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_merged_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_merged`;


[0m15:05:20.869903 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c0adc6c7-daf9-4651-8024-2cc5b6a0d3f0&page=queryresults
[0m15:05:20.872323 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_merged_tmp (execute): 15:05:19.878431 => 15:05:20.872091
[0m15:05:20.873278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f383a30>]}
[0m15:05:20.874041 [info ] [Thread-2 (]: 12 of 43 OK created sql view model dbt_robert.stg_github__issue_merged_tmp ..... [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m15:05:20.875058 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_merged_tmp
[0m15:05:20.875627 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_tmp
[0m15:05:20.876849 [info ] [Thread-2 (]: 13 of 43 START sql view model dbt_robert.stg_github__issue_tmp ................. [RUN]
[0m15:05:20.877939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_merged_tmp, now model.github_source.stg_github__issue_tmp)
[0m15:05:20.878403 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_tmp
[0m15:05:20.883549 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_tmp"
[0m15:05:20.884286 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_tmp (compile): 15:05:20.878713 => 15:05:20.884046
[0m15:05:20.884761 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_tmp
[0m15:05:20.891877 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_tmp"
[0m15:05:20.892540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:20.893007 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue`;


[0m15:05:21.822651 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a9374604-ba0b-4efb-8183-a5b1563f5f54&page=queryresults
[0m15:05:21.825327 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_tmp (execute): 15:05:20.885048 => 15:05:21.825109
[0m15:05:21.826212 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f18bf10>]}
[0m15:05:21.826929 [info ] [Thread-2 (]: 13 of 43 OK created sql view model dbt_robert.stg_github__issue_tmp ............ [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m15:05:21.827895 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_tmp
[0m15:05:21.828472 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__label_tmp
[0m15:05:21.829637 [info ] [Thread-2 (]: 14 of 43 START sql view model dbt_robert.stg_github__label_tmp ................. [RUN]
[0m15:05:21.830628 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_tmp, now model.github_source.stg_github__label_tmp)
[0m15:05:21.831112 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__label_tmp
[0m15:05:21.837581 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__label_tmp"
[0m15:05:21.838329 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__label_tmp (compile): 15:05:21.831432 => 15:05:21.838090
[0m15:05:21.838773 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__label_tmp
[0m15:05:21.842908 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__label_tmp"
[0m15:05:21.843545 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:21.844008 [debug] [Thread-2 (]: On model.github_source.stg_github__label_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__label_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__label_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`label`;


[0m15:05:22.773737 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0c82c30e-4b88-44a5-b441-cf5bf57e22cf&page=queryresults
[0m15:05:22.776106 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__label_tmp (execute): 15:05:21.839067 => 15:05:22.775882
[0m15:05:22.777055 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f178cd0>]}
[0m15:05:22.777784 [info ] [Thread-2 (]: 14 of 43 OK created sql view model dbt_robert.stg_github__label_tmp ............ [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m15:05:22.778776 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__label_tmp
[0m15:05:22.779383 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__pull_request_review_tmp
[0m15:05:22.780288 [info ] [Thread-2 (]: 15 of 43 START sql view model dbt_robert.stg_github__pull_request_review_tmp ... [RUN]
[0m15:05:22.781633 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__label_tmp, now model.github_source.stg_github__pull_request_review_tmp)
[0m15:05:22.782101 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__pull_request_review_tmp
[0m15:05:22.788697 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__pull_request_review_tmp"
[0m15:05:22.789521 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request_review_tmp (compile): 15:05:22.782520 => 15:05:22.789262
[0m15:05:22.790044 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__pull_request_review_tmp
[0m15:05:22.794298 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__pull_request_review_tmp"
[0m15:05:22.794973 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:22.795454 [debug] [Thread-2 (]: On model.github_source.stg_github__pull_request_review_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_review_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__pull_request_review_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`pull_request_review`;


[0m15:05:23.671460 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e09f947f-5db8-48a5-a79b-725849dc550c&page=queryresults
[0m15:05:23.675602 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request_review_tmp (execute): 15:05:22.790340 => 15:05:23.675202
[0m15:05:23.677387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f178b80>]}
[0m15:05:23.678814 [info ] [Thread-2 (]: 15 of 43 OK created sql view model dbt_robert.stg_github__pull_request_review_tmp  [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m15:05:23.680143 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__pull_request_review_tmp
[0m15:05:23.680740 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__pull_request_tmp
[0m15:05:23.681747 [info ] [Thread-2 (]: 16 of 43 START sql view model dbt_robert.stg_github__pull_request_tmp .......... [RUN]
[0m15:05:23.682760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__pull_request_review_tmp, now model.github_source.stg_github__pull_request_tmp)
[0m15:05:23.683217 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__pull_request_tmp
[0m15:05:23.692318 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__pull_request_tmp"
[0m15:05:23.693483 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request_tmp (compile): 15:05:23.683549 => 15:05:23.693218
[0m15:05:23.693951 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__pull_request_tmp
[0m15:05:23.698056 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__pull_request_tmp"
[0m15:05:23.698796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:23.699285 [debug] [Thread-2 (]: On model.github_source.stg_github__pull_request_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__pull_request_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`pull_request`;


[0m15:05:24.608113 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:91d089a7-e0f1-4ae8-accd-135121705946&page=queryresults
[0m15:05:24.611881 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request_tmp (execute): 15:05:23.694243 => 15:05:24.611494
[0m15:05:24.613304 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f3dea10>]}
[0m15:05:24.615113 [info ] [Thread-2 (]: 16 of 43 OK created sql view model dbt_robert.stg_github__pull_request_tmp ..... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m15:05:24.616780 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__pull_request_tmp
[0m15:05:24.617607 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__repo_team_tmp
[0m15:05:24.619151 [info ] [Thread-2 (]: 17 of 43 START sql view model dbt_robert.stg_github__repo_team_tmp ............. [RUN]
[0m15:05:24.621526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__pull_request_tmp, now model.github_source.stg_github__repo_team_tmp)
[0m15:05:24.622204 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__repo_team_tmp
[0m15:05:24.632936 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__repo_team_tmp"
[0m15:05:24.634127 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__repo_team_tmp (compile): 15:05:24.622712 => 15:05:24.633751
[0m15:05:24.634895 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__repo_team_tmp
[0m15:05:24.642057 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__repo_team_tmp"
[0m15:05:24.643123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:24.643859 [debug] [Thread-2 (]: On model.github_source.stg_github__repo_team_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__repo_team_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__repo_team_tmp`
  OPTIONS()
  as 

select * 
from `analytics-engineers-club`.`github`.`repo_team`;


[0m15:05:25.103137 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__repo_team_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__repo_team_tmp`
  OPTIONS()
  as 

select * 
from `analytics-engineers-club`.`github`.`repo_team`;


[0m15:05:25.103973 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Table analytics-engineers-club:github.repo_team was not found in location US

Location: US
Job ID: 404f792b-27ba-48e1-a70a-cec06ab80e38

[0m15:05:25.104940 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__repo_team_tmp (execute): 15:05:24.635409 => 15:05:25.104628
[0m15:05:25.108901 [debug] [Thread-2 (]: Runtime Error in model stg_github__repo_team_tmp (models/tmp/stg_github__repo_team_tmp.sql)
  404 Not found: Table analytics-engineers-club:github.repo_team was not found in location US
  
  Location: US
  Job ID: 404f792b-27ba-48e1-a70a-cec06ab80e38
  
[0m15:05:25.109567 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f589a50>]}
[0m15:05:25.110401 [error] [Thread-2 (]: 17 of 43 ERROR creating sql view model dbt_robert.stg_github__repo_team_tmp .... [[31mERROR[0m in 0.49s]
[0m15:05:25.111319 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__repo_team_tmp
[0m15:05:25.111900 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__repository_tmp
[0m15:05:25.113041 [info ] [Thread-2 (]: 18 of 43 START sql view model dbt_robert.stg_github__repository_tmp ............ [RUN]
[0m15:05:25.114507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__repo_team_tmp, now model.github_source.stg_github__repository_tmp)
[0m15:05:25.115064 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__repository_tmp
[0m15:05:25.121435 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__repository_tmp"
[0m15:05:25.122175 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__repository_tmp (compile): 15:05:25.115359 => 15:05:25.121936
[0m15:05:25.122617 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__repository_tmp
[0m15:05:25.126632 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__repository_tmp"
[0m15:05:25.127288 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:25.127753 [debug] [Thread-2 (]: On model.github_source.stg_github__repository_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__repository_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__repository_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`repository`;


[0m15:05:26.059953 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:35effe93-3760-4e63-a70e-53930c04b180&page=queryresults
[0m15:05:26.062752 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__repository_tmp (execute): 15:05:25.122905 => 15:05:26.062486
[0m15:05:26.063828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f075e70>]}
[0m15:05:26.064728 [info ] [Thread-2 (]: 18 of 43 OK created sql view model dbt_robert.stg_github__repository_tmp ....... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m15:05:26.065913 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__repository_tmp
[0m15:05:26.066462 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:05:26.067487 [info ] [Thread-2 (]: 19 of 43 START sql view model dbt_robert.stg_github__requested_reviewer_history_tmp  [RUN]
[0m15:05:26.068619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__repository_tmp, now model.github_source.stg_github__requested_reviewer_history_tmp)
[0m15:05:26.069106 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:05:26.074347 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__requested_reviewer_history_tmp"
[0m15:05:26.075107 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__requested_reviewer_history_tmp (compile): 15:05:26.069643 => 15:05:26.074858
[0m15:05:26.075556 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:05:26.079710 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__requested_reviewer_history_tmp"
[0m15:05:26.080410 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:26.080935 [debug] [Thread-2 (]: On model.github_source.stg_github__requested_reviewer_history_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__requested_reviewer_history_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__requested_reviewer_history_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`requested_reviewer_history`;


[0m15:05:27.039615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f11941c0-e051-45d6-b115-983715ee1abe&page=queryresults
[0m15:05:27.042875 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_sessionization (execute): 15:05:14.627518 => 15:05:27.042593
[0m15:05:27.043989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f361cf0>]}
[0m15:05:27.044929 [info ] [Thread-1 (]: 7 of 43 OK created sql table model dbt_robert.visitors_sessionization .......... [[32mCREATE TABLE (1.4m rows, 292.6 MiB processed)[0m in 12.43s]
[0m15:05:27.045928 [debug] [Thread-1 (]: Finished running node model.dbt_robert.visitors_sessionization
[0m15:05:27.046477 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__team_tmp
[0m15:05:27.047263 [info ] [Thread-1 (]: 20 of 43 START sql view model dbt_robert.stg_github__team_tmp .................. [RUN]
[0m15:05:27.048489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.visitors_sessionization, now model.github_source.stg_github__team_tmp)
[0m15:05:27.049092 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__team_tmp
[0m15:05:27.054787 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__team_tmp"
[0m15:05:27.056132 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__team_tmp (compile): 15:05:27.049552 => 15:05:27.055888
[0m15:05:27.057428 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2fc18dca-1c20-40b8-be99-617f2bfe8b52&page=queryresults
[0m15:05:27.057870 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__team_tmp
[0m15:05:27.060643 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__requested_reviewer_history_tmp (execute): 15:05:26.075850 => 15:05:27.060432
[0m15:05:27.065021 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__team_tmp"
[0m15:05:27.065901 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f55b2b0>]}
[0m15:05:27.067340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:27.067963 [debug] [Thread-1 (]: On model.github_source.stg_github__team_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__team_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__team_tmp`
  OPTIONS()
  as 

select * 
from `analytics-engineers-club`.`github`.`team`;


[0m15:05:27.066835 [info ] [Thread-2 (]: 19 of 43 OK created sql view model dbt_robert.stg_github__requested_reviewer_history_tmp  [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m15:05:27.077395 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:05:27.078336 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__user_tmp
[0m15:05:27.079305 [info ] [Thread-2 (]: 21 of 43 START sql view model dbt_robert.stg_github__user_tmp .................. [RUN]
[0m15:05:27.080630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__requested_reviewer_history_tmp, now model.github_source.stg_github__user_tmp)
[0m15:05:27.081314 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__user_tmp
[0m15:05:27.101065 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__user_tmp"
[0m15:05:27.102357 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__user_tmp (compile): 15:05:27.081758 => 15:05:27.101953
[0m15:05:27.103070 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__user_tmp
[0m15:05:27.110191 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__user_tmp"
[0m15:05:27.111356 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:27.112161 [debug] [Thread-2 (]: On model.github_source.stg_github__user_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__user_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__user_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`user`;


[0m15:05:28.102469 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7aaf08e4-24b7-469e-a644-5cb688b92f4f&page=queryresults
[0m15:05:28.105601 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__team_tmp (execute): 15:05:27.060959 => 15:05:28.105322
[0m15:05:28.106742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f18e020>]}
[0m15:05:28.107631 [info ] [Thread-1 (]: 20 of 43 OK created sql view model dbt_robert.stg_github__team_tmp ............. [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m15:05:28.108915 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__team_tmp
[0m15:05:28.109506 [debug] [Thread-1 (]: Began running node model.dbt_robert.coffee_jinja
[0m15:05:28.110512 [info ] [Thread-1 (]: 22 of 43 START sql table model dbt_robert.coffee_jinja ......................... [RUN]
[0m15:05:28.111565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__team_tmp, now model.dbt_robert.coffee_jinja)
[0m15:05:28.112022 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.coffee_jinja
[0m15:05:28.117691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.coffee_jinja"
[0m15:05:28.118599 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (compile): 15:05:28.112436 => 15:05:28.118258
[0m15:05:28.119088 [debug] [Thread-1 (]: Began executing node model.dbt_robert.coffee_jinja
[0m15:05:28.122325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:28.236712 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a5ad214b-d0f0-40c4-b0bd-c52ba22d3e52&page=queryresults
[0m15:05:28.239487 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__user_tmp (execute): 15:05:27.103513 => 15:05:28.239211
[0m15:05:28.240619 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f18c880>]}
[0m15:05:28.241395 [info ] [Thread-2 (]: 21 of 43 OK created sql view model dbt_robert.stg_github__user_tmp ............. [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m15:05:28.242371 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__user_tmp
[0m15:05:28.242956 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_assignee
[0m15:05:28.243992 [info ] [Thread-2 (]: 23 of 43 START sql table model dbt_robert.stg_github__issue_assignee ........... [RUN]
[0m15:05:28.245204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__user_tmp, now model.github_source.stg_github__issue_assignee)
[0m15:05:28.245717 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_assignee
[0m15:05:28.250950 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:28.434549 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.coffee_jinja"
[0m15:05:28.435714 [debug] [Thread-1 (]: On model.dbt_robert.coffee_jinja: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.coffee_jinja"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`coffee_jinja`
    
    

    OPTIONS()
    as (
      


select
  date_trunc(sold_at, month) as date_month,
 -- sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,
 -- sum(case when product_category = 'merch' then amount end) as merch_amount,
 -- sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount


sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,

sum(case when product_category = 'merch' then amount end) as merch_amount,

sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount,


-- you may have to `ref` a different model here, depending on what you've built previously
from `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
group by 1
    );
  
[0m15:05:28.558166 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_assignee"
[0m15:05:28.559123 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_assignee (compile): 15:05:28.246252 => 15:05:28.558822
[0m15:05:28.559633 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_assignee
[0m15:05:28.568024 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_assignee"
[0m15:05:28.568741 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_assignee: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_assignee"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue_assignee`
    
    

    OPTIONS()
    as (
      with issue_assignee as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_assignee_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from issue_assignee

), fields as (

    select 
      issue_id,
      user_id
    from macro
)

select *
from fields
    );
  
[0m15:05:31.280520 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:650f3101-0958-4a30-b542-054bb6dd6da4&page=queryresults
[0m15:05:31.283003 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_assignee (execute): 15:05:28.559935 => 15:05:31.282784
[0m15:05:31.284590 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f10fd60>]}
[0m15:05:31.285224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4bcb1200-5bf1-4ea8-b873-7876380d0ff8&page=queryresults
[0m15:05:31.289569 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (execute): 15:05:28.119380 => 15:05:31.289370
[0m15:05:31.290414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f07e620>]}
[0m15:05:31.798955 [info ] [Thread-2 (]: 23 of 43 OK created sql table model dbt_robert.stg_github__issue_assignee ...... [[32mCREATE TABLE (2.0 rows, 32.0 Bytes processed)[0m in 3.04s]
[0m15:05:31.800034 [info ] [Thread-1 (]: 22 of 43 OK created sql table model dbt_robert.coffee_jinja .................... [[32mCREATE TABLE (5.0 rows, 661.0 Bytes processed)[0m in 3.18s]
[0m15:05:31.801813 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_assignee
[0m15:05:31.802704 [debug] [Thread-1 (]: Finished running node model.dbt_robert.coffee_jinja
[0m15:05:31.803332 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_closed_history
[0m15:05:31.804120 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__issue_comment
[0m15:05:31.804871 [info ] [Thread-2 (]: 24 of 43 START sql table model dbt_robert.stg_github__issue_closed_history ..... [RUN]
[0m15:05:31.805883 [info ] [Thread-1 (]: 25 of 43 START sql table model dbt_robert.stg_github__issue_comment ............ [RUN]
[0m15:05:31.807427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_assignee, now model.github_source.stg_github__issue_closed_history)
[0m15:05:31.808269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.coffee_jinja, now model.github_source.stg_github__issue_comment)
[0m15:05:31.808834 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_closed_history
[0m15:05:31.809339 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__issue_comment
[0m15:05:31.814775 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:31.819375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:32.258508 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_closed_history"
[0m15:05:32.259641 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_closed_history (compile): 15:05:31.809698 => 15:05:32.259282
[0m15:05:32.260251 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_closed_history
[0m15:05:32.265191 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_closed_history"
[0m15:05:32.265837 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_closed_history: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_closed_history"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue_closed_history`
    
    

    OPTIONS()
    as (
      with issue_closed_history as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_closed_history_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    actor_id
    
 as 
    
    actor_id
    
, 
    
    
    closed
    
 as 
    
    closed
    
, 
    
    
    commit_sha
    
 as 
    
    commit_sha
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    updated_at
    
 as 
    
    updated_at
    




    from issue_closed_history

), fields as (

    select 
      issue_id,
      cast(updated_at as TIMESTAMP) as updated_at,
      closed as is_closed

    from macro
)

select *
from fields
    );
  
[0m15:05:32.351518 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__issue_comment"
[0m15:05:32.352704 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__issue_comment (compile): 15:05:31.815203 => 15:05:32.352309
[0m15:05:32.353225 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__issue_comment
[0m15:05:32.357670 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__issue_comment"
[0m15:05:32.358366 [debug] [Thread-1 (]: On model.github_source.stg_github__issue_comment: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_comment"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue_comment`
    
    

    OPTIONS()
    as (
      with issue_comment as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_comment_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    body
    
 as 
    
    body
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    updated_at
    
 as 
    
    updated_at
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from issue_comment

), fields as (

    select 
      id as issue_comment_id,
      issue_id,
      user_id

    from macro
)

select *
from fields
    );
  
[0m15:05:34.762397 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7f7f6e29-527c-4467-badd-54e9c5f21f05&page=queryresults
[0m15:05:34.764788 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_closed_history (execute): 15:05:32.260669 => 15:05:34.764564
[0m15:05:34.765676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f5dac80>]}
[0m15:05:34.766443 [info ] [Thread-2 (]: 24 of 43 OK created sql table model dbt_robert.stg_github__issue_closed_history  [[32mCREATE TABLE (70.0 rows, 1.2 KiB processed)[0m in 2.96s]
[0m15:05:34.767440 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_closed_history
[0m15:05:34.768013 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_label
[0m15:05:34.768890 [info ] [Thread-2 (]: 26 of 43 START sql table model dbt_robert.stg_github__issue_label .............. [RUN]
[0m15:05:34.770007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_closed_history, now model.github_source.stg_github__issue_label)
[0m15:05:34.770469 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_label
[0m15:05:34.780078 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:35.077345 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_label"
[0m15:05:35.078319 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_label (compile): 15:05:34.770811 => 15:05:35.078028
[0m15:05:35.078826 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_label
[0m15:05:35.083186 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_label"
[0m15:05:35.083839 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_label: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_label"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue_label`
    
    

    OPTIONS()
    as (
      with issue_label as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_label_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    label_id
    
 as 
    
    label_id
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    




    from issue_label

), fields as (

    select 
      issue_id,
      label_id
    from macro
)

select *
from fields
    );
  
[0m15:05:35.173567 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d2e79260-4ffd-49d9-94aa-ce807b539fac&page=queryresults
[0m15:05:35.176502 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__issue_comment (execute): 15:05:32.353535 => 15:05:35.176235
[0m15:05:35.177450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f13bd90>]}
[0m15:05:35.178254 [info ] [Thread-1 (]: 25 of 43 OK created sql table model dbt_robert.stg_github__issue_comment ....... [[32mCREATE TABLE (12.0 rows, 288.0 Bytes processed)[0m in 3.37s]
[0m15:05:35.179266 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__issue_comment
[0m15:05:35.179817 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__issue_merged
[0m15:05:35.180906 [info ] [Thread-1 (]: 27 of 43 START sql table model dbt_robert.stg_github__issue_merged ............. [RUN]
[0m15:05:35.181940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_comment, now model.github_source.stg_github__issue_merged)
[0m15:05:35.182402 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__issue_merged
[0m15:05:35.187766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:35.481872 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__issue_merged"
[0m15:05:35.482989 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__issue_merged (compile): 15:05:35.182746 => 15:05:35.482635
[0m15:05:35.483595 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__issue_merged
[0m15:05:35.488229 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__issue_merged"
[0m15:05:35.488901 [debug] [Thread-1 (]: On model.github_source.stg_github__issue_merged: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_merged"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue_merged`
    
    

    OPTIONS()
    as (
      with issue_merged as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_merged_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    actor_id
    
 as 
    
    actor_id
    
, 
    
    
    commit_sha
    
 as 
    
    commit_sha
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    merged_at
    
 as 
    
    merged_at
    




    from issue_merged

), fields as (

    select 
      issue_id,
      cast(merged_at as TIMESTAMP) as merged_at

    from macro
)

select *
from fields
    );
  
[0m15:05:37.552963 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ef0ec8c4-c85a-4bfb-ae4f-aa7d9668f591&page=queryresults
[0m15:05:37.555701 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_label (execute): 15:05:35.079125 => 15:05:37.555426
[0m15:05:37.556807 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f0e0790>]}
[0m15:05:37.557694 [info ] [Thread-2 (]: 26 of 43 OK created sql table model dbt_robert.stg_github__issue_label ......... [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 2.79s]
[0m15:05:37.558988 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_label
[0m15:05:37.559682 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue
[0m15:05:37.560467 [info ] [Thread-2 (]: 28 of 43 START sql table model dbt_robert.stg_github__issue .................... [RUN]
[0m15:05:37.561874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_label, now model.github_source.stg_github__issue)
[0m15:05:37.562456 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue
[0m15:05:37.571295 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:37.891731 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue"
[0m15:05:37.892756 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue (compile): 15:05:37.562869 => 15:05:37.892456
[0m15:05:37.893262 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue
[0m15:05:37.897817 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue"
[0m15:05:37.898528 [debug] [Thread-2 (]: On model.github_source.stg_github__issue: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue`
    
    

    OPTIONS()
    as (
      with issue as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    body
    
 as 
    
    body
    
, 
    
    
    closed_at
    
 as 
    
    closed_at
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    locked
    
 as 
    
    locked
    
, 
    
    
    milestone_id
    
 as 
    
    milestone_id
    
, 
    
    
    number
    
 as 
    
    number
    
, 
    
    
    pull_request
    
 as 
    
    pull_request
    
, 
    
    
    repository_id
    
 as 
    
    repository_id
    
, 
    
    
    state
    
 as 
    
    state
    
, 
    
    
    title
    
 as 
    
    title
    
, 
    
    
    updated_at
    
 as 
    
    updated_at
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from issue 

), fields as (

    select 
      id as issue_id,
      body,
      cast(closed_at as TIMESTAMP) as closed_at,
      cast(created_at as TIMESTAMP) as created_at,
      locked as is_locked,
      milestone_id,
      number as issue_number,
      pull_request as is_pull_request,
      repository_id,
      state,
      title,
      cast(updated_at as TIMESTAMP) as updated_at,
      user_id
      
    from macro
)

select *
from fields
    );
  
[0m15:05:38.212472 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:06a25390-c52e-4966-867b-90cdb7623484&page=queryresults
[0m15:05:38.214883 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__issue_merged (execute): 15:05:35.483961 => 15:05:38.214655
[0m15:05:38.215855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f164e20>]}
[0m15:05:38.216649 [info ] [Thread-1 (]: 27 of 43 OK created sql table model dbt_robert.stg_github__issue_merged ........ [[32mCREATE TABLE (69.0 rows, 1.1 KiB processed)[0m in 3.03s]
[0m15:05:38.217753 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__issue_merged
[0m15:05:38.218311 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__label
[0m15:05:38.219274 [info ] [Thread-1 (]: 29 of 43 START sql table model dbt_robert.stg_github__label .................... [RUN]
[0m15:05:38.220398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_merged, now model.github_source.stg_github__label)
[0m15:05:38.220905 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__label
[0m15:05:38.226260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:38.551993 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__label"
[0m15:05:38.552972 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__label (compile): 15:05:38.221287 => 15:05:38.552683
[0m15:05:38.553467 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__label
[0m15:05:38.557731 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__label"
[0m15:05:38.558370 [debug] [Thread-1 (]: On model.github_source.stg_github__label: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__label"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__label`
    
    

    OPTIONS()
    as (
      with issue_label as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__label_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    color
    
 as 
    
    color
    
, 
    
    
    description
    
 as 
    
    description
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    is_default
    
 as 
    
    is_default
    
, 
    
    
    name
    
 as 
    
    name
    
, 
    
    
    url
    
 as 
    
    url
    




    from issue_label

), fields as (

    select 
        id as label_id,
        _fivetran_synced,	
        color,
        description,
        is_default,
        name as label,
        url
    from macro
)

select *
from fields
    );
  
[0m15:05:40.596655 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:29447dd8-d100-4dff-8557-78a930a6220e&page=queryresults
[0m15:05:40.599388 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue (execute): 15:05:37.893565 => 15:05:40.599114
[0m15:05:40.600399 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f0e0790>]}
[0m15:05:40.601129 [info ] [Thread-2 (]: 28 of 43 OK created sql table model dbt_robert.stg_github__issue ............... [[32mCREATE TABLE (79.0 rows, 15.3 KiB processed)[0m in 3.04s]
[0m15:05:40.602111 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue
[0m15:05:40.602689 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__pull_request_review
[0m15:05:40.603706 [info ] [Thread-2 (]: 30 of 43 START sql table model dbt_robert.stg_github__pull_request_review ...... [RUN]
[0m15:05:40.604831 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue, now model.github_source.stg_github__pull_request_review)
[0m15:05:40.605298 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__pull_request_review
[0m15:05:40.610635 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:40.756293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:54304ad7-069c-47df-8b29-60389d1b3f13&page=queryresults
[0m15:05:40.758531 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__label (execute): 15:05:38.553764 => 15:05:40.758318
[0m15:05:40.759404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89c7b7bb0>]}
[0m15:05:40.760117 [info ] [Thread-1 (]: 29 of 43 OK created sql table model dbt_robert.stg_github__label ............... [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 2.54s]
[0m15:05:40.761223 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__label
[0m15:05:40.761910 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__pull_request
[0m15:05:40.762725 [info ] [Thread-1 (]: 31 of 43 START sql table model dbt_robert.stg_github__pull_request ............. [RUN]
[0m15:05:40.764141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__label, now model.github_source.stg_github__pull_request)
[0m15:05:40.764654 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__pull_request
[0m15:05:40.856100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:40.913294 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__pull_request_review"
[0m15:05:40.914726 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request_review (compile): 15:05:40.605615 => 15:05:40.914297
[0m15:05:40.915529 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__pull_request_review
[0m15:05:40.922927 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__pull_request_review"
[0m15:05:40.924061 [debug] [Thread-2 (]: On model.github_source.stg_github__pull_request_review: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_review"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__pull_request_review`
    
    

    OPTIONS()
    as (
      with pull_request_review as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request_review_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    body
    
 as 
    
    body
    
, 
    
    
    commit_sha
    
 as 
    
    commit_sha
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    pull_request_id
    
 as 
    
    pull_request_id
    
, 
    
    
    state
    
 as 
    
    state
    
, 
    
    
    submitted_at
    
 as 
    
    submitted_at
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from pull_request_review

), fields as (

    select 
      id as pull_request_review_id,
      pull_request_id,
      cast(submitted_at as TIMESTAMP) as submitted_at,
      state,
      user_id

    from macro
)

select *
from fields
    );
  
[0m15:05:41.192507 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__pull_request"
[0m15:05:41.193466 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__pull_request (compile): 15:05:40.764972 => 15:05:41.193173
[0m15:05:41.193961 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__pull_request
[0m15:05:41.198393 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__pull_request"
[0m15:05:41.199142 [debug] [Thread-1 (]: On model.github_source.stg_github__pull_request: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__pull_request`
    
    

    OPTIONS()
    as (
      with pull_request as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    base_label
    
 as 
    
    base_label
    
, 
    
    
    base_ref
    
 as 
    
    base_ref
    
, 
    
    
    base_repo_id
    
 as 
    
    base_repo_id
    
, 
    
    
    base_sha
    
 as 
    
    base_sha
    
, 
    
    
    base_user_id
    
 as 
    
    base_user_id
    
, 
    
    
    head_label
    
 as 
    
    head_label
    
, 
    
    
    head_ref
    
 as 
    
    head_ref
    
, 
    
    
    head_repo_id
    
 as 
    
    head_repo_id
    
, 
    
    
    head_sha
    
 as 
    
    head_sha
    
, 
    
    
    head_user_id
    
 as 
    
    head_user_id
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    merge_commit_sha
    
 as 
    
    merge_commit_sha
    




    from pull_request

), fields as (

    select 
      id as pull_request_id,
      issue_id,
      head_repo_id,
      head_user_id

    from macro
)

select *
from fields
    );
  
[0m15:05:43.665580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0ced6dd5-8758-4f1b-9456-819bf3a2764f&page=queryresults
[0m15:05:43.667851 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__pull_request (execute): 15:05:41.194257 => 15:05:43.667633
[0m15:05:43.668768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f10c520>]}
[0m15:05:43.669497 [info ] [Thread-1 (]: 31 of 43 OK created sql table model dbt_robert.stg_github__pull_request ........ [[32mCREATE TABLE (79.0 rows, 2.5 KiB processed)[0m in 2.90s]
[0m15:05:43.670967 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__pull_request
[0m15:05:43.671514 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__repo_team
[0m15:05:43.672104 [info ] [Thread-1 (]: 32 of 43 SKIP relation dbt_robert.stg_github__repo_team ........................ [[33mSKIP[0m]
[0m15:05:43.673359 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__repo_team
[0m15:05:43.673873 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__repository
[0m15:05:43.674728 [info ] [Thread-1 (]: 33 of 43 START sql table model dbt_robert.stg_github__repository ............... [RUN]
[0m15:05:43.676048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__pull_request, now model.github_source.stg_github__repository)
[0m15:05:43.676587 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__repository
[0m15:05:43.681628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:43.696170 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0b7e6089-7e4d-4705-a9d6-e76b32f76fed&page=queryresults
[0m15:05:43.699574 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request_review (execute): 15:05:40.916067 => 15:05:43.699242
[0m15:05:43.700942 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f18e110>]}
[0m15:05:43.702038 [info ] [Thread-2 (]: 30 of 43 OK created sql table model dbt_robert.stg_github__pull_request_review . [[32mCREATE TABLE (48.0 rows, 2.0 KiB processed)[0m in 3.10s]
[0m15:05:43.704546 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__pull_request_review
[0m15:05:43.706228 [debug] [Thread-2 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m15:05:43.707165 [info ] [Thread-2 (]: 34 of 43 START sql table model dbt_robert.pageviews_userstitching .............. [RUN]
[0m15:05:43.708430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__pull_request_review, now model.dbt_robert.pageviews_userstitching)
[0m15:05:43.709085 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m15:05:43.720032 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m15:05:43.721150 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 15:05:43.709523 => 15:05:43.720795
[0m15:05:43.721789 [debug] [Thread-2 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m15:05:43.726875 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:05:44.087291 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__repository"
[0m15:05:44.088360 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__repository (compile): 15:05:43.676942 => 15:05:44.088033
[0m15:05:44.088903 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__repository
[0m15:05:44.093408 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__repository"
[0m15:05:44.094123 [debug] [Thread-1 (]: On model.github_source.stg_github__repository: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__repository"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__repository`
    
    

    OPTIONS()
    as (
      with repository as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__repository_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    archived
    
 as 
    
    archived
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    default_branch
    
 as 
    
    default_branch
    
, 
    
    
    description
    
 as 
    
    description
    
, 
    
    
    fork
    
 as 
    
    fork
    
, 
    
    
    full_name
    
 as 
    
    full_name
    
, 
    
    
    homepage
    
 as 
    
    homepage
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    language
    
 as 
    
    language
    
, 
    
    
    name
    
 as 
    
    name
    
, 
    
    
    owner_id
    
 as 
    
    owner_id
    
, 
    
    
    private
    
 as 
    
    private
    




    from repository

), fields as (

    select 
      id as repository_id,
      full_name,
      private as is_private

    from macro
)

select *
from fields
    );
  
[0m15:05:44.110108 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m15:05:44.111106 [debug] [Thread-2 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

-- SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`

with pageviews as (
    select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
),

visitors as (
    select * from `aec-students`.`dbt_robert`.`visitors_sessionization`
),

joined as (
    select
        pageviews.*,
        -- customer id if we have it, else visitor id
        coalesce(
            visitors.first_customer_id,
            pageviews.visitor_id
        ) as blended_user_id,

        visitors.first_visitor_id

    from pageviews
    left join visitors
        on pageviews.visitor_id = visitors.visitor_id
)

select * from joined
    );
  
[0m15:05:46.530886 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:399f0d3a-ccd2-4c91-9d24-457fb4d7f56c&page=queryresults
[0m15:05:46.533727 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__repository (execute): 15:05:44.089208 => 15:05:46.533450
[0m15:05:46.534872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f5ac280>]}
[0m15:05:46.535798 [info ] [Thread-1 (]: 33 of 43 OK created sql table model dbt_robert.stg_github__repository .......... [[32mCREATE TABLE (16.0 rows, 792.0 Bytes processed)[0m in 2.86s]
[0m15:05:46.537227 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__repository
[0m15:05:46.538202 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__requested_reviewer_history
[0m15:05:46.539231 [info ] [Thread-1 (]: 35 of 43 START sql table model dbt_robert.stg_github__requested_reviewer_history  [RUN]
[0m15:05:46.540630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__repository, now model.github_source.stg_github__requested_reviewer_history)
[0m15:05:46.541232 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__requested_reviewer_history
[0m15:05:46.546648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:46.817545 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__requested_reviewer_history"
[0m15:05:46.818524 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__requested_reviewer_history (compile): 15:05:46.541738 => 15:05:46.818236
[0m15:05:46.819026 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__requested_reviewer_history
[0m15:05:46.824728 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__requested_reviewer_history"
[0m15:05:46.825418 [debug] [Thread-1 (]: On model.github_source.stg_github__requested_reviewer_history: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__requested_reviewer_history"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__requested_reviewer_history`
    
    

    OPTIONS()
    as (
      with requested_reviewer_history as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__requested_reviewer_history_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    actor_id
    
 as 
    
    actor_id
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    pull_request_id
    
 as 
    
    pull_request_id
    
, 
    
    
    removed
    
 as 
    
    removed
    
, 
    
    
    requested_id
    
 as 
    
    requested_id
    




    from requested_reviewer_history

), fields as (

    select 
      pull_request_id,
      cast(created_at as TIMESTAMP) as created_at,
      requested_id,
      removed

    from macro
)

select *
from fields
    );
  
[0m15:05:51.352250 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:dd092354-55a0-4d0f-93cd-bce8be36326e&page=queryresults
[0m15:05:51.354632 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__requested_reviewer_history (execute): 15:05:46.819333 => 15:05:51.354404
[0m15:05:51.355651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f5af190>]}
[0m15:05:51.356492 [info ] [Thread-1 (]: 35 of 43 OK created sql table model dbt_robert.stg_github__requested_reviewer_history  [[32mCREATE TABLE (26.0 rows, 650.0 Bytes processed)[0m in 4.82s]
[0m15:05:51.357539 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__requested_reviewer_history
[0m15:05:51.358176 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__team
[0m15:05:51.359544 [info ] [Thread-1 (]: 36 of 43 START sql table model dbt_robert.stg_github__team ..................... [RUN]
[0m15:05:51.360593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__requested_reviewer_history, now model.github_source.stg_github__team)
[0m15:05:51.361071 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__team
[0m15:05:51.367072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:51.656675 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__team"
[0m15:05:51.657850 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__team (compile): 15:05:51.361369 => 15:05:51.657479
[0m15:05:51.658517 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__team
[0m15:05:51.663083 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__team"
[0m15:05:51.663760 [debug] [Thread-1 (]: On model.github_source.stg_github__team: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__team"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__team`
    
    

    OPTIONS()
    as (
      

with base as (

    select * 
    from `aec-students`.`dbt_robert`.`stg_github__team_tmp`

),

fields as (

    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    description
    
 as 
    
    description
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    name
    
 as 
    
    name
    
, 
    
    
    org_id
    
 as 
    
    org_id
    
, 
    
    
    parent_id
    
 as 
    
    parent_id
    
, 
    
    
    privacy
    
 as 
    
    privacy
    
, 
    
    
    slug
    
 as 
    
    slug
    



        
    from base
    
), final as (
    
    select 
        id as team_id,
        description,
        name,
        parent_id,
        privacy,
        slug
    from fields
)

select * 
from final
    );
  
[0m15:05:54.450201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d61fea58-267c-4327-9201-0a02073d43ff&page=queryresults
[0m15:05:54.453081 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__team (execute): 15:05:51.658965 => 15:05:54.452802
[0m15:05:54.454258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89c7b7bb0>]}
[0m15:05:54.455239 [info ] [Thread-1 (]: 36 of 43 OK created sql table model dbt_robert.stg_github__team ................ [[32mCREATE TABLE (2.0 rows, 94.0 Bytes processed)[0m in 3.09s]
[0m15:05:54.456558 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__team
[0m15:05:54.457124 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__user
[0m15:05:54.458145 [info ] [Thread-1 (]: 37 of 43 START sql table model dbt_robert.stg_github__user ..................... [RUN]
[0m15:05:54.459610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__team, now model.github_source.stg_github__user)
[0m15:05:54.460073 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__user
[0m15:05:54.465357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:54.779563 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__user"
[0m15:05:54.780610 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__user (compile): 15:05:54.460397 => 15:05:54.780272
[0m15:05:54.781123 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__user
[0m15:05:54.785634 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__user"
[0m15:05:54.786345 [debug] [Thread-1 (]: On model.github_source.stg_github__user: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__user"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__user`
    
    

    OPTIONS()
    as (
      with github_user as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__user_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    company
    
 as 
    
    company
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    login
    
 as 
    
    login
    
, 
    
    
    name
    
 as 
    
    name
    



        
        
    from github_user

), fields as (

    select
      id as user_id,
      login as login_name,
      name,
      company

    from macro
)

select *
from fields
    );
  
[0m15:06:04.259432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fa3fdda3-5eb0-48cf-a10c-191bf67ba49d&page=queryresults
[0m15:06:04.262234 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__user (execute): 15:05:54.781429 => 15:06:04.261956
[0m15:06:04.263353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f5ade70>]}
[0m15:06:04.264285 [info ] [Thread-1 (]: 37 of 43 OK created sql table model dbt_robert.stg_github__user ................ [[32mCREATE TABLE (13.0 rows, 438.0 Bytes processed)[0m in 9.80s]
[0m15:06:04.265486 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__user
[0m15:06:04.266047 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_comments
[0m15:06:04.267280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__user, now model.github.int_github__issue_comments)
[0m15:06:04.267777 [debug] [Thread-1 (]: Began compiling node model.github.int_github__issue_comments
[0m15:06:04.272640 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__issue_comments"
[0m15:06:04.273539 [debug] [Thread-1 (]: Timing info for model.github.int_github__issue_comments (compile): 15:06:04.268071 => 15:06:04.273302
[0m15:06:04.274458 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_comments
[0m15:06:04.274961 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_open_length
[0m15:06:04.275758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__issue_comments, now model.github.int_github__issue_open_length)
[0m15:06:04.276209 [debug] [Thread-1 (]: Began compiling node model.github.int_github__issue_open_length
[0m15:06:04.284611 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__issue_open_length"
[0m15:06:04.285860 [debug] [Thread-1 (]: Timing info for model.github.int_github__issue_open_length (compile): 15:06:04.276534 => 15:06:04.285334
[0m15:06:04.287218 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_open_length
[0m15:06:04.287934 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_label_joined
[0m15:06:04.289071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__issue_open_length, now model.github.int_github__issue_label_joined)
[0m15:06:04.290294 [debug] [Thread-1 (]: Began compiling node model.github.int_github__issue_label_joined
[0m15:06:04.299517 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__issue_label_joined"
[0m15:06:04.300723 [debug] [Thread-1 (]: Timing info for model.github.int_github__issue_label_joined (compile): 15:06:04.290811 => 15:06:04.300307
[0m15:06:04.302248 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_label_joined
[0m15:06:04.303021 [debug] [Thread-1 (]: Began running node model.github.int_github__pull_request_times
[0m15:06:04.304619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__issue_label_joined, now model.github.int_github__pull_request_times)
[0m15:06:04.305304 [debug] [Thread-1 (]: Began compiling node model.github.int_github__pull_request_times
[0m15:06:04.323083 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__pull_request_times"
[0m15:06:04.323983 [debug] [Thread-1 (]: Timing info for model.github.int_github__pull_request_times (compile): 15:06:04.305723 => 15:06:04.323702
[0m15:06:04.325000 [debug] [Thread-1 (]: Finished running node model.github.int_github__pull_request_times
[0m15:06:04.325533 [debug] [Thread-1 (]: Began running node model.github.int_github__repository_teams
[0m15:06:04.326149 [debug] [Thread-1 (]: Finished running node model.github.int_github__repository_teams
[0m15:06:04.326656 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_assignees
[0m15:06:04.327448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__pull_request_times, now model.github.int_github__issue_assignees)
[0m15:06:04.328078 [debug] [Thread-1 (]: Began compiling node model.github.int_github__issue_assignees
[0m15:06:04.334751 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__issue_assignees"
[0m15:06:04.335548 [debug] [Thread-1 (]: Timing info for model.github.int_github__issue_assignees (compile): 15:06:04.328552 => 15:06:04.335261
[0m15:06:04.336826 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_assignees
[0m15:06:04.337337 [debug] [Thread-1 (]: Began running node model.github.int_github__pull_request_reviewers
[0m15:06:04.338140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__issue_assignees, now model.github.int_github__pull_request_reviewers)
[0m15:06:04.338615 [debug] [Thread-1 (]: Began compiling node model.github.int_github__pull_request_reviewers
[0m15:06:04.348896 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__pull_request_reviewers"
[0m15:06:04.349721 [debug] [Thread-1 (]: Timing info for model.github.int_github__pull_request_reviewers (compile): 15:06:04.338948 => 15:06:04.349466
[0m15:06:04.350681 [debug] [Thread-1 (]: Finished running node model.github.int_github__pull_request_reviewers
[0m15:06:04.351193 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_labels
[0m15:06:04.352002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__pull_request_reviewers, now model.github.int_github__issue_labels)
[0m15:06:04.352476 [debug] [Thread-1 (]: Began compiling node model.github.int_github__issue_labels
[0m15:06:04.363710 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__issue_labels"
[0m15:06:04.364570 [debug] [Thread-1 (]: Timing info for model.github.int_github__issue_labels (compile): 15:06:04.352769 => 15:06:04.364274
[0m15:06:04.365558 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_labels
[0m15:06:04.366296 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_joined
[0m15:06:04.366796 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_joined
[0m15:06:04.367511 [debug] [Thread-1 (]: Began running node model.github.github__issues
[0m15:06:04.367998 [info ] [Thread-1 (]: 38 of 43 SKIP relation dbt_robert.github__issues ............................... [[33mSKIP[0m]
[0m15:06:04.368731 [debug] [Thread-1 (]: Finished running node model.github.github__issues
[0m15:06:04.369320 [debug] [Thread-1 (]: Began running node model.github.github__pull_requests
[0m15:06:04.369894 [info ] [Thread-1 (]: 39 of 43 SKIP relation dbt_robert.github__pull_requests ........................ [[33mSKIP[0m]
[0m15:06:04.370702 [debug] [Thread-1 (]: Finished running node model.github.github__pull_requests
[0m15:06:04.371506 [debug] [Thread-1 (]: Began running node model.github.github__daily_metrics
[0m15:06:04.371985 [info ] [Thread-1 (]: 40 of 43 SKIP relation dbt_robert.github__daily_metrics ........................ [[33mSKIP[0m]
[0m15:06:04.372831 [debug] [Thread-1 (]: Finished running node model.github.github__daily_metrics
[0m15:06:04.373691 [debug] [Thread-1 (]: Began running node model.github.github__monthly_metrics
[0m15:06:04.374228 [info ] [Thread-1 (]: 41 of 43 SKIP relation dbt_robert.github__monthly_metrics ...................... [[33mSKIP[0m]
[0m15:06:04.375173 [debug] [Thread-1 (]: Finished running node model.github.github__monthly_metrics
[0m15:06:04.375682 [debug] [Thread-1 (]: Began running node model.github.github__quarterly_metrics
[0m15:06:04.376320 [info ] [Thread-1 (]: 42 of 43 SKIP relation dbt_robert.github__quarterly_metrics .................... [[33mSKIP[0m]
[0m15:06:04.377216 [debug] [Thread-1 (]: Finished running node model.github.github__quarterly_metrics
[0m15:06:04.377744 [debug] [Thread-1 (]: Began running node model.github.github__weekly_metrics
[0m15:06:04.378533 [info ] [Thread-1 (]: 43 of 43 SKIP relation dbt_robert.github__weekly_metrics ....................... [[33mSKIP[0m]
[0m15:06:04.379355 [debug] [Thread-1 (]: Finished running node model.github.github__weekly_metrics
[0m15:06:33.914166 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:75493751-d1fa-48ec-9438-4ca3510b7da2&page=queryresults
[0m15:06:33.917734 [debug] [Thread-2 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 15:05:43.722233 => 15:06:33.917462
[0m15:06:33.918798 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcb659b-971f-4e57-81c5-300f7b9968b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f5af130>]}
[0m15:06:33.919688 [info ] [Thread-2 (]: 34 of 43 OK created sql table model dbt_robert.pageviews_userstitching ......... [[32mCREATE TABLE (5.8m rows, 719.6 MiB processed)[0m in 50.21s]
[0m15:06:33.921093 [debug] [Thread-2 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m15:06:33.923764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:33.924212 [debug] [MainThread]: Connection 'model.github.int_github__issue_labels' was properly closed.
[0m15:06:33.924592 [debug] [MainThread]: Connection 'model.dbt_robert.pageviews_userstitching' was properly closed.
[0m15:06:33.925178 [info ] [MainThread]: 
[0m15:06:33.925767 [info ] [MainThread]: Finished running 17 view models, 26 table models in 0 hours 1 minutes and 28.55 seconds (88.55s).
[0m15:06:33.932507 [debug] [MainThread]: Command end result
[0m15:06:33.954631 [info ] [MainThread]: 
[0m15:06:33.955510 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:06:33.956189 [info ] [MainThread]: 
[0m15:06:33.956863 [error] [MainThread]: [33mRuntime Error in model stg_github__repo_team_tmp (models/tmp/stg_github__repo_team_tmp.sql)[0m
[0m15:06:33.957421 [error] [MainThread]:   404 Not found: Table analytics-engineers-club:github.repo_team was not found in location US
[0m15:06:33.958398 [error] [MainThread]:   
[0m15:06:33.958939 [error] [MainThread]:   Location: US
[0m15:06:33.959479 [error] [MainThread]:   Job ID: 404f792b-27ba-48e1-a70a-cec06ab80e38
[0m15:06:33.960421 [error] [MainThread]:   
[0m15:06:33.961049 [info ] [MainThread]: 
[0m15:06:33.961675 [info ] [MainThread]: Done. PASS=35 WARN=0 ERROR=1 SKIP=7 TOTAL=43
[0m15:06:33.963160 [debug] [MainThread]: Command `dbt run` failed at 15:06:33.962963 after 91.95 seconds
[0m15:06:33.963759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a283a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89fcb1300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89f18bf10>]}
[0m15:06:33.964231 [debug] [MainThread]: Flushing usage events
[0m15:07:22.738749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d215763e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d2080a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d2080a440>]}


============================== 15:07:22.741452 | b0ef1270-1b64-444e-9240-9ec881054295 ==============================
[0m15:07:22.741452 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:07:22.742265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/vscode/dbt_robert_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:07:23.183186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0ef1270-1b64-444e-9240-9ec881054295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d21323730>]}
[0m15:07:23.201687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0ef1270-1b64-444e-9240-9ec881054295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e9e1cf0>]}
[0m15:07:23.202682 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:07:23.259565 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:07:23.283919 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:07:23.284762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0ef1270-1b64-444e-9240-9ec881054295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e9e0550>]}
[0m15:07:24.840561 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m15:07:24.854700 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport_view.sql
[0m15:07:24.858678 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m15:07:24.862727 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbtcustomers/customers.sql
[0m15:07:24.866410 [debug] [MainThread]: 1603: static parser failed on marts/Jinja_exercises/coffee_jinja.sql
[0m15:07:24.873388 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/Jinja_exercises/coffee_jinja.sql
[0m15:07:24.875653 [debug] [MainThread]: 1603: static parser failed on marts/dbt_packages_exercise/date_scaffold.sql
[0m15:07:24.905956 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/dbt_packages_exercise/date_scaffold.sql
[0m15:07:24.909019 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbt_packages_exercise/product_price_history.sql
[0m15:07:24.915529 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/pageviews_userstitching.sql
[0m15:07:24.920044 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/visitors_sessionization.sql
[0m15:07:24.954950 [debug] [MainThread]: 1603: static parser failed on stg_github__pull_request_review.sql
[0m15:07:24.984886 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__pull_request_review.sql
[0m15:07:24.987002 [debug] [MainThread]: 1603: static parser failed on stg_github__requested_reviewer_history.sql
[0m15:07:24.999286 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__requested_reviewer_history.sql
[0m15:07:25.001243 [debug] [MainThread]: 1603: static parser failed on stg_github__label.sql
[0m15:07:25.013438 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__label.sql
[0m15:07:25.015387 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_assignee.sql
[0m15:07:25.024923 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_assignee.sql
[0m15:07:25.026838 [debug] [MainThread]: 1603: static parser failed on stg_github__user.sql
[0m15:07:25.038216 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__user.sql
[0m15:07:25.040146 [debug] [MainThread]: 1603: static parser failed on stg_github__issue.sql
[0m15:07:25.058499 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue.sql
[0m15:07:25.060535 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_closed_history.sql
[0m15:07:25.072961 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_closed_history.sql
[0m15:07:25.075118 [debug] [MainThread]: 1603: static parser failed on stg_github__repository.sql
[0m15:07:25.090471 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__repository.sql
[0m15:07:25.092410 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_label.sql
[0m15:07:25.102957 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_label.sql
[0m15:07:25.104958 [debug] [MainThread]: 1603: static parser failed on stg_github__repo_team.sql
[0m15:07:25.115556 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__repo_team.sql
[0m15:07:25.117464 [debug] [MainThread]: 1603: static parser failed on stg_github__pull_request.sql
[0m15:07:25.134337 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__pull_request.sql
[0m15:07:25.136282 [debug] [MainThread]: 1603: static parser failed on stg_github__team.sql
[0m15:07:25.149636 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__team.sql
[0m15:07:25.151567 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_merged.sql
[0m15:07:25.164827 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_merged.sql
[0m15:07:25.166824 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_comment.sql
[0m15:07:25.179522 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_comment.sql
[0m15:07:25.181453 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__requested_reviewer_history_tmp.sql
[0m15:07:25.188423 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__requested_reviewer_history_tmp.sql
[0m15:07:25.190592 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__team_tmp.sql
[0m15:07:25.196847 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__team_tmp.sql
[0m15:07:25.198791 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__repo_team_tmp.sql
[0m15:07:25.205176 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__repo_team_tmp.sql
[0m15:07:25.206983 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_closed_history_tmp.sql
[0m15:07:25.214017 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_closed_history_tmp.sql
[0m15:07:25.215816 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__repository_tmp.sql
[0m15:07:25.221526 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__repository_tmp.sql
[0m15:07:25.223493 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__pull_request_review_tmp.sql
[0m15:07:25.229154 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__pull_request_review_tmp.sql
[0m15:07:25.230905 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_merged_tmp.sql
[0m15:07:25.236707 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_merged_tmp.sql
[0m15:07:25.238487 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_label_tmp.sql
[0m15:07:25.244229 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_label_tmp.sql
[0m15:07:25.246026 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__label_tmp.sql
[0m15:07:25.252877 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__label_tmp.sql
[0m15:07:25.254730 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__pull_request_tmp.sql
[0m15:07:25.260999 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__pull_request_tmp.sql
[0m15:07:25.262781 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__user_tmp.sql
[0m15:07:25.268525 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__user_tmp.sql
[0m15:07:25.270278 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_tmp.sql
[0m15:07:25.276139 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_tmp.sql
[0m15:07:25.277924 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_assignee_tmp.sql
[0m15:07:25.283737 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_assignee_tmp.sql
[0m15:07:25.285543 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_comment_tmp.sql
[0m15:07:25.291341 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_comment_tmp.sql
[0m15:07:25.313885 [debug] [MainThread]: 1699: static parser successfully parsed github__pull_requests.sql
[0m15:07:25.318105 [debug] [MainThread]: 1603: static parser failed on github__quarterly_metrics.sql
[0m15:07:25.393434 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__quarterly_metrics.sql
[0m15:07:25.395469 [debug] [MainThread]: 1603: static parser failed on github__issues.sql
[0m15:07:25.401057 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__issues.sql
[0m15:07:25.402987 [debug] [MainThread]: 1603: static parser failed on github__weekly_metrics.sql
[0m15:07:25.408879 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__weekly_metrics.sql
[0m15:07:25.410803 [debug] [MainThread]: 1603: static parser failed on github__monthly_metrics.sql
[0m15:07:25.416422 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__monthly_metrics.sql
[0m15:07:25.418319 [debug] [MainThread]: 1603: static parser failed on github__daily_metrics.sql
[0m15:07:25.426647 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__daily_metrics.sql
[0m15:07:25.428690 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_joined.sql
[0m15:07:25.443661 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_joined.sql
[0m15:07:25.445898 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_open_length.sql
[0m15:07:25.460973 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_open_length.sql
[0m15:07:25.463044 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_comments.sql
[0m15:07:25.469234 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_comments.sql
[0m15:07:25.471278 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__pull_request_times.sql
[0m15:07:25.484856 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__pull_request_times.sql
[0m15:07:25.486741 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_labels.sql
[0m15:07:25.494374 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_labels.sql
[0m15:07:25.496181 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_assignees.sql
[0m15:07:25.504515 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_assignees.sql
[0m15:07:25.506442 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_label_joined.sql
[0m15:07:25.513211 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_label_joined.sql
[0m15:07:25.515063 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__pull_request_reviewers.sql
[0m15:07:25.524037 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__pull_request_reviewers.sql
[0m15:07:25.526035 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__repository_teams.sql
[0m15:07:25.535139 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__repository_teams.sql
[0m15:07:25.966537 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.github.int_github__repository_teams' (models/intermediate/int_github__repository_teams.sql) depends on a node named 'stg_github__repo_team' which is disabled
[0m15:07:25.967992 [debug] [MainThread]: Command `dbt run` failed at 15:07:25.967777 after 3.24 seconds
[0m15:07:25.968803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d215763e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e567100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1e5666b0>]}
[0m15:07:25.969564 [debug] [MainThread]: Flushing usage events
[0m15:08:49.937130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0a9a2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda09c364a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda09c36470>]}


============================== 15:08:49.939754 | 501c994a-4939-4cbc-bfeb-0e1faf2088b0 ==============================
[0m15:08:49.939754 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:08:49.940597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/vscode/dbt_robert_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:08:50.353411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07dd8520>]}
[0m15:08:50.381407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07d9b190>]}
[0m15:08:50.382350 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:08:50.440067 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:08:50.464413 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:08:50.465360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07dd9780>]}
[0m15:08:51.974836 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers.sql
[0m15:08:51.988670 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport_view.sql
[0m15:08:51.992155 [debug] [MainThread]: 1699: static parser successfully parsed marts/revenuereport/dbtcustomers_revenuereport.sql
[0m15:08:51.995469 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbtcustomers/customers.sql
[0m15:08:51.998803 [debug] [MainThread]: 1603: static parser failed on marts/Jinja_exercises/coffee_jinja.sql
[0m15:08:52.005036 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/Jinja_exercises/coffee_jinja.sql
[0m15:08:52.006843 [debug] [MainThread]: 1603: static parser failed on marts/dbt_packages_exercise/date_scaffold.sql
[0m15:08:52.036828 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/dbt_packages_exercise/date_scaffold.sql
[0m15:08:52.038747 [debug] [MainThread]: 1699: static parser successfully parsed marts/dbt_packages_exercise/product_price_history.sql
[0m15:08:52.043519 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/pageviews_userstitching.sql
[0m15:08:52.047984 [debug] [MainThread]: 1699: static parser successfully parsed marts/advanced_sql_exercises_marts/visitors_sessionization.sql
[0m15:08:52.084073 [debug] [MainThread]: 1603: static parser failed on stg_github__pull_request_review.sql
[0m15:08:52.112747 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__pull_request_review.sql
[0m15:08:52.115007 [debug] [MainThread]: 1603: static parser failed on stg_github__requested_reviewer_history.sql
[0m15:08:52.126562 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__requested_reviewer_history.sql
[0m15:08:52.128419 [debug] [MainThread]: 1603: static parser failed on stg_github__label.sql
[0m15:08:52.140141 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__label.sql
[0m15:08:52.141968 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_assignee.sql
[0m15:08:52.150895 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_assignee.sql
[0m15:08:52.152693 [debug] [MainThread]: 1603: static parser failed on stg_github__user.sql
[0m15:08:52.164049 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__user.sql
[0m15:08:52.165967 [debug] [MainThread]: 1603: static parser failed on stg_github__issue.sql
[0m15:08:52.183669 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue.sql
[0m15:08:52.185587 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_closed_history.sql
[0m15:08:52.196915 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_closed_history.sql
[0m15:08:52.198687 [debug] [MainThread]: 1603: static parser failed on stg_github__repository.sql
[0m15:08:52.216793 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__repository.sql
[0m15:08:52.219557 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_label.sql
[0m15:08:52.229631 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_label.sql
[0m15:08:52.231391 [debug] [MainThread]: 1603: static parser failed on stg_github__repo_team.sql
[0m15:08:52.241460 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__repo_team.sql
[0m15:08:52.243288 [debug] [MainThread]: 1603: static parser failed on stg_github__pull_request.sql
[0m15:08:52.260603 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__pull_request.sql
[0m15:08:52.262568 [debug] [MainThread]: 1603: static parser failed on stg_github__team.sql
[0m15:08:52.275994 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__team.sql
[0m15:08:52.277901 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_merged.sql
[0m15:08:52.290487 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_merged.sql
[0m15:08:52.292356 [debug] [MainThread]: 1603: static parser failed on stg_github__issue_comment.sql
[0m15:08:52.304532 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stg_github__issue_comment.sql
[0m15:08:52.306409 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__requested_reviewer_history_tmp.sql
[0m15:08:52.312608 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__requested_reviewer_history_tmp.sql
[0m15:08:52.314715 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__team_tmp.sql
[0m15:08:52.320836 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__team_tmp.sql
[0m15:08:52.322733 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__repo_team_tmp.sql
[0m15:08:52.328879 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__repo_team_tmp.sql
[0m15:08:52.330665 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_closed_history_tmp.sql
[0m15:08:52.337389 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_closed_history_tmp.sql
[0m15:08:52.339170 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__repository_tmp.sql
[0m15:08:52.344794 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__repository_tmp.sql
[0m15:08:52.346852 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__pull_request_review_tmp.sql
[0m15:08:52.352652 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__pull_request_review_tmp.sql
[0m15:08:52.354433 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_merged_tmp.sql
[0m15:08:52.360387 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_merged_tmp.sql
[0m15:08:52.362170 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_label_tmp.sql
[0m15:08:52.368318 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_label_tmp.sql
[0m15:08:52.370150 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__label_tmp.sql
[0m15:08:52.377135 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__label_tmp.sql
[0m15:08:52.378903 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__pull_request_tmp.sql
[0m15:08:52.384759 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__pull_request_tmp.sql
[0m15:08:52.386564 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__user_tmp.sql
[0m15:08:52.392310 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__user_tmp.sql
[0m15:08:52.394102 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_tmp.sql
[0m15:08:52.399669 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_tmp.sql
[0m15:08:52.401420 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_assignee_tmp.sql
[0m15:08:52.406936 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_assignee_tmp.sql
[0m15:08:52.408681 [debug] [MainThread]: 1603: static parser failed on tmp/stg_github__issue_comment_tmp.sql
[0m15:08:52.414366 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/stg_github__issue_comment_tmp.sql
[0m15:08:52.436611 [debug] [MainThread]: 1699: static parser successfully parsed github__pull_requests.sql
[0m15:08:52.440253 [debug] [MainThread]: 1603: static parser failed on github__quarterly_metrics.sql
[0m15:08:52.502137 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__quarterly_metrics.sql
[0m15:08:52.504037 [debug] [MainThread]: 1603: static parser failed on github__issues.sql
[0m15:08:52.509265 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__issues.sql
[0m15:08:52.511083 [debug] [MainThread]: 1603: static parser failed on github__weekly_metrics.sql
[0m15:08:52.516393 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__weekly_metrics.sql
[0m15:08:52.518232 [debug] [MainThread]: 1603: static parser failed on github__monthly_metrics.sql
[0m15:08:52.523476 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__monthly_metrics.sql
[0m15:08:52.525276 [debug] [MainThread]: 1603: static parser failed on github__daily_metrics.sql
[0m15:08:52.533144 [debug] [MainThread]: 1602: parser fallback to jinja rendering on github__daily_metrics.sql
[0m15:08:52.535017 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_joined.sql
[0m15:08:52.550073 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_joined.sql
[0m15:08:52.551918 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_open_length.sql
[0m15:08:52.565337 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_open_length.sql
[0m15:08:52.567372 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_comments.sql
[0m15:08:52.573369 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_comments.sql
[0m15:08:52.575338 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__pull_request_times.sql
[0m15:08:52.589135 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__pull_request_times.sql
[0m15:08:52.590942 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_labels.sql
[0m15:08:52.598221 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_labels.sql
[0m15:08:52.599967 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_assignees.sql
[0m15:08:52.607858 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_assignees.sql
[0m15:08:52.609745 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__issue_label_joined.sql
[0m15:08:52.617971 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__issue_label_joined.sql
[0m15:08:52.621002 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__pull_request_reviewers.sql
[0m15:08:52.635119 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__pull_request_reviewers.sql
[0m15:08:52.637037 [debug] [MainThread]: 1603: static parser failed on intermediate/int_github__repository_teams.sql
[0m15:08:52.645688 [debug] [MainThread]: 1602: parser fallback to jinja rendering on intermediate/int_github__repository_teams.sql
[0m15:08:53.053050 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.github_source.not_null_stg_github__repo_team_repository_id.7076be2503' (models/stg_github.yml) depends on a node named 'stg_github__repo_team' which is disabled
[0m15:08:53.053664 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.github_source.not_null_stg_github__repo_team_team_id.000230e64c' (models/stg_github.yml) depends on a node named 'stg_github__repo_team' which is disabled
[0m15:08:53.054149 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.github_source.unique_stg_github__team_team_id.94e9716ab4' (models/stg_github.yml) depends on a node named 'stg_github__team' which is disabled
[0m15:08:53.054554 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.github_source.not_null_stg_github__team_team_id.440aefe7a7' (models/stg_github.yml) depends on a node named 'stg_github__team' which is disabled
[0m15:08:53.121901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda073f4ac0>]}
[0m15:08:53.220636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07ec7730>]}
[0m15:08:53.221688 [info ] [MainThread]: Found 47 models, 54 tests, 0 snapshots, 0 analyses, 601 macros, 0 operations, 0 seed files, 19 sources, 0 exposures, 0 metrics, 0 groups
[0m15:08:53.222490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07c54ee0>]}
[0m15:08:53.229218 [info ] [MainThread]: 
[0m15:08:53.230604 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:08:53.237490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:08:53.238078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:54.318094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_robert)
[0m15:08:54.318791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:54.599970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07c56260>]}
[0m15:08:54.601023 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:08:54.601753 [info ] [MainThread]: 
[0m15:08:54.605830 [debug] [Thread-1 (]: Began running node model.dbt_robert.customers
[0m15:08:54.606285 [debug] [Thread-2 (]: Began running node model.dbt_robert.date_scaffold
[0m15:08:54.606937 [info ] [Thread-1 (]: 1 of 39 START sql view model dbt_robert.customers .............................. [RUN]
[0m15:08:54.607851 [info ] [Thread-2 (]: 2 of 39 START sql table model dbt_robert.date_scaffold ......................... [RUN]
[0m15:08:54.608936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_robert, now model.dbt_robert.customers)
[0m15:08:54.609897 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_robert.date_scaffold'
[0m15:08:54.610393 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.customers
[0m15:08:54.610866 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.date_scaffold
[0m15:08:54.619776 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:08:54.622664 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.customers"
[0m15:08:54.623168 [debug] [Thread-2 (]: On model.dbt_robert.date_scaffold: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_scaffold"} */


        select 

    datetime_diff(
        cast(cast('2023-01-31' as date) as datetime),
        cast(cast('2023-01-01' as date) as datetime),
        day
    )

  
[0m15:08:54.625686 [debug] [Thread-1 (]: Timing info for model.dbt_robert.customers (compile): 15:08:54.611186 => 15:08:54.625434
[0m15:08:54.627006 [debug] [Thread-1 (]: Began executing node model.dbt_robert.customers
[0m15:08:54.664616 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.customers"
[0m15:08:54.666182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:54.666961 [debug] [Thread-1 (]: On model.dbt_robert.customers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.customers"} */


  create or replace view `aec-students`.`dbt_robert`.`customers`
  OPTIONS()
  as select 

C.id
,C.name
,C.email 
,MIN(O.created_at) as first_order_at
,COUNT(O.id) as number_of_orders
--I've acceted your change.local
from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

order by first_order_at limit 5;


[0m15:08:55.737192 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5351e0d9-1d14-4a6f-adc7-025e4aa5eb69&page=queryresults
[0m15:08:55.754333 [debug] [Thread-1 (]: Timing info for model.dbt_robert.customers (execute): 15:08:54.627409 => 15:08:55.754116
[0m15:08:55.755229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda074a58a0>]}
[0m15:08:55.755969 [info ] [Thread-1 (]: 1 of 39 OK created sql view model dbt_robert.customers ......................... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m15:08:55.756969 [debug] [Thread-1 (]: Finished running node model.dbt_robert.customers
[0m15:08:55.757518 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers
[0m15:08:55.758258 [info ] [Thread-1 (]: 3 of 39 START sql table model dbt_robert.dbtcustomers .......................... [RUN]
[0m15:08:55.759403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.customers, now model.dbt_robert.dbtcustomers)
[0m15:08:55.759869 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers
[0m15:08:55.763823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers"
[0m15:08:55.764845 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (compile): 15:08:55.760223 => 15:08:55.764507
[0m15:08:55.765317 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers
[0m15:08:55.779620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:56.067734 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0e928bc3-2f6a-403b-8bf1-7a5d32860410&page=queryresults
[0m15:08:56.069812 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.date_scaffold"
[0m15:08:56.070838 [debug] [Thread-2 (]: Timing info for model.dbt_robert.date_scaffold (compile): 15:08:54.615096 => 15:08:56.070482
[0m15:08:56.071315 [debug] [Thread-2 (]: Began executing node model.dbt_robert.date_scaffold
[0m15:08:56.122543 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers"
[0m15:08:56.123559 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers`
    
    

    OPTIONS()
    as (
      

select
--latest one 3
C.id
,C.name
,C.email 
--,O.created_at
,MIN(O.created_at) as first_order_at
--,format_date('%G-%V', O.created_at) as year_week_ordercreated
,COUNT(O.id) as number_of_orders
,CASE
    when COUNT(O.id) > 1 then TRUE
    else FALSE
END as is_returning_customer

from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id

GROUP BY
C.id
,C.name
,C.email

--order by first_order_at 
limit 5
    );
  
[0m15:08:56.315308 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.date_scaffold"
[0m15:08:56.316505 [debug] [Thread-2 (]: On model.dbt_robert.date_scaffold: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.date_scaffold"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`date_scaffold`
    
    

    OPTIONS()
    as (
      








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
    
    

    )

    select *
    from unioned
    where generated_number <= 30
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2023-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2023-01-31' as date)

)

select * from filtered


    );
  
[0m15:08:59.234070 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:acde0545-84e5-4560-800f-d74a93cc0de9&page=queryresults
[0m15:08:59.237865 [debug] [Thread-2 (]: Timing info for model.dbt_robert.date_scaffold (execute): 15:08:56.071618 => 15:08:59.237590
[0m15:08:59.238988 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07b7ab00>]}
[0m15:08:59.240195 [info ] [Thread-2 (]: 2 of 39 OK created sql table model dbt_robert.date_scaffold .................... [[32mCREATE TABLE (30.0 rows, 0 processed)[0m in 4.63s]
[0m15:08:59.241447 [debug] [Thread-2 (]: Finished running node model.dbt_robert.date_scaffold
[0m15:08:59.243847 [debug] [Thread-2 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:08:59.244668 [info ] [Thread-2 (]: 4 of 39 START sql table model dbt_robert.dbtcustomers_revenuereport ............ [RUN]
[0m15:08:59.245848 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.date_scaffold, now model.dbt_robert.dbtcustomers_revenuereport)
[0m15:08:59.246834 [debug] [Thread-2 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport
[0m15:08:59.250676 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:08:59.251649 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (compile): 15:08:59.247170 => 15:08:59.251215
[0m15:08:59.252093 [debug] [Thread-2 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport
[0m15:08:59.255173 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:08:59.595800 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport"
[0m15:08:59.597055 [debug] [Thread-2 (]: On model.dbt_robert.dbtcustomers_revenuereport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
    
    

    OPTIONS()
    as (
      

select
C.id
,C.name
,C.email 
,O.created_at as sold_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category as product_category
,PP.price as amount
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25
    );
  
[0m15:08:59.640599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4e09d9ac-d3cc-4aa9-9a2f-b2051a78e96e&page=queryresults
[0m15:08:59.643842 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers (execute): 15:08:55.765603 => 15:08:59.643576
[0m15:08:59.644902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07bfa770>]}
[0m15:08:59.645784 [info ] [Thread-1 (]: 3 of 39 OK created sql table model dbt_robert.dbtcustomers ..................... [[32mCREATE TABLE (5.0 rows, 28.2 MiB processed)[0m in 3.89s]
[0m15:08:59.646983 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers
[0m15:08:59.647549 [debug] [Thread-1 (]: Began running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m15:08:59.648362 [info ] [Thread-1 (]: 5 of 39 START sql view model dbt_robert.dbtcustomers_revenuereport_view ........ [RUN]
[0m15:08:59.649593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers, now model.dbt_robert.dbtcustomers_revenuereport_view)
[0m15:08:59.650064 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.dbtcustomers_revenuereport_view
[0m15:08:59.654329 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m15:08:59.655327 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (compile): 15:08:59.650407 => 15:08:59.655069
[0m15:08:59.655771 [debug] [Thread-1 (]: Began executing node model.dbt_robert.dbtcustomers_revenuereport_view
[0m15:08:59.662986 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.dbtcustomers_revenuereport_view"
[0m15:08:59.663912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:59.664436 [debug] [Thread-1 (]: On model.dbt_robert.dbtcustomers_revenuereport_view: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.dbtcustomers_revenuereport_view"} */


  create or replace view `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport_view`
  OPTIONS()
  as 

select
C.id
,C.name
,C.email 
,O.created_at
,format_date('%G-%V', O.created_at) as year_week_ordercreated
,P.category
,PP.price
,dbtC.is_returning_customer
,dbtC.number_of_orders



from `analytics-engineers-club.coffee_shop.customers` as C
left join `analytics-engineers-club.coffee_shop.orders` as O on C.id = O.customer_id
left join `analytics-engineers-club.coffee_shop.order_items` as OI  on O.id = OI.order_id
left join `analytics-engineers-club.coffee_shop.products` as P  on P.id = OI.product_id
left join `analytics-engineers-club.coffee_shop.product_prices` as PP  on PP.product_id = OI.product_id
left join `aec-students.dbt_robert.dbtcustomers` as dbtC on C.id = dbtC.id

--GROUP BY
--C.id
--,C.name
--,C.email

--order by first_order_at 
limit 25;


[0m15:09:00.546934 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fff094c7-bbd6-474a-ae9a-ba5e9c716ea8&page=queryresults
[0m15:09:00.550324 [debug] [Thread-1 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport_view (execute): 15:08:59.656061 => 15:09:00.550047
[0m15:09:00.551409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07521090>]}
[0m15:09:00.552309 [info ] [Thread-1 (]: 5 of 39 OK created sql view model dbt_robert.dbtcustomers_revenuereport_view ... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m15:09:00.553545 [debug] [Thread-1 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport_view
[0m15:09:00.554218 [debug] [Thread-1 (]: Began running node model.dbt_robert.product_price_history
[0m15:09:00.555028 [info ] [Thread-1 (]: 6 of 39 START sql view model dbt_robert.product_price_history .................. [RUN]
[0m15:09:00.556109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport_view, now model.dbt_robert.product_price_history)
[0m15:09:00.556592 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.product_price_history
[0m15:09:00.561083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.product_price_history"
[0m15:09:00.561980 [debug] [Thread-1 (]: Timing info for model.dbt_robert.product_price_history (compile): 15:09:00.556917 => 15:09:00.561632
[0m15:09:00.562598 [debug] [Thread-1 (]: Began executing node model.dbt_robert.product_price_history
[0m15:09:00.567030 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.product_price_history"
[0m15:09:00.567786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:00.568327 [debug] [Thread-1 (]: On model.dbt_robert.product_price_history: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.product_price_history"} */


  create or replace view `aec-students`.`dbt_robert`.`product_price_history`
  OPTIONS()
  as select 
--test
id,
product_id,
price,
created_at,
ended_at

from analytics-engineers-club.coffee_shop.product_prices;


[0m15:09:01.684184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:803e9992-0283-412d-a262-db29c9a55be5&page=queryresults
[0m15:09:01.687333 [debug] [Thread-1 (]: Timing info for model.dbt_robert.product_price_history (execute): 15:09:00.563005 => 15:09:01.687111
[0m15:09:01.688217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07b79b70>]}
[0m15:09:01.688963 [info ] [Thread-1 (]: 6 of 39 OK created sql view model dbt_robert.product_price_history ............. [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m15:09:01.689945 [debug] [Thread-1 (]: Finished running node model.dbt_robert.product_price_history
[0m15:09:01.690488 [debug] [Thread-1 (]: Began running node model.dbt_robert.visitors_sessionization
[0m15:09:01.691221 [info ] [Thread-1 (]: 7 of 39 START sql table model dbt_robert.visitors_sessionization ............... [RUN]
[0m15:09:01.692377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.product_price_history, now model.dbt_robert.visitors_sessionization)
[0m15:09:01.692837 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.visitors_sessionization
[0m15:09:01.698808 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.visitors_sessionization"
[0m15:09:01.699755 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_sessionization (compile): 15:09:01.693132 => 15:09:01.699401
[0m15:09:01.700266 [debug] [Thread-1 (]: Began executing node model.dbt_robert.visitors_sessionization
[0m15:09:01.703425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:02.022099 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.visitors_sessionization"
[0m15:09:02.023442 [debug] [Thread-1 (]: On model.dbt_robert.visitors_sessionization: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.visitors_sessionization"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`visitors_sessionization`
    
    

    OPTIONS()
    as (
      


-- one record per visitor id
with visitors_userstitching as (
    select distinct
        visitor_id,

        first_value(customer_id ignore nulls) over (
            partition by visitor_id
            order by timestamp
            range between unbounded preceding and unbounded following
        ) as first_customer_id,

        min(timestamp) over (
            partition by visitor_id
        ) as first_seen_at,

        max(timestamp) over (
            partition by visitor_id
        ) as last_seen_at


    from `analytics-engineers-club`.`web_tracking`.`pageviews`
)
select
    *,
    first_value(visitor_id) over (
        partition by coalesce(first_customer_id, visitor_id)
        order by first_seen_at
    ) as first_visitor_id
from visitors_userstitching
    );
  
[0m15:09:03.191175 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0f29b637-1732-467a-8ca9-f37f198310cd&page=queryresults
[0m15:09:03.194303 [debug] [Thread-2 (]: Timing info for model.dbt_robert.dbtcustomers_revenuereport (execute): 15:08:59.252404 => 15:09:03.194030
[0m15:09:03.195441 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07530730>]}
[0m15:09:03.196396 [info ] [Thread-2 (]: 4 of 39 OK created sql table model dbt_robert.dbtcustomers_revenuereport ....... [[32mCREATE TABLE (25.0 rows, 45.1 MiB processed)[0m in 3.95s]
[0m15:09:03.197554 [debug] [Thread-2 (]: Finished running node model.dbt_robert.dbtcustomers_revenuereport
[0m15:09:03.198134 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_assignee_tmp
[0m15:09:03.199168 [info ] [Thread-2 (]: 8 of 39 START sql view model dbt_robert.stg_github__issue_assignee_tmp ......... [RUN]
[0m15:09:03.200247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_robert.dbtcustomers_revenuereport, now model.github_source.stg_github__issue_assignee_tmp)
[0m15:09:03.200743 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_assignee_tmp
[0m15:09:03.207585 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_assignee_tmp"
[0m15:09:03.208511 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_assignee_tmp (compile): 15:09:03.201189 => 15:09:03.208098
[0m15:09:03.208960 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_assignee_tmp
[0m15:09:03.212973 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_assignee_tmp"
[0m15:09:03.213677 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:03.214147 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_assignee_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_assignee_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_assignee_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_assignee`;


[0m15:09:04.161999 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ab209643-e1f8-45df-8863-eef074055fc5&page=queryresults
[0m15:09:04.164988 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_assignee_tmp (execute): 15:09:03.209252 => 15:09:04.164773
[0m15:09:04.165894 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda079f4940>]}
[0m15:09:04.166609 [info ] [Thread-2 (]: 8 of 39 OK created sql view model dbt_robert.stg_github__issue_assignee_tmp .... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m15:09:04.167588 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_assignee_tmp
[0m15:09:04.168384 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_closed_history_tmp
[0m15:09:04.169350 [info ] [Thread-2 (]: 9 of 39 START sql view model dbt_robert.stg_github__issue_closed_history_tmp ... [RUN]
[0m15:09:04.170409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_assignee_tmp, now model.github_source.stg_github__issue_closed_history_tmp)
[0m15:09:04.170894 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_closed_history_tmp
[0m15:09:04.175899 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_closed_history_tmp"
[0m15:09:04.176760 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_closed_history_tmp (compile): 15:09:04.171228 => 15:09:04.176425
[0m15:09:04.177205 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_closed_history_tmp
[0m15:09:04.181380 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_closed_history_tmp"
[0m15:09:04.182085 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:04.182558 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_closed_history_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_closed_history_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_closed_history_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_closed_history`;


[0m15:09:05.082708 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:54705d39-2381-4027-b127-a664ef5bf019&page=queryresults
[0m15:09:05.085898 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_closed_history_tmp (execute): 15:09:04.177500 => 15:09:05.085633
[0m15:09:05.087003 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda079f4940>]}
[0m15:09:05.087864 [info ] [Thread-2 (]: 9 of 39 OK created sql view model dbt_robert.stg_github__issue_closed_history_tmp  [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m15:09:05.089096 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_closed_history_tmp
[0m15:09:05.089723 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_comment_tmp
[0m15:09:05.090851 [info ] [Thread-2 (]: 10 of 39 START sql view model dbt_robert.stg_github__issue_comment_tmp ......... [RUN]
[0m15:09:05.092047 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_closed_history_tmp, now model.github_source.stg_github__issue_comment_tmp)
[0m15:09:05.092552 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_comment_tmp
[0m15:09:05.098063 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_comment_tmp"
[0m15:09:05.098922 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_comment_tmp (compile): 15:09:05.092976 => 15:09:05.098592
[0m15:09:05.099361 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_comment_tmp
[0m15:09:05.107836 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_comment_tmp"
[0m15:09:05.108622 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:05.109098 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_comment_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_comment_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_comment_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_comment`;


[0m15:09:05.985649 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:dd7bc7f7-f52b-4a24-8e57-4ae5d6124172&page=queryresults
[0m15:09:05.988836 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_comment_tmp (execute): 15:09:05.099648 => 15:09:05.988564
[0m15:09:05.989840 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda074cb640>]}
[0m15:09:05.990555 [info ] [Thread-2 (]: 10 of 39 OK created sql view model dbt_robert.stg_github__issue_comment_tmp .... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m15:09:05.991556 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_comment_tmp
[0m15:09:05.992099 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_label_tmp
[0m15:09:05.993153 [info ] [Thread-2 (]: 11 of 39 START sql view model dbt_robert.stg_github__issue_label_tmp ........... [RUN]
[0m15:09:05.994211 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_comment_tmp, now model.github_source.stg_github__issue_label_tmp)
[0m15:09:05.994670 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_label_tmp
[0m15:09:06.002634 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_label_tmp"
[0m15:09:06.003838 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_label_tmp (compile): 15:09:05.995046 => 15:09:06.003343
[0m15:09:06.004519 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_label_tmp
[0m15:09:06.010681 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_label_tmp"
[0m15:09:06.011437 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:06.011906 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_label_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_label_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_label_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_label`;


[0m15:09:06.877000 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:92e4db20-9158-4657-9236-5c2821e5b211&page=queryresults
[0m15:09:06.879608 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_label_tmp (execute): 15:09:06.004965 => 15:09:06.879388
[0m15:09:06.880513 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07b1f5e0>]}
[0m15:09:06.881241 [info ] [Thread-2 (]: 11 of 39 OK created sql view model dbt_robert.stg_github__issue_label_tmp ...... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m15:09:06.882311 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_label_tmp
[0m15:09:06.882852 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_merged_tmp
[0m15:09:06.883860 [info ] [Thread-2 (]: 12 of 39 START sql view model dbt_robert.stg_github__issue_merged_tmp .......... [RUN]
[0m15:09:06.885054 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_label_tmp, now model.github_source.stg_github__issue_merged_tmp)
[0m15:09:06.885525 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_merged_tmp
[0m15:09:06.892108 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_merged_tmp"
[0m15:09:06.892966 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_merged_tmp (compile): 15:09:06.885891 => 15:09:06.892662
[0m15:09:06.893420 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_merged_tmp
[0m15:09:06.897512 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_merged_tmp"
[0m15:09:06.898221 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:06.898696 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_merged_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_merged_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_merged_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue_merged`;


[0m15:09:07.816555 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:34e8e73b-8e89-4214-a82c-3c8bad3681e2&page=queryresults
[0m15:09:07.822454 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_merged_tmp (execute): 15:09:06.893709 => 15:09:07.821946
[0m15:09:07.824228 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07530f40>]}
[0m15:09:07.826140 [info ] [Thread-2 (]: 12 of 39 OK created sql view model dbt_robert.stg_github__issue_merged_tmp ..... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m15:09:07.827436 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_merged_tmp
[0m15:09:07.827997 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_tmp
[0m15:09:07.829031 [info ] [Thread-2 (]: 13 of 39 START sql view model dbt_robert.stg_github__issue_tmp ................. [RUN]
[0m15:09:07.830083 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_merged_tmp, now model.github_source.stg_github__issue_tmp)
[0m15:09:07.830549 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_tmp
[0m15:09:07.839960 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_tmp"
[0m15:09:07.841376 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_tmp (compile): 15:09:07.831214 => 15:09:07.840974
[0m15:09:07.842147 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_tmp
[0m15:09:07.847015 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_tmp"
[0m15:09:07.847760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:07.848231 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__issue_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`issue`;


[0m15:09:08.775700 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c42adf87-1732-47e7-ab61-9d67fdea7766&page=queryresults
[0m15:09:08.778996 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_tmp (execute): 15:09:07.842692 => 15:09:08.778748
[0m15:09:08.780007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07a48460>]}
[0m15:09:08.780840 [info ] [Thread-2 (]: 13 of 39 OK created sql view model dbt_robert.stg_github__issue_tmp ............ [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m15:09:08.782010 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_tmp
[0m15:09:08.782612 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__label_tmp
[0m15:09:08.783449 [info ] [Thread-2 (]: 14 of 39 START sql view model dbt_robert.stg_github__label_tmp ................. [RUN]
[0m15:09:08.784996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_tmp, now model.github_source.stg_github__label_tmp)
[0m15:09:08.785503 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__label_tmp
[0m15:09:08.790482 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__label_tmp"
[0m15:09:08.791312 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__label_tmp (compile): 15:09:08.785953 => 15:09:08.790995
[0m15:09:08.791760 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__label_tmp
[0m15:09:08.795888 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__label_tmp"
[0m15:09:08.796602 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:08.797071 [debug] [Thread-2 (]: On model.github_source.stg_github__label_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__label_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__label_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`label`;


[0m15:09:09.790543 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a0974d7c-803d-4a70-8fb3-fd794d0f2bdd&page=queryresults
[0m15:09:09.794098 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__label_tmp (execute): 15:09:08.792048 => 15:09:09.793858
[0m15:09:09.794969 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda074a6320>]}
[0m15:09:09.795690 [info ] [Thread-2 (]: 14 of 39 OK created sql view model dbt_robert.stg_github__label_tmp ............ [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m15:09:09.796782 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__label_tmp
[0m15:09:09.797317 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__pull_request_review_tmp
[0m15:09:09.797967 [info ] [Thread-2 (]: 15 of 39 START sql view model dbt_robert.stg_github__pull_request_review_tmp ... [RUN]
[0m15:09:09.799446 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__label_tmp, now model.github_source.stg_github__pull_request_review_tmp)
[0m15:09:09.799904 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__pull_request_review_tmp
[0m15:09:09.804906 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__pull_request_review_tmp"
[0m15:09:09.805770 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request_review_tmp (compile): 15:09:09.800370 => 15:09:09.805434
[0m15:09:09.806223 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__pull_request_review_tmp
[0m15:09:09.814791 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__pull_request_review_tmp"
[0m15:09:09.815690 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:09.816200 [debug] [Thread-2 (]: On model.github_source.stg_github__pull_request_review_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_review_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__pull_request_review_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`pull_request_review`;


[0m15:09:10.512281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:764d9ce1-f23b-44f2-abe6-afd75ba11408&page=queryresults
[0m15:09:10.515376 [debug] [Thread-1 (]: Timing info for model.dbt_robert.visitors_sessionization (execute): 15:09:01.700577 => 15:09:10.515155
[0m15:09:10.516292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07b57490>]}
[0m15:09:10.517071 [info ] [Thread-1 (]: 7 of 39 OK created sql table model dbt_robert.visitors_sessionization .......... [[32mCREATE TABLE (1.4m rows, 292.6 MiB processed)[0m in 8.82s]
[0m15:09:10.518132 [debug] [Thread-1 (]: Finished running node model.dbt_robert.visitors_sessionization
[0m15:09:10.518670 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__pull_request_tmp
[0m15:09:10.519643 [info ] [Thread-1 (]: 16 of 39 START sql view model dbt_robert.stg_github__pull_request_tmp .......... [RUN]
[0m15:09:10.520841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.visitors_sessionization, now model.github_source.stg_github__pull_request_tmp)
[0m15:09:10.526735 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__pull_request_tmp
[0m15:09:10.533284 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__pull_request_tmp"
[0m15:09:10.534128 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__pull_request_tmp (compile): 15:09:10.527194 => 15:09:10.533794
[0m15:09:10.534581 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__pull_request_tmp
[0m15:09:10.538865 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__pull_request_tmp"
[0m15:09:10.539575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:10.540052 [debug] [Thread-1 (]: On model.github_source.stg_github__pull_request_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__pull_request_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`pull_request`;


[0m15:09:10.779309 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:15692848-9cd9-4fa4-8240-75f71e4d9d8e&page=queryresults
[0m15:09:10.781981 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request_review_tmp (execute): 15:09:09.806518 => 15:09:10.781757
[0m15:09:10.782925 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda072d6b30>]}
[0m15:09:10.783688 [info ] [Thread-2 (]: 15 of 39 OK created sql view model dbt_robert.stg_github__pull_request_review_tmp  [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m15:09:10.784735 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__pull_request_review_tmp
[0m15:09:10.785328 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__repository_tmp
[0m15:09:10.786442 [info ] [Thread-2 (]: 17 of 39 START sql view model dbt_robert.stg_github__repository_tmp ............ [RUN]
[0m15:09:10.787472 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__pull_request_review_tmp, now model.github_source.stg_github__repository_tmp)
[0m15:09:10.787956 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__repository_tmp
[0m15:09:10.793211 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__repository_tmp"
[0m15:09:10.794063 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__repository_tmp (compile): 15:09:10.788281 => 15:09:10.793731
[0m15:09:10.794505 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__repository_tmp
[0m15:09:10.798722 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__repository_tmp"
[0m15:09:10.799431 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:10.799901 [debug] [Thread-2 (]: On model.github_source.stg_github__repository_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__repository_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__repository_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`repository`;


[0m15:09:11.402642 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0182b7a4-7229-4c42-b3a5-aceb8eee27a3&page=queryresults
[0m15:09:11.405832 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__pull_request_tmp (execute): 15:09:10.534881 => 15:09:11.405556
[0m15:09:11.406874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda072d5f60>]}
[0m15:09:11.407593 [info ] [Thread-1 (]: 16 of 39 OK created sql view model dbt_robert.stg_github__pull_request_tmp ..... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m15:09:11.408680 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__pull_request_tmp
[0m15:09:11.409224 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:09:11.410322 [info ] [Thread-1 (]: 18 of 39 START sql view model dbt_robert.stg_github__requested_reviewer_history_tmp  [RUN]
[0m15:09:11.411314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__pull_request_tmp, now model.github_source.stg_github__requested_reviewer_history_tmp)
[0m15:09:11.411785 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:09:11.421140 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__requested_reviewer_history_tmp"
[0m15:09:11.421999 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__requested_reviewer_history_tmp (compile): 15:09:11.412101 => 15:09:11.421666
[0m15:09:11.422449 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:09:11.426723 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__requested_reviewer_history_tmp"
[0m15:09:11.427425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:11.427896 [debug] [Thread-1 (]: On model.github_source.stg_github__requested_reviewer_history_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__requested_reviewer_history_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__requested_reviewer_history_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`requested_reviewer_history`;


[0m15:09:11.707768 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a3e6d13e-1c68-493e-9862-7839f64ba19e&page=queryresults
[0m15:09:11.710494 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__repository_tmp (execute): 15:09:10.794792 => 15:09:11.710273
[0m15:09:11.711415 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07269a20>]}
[0m15:09:11.712148 [info ] [Thread-2 (]: 17 of 39 OK created sql view model dbt_robert.stg_github__repository_tmp ....... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m15:09:11.713242 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__repository_tmp
[0m15:09:11.713988 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__user_tmp
[0m15:09:11.714986 [info ] [Thread-2 (]: 19 of 39 START sql view model dbt_robert.stg_github__user_tmp .................. [RUN]
[0m15:09:11.716702 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__repository_tmp, now model.github_source.stg_github__user_tmp)
[0m15:09:11.717311 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__user_tmp
[0m15:09:11.727243 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__user_tmp"
[0m15:09:11.728109 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__user_tmp (compile): 15:09:11.717726 => 15:09:11.727802
[0m15:09:11.728646 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__user_tmp
[0m15:09:11.738316 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__user_tmp"
[0m15:09:11.739401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:11.740644 [debug] [Thread-2 (]: On model.github_source.stg_github__user_tmp: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__user_tmp"} */


  create or replace view `aec-students`.`dbt_robert`.`stg_github__user_tmp`
  OPTIONS()
  as select *
from `analytics-engineers-club`.`github`.`user`;


[0m15:09:12.290964 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3f218aae-c9db-454a-978b-a6bfbae51726&page=queryresults
[0m15:09:12.294152 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__requested_reviewer_history_tmp (execute): 15:09:11.422740 => 15:09:12.293873
[0m15:09:12.295293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda072d70d0>]}
[0m15:09:12.296123 [info ] [Thread-1 (]: 18 of 39 OK created sql view model dbt_robert.stg_github__requested_reviewer_history_tmp  [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m15:09:12.297189 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__requested_reviewer_history_tmp
[0m15:09:12.297735 [debug] [Thread-1 (]: Began running node model.dbt_robert.coffee_jinja
[0m15:09:12.298809 [info ] [Thread-1 (]: 20 of 39 START sql table model dbt_robert.coffee_jinja ......................... [RUN]
[0m15:09:12.300125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__requested_reviewer_history_tmp, now model.dbt_robert.coffee_jinja)
[0m15:09:12.301166 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.coffee_jinja
[0m15:09:12.306465 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.coffee_jinja"
[0m15:09:12.307454 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (compile): 15:09:12.301597 => 15:09:12.307029
[0m15:09:12.307901 [debug] [Thread-1 (]: Began executing node model.dbt_robert.coffee_jinja
[0m15:09:12.314401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:12.627276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.coffee_jinja"
[0m15:09:12.629035 [debug] [Thread-1 (]: On model.dbt_robert.coffee_jinja: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.coffee_jinja"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`coffee_jinja`
    
    

    OPTIONS()
    as (
      


select
  date_trunc(sold_at, month) as date_month,
 -- sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,
 -- sum(case when product_category = 'merch' then amount end) as merch_amount,
 -- sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount


sum(case when product_category = 'coffee beans' then amount end) as coffee_beans_amount,

sum(case when product_category = 'merch' then amount end) as merch_amount,

sum(case when product_category = 'brewing supplies' then amount end) as brewing_supplies_amount,


-- you may have to `ref` a different model here, depending on what you've built previously
from `aec-students`.`dbt_robert`.`dbtcustomers_revenuereport`
group by 1
    );
  
[0m15:09:12.742225 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3d8655a9-1f6e-407a-8ee6-cc98394ab380&page=queryresults
[0m15:09:12.745451 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__user_tmp (execute): 15:09:11.729065 => 15:09:12.745230
[0m15:09:12.746400 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07269a20>]}
[0m15:09:12.747136 [info ] [Thread-2 (]: 19 of 39 OK created sql view model dbt_robert.stg_github__user_tmp ............. [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m15:09:12.748168 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__user_tmp
[0m15:09:12.748764 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_assignee
[0m15:09:12.749652 [info ] [Thread-2 (]: 21 of 39 START sql table model dbt_robert.stg_github__issue_assignee ........... [RUN]
[0m15:09:12.750958 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__user_tmp, now model.github_source.stg_github__issue_assignee)
[0m15:09:12.751419 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_assignee
[0m15:09:12.756796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:13.084215 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_assignee"
[0m15:09:13.085528 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_assignee (compile): 15:09:12.751822 => 15:09:13.085116
[0m15:09:13.086142 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_assignee
[0m15:09:13.327304 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_assignee"
[0m15:09:13.328244 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_assignee: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_assignee"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue_assignee`
    
    

    OPTIONS()
    as (
      with issue_assignee as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_assignee_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from issue_assignee

), fields as (

    select 
      issue_id,
      user_id
    from macro
)

select *
from fields
    );
  
[0m15:09:15.077937 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1ed0a10b-b0cd-46ee-91a1-f38a15abf63e&page=queryresults
[0m15:09:15.080492 [debug] [Thread-1 (]: Timing info for model.dbt_robert.coffee_jinja (execute): 15:09:12.308194 => 15:09:15.080246
[0m15:09:15.081386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda074e31f0>]}
[0m15:09:15.082197 [info ] [Thread-1 (]: 20 of 39 OK created sql table model dbt_robert.coffee_jinja .................... [[32mCREATE TABLE (5.0 rows, 661.0 Bytes processed)[0m in 2.78s]
[0m15:09:15.083185 [debug] [Thread-1 (]: Finished running node model.dbt_robert.coffee_jinja
[0m15:09:15.083736 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__issue_closed_history
[0m15:09:15.084765 [info ] [Thread-1 (]: 22 of 39 START sql table model dbt_robert.stg_github__issue_closed_history ..... [RUN]
[0m15:09:15.085878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.coffee_jinja, now model.github_source.stg_github__issue_closed_history)
[0m15:09:15.086349 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__issue_closed_history
[0m15:09:15.091719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:15.397133 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__issue_closed_history"
[0m15:09:15.398761 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__issue_closed_history (compile): 15:09:15.086673 => 15:09:15.398300
[0m15:09:15.399903 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__issue_closed_history
[0m15:09:15.645841 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__issue_closed_history"
[0m15:09:15.646898 [debug] [Thread-1 (]: On model.github_source.stg_github__issue_closed_history: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_closed_history"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue_closed_history`
    
    

    OPTIONS()
    as (
      with issue_closed_history as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_closed_history_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    actor_id
    
 as 
    
    actor_id
    
, 
    
    
    closed
    
 as 
    
    closed
    
, 
    
    
    commit_sha
    
 as 
    
    commit_sha
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    updated_at
    
 as 
    
    updated_at
    




    from issue_closed_history

), fields as (

    select 
      issue_id,
      cast(updated_at as TIMESTAMP) as updated_at,
      closed as is_closed

    from macro
)

select *
from fields
    );
  
[0m15:09:15.870322 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8554f598-a4bb-4a73-a0fb-f16c6c985dd1&page=queryresults
[0m15:09:15.872842 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_assignee (execute): 15:09:13.086514 => 15:09:15.872616
[0m15:09:15.873723 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07094b20>]}
[0m15:09:15.874537 [info ] [Thread-2 (]: 21 of 39 OK created sql table model dbt_robert.stg_github__issue_assignee ...... [[32mCREATE TABLE (2.0 rows, 32.0 Bytes processed)[0m in 3.12s]
[0m15:09:15.875597 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_assignee
[0m15:09:15.876141 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_comment
[0m15:09:15.877033 [info ] [Thread-2 (]: 23 of 39 START sql table model dbt_robert.stg_github__issue_comment ............ [RUN]
[0m15:09:15.878048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_assignee, now model.github_source.stg_github__issue_comment)
[0m15:09:15.878504 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_comment
[0m15:09:15.883701 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:16.185352 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_comment"
[0m15:09:16.186635 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_comment (compile): 15:09:15.878847 => 15:09:16.186161
[0m15:09:16.187284 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_comment
[0m15:09:16.424144 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_comment"
[0m15:09:16.425131 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_comment: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_comment"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue_comment`
    
    

    OPTIONS()
    as (
      with issue_comment as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_comment_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    body
    
 as 
    
    body
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    updated_at
    
 as 
    
    updated_at
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from issue_comment

), fields as (

    select 
      id as issue_comment_id,
      issue_id,
      user_id

    from macro
)

select *
from fields
    );
  
[0m15:09:18.131008 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e2793ab1-bb79-4184-b5c3-ad43e72c8f2d&page=queryresults
[0m15:09:18.134539 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__issue_closed_history (execute): 15:09:15.400489 => 15:09:18.134266
[0m15:09:18.135611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07bfa770>]}
[0m15:09:18.662274 [info ] [Thread-1 (]: 22 of 39 OK created sql table model dbt_robert.stg_github__issue_closed_history  [[32mCREATE TABLE (70.0 rows, 1.2 KiB processed)[0m in 3.05s]
[0m15:09:18.663597 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__issue_closed_history
[0m15:09:18.664198 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__issue_label
[0m15:09:18.665192 [info ] [Thread-1 (]: 24 of 39 START sql table model dbt_robert.stg_github__issue_label .............. [RUN]
[0m15:09:18.666285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_closed_history, now model.github_source.stg_github__issue_label)
[0m15:09:18.666770 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__issue_label
[0m15:09:18.671979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:18.995975 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__issue_label"
[0m15:09:18.997076 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__issue_label (compile): 15:09:18.667293 => 15:09:18.996715
[0m15:09:18.997589 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__issue_label
[0m15:09:19.140233 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0ddb9478-c374-42ce-adee-0ff5e3cfcf8c&page=queryresults
[0m15:09:19.142735 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_comment (execute): 15:09:16.187695 => 15:09:19.142514
[0m15:09:19.143611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07077220>]}
[0m15:09:19.144357 [info ] [Thread-2 (]: 23 of 39 OK created sql table model dbt_robert.stg_github__issue_comment ....... [[32mCREATE TABLE (12.0 rows, 288.0 Bytes processed)[0m in 3.27s]
[0m15:09:19.145420 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_comment
[0m15:09:19.145955 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__issue_merged
[0m15:09:19.146962 [info ] [Thread-2 (]: 25 of 39 START sql table model dbt_robert.stg_github__issue_merged ............. [RUN]
[0m15:09:19.148192 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_comment, now model.github_source.stg_github__issue_merged)
[0m15:09:19.148887 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__issue_merged
[0m15:09:19.156748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:19.196750 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__issue_label"
[0m15:09:19.198156 [debug] [Thread-1 (]: On model.github_source.stg_github__issue_label: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_label"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue_label`
    
    

    OPTIONS()
    as (
      with issue_label as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_label_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    label_id
    
 as 
    
    label_id
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    




    from issue_label

), fields as (

    select 
      issue_id,
      label_id
    from macro
)

select *
from fields
    );
  
[0m15:09:19.430768 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__issue_merged"
[0m15:09:19.431778 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_merged (compile): 15:09:19.149328 => 15:09:19.431435
[0m15:09:19.432315 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__issue_merged
[0m15:09:19.653876 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__issue_merged"
[0m15:09:19.658447 [debug] [Thread-2 (]: On model.github_source.stg_github__issue_merged: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue_merged"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue_merged`
    
    

    OPTIONS()
    as (
      with issue_merged as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_merged_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    actor_id
    
 as 
    
    actor_id
    
, 
    
    
    commit_sha
    
 as 
    
    commit_sha
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    merged_at
    
 as 
    
    merged_at
    




    from issue_merged

), fields as (

    select 
      issue_id,
      cast(merged_at as TIMESTAMP) as merged_at

    from macro
)

select *
from fields
    );
  
[0m15:09:22.142617 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f49729b4-6c42-4b0e-990b-55bed899bc2d&page=queryresults
[0m15:09:22.145688 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__issue_label (execute): 15:09:18.997896 => 15:09:22.145459
[0m15:09:22.146604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07bfa770>]}
[0m15:09:22.147353 [info ] [Thread-1 (]: 24 of 39 OK created sql table model dbt_robert.stg_github__issue_label ......... [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.48s]
[0m15:09:22.148485 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__issue_label
[0m15:09:22.149034 [debug] [Thread-1 (]: Began running node model.github_source.stg_github__issue
[0m15:09:22.150053 [info ] [Thread-1 (]: 26 of 39 START sql table model dbt_robert.stg_github__issue .................... [RUN]
[0m15:09:22.151059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_label, now model.github_source.stg_github__issue)
[0m15:09:22.151529 [debug] [Thread-1 (]: Began compiling node model.github_source.stg_github__issue
[0m15:09:22.157196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:22.442309 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:152df8be-37b3-4135-b483-5209be9799ca&page=queryresults
[0m15:09:22.451482 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__issue_merged (execute): 15:09:19.432649 => 15:09:22.451093
[0m15:09:22.453946 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0731d420>]}
[0m15:09:22.455203 [info ] [Thread-2 (]: 25 of 39 OK created sql table model dbt_robert.stg_github__issue_merged ........ [[32mCREATE TABLE (69.0 rows, 1.1 KiB processed)[0m in 3.31s]
[0m15:09:22.457861 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__issue_merged
[0m15:09:22.458652 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__label
[0m15:09:22.459369 [info ] [Thread-2 (]: 27 of 39 START sql table model dbt_robert.stg_github__label .................... [RUN]
[0m15:09:22.460495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue_merged, now model.github_source.stg_github__label)
[0m15:09:22.461088 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__label
[0m15:09:22.465893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:22.516786 [debug] [Thread-1 (]: Writing injected SQL for node "model.github_source.stg_github__issue"
[0m15:09:22.518277 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__issue (compile): 15:09:22.151847 => 15:09:22.517854
[0m15:09:22.519069 [debug] [Thread-1 (]: Began executing node model.github_source.stg_github__issue
[0m15:09:22.740619 [debug] [Thread-1 (]: Writing runtime sql for node "model.github_source.stg_github__issue"
[0m15:09:22.741773 [debug] [Thread-1 (]: On model.github_source.stg_github__issue: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__issue"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__issue`
    
    

    OPTIONS()
    as (
      with issue as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    body
    
 as 
    
    body
    
, 
    
    
    closed_at
    
 as 
    
    closed_at
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    locked
    
 as 
    
    locked
    
, 
    
    
    milestone_id
    
 as 
    
    milestone_id
    
, 
    
    
    number
    
 as 
    
    number
    
, 
    
    
    pull_request
    
 as 
    
    pull_request
    
, 
    
    
    repository_id
    
 as 
    
    repository_id
    
, 
    
    
    state
    
 as 
    
    state
    
, 
    
    
    title
    
 as 
    
    title
    
, 
    
    
    updated_at
    
 as 
    
    updated_at
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from issue 

), fields as (

    select 
      id as issue_id,
      body,
      cast(closed_at as TIMESTAMP) as closed_at,
      cast(created_at as TIMESTAMP) as created_at,
      locked as is_locked,
      milestone_id,
      number as issue_number,
      pull_request as is_pull_request,
      repository_id,
      state,
      title,
      cast(updated_at as TIMESTAMP) as updated_at,
      user_id
      
    from macro
)

select *
from fields
    );
  
[0m15:09:22.796152 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__label"
[0m15:09:22.797509 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__label (compile): 15:09:22.461412 => 15:09:22.797015
[0m15:09:22.798247 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__label
[0m15:09:23.073392 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__label"
[0m15:09:23.074361 [debug] [Thread-2 (]: On model.github_source.stg_github__label: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__label"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__label`
    
    

    OPTIONS()
    as (
      with issue_label as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__label_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    color
    
 as 
    
    color
    
, 
    
    
    description
    
 as 
    
    description
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    is_default
    
 as 
    
    is_default
    
, 
    
    
    name
    
 as 
    
    name
    
, 
    
    
    url
    
 as 
    
    url
    




    from issue_label

), fields as (

    select 
        id as label_id,
        _fivetran_synced,	
        color,
        description,
        is_default,
        name as label,
        url
    from macro
)

select *
from fields
    );
  
[0m15:09:25.215330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d107bef4-d49c-42eb-8435-3c2ce903a58f&page=queryresults
[0m15:09:25.218382 [debug] [Thread-1 (]: Timing info for model.github_source.stg_github__issue (execute): 15:09:22.519579 => 15:09:25.218158
[0m15:09:25.219327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07bfa770>]}
[0m15:09:25.220090 [info ] [Thread-1 (]: 26 of 39 OK created sql table model dbt_robert.stg_github__issue ............... [[32mCREATE TABLE (79.0 rows, 15.3 KiB processed)[0m in 3.07s]
[0m15:09:25.221165 [debug] [Thread-1 (]: Finished running node model.github_source.stg_github__issue
[0m15:09:25.221712 [debug] [Thread-1 (]: Began running node model.dbt_robert.pageviews_userstitching
[0m15:09:25.222698 [info ] [Thread-1 (]: 28 of 39 START sql table model dbt_robert.pageviews_userstitching .............. [RUN]
[0m15:09:25.223767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__issue, now model.dbt_robert.pageviews_userstitching)
[0m15:09:25.224222 [debug] [Thread-1 (]: Began compiling node model.dbt_robert.pageviews_userstitching
[0m15:09:25.229755 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_robert.pageviews_userstitching"
[0m15:09:25.230936 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (compile): 15:09:25.224535 => 15:09:25.230299
[0m15:09:25.231381 [debug] [Thread-1 (]: Began executing node model.dbt_robert.pageviews_userstitching
[0m15:09:25.234413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:25.561653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_robert.pageviews_userstitching"
[0m15:09:25.562910 [debug] [Thread-1 (]: On model.dbt_robert.pageviews_userstitching: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.dbt_robert.pageviews_userstitching"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`pageviews_userstitching`
    
    

    OPTIONS()
    as (
      

-- SELECT * from `analytics-engineers-club`.`web_tracking`.`pageviews`

--id,
--visitor_id,		
--device_type,	
--timestamp,	
--page,
--customer_id

--from `analytics-engineers-club.web_tracking.pageviews`

with pageviews as (
    select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
),

visitors as (
    select * from `aec-students`.`dbt_robert`.`visitors_sessionization`
),

joined as (
    select
        pageviews.*,
        -- customer id if we have it, else visitor id
        coalesce(
            visitors.first_customer_id,
            pageviews.visitor_id
        ) as blended_user_id,

        visitors.first_visitor_id

    from pageviews
    left join visitors
        on pageviews.visitor_id = visitors.visitor_id
)

select * from joined
    );
  
[0m15:09:25.721788 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3f1f2a58-4cee-4259-a57b-67124ad473e6&page=queryresults
[0m15:09:25.724937 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__label (execute): 15:09:22.798647 => 15:09:25.724654
[0m15:09:25.726084 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07094b20>]}
[0m15:09:25.726995 [info ] [Thread-2 (]: 27 of 39 OK created sql table model dbt_robert.stg_github__label ............... [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.27s]
[0m15:09:25.728285 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__label
[0m15:09:25.728943 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__pull_request_review
[0m15:09:25.729960 [info ] [Thread-2 (]: 29 of 39 START sql table model dbt_robert.stg_github__pull_request_review ...... [RUN]
[0m15:09:25.730992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__label, now model.github_source.stg_github__pull_request_review)
[0m15:09:25.731465 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__pull_request_review
[0m15:09:25.736756 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:26.051150 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__pull_request_review"
[0m15:09:26.052194 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request_review (compile): 15:09:25.731831 => 15:09:26.051842
[0m15:09:26.052747 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__pull_request_review
[0m15:09:26.339475 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__pull_request_review"
[0m15:09:26.340580 [debug] [Thread-2 (]: On model.github_source.stg_github__pull_request_review: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request_review"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__pull_request_review`
    
    

    OPTIONS()
    as (
      with pull_request_review as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request_review_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    body
    
 as 
    
    body
    
, 
    
    
    commit_sha
    
 as 
    
    commit_sha
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    pull_request_id
    
 as 
    
    pull_request_id
    
, 
    
    
    state
    
 as 
    
    state
    
, 
    
    
    submitted_at
    
 as 
    
    submitted_at
    
, 
    
    
    user_id
    
 as 
    
    user_id
    




    from pull_request_review

), fields as (

    select 
      id as pull_request_review_id,
      pull_request_id,
      cast(submitted_at as TIMESTAMP) as submitted_at,
      state,
      user_id

    from macro
)

select *
from fields
    );
  
[0m15:09:29.329919 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3a4fe14b-7e26-4b26-bcad-a39d58d86f25&page=queryresults
[0m15:09:29.333385 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request_review (execute): 15:09:26.053052 => 15:09:29.332930
[0m15:09:29.334654 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07328430>]}
[0m15:09:29.335458 [info ] [Thread-2 (]: 29 of 39 OK created sql table model dbt_robert.stg_github__pull_request_review . [[32mCREATE TABLE (48.0 rows, 2.0 KiB processed)[0m in 3.60s]
[0m15:09:29.336587 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__pull_request_review
[0m15:09:29.337147 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__pull_request
[0m15:09:29.338104 [info ] [Thread-2 (]: 30 of 39 START sql table model dbt_robert.stg_github__pull_request ............. [RUN]
[0m15:09:29.339248 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__pull_request_review, now model.github_source.stg_github__pull_request)
[0m15:09:29.339731 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__pull_request
[0m15:09:29.346838 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:29.654953 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__pull_request"
[0m15:09:29.656040 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request (compile): 15:09:29.340197 => 15:09:29.655671
[0m15:09:29.656585 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__pull_request
[0m15:09:29.881560 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__pull_request"
[0m15:09:29.882509 [debug] [Thread-2 (]: On model.github_source.stg_github__pull_request: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__pull_request"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__pull_request`
    
    

    OPTIONS()
    as (
      with pull_request as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    base_label
    
 as 
    
    base_label
    
, 
    
    
    base_ref
    
 as 
    
    base_ref
    
, 
    
    
    base_repo_id
    
 as 
    
    base_repo_id
    
, 
    
    
    base_sha
    
 as 
    
    base_sha
    
, 
    
    
    base_user_id
    
 as 
    
    base_user_id
    
, 
    
    
    head_label
    
 as 
    
    head_label
    
, 
    
    
    head_ref
    
 as 
    
    head_ref
    
, 
    
    
    head_repo_id
    
 as 
    
    head_repo_id
    
, 
    
    
    head_sha
    
 as 
    
    head_sha
    
, 
    
    
    head_user_id
    
 as 
    
    head_user_id
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    issue_id
    
 as 
    
    issue_id
    
, 
    
    
    merge_commit_sha
    
 as 
    
    merge_commit_sha
    




    from pull_request

), fields as (

    select 
      id as pull_request_id,
      issue_id,
      head_repo_id,
      head_user_id

    from macro
)

select *
from fields
    );
  
[0m15:09:32.283157 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2b71facd-dcf5-4a14-92d6-f8dec040698c&page=queryresults
[0m15:09:32.286028 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__pull_request (execute): 15:09:29.656896 => 15:09:32.285807
[0m15:09:32.286904 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda079f4c40>]}
[0m15:09:32.287634 [info ] [Thread-2 (]: 30 of 39 OK created sql table model dbt_robert.stg_github__pull_request ........ [[32mCREATE TABLE (79.0 rows, 2.5 KiB processed)[0m in 2.95s]
[0m15:09:32.288653 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__pull_request
[0m15:09:32.289200 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__repository
[0m15:09:32.290130 [info ] [Thread-2 (]: 31 of 39 START sql table model dbt_robert.stg_github__repository ............... [RUN]
[0m15:09:32.291224 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__pull_request, now model.github_source.stg_github__repository)
[0m15:09:32.291679 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__repository
[0m15:09:32.296775 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:32.579506 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__repository"
[0m15:09:32.580603 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__repository (compile): 15:09:32.292044 => 15:09:32.580198
[0m15:09:32.581137 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__repository
[0m15:09:32.831311 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__repository"
[0m15:09:32.832288 [debug] [Thread-2 (]: On model.github_source.stg_github__repository: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__repository"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__repository`
    
    

    OPTIONS()
    as (
      with repository as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__repository_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    archived
    
 as 
    
    archived
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    default_branch
    
 as 
    
    default_branch
    
, 
    
    
    description
    
 as 
    
    description
    
, 
    
    
    fork
    
 as 
    
    fork
    
, 
    
    
    full_name
    
 as 
    
    full_name
    
, 
    
    
    homepage
    
 as 
    
    homepage
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    language
    
 as 
    
    language
    
, 
    
    
    name
    
 as 
    
    name
    
, 
    
    
    owner_id
    
 as 
    
    owner_id
    
, 
    
    
    private
    
 as 
    
    private
    




    from repository

), fields as (

    select 
      id as repository_id,
      full_name,
      private as is_private

    from macro
)

select *
from fields
    );
  
[0m15:09:35.272583 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:342e20e4-46ab-4eb1-8d6b-a6455edc12af&page=queryresults
[0m15:09:35.275369 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__repository (execute): 15:09:32.581477 => 15:09:35.275149
[0m15:09:35.276316 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0799d8d0>]}
[0m15:09:35.277061 [info ] [Thread-2 (]: 31 of 39 OK created sql table model dbt_robert.stg_github__repository .......... [[32mCREATE TABLE (16.0 rows, 792.0 Bytes processed)[0m in 2.99s]
[0m15:09:35.278059 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__repository
[0m15:09:35.278621 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__requested_reviewer_history
[0m15:09:35.279364 [info ] [Thread-2 (]: 32 of 39 START sql table model dbt_robert.stg_github__requested_reviewer_history  [RUN]
[0m15:09:35.280565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__repository, now model.github_source.stg_github__requested_reviewer_history)
[0m15:09:35.281022 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__requested_reviewer_history
[0m15:09:35.286383 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:35.574928 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__requested_reviewer_history"
[0m15:09:35.575947 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__requested_reviewer_history (compile): 15:09:35.281323 => 15:09:35.575598
[0m15:09:35.576513 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__requested_reviewer_history
[0m15:09:35.807391 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__requested_reviewer_history"
[0m15:09:35.808551 [debug] [Thread-2 (]: On model.github_source.stg_github__requested_reviewer_history: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__requested_reviewer_history"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__requested_reviewer_history`
    
    

    OPTIONS()
    as (
      with requested_reviewer_history as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__requested_reviewer_history_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
        
    
    
    _fivetran_synced
    
 as 
    
    _fivetran_synced
    
, 
    
    
    actor_id
    
 as 
    
    actor_id
    
, 
    
    
    created_at
    
 as 
    
    created_at
    
, 
    
    
    pull_request_id
    
 as 
    
    pull_request_id
    
, 
    
    
    removed
    
 as 
    
    removed
    
, 
    
    
    requested_id
    
 as 
    
    requested_id
    




    from requested_reviewer_history

), fields as (

    select 
      pull_request_id,
      cast(created_at as TIMESTAMP) as created_at,
      requested_id,
      removed

    from macro
)

select *
from fields
    );
  
[0m15:09:38.219138 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:679dc5d5-b2d8-4690-b1fd-b6d33bb240e6&page=queryresults
[0m15:09:38.221952 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__requested_reviewer_history (execute): 15:09:35.576823 => 15:09:38.221722
[0m15:09:38.222913 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07b63fd0>]}
[0m15:09:38.223679 [info ] [Thread-2 (]: 32 of 39 OK created sql table model dbt_robert.stg_github__requested_reviewer_history  [[32mCREATE TABLE (26.0 rows, 650.0 Bytes processed)[0m in 2.94s]
[0m15:09:38.224852 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__requested_reviewer_history
[0m15:09:38.225395 [debug] [Thread-2 (]: Began running node model.github_source.stg_github__user
[0m15:09:38.226132 [info ] [Thread-2 (]: 33 of 39 START sql table model dbt_robert.stg_github__user ..................... [RUN]
[0m15:09:38.227623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__requested_reviewer_history, now model.github_source.stg_github__user)
[0m15:09:38.228128 [debug] [Thread-2 (]: Began compiling node model.github_source.stg_github__user
[0m15:09:38.233261 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:38.523751 [debug] [Thread-2 (]: Writing injected SQL for node "model.github_source.stg_github__user"
[0m15:09:38.525058 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__user (compile): 15:09:38.228653 => 15:09:38.524623
[0m15:09:38.525655 [debug] [Thread-2 (]: Began executing node model.github_source.stg_github__user
[0m15:09:38.603444 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5c437266-c1e2-4c4f-963a-8dcad1fdf2b1&page=queryresults
[0m15:09:38.606009 [debug] [Thread-1 (]: Timing info for model.dbt_robert.pageviews_userstitching (execute): 15:09:25.231669 => 15:09:38.605794
[0m15:09:38.606894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07be6f80>]}
[0m15:09:38.607616 [info ] [Thread-1 (]: 28 of 39 OK created sql table model dbt_robert.pageviews_userstitching ......... [[32mCREATE TABLE (5.8m rows, 719.6 MiB processed)[0m in 13.38s]
[0m15:09:38.608716 [debug] [Thread-1 (]: Finished running node model.dbt_robert.pageviews_userstitching
[0m15:09:38.609265 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_comments
[0m15:09:38.610183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_robert.pageviews_userstitching, now model.github.int_github__issue_comments)
[0m15:09:38.610835 [debug] [Thread-1 (]: Began compiling node model.github.int_github__issue_comments
[0m15:09:38.615626 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__issue_comments"
[0m15:09:38.616490 [debug] [Thread-1 (]: Timing info for model.github.int_github__issue_comments (compile): 15:09:38.611135 => 15:09:38.616143
[0m15:09:38.617418 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_comments
[0m15:09:38.617923 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_open_length
[0m15:09:38.618720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__issue_comments, now model.github.int_github__issue_open_length)
[0m15:09:38.619168 [debug] [Thread-1 (]: Began compiling node model.github.int_github__issue_open_length
[0m15:09:38.625612 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__issue_open_length"
[0m15:09:38.626443 [debug] [Thread-1 (]: Timing info for model.github.int_github__issue_open_length (compile): 15:09:38.619457 => 15:09:38.626121
[0m15:09:38.627355 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_open_length
[0m15:09:38.627855 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_label_joined
[0m15:09:38.628665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__issue_open_length, now model.github.int_github__issue_label_joined)
[0m15:09:38.629115 [debug] [Thread-1 (]: Began compiling node model.github.int_github__issue_label_joined
[0m15:09:38.637282 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__issue_label_joined"
[0m15:09:38.638176 [debug] [Thread-1 (]: Timing info for model.github.int_github__issue_label_joined (compile): 15:09:38.629581 => 15:09:38.637811
[0m15:09:38.639114 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_label_joined
[0m15:09:38.639620 [debug] [Thread-1 (]: Began running node model.github.int_github__pull_request_times
[0m15:09:38.640542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__issue_label_joined, now model.github.int_github__pull_request_times)
[0m15:09:38.641025 [debug] [Thread-1 (]: Began compiling node model.github.int_github__pull_request_times
[0m15:09:38.653143 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__pull_request_times"
[0m15:09:38.654231 [debug] [Thread-1 (]: Timing info for model.github.int_github__pull_request_times (compile): 15:09:38.641315 => 15:09:38.653950
[0m15:09:38.655152 [debug] [Thread-1 (]: Finished running node model.github.int_github__pull_request_times
[0m15:09:38.655669 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_labels
[0m15:09:38.656481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__pull_request_times, now model.github.int_github__issue_labels)
[0m15:09:38.656929 [debug] [Thread-1 (]: Began compiling node model.github.int_github__issue_labels
[0m15:09:38.669347 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__issue_labels"
[0m15:09:38.670203 [debug] [Thread-1 (]: Timing info for model.github.int_github__issue_labels (compile): 15:09:38.657219 => 15:09:38.669905
[0m15:09:38.671161 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_labels
[0m15:09:38.729543 [debug] [Thread-2 (]: Writing runtime sql for node "model.github_source.stg_github__user"
[0m15:09:38.730533 [debug] [Thread-2 (]: On model.github_source.stg_github__user: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github_source.stg_github__user"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`stg_github__user`
    
    

    OPTIONS()
    as (
      with github_user as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__user_tmp`

), macro as (
    select
        /*
        The below macro is used to generate the correct SQL for package staging models. It takes a list of columns 
        that are expected/needed (staging_columns from dbt_github_source/models/tmp/) and compares it with columns 
        in the source (source_columns from dbt_github_source/macros/).

        For more information refer to our dbt_fivetran_utils documentation (https://github.com/fivetran/dbt_fivetran_utils.git).
        */
            
    
    
    company
    
 as 
    
    company
    
, 
    
    
    id
    
 as 
    
    id
    
, 
    
    
    login
    
 as 
    
    login
    
, 
    
    
    name
    
 as 
    
    name
    



        
        
    from github_user

), fields as (

    select
      id as user_id,
      login as login_name,
      name,
      company

    from macro
)

select *
from fields
    );
  
[0m15:09:41.421968 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:11b8f727-d8e8-4105-a6f9-809488afd335&page=queryresults
[0m15:09:41.425132 [debug] [Thread-2 (]: Timing info for model.github_source.stg_github__user (execute): 15:09:38.525961 => 15:09:41.424860
[0m15:09:41.426305 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07b82680>]}
[0m15:09:41.427270 [info ] [Thread-2 (]: 33 of 39 OK created sql table model dbt_robert.stg_github__user ................ [[32mCREATE TABLE (13.0 rows, 438.0 Bytes processed)[0m in 3.20s]
[0m15:09:41.428645 [debug] [Thread-2 (]: Finished running node model.github_source.stg_github__user
[0m15:09:41.430558 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_assignees
[0m15:09:41.431202 [debug] [Thread-2 (]: Began running node model.github.int_github__pull_request_reviewers
[0m15:09:41.432287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__issue_labels, now model.github.int_github__issue_assignees)
[0m15:09:41.433112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github_source.stg_github__user, now model.github.int_github__pull_request_reviewers)
[0m15:09:41.433646 [debug] [Thread-1 (]: Began compiling node model.github.int_github__issue_assignees
[0m15:09:41.434164 [debug] [Thread-2 (]: Began compiling node model.github.int_github__pull_request_reviewers
[0m15:09:41.440716 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__issue_assignees"
[0m15:09:41.448064 [debug] [Thread-2 (]: Writing injected SQL for node "model.github.int_github__pull_request_reviewers"
[0m15:09:41.449132 [debug] [Thread-1 (]: Timing info for model.github.int_github__issue_assignees (compile): 15:09:41.434493 => 15:09:41.448884
[0m15:09:41.449765 [debug] [Thread-2 (]: Timing info for model.github.int_github__pull_request_reviewers (compile): 15:09:41.441066 => 15:09:41.449492
[0m15:09:41.450652 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_assignees
[0m15:09:41.451595 [debug] [Thread-2 (]: Finished running node model.github.int_github__pull_request_reviewers
[0m15:09:41.452778 [debug] [Thread-1 (]: Began running node model.github.int_github__issue_joined
[0m15:09:41.453513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__issue_assignees, now model.github.int_github__issue_joined)
[0m15:09:41.453991 [debug] [Thread-1 (]: Began compiling node model.github.int_github__issue_joined
[0m15:09:41.481946 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.int_github__issue_joined"
[0m15:09:41.482798 [debug] [Thread-1 (]: Timing info for model.github.int_github__issue_joined (compile): 15:09:41.454280 => 15:09:41.482539
[0m15:09:41.483777 [debug] [Thread-1 (]: Finished running node model.github.int_github__issue_joined
[0m15:09:41.484773 [debug] [Thread-2 (]: Began running node model.github.github__issues
[0m15:09:41.485206 [debug] [Thread-1 (]: Began running node model.github.github__pull_requests
[0m15:09:41.485777 [info ] [Thread-2 (]: 34 of 39 START sql table model dbt_robert.github__issues ....................... [RUN]
[0m15:09:41.486796 [info ] [Thread-1 (]: 35 of 39 START sql table model dbt_robert.github__pull_requests ................ [RUN]
[0m15:09:41.488152 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github.int_github__pull_request_reviewers, now model.github.github__issues)
[0m15:09:41.488941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.int_github__issue_joined, now model.github.github__pull_requests)
[0m15:09:41.489442 [debug] [Thread-2 (]: Began compiling node model.github.github__issues
[0m15:09:41.489918 [debug] [Thread-1 (]: Began compiling node model.github.github__pull_requests
[0m15:09:41.498457 [debug] [Thread-2 (]: Writing injected SQL for node "model.github.github__issues"
[0m15:09:41.505263 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.github__pull_requests"
[0m15:09:41.506185 [debug] [Thread-2 (]: Timing info for model.github.github__issues (compile): 15:09:41.490239 => 15:09:41.505927
[0m15:09:41.507005 [debug] [Thread-1 (]: Timing info for model.github.github__pull_requests (compile): 15:09:41.498819 => 15:09:41.506761
[0m15:09:41.507408 [debug] [Thread-2 (]: Began executing node model.github.github__issues
[0m15:09:41.507882 [debug] [Thread-1 (]: Began executing node model.github.github__pull_requests
[0m15:09:41.512120 [debug] [Thread-2 (]: Writing runtime sql for node "model.github.github__issues"
[0m15:09:41.515981 [debug] [Thread-1 (]: Writing runtime sql for node "model.github.github__pull_requests"
[0m15:09:41.517042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:41.517885 [debug] [Thread-1 (]: On model.github.github__pull_requests: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github.github__pull_requests"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`github__pull_requests`
    
    

    OPTIONS()
    as (
      with  __dbt__cte__int_github__issue_label_joined as (
with issue_label as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_label`

), label as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__label`

), joined as (

    select 
        issue_label.issue_id,
        label.label
    from issue_label
    left join label 
        on issue_label.label_id = label.label_id

)

select *
from joined
),  __dbt__cte__int_github__issue_labels as (
with issue_label as (
    select *
    from __dbt__cte__int_github__issue_label_joined
)

select
  issue_id,
  
    string_agg(label, ', ')

 as labels
from issue_label
group by issue_id
),  __dbt__cte__int_github__issue_assignees as (
with issue_assignee as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_assignee`
), 

github_user as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__user`
)

select
  issue_assignee.issue_id,
  
    string_agg(github_user.login_name, ', ')

 as assignees
from issue_assignee
join github_user on issue_assignee.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_open_length as (
with issue as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue`
), 

issue_closed_history as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_closed_history`
), 

close_events_stacked as (
    select   
      issue_id,
      created_at as updated_at,
      false as is_closed
    from issue -- required because issue_closed_history table does not have a line item for when the issue was opened
    union all
    select
      issue_id,
      updated_at,
      is_closed
    from issue_closed_history
), 

close_events_with_timestamps as (
  select
    issue_id,
    updated_at as valid_starting,
    coalesce(lead(updated_at) over (partition by issue_id order by updated_at), current_timestamp) as valid_until,
    is_closed
  from close_events_stacked
)

select
  issue_id,
  sum(

    datetime_diff(
        cast(valid_until as datetime),
        cast(valid_starting as datetime),
        second
    )

  ) /60/60/24 as days_issue_open,
  count(*) - 1 as number_of_times_reopened
from close_events_with_timestamps
  where not is_closed
group by issue_id
),  __dbt__cte__int_github__issue_comments as (
with issue_comment as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_comment`
)

select
  issue_id,
  count(*) as number_of_comments
from issue_comment
group by issue_id
),  __dbt__cte__int_github__pull_request_times as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request_review`
), 

pull_request as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request`
), 

requested_reviewer_history as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__requested_reviewer_history`
    where not removed
), 

issue as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue`
), 

issue_merged as (
    select
      issue_id,
      min(merged_at) as merged_at
      from `aec-students`.`dbt_robert`.`stg_github__issue_merged`
    group by 1
), 

first_request_time as (
    select
      pull_request.issue_id,
      pull_request.pull_request_id,
      -- Finds the first review that is by the requested reviewer and is not a dismissal
      min(case when requested_reviewer_history.requested_id = pull_request_review.user_id then
          case when lower(pull_request_review.state) in ('commented', 'approved', 'changes_requested') 
                then pull_request_review.submitted_at end 
      else null end) as time_of_first_requested_reviewer_review,
      min(requested_reviewer_history.created_at) as time_of_first_request,
      min(pull_request_review.submitted_at) as time_of_first_review_post_request
    from pull_request
    join requested_reviewer_history on requested_reviewer_history.pull_request_id = pull_request.pull_request_id
    left join pull_request_review on pull_request_review.pull_request_id = pull_request.pull_request_id
      and pull_request_review.submitted_at > requested_reviewer_history.created_at
    group by 1, 2
)

select
  first_request_time.issue_id,
  issue_merged.merged_at,
  

    datetime_diff(
        cast(coalesce(time_of_first_review_post_request, current_timestamp) as datetime),
        cast(time_of_first_request as datetime),
        second
    )

  / 60/60 as hours_request_review_to_first_review,
  

    datetime_diff(
        cast(least(
                            coalesce(time_of_first_requested_reviewer_review, current_timestamp),
                            coalesce(issue.closed_at, current_timestamp)) as datetime),
        cast(time_of_first_request as datetime),
        second
    )

   / 60/60 as hours_request_review_to_first_action,
  

    datetime_diff(
        cast(merged_at as datetime),
        cast(time_of_first_request as datetime),
        second
    )

  / 60/60 as hours_request_review_to_merge
from first_request_time
join issue on first_request_time.issue_id = issue.issue_id
left join issue_merged on first_request_time.issue_id = issue_merged.issue_id
),  __dbt__cte__int_github__pull_request_reviewers as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request_review`
), 

github_user as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__user`
),

actual_reviewers as (
  select
    pull_request_review.pull_request_id,
    
    string_agg(distinct github_user.login_name, ', ')

 as reviewers,
    count(*) as number_of_reviews
from pull_request_review
left join github_user on pull_request_review.user_id = github_user.user_id
group by 1
),

requested_reviewer_history as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__requested_reviewer_history`
    where removed = false
),

requested_reviewers as (
  select
    requested_reviewer_history.pull_request_id,
    
    string_agg(distinct github_user.login_name, ', ')

 as requested_reviewers
from requested_reviewer_history
left join github_user on requested_reviewer_history.requested_id = github_user.user_id
group by 1
),

joined as (
  select
    actual_reviewers.pull_request_id,
    actual_reviewers.reviewers,
    requested_reviewers.requested_reviewers,
    actual_reviewers.number_of_reviews
  from actual_reviewers
  full outer join requested_reviewers 
    on requested_reviewers.pull_request_id = actual_reviewers.pull_request_id
)

select *
from joined
),  __dbt__cte__int_github__issue_joined as (
with issue as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue`
), 

issue_labels as (
    select *
    from __dbt__cte__int_github__issue_labels
), 

repository_teams as (
    select 
    
      repository_id,
      full_name as repository
    from `aec-students`.`dbt_robert`.`stg_github__repository`

    
), 

issue_assignees as (
    select *
    from __dbt__cte__int_github__issue_assignees
), 

issue_open_length as (
    select *
    from __dbt__cte__int_github__issue_open_length
), 

issue_comments as (
    select *
    from __dbt__cte__int_github__issue_comments
), 

creator as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__user`
), 

pull_request_times as (
    select *
    from __dbt__cte__int_github__pull_request_times
), 

pull_request_reviewers as (
    select *
    from __dbt__cte__int_github__pull_request_reviewers
), 

pull_request as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request`
)

select
  issue.*,
  case 
    when issue.is_pull_request then 'https://github.com/' || repository_teams.repository || '/pull/' || issue.issue_number
    else 'https://github.com/' || repository_teams.repository || '/issues/' || issue.issue_number
  end as url_link,
  issue_open_length.days_issue_open,
  issue_open_length.number_of_times_reopened,
  labels.labels,
  issue_comments.number_of_comments,
  repository_teams.repository,
  
  issue_assignees.assignees,
  creator.login_name as creator_login_name,
  creator.name as creator_name,
  creator.company as creator_company,
  hours_request_review_to_first_review,
  hours_request_review_to_first_action,
  hours_request_review_to_merge,
  merged_at,
  reviewers, 
  requested_reviewers,
  number_of_reviews
from issue
left join issue_labels as labels
  on issue.issue_id = labels.issue_id
join repository_teams
  on issue.repository_id = repository_teams.repository_id
left join issue_assignees
  on issue.issue_id = issue_assignees.issue_id
left join issue_open_length
  on issue.issue_id = issue_open_length.issue_id
left join issue_comments 
  on issue.issue_id = issue_comments.issue_id
left join creator 
  on issue.user_id = creator.user_id
left join pull_request
  on issue.issue_id = pull_request.issue_id
left join pull_request_times
  on issue.issue_id = pull_request_times.issue_id
left join pull_request_reviewers
  on pull_request.pull_request_id = pull_request_reviewers.pull_request_id
),issue_joined as (
    select *
    from __dbt__cte__int_github__issue_joined  
)

select
  *
from issue_joined
where is_pull_request
    );
  
[0m15:09:41.521009 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:41.522038 [debug] [Thread-2 (]: On model.github.github__issues: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github.github__issues"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`github__issues`
    
    

    OPTIONS()
    as (
      with  __dbt__cte__int_github__issue_label_joined as (
with issue_label as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_label`

), label as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__label`

), joined as (

    select 
        issue_label.issue_id,
        label.label
    from issue_label
    left join label 
        on issue_label.label_id = label.label_id

)

select *
from joined
),  __dbt__cte__int_github__issue_labels as (
with issue_label as (
    select *
    from __dbt__cte__int_github__issue_label_joined
)

select
  issue_id,
  
    string_agg(label, ', ')

 as labels
from issue_label
group by issue_id
),  __dbt__cte__int_github__issue_assignees as (
with issue_assignee as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_assignee`
), 

github_user as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__user`
)

select
  issue_assignee.issue_id,
  
    string_agg(github_user.login_name, ', ')

 as assignees
from issue_assignee
join github_user on issue_assignee.user_id = github_user.user_id
group by 1
),  __dbt__cte__int_github__issue_open_length as (
with issue as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue`
), 

issue_closed_history as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_closed_history`
), 

close_events_stacked as (
    select   
      issue_id,
      created_at as updated_at,
      false as is_closed
    from issue -- required because issue_closed_history table does not have a line item for when the issue was opened
    union all
    select
      issue_id,
      updated_at,
      is_closed
    from issue_closed_history
), 

close_events_with_timestamps as (
  select
    issue_id,
    updated_at as valid_starting,
    coalesce(lead(updated_at) over (partition by issue_id order by updated_at), current_timestamp) as valid_until,
    is_closed
  from close_events_stacked
)

select
  issue_id,
  sum(

    datetime_diff(
        cast(valid_until as datetime),
        cast(valid_starting as datetime),
        second
    )

  ) /60/60/24 as days_issue_open,
  count(*) - 1 as number_of_times_reopened
from close_events_with_timestamps
  where not is_closed
group by issue_id
),  __dbt__cte__int_github__issue_comments as (
with issue_comment as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue_comment`
)

select
  issue_id,
  count(*) as number_of_comments
from issue_comment
group by issue_id
),  __dbt__cte__int_github__pull_request_times as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request_review`
), 

pull_request as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request`
), 

requested_reviewer_history as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__requested_reviewer_history`
    where not removed
), 

issue as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue`
), 

issue_merged as (
    select
      issue_id,
      min(merged_at) as merged_at
      from `aec-students`.`dbt_robert`.`stg_github__issue_merged`
    group by 1
), 

first_request_time as (
    select
      pull_request.issue_id,
      pull_request.pull_request_id,
      -- Finds the first review that is by the requested reviewer and is not a dismissal
      min(case when requested_reviewer_history.requested_id = pull_request_review.user_id then
          case when lower(pull_request_review.state) in ('commented', 'approved', 'changes_requested') 
                then pull_request_review.submitted_at end 
      else null end) as time_of_first_requested_reviewer_review,
      min(requested_reviewer_history.created_at) as time_of_first_request,
      min(pull_request_review.submitted_at) as time_of_first_review_post_request
    from pull_request
    join requested_reviewer_history on requested_reviewer_history.pull_request_id = pull_request.pull_request_id
    left join pull_request_review on pull_request_review.pull_request_id = pull_request.pull_request_id
      and pull_request_review.submitted_at > requested_reviewer_history.created_at
    group by 1, 2
)

select
  first_request_time.issue_id,
  issue_merged.merged_at,
  

    datetime_diff(
        cast(coalesce(time_of_first_review_post_request, current_timestamp) as datetime),
        cast(time_of_first_request as datetime),
        second
    )

  / 60/60 as hours_request_review_to_first_review,
  

    datetime_diff(
        cast(least(
                            coalesce(time_of_first_requested_reviewer_review, current_timestamp),
                            coalesce(issue.closed_at, current_timestamp)) as datetime),
        cast(time_of_first_request as datetime),
        second
    )

   / 60/60 as hours_request_review_to_first_action,
  

    datetime_diff(
        cast(merged_at as datetime),
        cast(time_of_first_request as datetime),
        second
    )

  / 60/60 as hours_request_review_to_merge
from first_request_time
join issue on first_request_time.issue_id = issue.issue_id
left join issue_merged on first_request_time.issue_id = issue_merged.issue_id
),  __dbt__cte__int_github__pull_request_reviewers as (
with pull_request_review as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request_review`
), 

github_user as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__user`
),

actual_reviewers as (
  select
    pull_request_review.pull_request_id,
    
    string_agg(distinct github_user.login_name, ', ')

 as reviewers,
    count(*) as number_of_reviews
from pull_request_review
left join github_user on pull_request_review.user_id = github_user.user_id
group by 1
),

requested_reviewer_history as (

    select *
    from `aec-students`.`dbt_robert`.`stg_github__requested_reviewer_history`
    where removed = false
),

requested_reviewers as (
  select
    requested_reviewer_history.pull_request_id,
    
    string_agg(distinct github_user.login_name, ', ')

 as requested_reviewers
from requested_reviewer_history
left join github_user on requested_reviewer_history.requested_id = github_user.user_id
group by 1
),

joined as (
  select
    actual_reviewers.pull_request_id,
    actual_reviewers.reviewers,
    requested_reviewers.requested_reviewers,
    actual_reviewers.number_of_reviews
  from actual_reviewers
  full outer join requested_reviewers 
    on requested_reviewers.pull_request_id = actual_reviewers.pull_request_id
)

select *
from joined
),  __dbt__cte__int_github__issue_joined as (
with issue as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__issue`
), 

issue_labels as (
    select *
    from __dbt__cte__int_github__issue_labels
), 

repository_teams as (
    select 
    
      repository_id,
      full_name as repository
    from `aec-students`.`dbt_robert`.`stg_github__repository`

    
), 

issue_assignees as (
    select *
    from __dbt__cte__int_github__issue_assignees
), 

issue_open_length as (
    select *
    from __dbt__cte__int_github__issue_open_length
), 

issue_comments as (
    select *
    from __dbt__cte__int_github__issue_comments
), 

creator as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__user`
), 

pull_request_times as (
    select *
    from __dbt__cte__int_github__pull_request_times
), 

pull_request_reviewers as (
    select *
    from __dbt__cte__int_github__pull_request_reviewers
), 

pull_request as (
    select *
    from `aec-students`.`dbt_robert`.`stg_github__pull_request`
)

select
  issue.*,
  case 
    when issue.is_pull_request then 'https://github.com/' || repository_teams.repository || '/pull/' || issue.issue_number
    else 'https://github.com/' || repository_teams.repository || '/issues/' || issue.issue_number
  end as url_link,
  issue_open_length.days_issue_open,
  issue_open_length.number_of_times_reopened,
  labels.labels,
  issue_comments.number_of_comments,
  repository_teams.repository,
  
  issue_assignees.assignees,
  creator.login_name as creator_login_name,
  creator.name as creator_name,
  creator.company as creator_company,
  hours_request_review_to_first_review,
  hours_request_review_to_first_action,
  hours_request_review_to_merge,
  merged_at,
  reviewers, 
  requested_reviewers,
  number_of_reviews
from issue
left join issue_labels as labels
  on issue.issue_id = labels.issue_id
join repository_teams
  on issue.repository_id = repository_teams.repository_id
left join issue_assignees
  on issue.issue_id = issue_assignees.issue_id
left join issue_open_length
  on issue.issue_id = issue_open_length.issue_id
left join issue_comments 
  on issue.issue_id = issue_comments.issue_id
left join creator 
  on issue.user_id = creator.user_id
left join pull_request
  on issue.issue_id = pull_request.issue_id
left join pull_request_times
  on issue.issue_id = pull_request_times.issue_id
left join pull_request_reviewers
  on pull_request.pull_request_id = pull_request_reviewers.pull_request_id
),issue_joined as (
    select *
    from __dbt__cte__int_github__issue_joined  
)

select
  issue_id,
  body,
  closed_at,
  created_at,
  is_locked,
  milestone_id,
  issue_number,
  is_pull_request,
  repository_id,
  state,
  title,
  updated_at,
  user_id,
  url_link,
  days_issue_open,
  number_of_times_reopened,
  labels,
  number_of_comments,
  repository,
  
  assignees,
  creator_login_name,
  creator_name,
  creator_company
from issue_joined
where not is_pull_request
    );
  
[0m15:09:45.356030 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8397e8c9-8416-405d-a47a-d5acc1a413e1&page=queryresults
[0m15:09:45.358918 [debug] [Thread-2 (]: Timing info for model.github.github__issues (execute): 15:09:41.508207 => 15:09:45.358648
[0m15:09:45.359904 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda072bbe20>]}
[0m15:09:45.360676 [info ] [Thread-2 (]: 34 of 39 OK created sql table model dbt_robert.github__issues .................. [[32mCREATE TABLE (0.0 rows, 20.2 KiB processed)[0m in 3.87s]
[0m15:09:45.361968 [debug] [Thread-2 (]: Finished running node model.github.github__issues
[0m15:09:45.686583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:70283774-a91c-4faa-b57d-b6ddaf9c02ba&page=queryresults
[0m15:09:45.689669 [debug] [Thread-1 (]: Timing info for model.github.github__pull_requests (execute): 15:09:41.512486 => 15:09:45.689403
[0m15:09:45.690723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07cadcc0>]}
[0m15:09:45.691596 [info ] [Thread-1 (]: 35 of 39 OK created sql table model dbt_robert.github__pull_requests ........... [[32mCREATE TABLE (79.0 rows, 22.4 KiB processed)[0m in 4.20s]
[0m15:09:45.692846 [debug] [Thread-1 (]: Finished running node model.github.github__pull_requests
[0m15:09:45.694585 [debug] [Thread-2 (]: Began running node model.github.github__daily_metrics
[0m15:09:45.695344 [info ] [Thread-2 (]: 36 of 39 START sql table model dbt_robert.github__daily_metrics ................ [RUN]
[0m15:09:45.696430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github.github__issues, now model.github.github__daily_metrics)
[0m15:09:45.696918 [debug] [Thread-2 (]: Began compiling node model.github.github__daily_metrics
[0m15:09:45.704745 [debug] [Thread-2 (]: Writing injected SQL for node "model.github.github__daily_metrics"
[0m15:09:45.705482 [debug] [Thread-2 (]: Timing info for model.github.github__daily_metrics (compile): 15:09:45.697631 => 15:09:45.705247
[0m15:09:45.705915 [debug] [Thread-2 (]: Began executing node model.github.github__daily_metrics
[0m15:09:45.713381 [debug] [Thread-2 (]: Writing runtime sql for node "model.github.github__daily_metrics"
[0m15:09:45.714123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:45.714765 [debug] [Thread-2 (]: On model.github.github__daily_metrics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github.github__daily_metrics"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`github__daily_metrics`
    
    

    OPTIONS()
    as (
      with github_issues as (
    select *
    from `aec-students`.`dbt_robert`.`github__issues`
), 

pull_requests as (
    select *
    from `aec-students`.`dbt_robert`.`github__pull_requests`
), 

issues_opened_per_day as (
    select 
      timestamp_trunc(
        cast(created_at as timestamp),
        day
    ) as day,
      repository as repository,
      count(*) as number_issues_opened,
      sum(days_issue_open) as sum_days_issue_open,
      max(days_issue_open) as longest_days_issue_open
    from github_issues
    group by 
      1,2
), 

issues_closed_per_day as (
    select 
      timestamp_trunc(
        cast(closed_at as timestamp),
        day
    ) as day,
      repository as repository,
      count(*) as number_issues_closed
    from github_issues
    where closed_at is not null
    group by 
      1,2
), 

prs_opened_per_day as (
    select 
      timestamp_trunc(
        cast(created_at as timestamp),
        day
    ) as day,
      repository as repository,
      count(*) as number_prs_opened,
      sum(days_issue_open) as sum_days_pr_open,
      max(days_issue_open) as longest_days_pr_open
    from pull_requests
    group by 
      1,2
), 

prs_merged_per_day as (
    select 
      timestamp_trunc(
        cast(merged_at as timestamp),
        day
    ) as day, 
      repository as repository,
      count(*) as number_prs_merged
    from pull_requests
    where merged_at is not null
    group by
      1,2
), 

prs_closed_without_merge_per_day as (
    select 
      timestamp_trunc(
        cast(closed_at as timestamp),
        day
    ) as day,
      repository as repository,
      count(*) as number_prs_closed_without_merge
    from pull_requests
    where closed_at is not null
      and merged_at is null
    group by
      1,2
), 

issues_per_day as (
    select 
      coalesce(issues_opened_per_day.day, 
        issues_closed_per_day.day
      ) as day,
      coalesce(issues_opened_per_day.repository, 
        issues_closed_per_day.repository
      ) as repository,
      number_issues_opened,
      number_issues_closed,      
      sum_days_issue_open,
      longest_days_issue_open
    from issues_opened_per_day
    full outer join issues_closed_per_day
    on 
      issues_opened_per_day.day = issues_closed_per_day.day
      and issues_opened_per_day.repository = issues_closed_per_day.repository
), 

prs_per_day as (
    select 
      coalesce(prs_opened_per_day.day, 
        prs_merged_per_day.day,
        prs_closed_without_merge_per_day.day
      ) as day,
      coalesce(prs_opened_per_day.repository, 
        prs_merged_per_day.repository,
        prs_closed_without_merge_per_day.repository
      ) as repository,
      number_prs_opened,
      number_prs_merged,
      number_prs_closed_without_merge,
      sum_days_pr_open,
      longest_days_pr_open
    from prs_opened_per_day
    full outer join prs_merged_per_day 
    on
      prs_opened_per_day.day = prs_merged_per_day.day
      and prs_opened_per_day.repository = prs_merged_per_day.repository
    full outer join prs_closed_without_merge_per_day 
    on
      coalesce(prs_opened_per_day.day, prs_merged_per_day.day) = prs_closed_without_merge_per_day.day
      and coalesce(prs_opened_per_day.repository, prs_merged_per_day.repository) = prs_closed_without_merge_per_day.repository
)

select 
  coalesce(issues_per_day.day, prs_per_day.day) as day,
  coalesce(issues_per_day.repository, prs_per_day.repository) as repository,
  coalesce(number_issues_opened, 0) as number_issues_opened,
  coalesce(number_issues_closed, 0) as number_issues_closed,
  sum_days_issue_open,
  longest_days_issue_open,
  coalesce(number_prs_opened, 0) as number_prs_opened,
  coalesce(number_prs_merged, 0) as number_prs_merged,
  coalesce(number_prs_closed_without_merge, 0) as number_prs_closed_without_merge,
  sum_days_pr_open,
  longest_days_pr_open
from issues_per_day 
full outer join prs_per_day 
on
  issues_per_day.day = prs_per_day.day
  and issues_per_day.repository = prs_per_day.repository
    );
  
[0m15:09:49.088487 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c16d2ac5-8008-422f-9935-9ee7c3960162&page=queryresults
[0m15:09:49.091080 [debug] [Thread-2 (]: Timing info for model.github.github__daily_metrics (execute): 15:09:45.706205 => 15:09:49.090860
[0m15:09:49.091973 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07cd1d50>]}
[0m15:09:49.092744 [info ] [Thread-2 (]: 36 of 39 OK created sql table model dbt_robert.github__daily_metrics ........... [[32mCREATE TABLE (62.0 rows, 5.0 KiB processed)[0m in 3.40s]
[0m15:09:49.093736 [debug] [Thread-2 (]: Finished running node model.github.github__daily_metrics
[0m15:09:49.094868 [debug] [Thread-1 (]: Began running node model.github.github__monthly_metrics
[0m15:09:49.095449 [debug] [Thread-2 (]: Began running node model.github.github__quarterly_metrics
[0m15:09:49.096147 [info ] [Thread-1 (]: 37 of 39 START sql table model dbt_robert.github__monthly_metrics .............. [RUN]
[0m15:09:49.098228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.github.github__pull_requests, now model.github.github__monthly_metrics)
[0m15:09:49.098721 [debug] [Thread-1 (]: Began compiling node model.github.github__monthly_metrics
[0m15:09:49.103293 [debug] [Thread-1 (]: Writing injected SQL for node "model.github.github__monthly_metrics"
[0m15:09:49.096983 [info ] [Thread-2 (]: 38 of 39 START sql table model dbt_robert.github__quarterly_metrics ............ [RUN]
[0m15:09:49.104210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github.github__daily_metrics, now model.github.github__quarterly_metrics)
[0m15:09:49.104724 [debug] [Thread-1 (]: Timing info for model.github.github__monthly_metrics (compile): 15:09:49.099021 => 15:09:49.104502
[0m15:09:49.105177 [debug] [Thread-2 (]: Began compiling node model.github.github__quarterly_metrics
[0m15:09:49.105665 [debug] [Thread-1 (]: Began executing node model.github.github__monthly_metrics
[0m15:09:49.109958 [debug] [Thread-2 (]: Writing injected SQL for node "model.github.github__quarterly_metrics"
[0m15:09:49.113933 [debug] [Thread-1 (]: Writing runtime sql for node "model.github.github__monthly_metrics"
[0m15:09:49.114682 [debug] [Thread-2 (]: Timing info for model.github.github__quarterly_metrics (compile): 15:09:49.106068 => 15:09:49.114444
[0m15:09:49.115267 [debug] [Thread-2 (]: Began executing node model.github.github__quarterly_metrics
[0m15:09:49.119140 [debug] [Thread-2 (]: Writing runtime sql for node "model.github.github__quarterly_metrics"
[0m15:09:49.119896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:49.120383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:49.120878 [debug] [Thread-2 (]: On model.github.github__quarterly_metrics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github.github__quarterly_metrics"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`github__quarterly_metrics`
    
    

    OPTIONS()
    as (
      with daily_metrics as (
    select *
    from `aec-students`.`dbt_robert`.`github__daily_metrics`
)

select 
  timestamp_trunc(
        cast(day as timestamp),
        quarter
    ) as quarter, 
  repository as repository,
  sum(number_issues_opened) as number_issues_opened,
  sum(number_issues_closed) as number_issues_closed,
  sum(sum_days_issue_open) / sum(number_issues_opened) as avg_days_issue_open,
  max(longest_days_issue_open) as longest_days_issue_open,
  sum(number_prs_opened) as number_prs_opened,
  sum(number_prs_merged) as number_prs_merged,
  sum(number_prs_closed_without_merge) as number_prs_closed_without_merge,
  sum(sum_days_pr_open) / sum(number_prs_opened) as avg_days_pr_open,
  max(longest_days_pr_open) as longest_days_pr_open

from daily_metrics 
group by 1,2
    );
  
[0m15:09:49.121438 [debug] [Thread-1 (]: On model.github.github__monthly_metrics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github.github__monthly_metrics"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`github__monthly_metrics`
    
    

    OPTIONS()
    as (
      with daily_metrics as (
    select *
    from `aec-students`.`dbt_robert`.`github__daily_metrics`
)

select 
  timestamp_trunc(
        cast(day as timestamp),
        month
    ) as month, 
  repository as repository,
  sum(number_issues_opened) as number_issues_opened,
  sum(number_issues_closed) as number_issues_closed,
  sum(sum_days_issue_open) / sum(number_issues_opened) as avg_days_issue_open,
  max(longest_days_issue_open) as longest_days_issue_open,
  sum(number_prs_opened) as number_prs_opened,
  sum(number_prs_merged) as number_prs_merged,
  sum(number_prs_closed_without_merge) as number_prs_closed_without_merge,
  sum(sum_days_pr_open) / sum(number_prs_opened) as avg_days_pr_open,
  max(longest_days_pr_open) as longest_days_pr_open
from daily_metrics 
group by 1,2
    );
  
[0m15:09:51.570606 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:574a0022-e58b-477d-bc18-091226be0d0a&page=queryresults
[0m15:09:51.572886 [debug] [Thread-2 (]: Timing info for model.github.github__quarterly_metrics (execute): 15:09:49.115599 => 15:09:51.572668
[0m15:09:51.573794 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07476ec0>]}
[0m15:09:51.574530 [info ] [Thread-2 (]: 38 of 39 OK created sql table model dbt_robert.github__quarterly_metrics ....... [[32mCREATE TABLE (20.0 rows, 6.2 KiB processed)[0m in 2.47s]
[0m15:09:51.575518 [debug] [Thread-2 (]: Finished running node model.github.github__quarterly_metrics
[0m15:09:51.576070 [debug] [Thread-2 (]: Began running node model.github.github__weekly_metrics
[0m15:09:51.576820 [info ] [Thread-2 (]: 39 of 39 START sql table model dbt_robert.github__weekly_metrics ............... [RUN]
[0m15:09:51.578085 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.github.github__quarterly_metrics, now model.github.github__weekly_metrics)
[0m15:09:51.578540 [debug] [Thread-2 (]: Began compiling node model.github.github__weekly_metrics
[0m15:09:51.583789 [debug] [Thread-2 (]: Writing injected SQL for node "model.github.github__weekly_metrics"
[0m15:09:51.584553 [debug] [Thread-2 (]: Timing info for model.github.github__weekly_metrics (compile): 15:09:51.578891 => 15:09:51.584289
[0m15:09:51.584986 [debug] [Thread-2 (]: Began executing node model.github.github__weekly_metrics
[0m15:09:51.589120 [debug] [Thread-2 (]: Writing runtime sql for node "model.github.github__weekly_metrics"
[0m15:09:51.589942 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:09:51.590446 [debug] [Thread-2 (]: On model.github.github__weekly_metrics: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "dbt_robert", "target_name": "dev", "node_id": "model.github.github__weekly_metrics"} */

  
    

    create or replace table `aec-students`.`dbt_robert`.`github__weekly_metrics`
    
    

    OPTIONS()
    as (
      with daily_metrics as (
    select *
    from `aec-students`.`dbt_robert`.`github__daily_metrics`
)

select 
  timestamp_trunc(
        cast(day as timestamp),
        week
    ) as week,
  repository as repository, 
  sum(number_issues_opened) as number_issues_opened,
  sum(number_issues_closed) as number_issues_closed,
  sum(sum_days_issue_open) / sum(number_issues_opened) as avg_days_issue_open,
  max(longest_days_issue_open) as longest_days_issue_open,
  sum(number_prs_opened) as number_prs_opened,
  sum(number_prs_merged) as number_prs_merged,
  sum(number_prs_closed_without_merge) as number_prs_closed_without_merge,
  sum(sum_days_pr_open) / sum(number_prs_opened) as avg_days_pr_open,
  max(longest_days_pr_open) as longest_days_pr_open
from daily_metrics 
group by 1,2
    );
  
[0m15:09:51.915971 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ccfc8915-50d1-47d2-91a6-126a53c97b5f&page=queryresults
[0m15:09:51.918621 [debug] [Thread-1 (]: Timing info for model.github.github__monthly_metrics (execute): 15:09:49.110302 => 15:09:51.918348
[0m15:09:51.919680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07468100>]}
[0m15:09:51.920588 [info ] [Thread-1 (]: 37 of 39 OK created sql table model dbt_robert.github__monthly_metrics ......... [[32mCREATE TABLE (26.0 rows, 6.2 KiB processed)[0m in 2.82s]
[0m15:09:51.921778 [debug] [Thread-1 (]: Finished running node model.github.github__monthly_metrics
[0m15:09:54.027129 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:dcd71920-c4ad-4a81-bc2c-cb9c60df3cb0&page=queryresults
[0m15:09:54.029975 [debug] [Thread-2 (]: Timing info for model.github.github__weekly_metrics (execute): 15:09:51.585272 => 15:09:54.029696
[0m15:09:54.031140 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501c994a-4939-4cbc-bfeb-0e1faf2088b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda074c8bb0>]}
[0m15:09:54.031934 [info ] [Thread-2 (]: 39 of 39 OK created sql table model dbt_robert.github__weekly_metrics .......... [[32mCREATE TABLE (43.0 rows, 6.2 KiB processed)[0m in 2.45s]
[0m15:09:54.032965 [debug] [Thread-2 (]: Finished running node model.github.github__weekly_metrics
[0m15:09:54.035412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:54.035828 [debug] [MainThread]: Connection 'model.github.github__monthly_metrics' was properly closed.
[0m15:09:54.036187 [debug] [MainThread]: Connection 'model.github.github__weekly_metrics' was properly closed.
[0m15:09:54.036761 [info ] [MainThread]: 
[0m15:09:54.037502 [info ] [MainThread]: Finished running 15 view models, 24 table models in 0 hours 1 minutes and 0.81 seconds (60.81s).
[0m15:09:54.044708 [debug] [MainThread]: Command end result
[0m15:09:54.071098 [info ] [MainThread]: 
[0m15:09:54.071987 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:54.072764 [info ] [MainThread]: 
[0m15:09:54.073454 [info ] [MainThread]: Done. PASS=39 WARN=0 ERROR=0 SKIP=0 TOTAL=39
[0m15:09:54.074567 [debug] [MainThread]: Command `dbt run` succeeded at 15:09:54.074375 after 64.14 seconds
[0m15:09:54.075115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0a9a2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07d9b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda07ec7580>]}
[0m15:09:54.075583 [debug] [MainThread]: Flushing usage events
